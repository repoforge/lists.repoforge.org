<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [svn] r3443 - in trunk/rpms: xine xine-lib
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:commits%40lists.repoforge.org?Subject=Re:%20Re%3A%20%5Bsvn%5D%20r3443%20-%20in%20trunk/rpms%3A%20xine%20xine-lib&In-Reply-To=%3C20050730140957.78372318042%40pooch.vmhosting.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002244.html">
   <LINK REL="Next"  HREF="002246.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[svn] r3443 - in trunk/rpms: xine xine-lib</H1>
    <B>packagers at lists.rpmforge.net</B> 
    <A HREF="mailto:commits%40lists.repoforge.org?Subject=Re:%20Re%3A%20%5Bsvn%5D%20r3443%20-%20in%20trunk/rpms%3A%20xine%20xine-lib&In-Reply-To=%3C20050730140957.78372318042%40pooch.vmhosting.org%3E"
       TITLE="[svn] r3443 - in trunk/rpms: xine xine-lib">packagers at lists.rpmforge.net
       </A><BR>
    <I>Sat Jul 30 16:09:57 CEST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="002244.html">[svn] r3442 - trunk/rpms/mathomatic
</A></li>
        <LI>Next message: <A HREF="002246.html">[svn] r3444 - in trunk/tools/pydar2: pydar scripts
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2245">[ date ]</a>
              <a href="thread.html#2245">[ thread ]</a>
              <a href="subject.html#2245">[ subject ]</a>
              <a href="author.html#2245">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: thias
Date: 2005-07-30 16:09:55 +0200 (Sat, 30 Jul 2005)
New Revision: 3443

Added:
   trunk/rpms/xine/xine-ui-0.99.3-sprintf.patch
   trunk/rpms/xine/xine-ui-0.99.3-uifixups.patch
   trunk/rpms/xine/xine-ui-0.99.3-xftfontsize.patch
Removed:
   trunk/rpms/xine-lib/xine-lib-1.0.1-gcc4.patch
   trunk/rpms/xine/xine-ui-0.99.3-gcc4.patch
   trunk/rpms/xine/xine-ui-0.99.3-menucrash.patch
Modified:
   trunk/rpms/xine-lib/xine-lib.spec
   trunk/rpms/xine/xine.spec
Log:
Update xine-lib to 1.1.0 and xine to 0.99.4.


Deleted: trunk/rpms/xine/xine-ui-0.99.3-gcc4.patch
===================================================================
--- trunk/rpms/xine/xine-ui-0.99.3-gcc4.patch	2005-07-30 09:41:33 UTC (rev 3442)
+++ trunk/rpms/xine/xine-ui-0.99.3-gcc4.patch	2005-07-30 14:09:55 UTC (rev 3443)
@@ -1,16 +0,0 @@
---- xine-ui-0.99.3/src/xitk/mediamark.c.orig	2005-04-21 21:12:34.000000000 +0800
-+++ xine-ui-0.99.3/src/xitk/mediamark.c	2005-04-21 21:15:31.000000000 +0800
-@@ -3121,11 +3121,11 @@ static void mmkeditor_apply(xitk_widget_
-     
-     mrl = atoa(xitk_inputtext_get_text(mmkeditor-&gt;mrl));
-     if(mrl &amp;&amp; (!strlen(mrl)))
--      xine_strdupa((char *) mrl, (*mmkeditor-&gt;mmk)-&gt;mrl);
-+      xine_strdupa(mrl, (*mmkeditor-&gt;mmk)-&gt;mrl);
-     
-     ident = atoa(xitk_inputtext_get_text(mmkeditor-&gt;ident));
-     if(ident &amp;&amp; (!strlen(ident)))
--      xine_strdupa((char *) ident, mrl);
-+      xine_strdupa(ident, mrl);
- 
-     sub = xitk_inputtext_get_text(mmkeditor-&gt;sub);
-     if(sub &amp;&amp; (!strlen(sub)))

Deleted: trunk/rpms/xine/xine-ui-0.99.3-menucrash.patch
===================================================================
--- trunk/rpms/xine/xine-ui-0.99.3-menucrash.patch	2005-07-30 09:41:33 UTC (rev 3442)
+++ trunk/rpms/xine/xine-ui-0.99.3-menucrash.patch	2005-07-30 14:09:55 UTC (rev 3443)
@@ -1,295 +0,0 @@
-diff -ur xine-ui-0.99.3/src/xitk/menus.c.orig xine-ui-0.99.3/src/xitk/menus.c
---- xine-ui-0.99.3/src/xitk/menus.c.orig	2004-10-19 14:18:48.000000000 -0700
-+++ xine-ui-0.99.3/src/xitk/menus.c	2005-07-04 12:38:53.000000000 -0700
-@@ -425,8 +425,7 @@
-   int                  x, y;
-   xitk_menu_widget_t   menu;
-   char                 buffer[2048];
--  char                *sh[255];
--  int                  shc = 0;
-+  int                  i;
-   xitk_widget_t       *w;
- #ifdef HAVE_XINERAMA
-   int                  fullscr_mode = (FULLSCR_MODE | FULLSCR_XI_MODE);
-@@ -439,15 +438,15 @@
-       &quot;&lt;title&gt;&quot;,      
-       NULL, NULL                                                                             },
-     { _(&quot;Show controls&quot;),
--      (sh[shc++] = menu_get_shortcut(&quot;ToggleVisibility&quot;)),
-+      menu_get_shortcut(&quot;ToggleVisibility&quot;),
-       panel_is_visible() ? &quot;&lt;checked&gt;&quot; : &quot;&lt;check&gt;&quot;,  
-       menu_panel_visibility, NULL                                                            },
-     { _(&quot;Show video window&quot;),
--      (sh[shc++] = menu_get_shortcut(&quot;ToggleWindowVisibility&quot;)),
-+      menu_get_shortcut(&quot;ToggleWindowVisibility&quot;),
-       video_window_is_visible() ? &quot;&lt;checked&gt;&quot; : &quot;&lt;check&gt;&quot;,  
-       menu_video_ctrl, (void *) VIDEO_TOGGLE                                                 },
-     { _(&quot;Fullscreen&quot;),
--      (sh[shc++] = menu_get_shortcut(&quot;ToggleFullscreen&quot;)),
-+      menu_get_shortcut(&quot;ToggleFullscreen&quot;),
-       (video_window_get_fullscreen_mode() &amp; fullscr_mode) ? &quot;&lt;checked&gt;&quot; : &quot;&lt;check&gt;&quot;,
-       menu_video_ctrl, (void *) VIDEO_FULLSCR                                                },
-     { &quot;SEP&quot;,  
-@@ -459,7 +458,7 @@
-       &quot;&lt;branch&gt;&quot;,   
-       NULL, NULL                                                                             },
-     { _(&quot;Open/File...&quot;),
--      (sh[shc++] = menu_get_shortcut(&quot;FileSelector&quot;)),
-+      menu_get_shortcut(&quot;FileSelector&quot;),
-       NULL,
-       menu_file_selector,        NULL                                                        },
-     { _(&quot;Open/Playlist...&quot;),
-@@ -467,7 +466,7 @@
-       NULL,
-       menu_playlist_ctrl, (void *) PLAYL_LOAD                                                },
-     { _(&quot;Open/Location...&quot;),
--      (sh[shc++] = menu_get_shortcut(&quot;MrlBrowser&quot;)),
-+      menu_get_shortcut(&quot;MrlBrowser&quot;),
-       NULL,
-       menu_mrl_browser, NULL                                                                 },
-     { _(&quot;Playback&quot;),
-@@ -475,15 +474,15 @@
-       &quot;&lt;Branch&gt;&quot;,
-       NULL, NULL                                                                             },
-     { _(&quot;Playback/Play&quot;),
--      (sh[shc++] = menu_get_shortcut(&quot;Play&quot;)),
-+      menu_get_shortcut(&quot;Play&quot;),
-       NULL,
-       menu_playback_ctrl, (void *) PLAYB_PLAY                                                },
-     { _(&quot;Playback/Stop&quot;),
--      (sh[shc++] = menu_get_shortcut(&quot;Stop&quot;)),
-+      menu_get_shortcut(&quot;Stop&quot;),
-       NULL,
-       menu_playback_ctrl, (void *) PLAYB_STOP                                                },
-     { _(&quot;Playback/Pause&quot;),
--      (sh[shc++] = menu_get_shortcut(&quot;Pause&quot;)),
-+      menu_get_shortcut(&quot;Pause&quot;),
-       NULL,
-       menu_playback_ctrl, (void *) PLAYB_PAUSE                                               },
-     { _(&quot;Playback/SEP&quot;),
-@@ -491,11 +490,11 @@
-       &quot;&lt;separator&gt;&quot;,  
-       NULL,  NULL                                                                            },
-     { _(&quot;Playback/Next MRL&quot;),
--      (sh[shc++] = menu_get_shortcut(&quot;NextMrl&quot;)),
-+      menu_get_shortcut(&quot;NextMrl&quot;),
-       NULL,
-       menu_playback_ctrl, (void *) PLAYB_NEXT                                                },
-     { _(&quot;Playback/Previous MRL&quot;),
--      (sh[shc++] = menu_get_shortcut(&quot;PriorMrl&quot;)),
-+      menu_get_shortcut(&quot;PriorMrl&quot;),
-       NULL,
-       menu_playback_ctrl, (void *) PLAYB_PREV                                                },
-     { _(&quot;Playback/SEP&quot;),
-@@ -503,11 +502,11 @@
-       &quot;&lt;separator&gt;&quot;,  
-       NULL,  NULL                                                                            },
-     { _(&quot;Playback/Increase Speed&quot;),
--      (sh[shc++] = menu_get_shortcut(&quot;SpeedFaster&quot;)),
-+      menu_get_shortcut(&quot;SpeedFaster&quot;),
-       NULL,
-       menu_playback_ctrl, (void *) PLAYB_SPEEDM                                              },
-     { _(&quot;Playback/Decrease Speed&quot;),
--      (sh[shc++] = menu_get_shortcut(&quot;SpeedSlower&quot;)),
-+      menu_get_shortcut(&quot;SpeedSlower&quot;),
-       NULL,
-       menu_playback_ctrl, (void *) PLAYB_SPEEDL                                              },
-     { _(&quot;Playlist&quot;),
-@@ -523,7 +522,7 @@
-       NULL,
-       menu_playlist_ctrl, (void *) PLAYL_LOAD                                                },
-     { _(&quot;Playlist/Editor...&quot;),
--      (sh[shc++] = menu_get_shortcut(&quot;PlaylistEditor&quot;)),
-+      menu_get_shortcut(&quot;PlaylistEditor&quot;),
-       NULL,
-       menu_playlist_ctrl, (void *) PLAYL_EDIT                                                },
-     { _(&quot;Playlist/SEP&quot;),  
-@@ -555,7 +554,7 @@
-       (gGui-&gt;playlist.loop == PLAYLIST_LOOP_SHUF_PLUS) ? &quot;&lt;checked&gt;&quot; : &quot;&lt;check&gt;&quot;,
-       menu_playlist_ctrl, (void *) PLAYL_SHUF_PLUS                                           },
-     { _(&quot;Playlist/Continue Playback&quot;),
--      (sh[shc++] = menu_get_shortcut(&quot;PlaylistStop&quot;)),
-+      menu_get_shortcut(&quot;PlaylistStop&quot;),
-       (gGui-&gt;playlist.control &amp; PLAYLIST_CONTROL_STOP) ? &quot;&lt;check&gt;&quot; : &quot;&lt;checked&gt;&quot;,
-       menu_playlist_ctrl, (void *) PLAYL_CTRL_STOP                                           },
-     { &quot;SEP&quot;,  
-@@ -567,7 +566,7 @@
-       &quot;&lt;branch&gt;&quot;,
-       NULL, NULL                                                                             },
-     { _(&quot;Menus/Navigation...&quot;),
--      (sh[shc++] = menu_get_shortcut(&quot;EventSenderShow&quot;)),
-+      menu_get_shortcut(&quot;EventSenderShow&quot;),
-       NULL,
-       menu_event_sender, NULL                                                                },
-     { _(&quot;Menus/SEP&quot;),  
-@@ -583,11 +582,11 @@
-       &quot;&lt;branch&gt;&quot;,
-       NULL, NULL                                                                             },
-     { _(&quot;Stream/Information...&quot;),
--      (sh[shc++] = menu_get_shortcut(&quot;StreamInfosShow&quot;)),
-+      menu_get_shortcut(&quot;StreamInfosShow&quot;),
-       NULL,
-       menu_stream, (void *) STREAM_WINI                                                      },
-     { _(&quot;Stream/Information (OSD)&quot;),
--      (sh[shc++] = menu_get_shortcut(&quot;OSDStreamInfos&quot;)),
-+      menu_get_shortcut(&quot;OSDStreamInfos&quot;),
-       NULL,
-       menu_stream, (void *) STREAM_OSDI                                                      },
-     { _(&quot;Video&quot;),
-@@ -595,7 +594,7 @@
-       &quot;&lt;branch&gt;&quot;,
-       NULL, NULL                                                                             },
-     { _(&quot;Video/Deinterlace&quot;),
--      (sh[shc++] = menu_get_shortcut(&quot;ToggleInterleave&quot;)),
-+      menu_get_shortcut(&quot;ToggleInterleave&quot;),
-       (gGui-&gt;deinterlace_enable) ? &quot;&lt;checked&gt;&quot; : &quot;&lt;check&gt;&quot;,
-       menu_video_ctrl, (void *) VIDEO_INTERLEAVE                                             },
-     { _(&quot;Video/SEP&quot;),
-@@ -627,15 +626,15 @@
-       (aspect == XINE_VO_ASPECT_DVB) ? &quot;&lt;checked&gt;&quot; : &quot;&lt;check&gt;&quot;,
-       menu_aspect, (void *) XINE_VO_ASPECT_DVB                                               },
-     { _(&quot;Video/200%&quot;),
--      (sh[shc++] = menu_get_shortcut(&quot;Window200&quot;)),
-+      menu_get_shortcut(&quot;Window200&quot;),
-       (video_window_get_mag() == 2.0) ? &quot;&lt;checked&gt;&quot; : &quot;&lt;check&gt;&quot;,
-       menu_video_ctrl, (void *) VIDEO_2X                                                     },
-     { _(&quot;Video/100%&quot;),
--      (sh[shc++] = menu_get_shortcut(&quot;Window100&quot;)),
-+      menu_get_shortcut(&quot;Window100&quot;),
-       (video_window_get_mag() == 1.0) ? &quot;&lt;checked&gt;&quot; : &quot;&lt;check&gt;&quot;,
-       menu_video_ctrl, (void *) VIDEO_1X                                                     },
-     { _(&quot;Video/50%&quot;),
--      (sh[shc++] = menu_get_shortcut(&quot;Window50&quot;)),
-+      menu_get_shortcut(&quot;Window50&quot;),
-       (video_window_get_mag() ==  .5) ? &quot;&lt;checked&gt;&quot; : &quot;&lt;check&gt;&quot;,
-       menu_video_ctrl, (void *) VIDEO__5X                                                    },
-     { _(&quot;Video/SEP&quot;),
-@@ -647,11 +646,11 @@
-       &quot;&lt;branch&gt;&quot;,
-       NULL, NULL                                                                             },
-     { _(&quot;Video/Postprocess/Chain Reaction...&quot;),
--      (sh[shc++] = menu_get_shortcut(&quot;VPProcessShow&quot;)),
-+      menu_get_shortcut(&quot;VPProcessShow&quot;),
-       NULL,
-       menu_video_ctrl, (void *) VIDEO_PPROCESS                                               },
-     { _(&quot;Video/Postprocess/Enable Postprocessing&quot;),
--      (sh[shc++] = menu_get_shortcut(&quot;VPProcessEnable&quot;)),
-+      menu_get_shortcut(&quot;VPProcessEnable&quot;),
-       gGui-&gt;post_enable ? &quot;&lt;checked&gt;&quot; : &quot;&lt;check&gt;&quot;,
-       menu_video_ctrl, (void *) VIDEO_PPROCESS_ENABLE                                        },
-     { _(&quot;Audio&quot;),
-@@ -663,7 +662,7 @@
-       &quot;&lt;branch&gt;&quot;,
-       NULL, NULL                                                                             },
-     { _(&quot;Audio/Volume/Mute&quot;),
--      (sh[shc++] = menu_get_shortcut(&quot;Mute&quot;)),
-+      menu_get_shortcut(&quot;Mute&quot;),
-       gGui-&gt;mixer.mute ? &quot;&lt;checked&gt;&quot; : &quot;&lt;check&gt;&quot;,
-       menu_audio_ctrl, (void *) AUDIO_MUTE                                                   },
-     { _(&quot;Audio/Volume/Increase 10%&quot;),
-@@ -699,25 +698,25 @@
-       &quot;&lt;branch&gt;&quot;,
-       NULL, NULL                                                                             },
-     { _(&quot;Settings/Setup...&quot;),
--      (sh[shc++] = menu_get_shortcut(&quot;SetupShow&quot;)),
-+      menu_get_shortcut(&quot;SetupShow&quot;),
-       NULL,
-       menu_settings, (void *) SETS_SETUP                                                     },
- #ifdef HAVE_CURL
-     { _(&quot;Settings/Skin Downloader...&quot;),
--      (sh[shc++] = menu_get_shortcut(&quot;SkinDownload&quot;)),
-+      menu_get_shortcut(&quot;SkinDownload&quot;),
-       NULL,
-       menu_settings, (void *) SETS_SKINDL                                                    },
- #endif
-     { _(&quot;Settings/Keymap Editor...&quot;),
--      (sh[shc++] = menu_get_shortcut(&quot;KeyBindingEditor&quot;)),
-+      menu_get_shortcut(&quot;KeyBindingEditor&quot;),
-       NULL,
-       menu_settings, (void *) SETS_KEYMAP                                                    },
-     { _(&quot;Settings/Video...&quot;),
--      (sh[shc++] = menu_get_shortcut(&quot;ControlShow&quot;)),
-+      menu_get_shortcut(&quot;ControlShow&quot;),
-       NULL,
-       menu_settings, (void *) SETS_VIDEO                                                     },
-     { _(&quot;Settings/TV Analog...&quot;),
--      (sh[shc++] = menu_get_shortcut(&quot;TVAnalogShow&quot;)),
-+      menu_get_shortcut(&quot;TVAnalogShow&quot;),
-       NULL,
-       menu_settings, (void *) SETS_TVANALOG                                                  },
-     { &quot;SEP&quot;,
-@@ -725,11 +724,11 @@
-       &quot;&lt;separator&gt;&quot;,
-       NULL, NULL                                                                             },
-     { _(&quot;Help...&quot;),
--      (sh[shc++] = menu_get_shortcut(&quot;HelpShow&quot;)),
-+      menu_get_shortcut(&quot;HelpShow&quot;),
-       NULL,
-       menu_help, NULL                                                                        },
-     { _(&quot;Logs...&quot;),
--      (sh[shc++] = menu_get_shortcut(&quot;ViewlogShow&quot;)),
-+      menu_get_shortcut(&quot;ViewlogShow&quot;),
-       NULL,
-       menu_settings, (void *) SETS_LOGS                                                      },
-     { &quot;SEP&quot;,
-@@ -737,7 +736,7 @@
-       &quot;&lt;separator&gt;&quot;,
-       NULL, NULL                                                                             },
-     { _(&quot;Quit&quot;),
--      (sh[shc++] = menu_get_shortcut(&quot;Quit&quot;)),
-+      menu_get_shortcut(&quot;Quit&quot;),
-       NULL,
-       menu_quit, NULL                                                                        },
-     { NULL,
-@@ -765,8 +764,9 @@
-   
-   w = xitk_noskin_menu_create(wl, &amp;menu, x + 1, y + 1);
- 
--  while(shc &gt; 0)
--    free(sh[--shc]);
-+  for (i = 0; i &lt; sizeof(menu_entries)/sizeof(*menu_entries); i++)
-+    if (menu_entries[i].shortcut)
-+      free(menu_entries[i].shortcut);
- 
-   /* Subtitle loader */
-   if(gGui-&gt;playlist.num) {
-@@ -1155,12 +1155,11 @@
-   xitk_menu_widget_t   menu;
-   xitk_widget_t       *w = NULL;
-   char                 buffer[2048];
--  char                *sh[50];
--  int                  shc = 0;
-+  int                  i;
-   xitk_menu_entry_t    menu_entries_nosel[] = {
-     { NULL ,           NULL,          &quot;&lt;title&gt;&quot;,     NULL,                         NULL                    },
-     { &quot;SEP&quot;,           NULL,          &quot;&lt;separator&gt;&quot;, NULL,                         NULL                    },
--    { _(&quot;Scan&quot;),       (sh[shc] = menu_get_shortcut(&quot;ScanPlaylistInfo&quot;)),
-+    { _(&quot;Scan&quot;),       menu_get_shortcut(&quot;ScanPlaylistInfo&quot;),
-                                       NULL,          menu_scan_infos,              NULL                    },
-     { _(&quot;Add&quot;),        NULL,          NULL,          menu_open_mrlbrowser,         NULL                    },
-     { NULL,            NULL,          NULL,          NULL,                         NULL                    }
-@@ -1172,7 +1171,7 @@
-     { &quot;SEP&quot;,           NULL,          &quot;&lt;separator&gt;&quot;, NULL,                         NULL                    },
-     { _(&quot;Scan&quot;),       NULL,          NULL,          menu_scan_infos_selected,     NULL                    },
-     { _(&quot;Add&quot;),        NULL,          NULL,          menu_open_mrlbrowser,         NULL                    },
--    { _(&quot;Edit&quot;),       (sh[shc] = menu_get_shortcut(&quot;MediamarkEditor&quot;)),
-+    { _(&quot;Edit&quot;),       menu_get_shortcut(&quot;MediamarkEditor&quot;),
-                                       NULL,          menu_playlist_mmk_editor,     NULL                    },
-     { _(&quot;Delete&quot;),     NULL,          NULL,          menu_playlist_delete_current, NULL                    },
-     { _(&quot;Delete All&quot;), NULL,          NULL,          menu_playlist_delete_all,     NULL                    },
-@@ -1200,8 +1199,12 @@
- 
-   w = xitk_noskin_menu_create(wl, &amp;menu, x, y);
- 
--  while(shc &gt; 0)
--    free(sh[--shc]);
-+  for (i = 0; i &lt; sizeof(menu_entries_nosel)/sizeof(*menu_entries_nosel); i++)
-+    if (menu_entries_nosel[i].shortcut)
-+      free(menu_entries_nosel[i].shortcut);
-+  for (i = 0; i &lt; sizeof(menu_entries_sel)/sizeof(*menu_entries_sel); i++)
-+    if (menu_entries_sel[i].shortcut)
-+      free(menu_entries_sel[i].shortcut);
-   
-   if(!selected &amp;&amp; gGui-&gt;playlist.num) {
-     xitk_menu_entry_t   menu_entry;
-

Added: trunk/rpms/xine/xine-ui-0.99.3-sprintf.patch
===================================================================
--- trunk/rpms/xine/xine-ui-0.99.3-sprintf.patch	2005-07-30 09:41:33 UTC (rev 3442)
+++ trunk/rpms/xine/xine-ui-0.99.3-sprintf.patch	2005-07-30 14:09:55 UTC (rev 3443)
@@ -0,0 +1,1116 @@
+diff -ur xine-ui-0.99.3/src/common/utils.c xine-ui-0.99.3.sprintf/src/common/utils.c
+--- xine-ui-0.99.3/src/common/utils.c	2004-04-15 13:55:36.000000000 -0700
++++ xine-ui-0.99.3.sprintf/src/common/utils.c	2005-07-07 02:18:25.546943500 -0700
+@@ -195,7 +195,7 @@
+   pp = buf;
+   while((p = xine_strsep(&amp;pp, &quot;/&quot;)) != NULL) {
+     if(p &amp;&amp; strlen(p)) {
+-      sprintf(buf2, &quot;%s/%s&quot;, buf2, p);
++      sprintf(buf2+strlen(buf2), &quot;/%s&quot;, p);
+       if(!_mkdir_safe(buf2))
+ 	return 0;
+     }
+diff -ur xine-ui-0.99.3/src/fb/osd.c xine-ui-0.99.3.sprintf/src/fb/osd.c
+--- xine-ui-0.99.3/src/fb/osd.c	2003-12-01 09:23:27.000000000 -0800
++++ xine-ui-0.99.3.sprintf/src/fb/osd.c	2005-07-05 18:53:05.000000000 -0700
+@@ -392,34 +392,34 @@
+     len = strlen(buffer);
+     switch(audiochannel) {
+     case -2:
+-      sprintf(buffer, &quot;%soff&quot;, buffer);
++      strcat(buffer, &quot;off&quot;);
+       break;
+     case -1:
+       if(!xine_get_audio_lang (fbxine.stream, audiochannel, &amp;buffer[len]))
+-	sprintf(buffer, &quot;%sauto&quot;, buffer);
++	strcat(buffer, &quot;auto&quot;);
+       break;
+     default:
+       if(!xine_get_audio_lang (fbxine.stream, audiochannel, &amp;buffer[len]))
+-	sprintf(buffer, &quot;%s%3d&quot;, buffer, audiochannel);
++	sprintf(&amp;buffer[len], &quot;%3d&quot;, audiochannel);
+       break;
+     }
+ 
+-    sprintf(buffer, &quot;%s, Spu: &quot;, buffer);
++    strcat(buffer, &quot;, Spu: &quot;);
+     len = strlen(buffer);
+     switch (spuchannel) {
+     case -2:
+-      sprintf(buffer, &quot;%soff&quot;, buffer);
++      strcat(buffer, &quot;off&quot;);
+       break;
+     case -1:
+       if(!xine_get_spu_lang (fbxine.stream, spuchannel, &amp;buffer[len]))
+-	sprintf(buffer, &quot;%sauto&quot;, buffer);
++	strcat(buffer, &quot;auto&quot;);
+       break;
+     default:
+       if(!xine_get_spu_lang (fbxine.stream, spuchannel, &amp;buffer[len]))
+-        sprintf(buffer, &quot;%s%3d&quot;, buffer, spuchannel);
++        sprintf(&amp;buffer[len], &quot;%3d&quot;, spuchannel);
+       break;
+     }
+-    sprintf(buffer, &quot;%s.&quot;, buffer);
++    strcat(buffer, &quot;.&quot;);
+     xine_osd_draw_text(fbxine.osd.sinfo, x, y, buffer, XINE_OSD_TEXT1);
+     xine_osd_get_text_size(fbxine.osd.sinfo, buffer, &amp;w, &amp;h);
+     if(w &gt; osdw)
+diff -ur xine-ui-0.99.3/src/xitk/file_browser.c xine-ui-0.99.3.sprintf/src/xitk/file_browser.c
+--- xine-ui-0.99.3/src/xitk/file_browser.c	2004-12-12 06:19:08.000000000 -0800
++++ xine-ui-0.99.3.sprintf/src/xitk/file_browser.c	2005-07-05 19:01:50.000000000 -0700
+@@ -983,7 +983,7 @@
+       snprintf(buf, sizeof(buf), &quot;%s&quot;, fb-&gt;current_dir);
+       if(strlen(fb-&gt;current_dir) &gt; 1)
+ 	strcat(buf, &quot;/&quot;);
+-      sprintf(buf, &quot;%s%s&quot;, buf, fb-&gt;norm_files[sel].name);
++      strcat(buf, fb-&gt;norm_files[sel].name);
+       
+       if((unlink(buf)) == -1)
+ 	xine_error(_(&quot;Unable to delete file '%s': %s.&quot;), buf, strerror(errno));
+@@ -1006,7 +1006,7 @@
+     snprintf(buf, sizeof(buf), _(&quot;Do you really want to delete the file: '%s'&quot;), fb-&gt;current_dir);
+     if(strlen(fb-&gt;current_dir) &gt; 1)
+       strcat(buf, &quot;/&quot;);
+-    sprintf(buf, &quot;%s%s' ?.&quot;, buf, fb-&gt;norm_files[sel].name);
++    sprintf(buf+strlen(buf), &quot;%s' ?&quot;, fb-&gt;norm_files[sel].name);
+     
+     fb_deactivate(fb);
+     xitk_window_dialog_yesno(gGui-&gt;imlib_data, _(&quot;Confirm deletion ?&quot;),
+@@ -1025,7 +1025,7 @@
+   snprintf(buf, sizeof(buf), &quot;%s&quot;, fb-&gt;current_dir);
+   if(strlen(fb-&gt;current_dir) &gt; 1)
+     strcat(buf, &quot;/&quot;);
+-  sprintf(buf, &quot;%s%s&quot;, buf, fb-&gt;norm_files[sel].name);
++  strcat(buf, fb-&gt;norm_files[sel].name);
+   
+   if((rename(buf, newname)) == -1)
+     xine_error(_(&quot;Unable to rename file '%s' to '%s': %s.&quot;), buf, newname, strerror(errno));
+@@ -1044,7 +1044,7 @@
+     snprintf(buf, sizeof(buf), &quot;%s&quot;, fb-&gt;current_dir);
+     if(strlen(fb-&gt;current_dir) &gt; 1)
+       strcat(buf, &quot;/&quot;);
+-    sprintf(buf, &quot;%s%s&quot;, buf, fb-&gt;norm_files[sel].name);
++    strcat(buf, fb-&gt;norm_files[sel].name);
+     
+     fb_deactivate(fb);
+     fb_create_input_window(_(&quot;Rename file&quot;), buf, fb_rename_file_cb, fb);
+diff -ur xine-ui-0.99.3/src/xitk/kbindings.c xine-ui-0.99.3.sprintf/src/xitk/kbindings.c
+--- xine-ui-0.99.3/src/xitk/kbindings.c	2004-12-16 08:14:08.000000000 -0800
++++ xine-ui-0.99.3.sprintf/src/xitk/kbindings.c	2005-07-07 01:53:29.110252000 -0700
+@@ -590,12 +590,12 @@
+ 	    char *header = _(&quot;The following key bindings pairs are identical:\n\n&quot;);
+ 	    len += strlen(header);
+ 	    kmsg = (char *) xine_xmalloc(len + 1);
+-	    sprintf(kmsg, &quot;%s%s%c%s%c%s&quot;, header, action1,' ', dna, ' ', action2);
++	    sprintf(kmsg, &quot;%s%s %s %s&quot;, header, action1, dna, action2);
+ 	  }
+ 	  else {
+ 	    len += 2;
+ 	    kmsg = (char *) realloc(kmsg, strlen(kmsg) + len + 1);
+-	    sprintf(kmsg, &quot;%s%s%s%c%s%c%s&quot;, kmsg, &quot;, &quot;, action1, ' ', dna, ' ', action2);
++	    sprintf(kmsg+strlen(kmsg), &quot;, %s %s %s&quot;, action1, dna, action2);
+ 	  }
+ 	}
+       }
+@@ -607,7 +607,7 @@
+     char          *footer = _(&quot;.\n\nWhat do you want to do ?\n&quot;);
+     
+     kmsg = (char *) realloc(kmsg, strlen(kmsg) + strlen(footer) + 1);
+-    sprintf(kmsg, &quot;%s%s&quot;, kmsg, footer);
++    strcat(kmsg, footer);
+ 
+     dump_error(gGui-&gt;verbosity, kmsg);
+ 
+@@ -1007,16 +1007,14 @@
+     
+     for(k = kbt-&gt;entry, i = 0; k[i]-&gt;action != NULL; i++) {
+       if(!k[i]-&gt;is_alias) {
+-	sprintf(buf, &quot;# %s\n&quot;, k[i]-&gt;comment);
+-	sprintf(buf, &quot;%sbegin\n&quot;, buf);
+-	sprintf(buf, &quot;%s\tremote = xxxxx\n&quot;, buf);
+-	sprintf(buf, &quot;%s\tbutton = xxxxx\n&quot;, buf);
+-	sprintf(buf, &quot;%s\tprog   = xine\n&quot;, buf);
+-	sprintf(buf, &quot;%s\trepeat = 0\n&quot;, buf);
+-	sprintf(buf, &quot;%s\tconfig = %s\n&quot;, buf, k[i]-&gt;action);
+-	sprintf(buf, &quot;%send\n\n&quot;, buf);
+-	fputs(buf, stream);
+-	memset(&amp;buf, 0, sizeof(buf));
++	fprintf(stream, &quot;# %s\n&quot;
++	                &quot;begin\n&quot;
++	                &quot;\tremote = xxxxx\n&quot;
++	                &quot;\tbutton = xxxxx\n&quot;
++	                &quot;\tprog   = xine\n&quot;
++	                &quot;\trepeat = 0\n&quot;
++	                &quot;\tconfig = %s\n&quot;
++	                &quot;end\n\n&quot;, k[i]-&gt;comment, k[i]-&gt;action);
+       }
+     }
+     fprintf(stream, &quot;##\n# End of xine key bindings.\n##\n&quot;);
+@@ -1028,33 +1026,31 @@
+     fprintf(stream, &quot;# Automatically generated by %s version %s.\n##\n\n&quot;, PACKAGE, VERSION);
+ 
+     for(k = kbt-&gt;entry, i = 0; k[i]-&gt;action != NULL; i++) {
+-      snprintf(buf, sizeof(buf), &quot;# %s\n&quot;, k[i]-&gt;comment);
++      fprintf(stream, &quot;# %s\n&quot;, k[i]-&gt;comment);
+ 
+       if(k[i]-&gt;is_alias) {
+-	sprintf(buf, &quot;%sAlias {\n&quot;, buf);
+-	sprintf(buf, &quot;%s\tentry = %s\n&quot;, buf, k[i]-&gt;action);
++	fprintf(stream, &quot;Alias {\n&quot;
++	                &quot;\tentry = %s\n&quot;, k[i]-&gt;action);
+       }
+       else
+-	sprintf(buf, &quot;%s%s {\n&quot;, buf, k[i]-&gt;action);
++	fprintf(stream, &quot;%s {\n&quot;, k[i]-&gt;action);
+ 
+-      sprintf(buf, &quot;%s\tkey = %s\n&quot;, buf, k[i]-&gt;key);
+-      sprintf(buf, &quot;%s%s&quot;, buf, &quot;\tmodifier = &quot;);
++      fprintf(stream, &quot;\tkey = %s\n&quot;, k[i]-&gt;key);
++      strcpy(buf, &quot;\tmodifier = &quot;);
+       if(k[i]-&gt;modifier == KEYMOD_NOMOD)
+-	sprintf(buf, &quot;%s%s, &quot;, buf, &quot;none&quot;);
++	strcat(buf, &quot;none, &quot;);
+       if(k[i]-&gt;modifier &amp; KEYMOD_CONTROL)
+-	sprintf(buf, &quot;%s%s, &quot;, buf, &quot;control&quot;);
++	strcat(buf, &quot;control, &quot;);
+       if(k[i]-&gt;modifier &amp; KEYMOD_META)
+-	sprintf(buf, &quot;%s%s, &quot;, buf, &quot;meta&quot;);
++	strcat(buf, &quot;meta, &quot;);
+       if(k[i]-&gt;modifier &amp; KEYMOD_MOD3)
+-	sprintf(buf, &quot;%s%s, &quot;, buf, &quot;mod3&quot;);
++	strcat(buf, &quot;mod3, &quot;);
+       if(k[i]-&gt;modifier &amp; KEYMOD_MOD4)
+-	sprintf(buf, &quot;%s%s, &quot;, buf, &quot;mod4&quot;);
++	strcat(buf, &quot;mod4, &quot;);
+       if(k[i]-&gt;modifier &amp; KEYMOD_MOD5)
+-	sprintf(buf, &quot;%s%s, &quot;, buf, &quot;mod5&quot;);
+-      buf[strlen(buf) - 2] = '\n';
+-      buf[strlen(buf) - 1] = '\0';
+-      sprintf(buf, &quot;%s%s&quot;, buf, &quot;}\n\n&quot;);
+-      fprintf(stream, &quot;%s&quot;, buf);
++	strcat(buf, &quot;mod5, &quot;);
++      buf[strlen(buf) - 2] = '\0';
++      fprintf(stream, &quot;%s\n}\n\n&quot;, buf);
+       memset(&amp;buf, 0, sizeof(buf));
+     }
+     fprintf(stream, &quot;##\n# End of xine key bindings.\n##\n&quot;);
+@@ -1267,31 +1263,35 @@
+     memset(&amp;shortcut, 0, sizeof(shortcut));
+     
+     if(gGui-&gt;shortcut_style == 0) {
+-      if(kbe-&gt;modifier &amp; KEYMOD_CONTROL)
+-	sprintf(shortcut, &quot;%s%s+&quot;, shortcut, _(&quot;Ctrl&quot;));
+-      if(kbe-&gt;modifier &amp; KEYMOD_META)
+-	sprintf(shortcut, &quot;%s%s+&quot;, shortcut, _(&quot;Alt&quot;));
++      if(kbe-&gt;modifier &amp; KEYMOD_CONTROL) {
++	strcat(shortcut, _(&quot;Ctrl&quot;));
++	strcat(shortcut, &quot;+&quot;);
++      }
++      if(kbe-&gt;modifier &amp; KEYMOD_META) {
++	strcat(shortcut, _(&quot;Alt&quot;));
++	strcat(shortcut, &quot;+&quot;);
++      }
+       if(kbe-&gt;modifier &amp; KEYMOD_MOD3)
+-	sprintf(shortcut, &quot;%s%s+&quot;, shortcut, &quot;M3&quot;);
++	strcat(shortcut, &quot;M3+&quot;);
+       if(kbe-&gt;modifier &amp; KEYMOD_MOD4)
+-	sprintf(shortcut, &quot;%s%s+&quot;, shortcut, &quot;M4&quot;);
++	strcat(shortcut, &quot;M4+&quot;);
+       if(kbe-&gt;modifier &amp; KEYMOD_MOD5)
+-	sprintf(shortcut, &quot;%s%s+&quot;, shortcut, &quot;M5&quot;);
++	strcat(shortcut, &quot;M5+&quot;);
+     }
+     else {
+       if(kbe-&gt;modifier &amp; KEYMOD_CONTROL)
+-	sprintf(shortcut, &quot;%s%s-&quot;, shortcut, &quot;C&quot;);
++	strcat(shortcut, &quot;C-&quot;);
+       if(kbe-&gt;modifier &amp; KEYMOD_META)
+-	sprintf(shortcut, &quot;%s%s-&quot;, shortcut, &quot;M&quot;);
++	strcat(shortcut, &quot;M-&quot;);
+       if(kbe-&gt;modifier &amp; KEYMOD_MOD3)
+-	sprintf(shortcut, &quot;%s%s-&quot;, shortcut, &quot;M3&quot;);
++	strcat(shortcut, &quot;M3-&quot;);
+       if(kbe-&gt;modifier &amp; KEYMOD_MOD4)
+-	sprintf(shortcut, &quot;%s%s-&quot;, shortcut, &quot;M4&quot;);
++	strcat(shortcut, &quot;M4-&quot;);
+       if(kbe-&gt;modifier &amp; KEYMOD_MOD5)
+-	sprintf(shortcut, &quot;%s%s-&quot;, shortcut, &quot;M5&quot;);
++	strcat(shortcut, &quot;M5-&quot;);
+     }
+     
+-    sprintf(shortcut, &quot;%s%s&quot;, shortcut, kbe-&gt;key);
++    strcat(shortcut, kbe-&gt;key);
+     
+     return shortcut;
+   }
+@@ -2486,23 +2486,23 @@
+ 	  sprintf(buf, &quot;%s&quot;, &quot;\\fBC\\fP&quot;);
+ 	if(k[i]-&gt;modifier &amp; KEYMOD_META) {
+ 	  if(strlen(buf))
+-	    sprintf(buf, &quot;%s%s&quot;, buf, &quot;\\-&quot;);
+-	  sprintf(buf, &quot;%s%s&quot;, buf, &quot;\\fBM\\fP&quot;);
++	    strcat(buf, &quot;\\-&quot;);
++	  strcat(buf, &quot;\\fBM\\fP&quot;);
+ 	}
+ 	if(k[i]-&gt;modifier &amp; KEYMOD_MOD3) {
+ 	  if(strlen(buf))
+-	    sprintf(buf, &quot;%s%s&quot;, buf, &quot;\\-&quot;);
+-	  sprintf(buf, &quot;%s%s&quot;, buf, &quot;\\fBM3\\fP&quot;);
++	    strcat(buf, &quot;\\-&quot;);
++	  strcat(buf, &quot;\\fBM3\\fP&quot;);
+ 	}
+ 	if(k[i]-&gt;modifier &amp; KEYMOD_MOD4) {
+ 	  if(strlen(buf))
+-	    sprintf(buf, &quot;%s%s&quot;, buf, &quot;\\-&quot;);
+-	  sprintf(buf, &quot;%s%s&quot;, buf, &quot;\\fBM4\\fP&quot;);
++	    strcat(buf, &quot;\\-&quot;);
++	  strcat(buf, &quot;\\fBM4\\fP&quot;);
+ 	}
+ 	if(k[i]-&gt;modifier &amp; KEYMOD_MOD5) {
+ 	  if(strlen(buf))
+-	    sprintf(buf, &quot;%s%s&quot;, buf, &quot;\\-&quot;);
+-	  sprintf(buf, &quot;%s%s&quot;, buf, &quot;\\fBM5\\fP&quot;);
++	    strcat(buf, &quot;\\-&quot;);
++	  strcat(buf, &quot;\\fBM5\\fP&quot;);
+ 	}
+ 	printf(&quot;%s\\-&quot;, buf);
+       }
+diff -ur xine-ui-0.99.3/src/xitk/kbindings_man.c xine-ui-0.99.3.sprintf/src/xitk/kbindings_man.c
+--- xine-ui-0.99.3/src/xitk/kbindings_man.c	2004-12-16 08:14:08.000000000 -0800
++++ xine-ui-0.99.3.sprintf/src/xitk/kbindings_man.c	2005-07-06 12:12:21.000000000 -0700
+@@ -590,12 +590,12 @@
+ 	    char *header = _(&quot;The following key bindings pairs are identical:\n\n&quot;);
+ 	    len += strlen(header);
+ 	    kmsg = (char *) xine_xmalloc(len + 1);
+-	    sprintf(kmsg, &quot;%s%s%c%s%c%s&quot;, header, action1,' ', dna, ' ', action2);
++	    sprintf(kmsg, &quot;%s%s %s %s&quot;, header, action1, dna, action2);
+ 	  }
+ 	  else {
+ 	    len += 2;
+ 	    kmsg = (char *) realloc(kmsg, strlen(kmsg) + len + 1);
+-	    sprintf(kmsg, &quot;%s%s%s%c%s%c%s&quot;, kmsg, &quot;, &quot;, action1, ' ', dna, ' ', action2);
++	    sprintf(kmsg+strlen(kmsg), &quot;, %s %s %s&quot;, action1, dna, action2);
+ 	  }
+ 	}
+       }
+@@ -607,7 +607,7 @@
+     char          *footer = _(&quot;.\n\nWhat do you want to do ?\n&quot;);
+     
+     kmsg = (char *) realloc(kmsg, strlen(kmsg) + strlen(footer) + 1);
+-    sprintf(kmsg, &quot;%s%s&quot;, kmsg, footer);
++    strcat(kmsg, footer);
+ 
+     dump_error(gGui-&gt;verbosity, kmsg);
+ 
+@@ -1007,16 +1007,14 @@
+     
+     for(k = kbt-&gt;entry, i = 0; k[i]-&gt;action != NULL; i++) {
+       if(!k[i]-&gt;is_alias) {
+-	sprintf(buf, &quot;# %s\n&quot;, k[i]-&gt;comment);
+-	sprintf(buf, &quot;%sbegin\n&quot;, buf);
+-	sprintf(buf, &quot;%s\tremote = xxxxx\n&quot;, buf);
+-	sprintf(buf, &quot;%s\tbutton = xxxxx\n&quot;, buf);
+-	sprintf(buf, &quot;%s\tprog   = xine\n&quot;, buf);
+-	sprintf(buf, &quot;%s\trepeat = 0\n&quot;, buf);
+-	sprintf(buf, &quot;%s\tconfig = %s\n&quot;, buf, k[i]-&gt;action);
+-	sprintf(buf, &quot;%send\n\n&quot;, buf);
+-	fputs(buf, stream);
+-	memset(&amp;buf, 0, sizeof(buf));
++	fprintf(stream, &quot;# %s\n&quot;
++	                &quot;begin\n&quot;
++	                &quot;\tremote = xxxxx\n&quot;
++	                &quot;\tbutton = xxxxx\n&quot;
++	                &quot;\tprog   = xine\n&quot;
++	                &quot;\trepeat = 0\n&quot;
++	                &quot;\tconfig = %s\n&quot;
++	                &quot;end\n\n&quot;, k[i]-&gt;comment, k[i]-&gt;action);
+       }
+     }
+     fprintf(stream, &quot;##\n# End of xine key bindings.\n##\n&quot;);
+@@ -1028,33 +1026,31 @@
+     fprintf(stream, &quot;# Automatically generated by %s version %s.\n##\n\n&quot;, PACKAGE, VERSION);
+ 
+     for(k = kbt-&gt;entry, i = 0; k[i]-&gt;action != NULL; i++) {
+-      snprintf(buf, sizeof(buf), &quot;# %s\n&quot;, k[i]-&gt;comment);
++      fprintf(stream, &quot;# %s\n&quot;, k[i]-&gt;comment);
+ 
+       if(k[i]-&gt;is_alias) {
+-	sprintf(buf, &quot;%sAlias {\n&quot;, buf);
+-	sprintf(buf, &quot;%s\tentry = %s\n&quot;, buf, k[i]-&gt;action);
++	fprintf(stream, &quot;Alias {\n&quot;
++	                &quot;\tentry = %s\n&quot;, k[i]-&gt;action);
+       }
+       else
+-	sprintf(buf, &quot;%s%s {\n&quot;, buf, k[i]-&gt;action);
++	fprintf(stream, &quot;%s {\n&quot;, k[i]-&gt;action);
+ 
+-      sprintf(buf, &quot;%s\tkey = %s\n&quot;, buf, k[i]-&gt;key);
+-      sprintf(buf, &quot;%s%s&quot;, buf, &quot;\tmodifier = &quot;);
++      fprintf(stream, &quot;\tkey = %s\n&quot;, k[i]-&gt;key);
++      strcpy(buf, &quot;\tmodifier = &quot;);
+       if(k[i]-&gt;modifier == KEYMOD_NOMOD)
+-	sprintf(buf, &quot;%s%s, &quot;, buf, &quot;none&quot;);
++	sprintf(buf+strlen(buf), &quot;%s, &quot;, &quot;none&quot;);
+       if(k[i]-&gt;modifier &amp; KEYMOD_CONTROL)
+-	sprintf(buf, &quot;%s%s, &quot;, buf, &quot;control&quot;);
++	sprintf(buf+strlen(buf), &quot;%s, &quot;, &quot;control&quot;);
+       if(k[i]-&gt;modifier &amp; KEYMOD_META)
+-	sprintf(buf, &quot;%s%s, &quot;, buf, &quot;meta&quot;);
++	sprintf(buf+strlen(buf), &quot;%s, &quot;, &quot;meta&quot;);
+       if(k[i]-&gt;modifier &amp; KEYMOD_MOD3)
+-	sprintf(buf, &quot;%s%s, &quot;, buf, &quot;mod3&quot;);
++	sprintf(buf+strlen(buf), &quot;%s, &quot;, &quot;mod3&quot;);
+       if(k[i]-&gt;modifier &amp; KEYMOD_MOD4)
+-	sprintf(buf, &quot;%s%s, &quot;, buf, &quot;mod4&quot;);
++	sprintf(buf+strlen(buf), &quot;%s, &quot;, &quot;mod4&quot;);
+       if(k[i]-&gt;modifier &amp; KEYMOD_MOD5)
+-	sprintf(buf, &quot;%s%s, &quot;, buf, &quot;mod5&quot;);
+-      buf[strlen(buf) - 2] = '\n';
+-      buf[strlen(buf) - 1] = '\0';
+-      sprintf(buf, &quot;%s%s&quot;, buf, &quot;}\n\n&quot;);
+-      fprintf(stream, &quot;%s&quot;, buf);
++	sprintf(buf+strlen(buf), &quot;%s, &quot;, &quot;mod5&quot;);
++      buf[strlen(buf) - 2] = '\0';
++      fprintf(stream, &quot;%s\n}\n\n&quot;, buf);
+       memset(&amp;buf, 0, sizeof(buf));
+     }
+     fprintf(stream, &quot;##\n# End of xine key bindings.\n##\n&quot;);
+@@ -1267,31 +1263,35 @@
+     memset(&amp;shortcut, 0, sizeof(shortcut));
+     
+     if(gGui-&gt;shortcut_style == 0) {
+-      if(kbe-&gt;modifier &amp; KEYMOD_CONTROL)
+-	sprintf(shortcut, &quot;%s%s+&quot;, shortcut, _(&quot;Ctrl&quot;));
+-      if(kbe-&gt;modifier &amp; KEYMOD_META)
+-	sprintf(shortcut, &quot;%s%s+&quot;, shortcut, _(&quot;Alt&quot;));
++      if(kbe-&gt;modifier &amp; KEYMOD_CONTROL) {
++	strcat(shortcut, _(&quot;Ctrl&quot;));
++	strcat(shortcut, &quot;+&quot;);
++      }
++      if(kbe-&gt;modifier &amp; KEYMOD_META) {
++	strcat(shortcut, _(&quot;Alt&quot;));
++	strcat(shortcut, &quot;+&quot;);
++      }
+       if(kbe-&gt;modifier &amp; KEYMOD_MOD3)
+-	sprintf(shortcut, &quot;%s%s+&quot;, shortcut, &quot;M3&quot;);
++	strcat(shortcut, &quot;M3+&quot;);
+       if(kbe-&gt;modifier &amp; KEYMOD_MOD4)
+-	sprintf(shortcut, &quot;%s%s+&quot;, shortcut, &quot;M4&quot;);
++	strcat(shortcut, &quot;M4+&quot;);
+       if(kbe-&gt;modifier &amp; KEYMOD_MOD5)
+-	sprintf(shortcut, &quot;%s%s+&quot;, shortcut, &quot;M5&quot;);
++	strcat(shortcut, &quot;M5+&quot;);
+     }
+     else {
+       if(kbe-&gt;modifier &amp; KEYMOD_CONTROL)
+-	sprintf(shortcut, &quot;%s%s-&quot;, shortcut, &quot;C&quot;);
++	strcat(shortcut, &quot;C-&quot;);
+       if(kbe-&gt;modifier &amp; KEYMOD_META)
+-	sprintf(shortcut, &quot;%s%s-&quot;, shortcut, &quot;M&quot;);
++	strcat(shortcut, &quot;M-&quot;);
+       if(kbe-&gt;modifier &amp; KEYMOD_MOD3)
+-	sprintf(shortcut, &quot;%s%s-&quot;, shortcut, &quot;M3&quot;);
++	strcat(shortcut, &quot;M3-&quot;);
+       if(kbe-&gt;modifier &amp; KEYMOD_MOD4)
+-	sprintf(shortcut, &quot;%s%s-&quot;, shortcut, &quot;M4&quot;);
++	strcat(shortcut, &quot;M4-&quot;);
+       if(kbe-&gt;modifier &amp; KEYMOD_MOD5)
+-	sprintf(shortcut, &quot;%s%s-&quot;, shortcut, &quot;M5&quot;);
++	strcat(shortcut, &quot;M5-&quot;);
+     }
+     
+-    sprintf(shortcut, &quot;%s%s&quot;, shortcut, kbe-&gt;key);
++    strcat(shortcut, kbe-&gt;key);
+     
+     return shortcut;
+   }
+@@ -2486,23 +2486,23 @@
+ 	  sprintf(buf, &quot;%s&quot;, &quot;\\fBC\\fP&quot;);
+ 	if(k[i]-&gt;modifier &amp; KEYMOD_META) {
+ 	  if(strlen(buf))
+-	    sprintf(buf, &quot;%s%s&quot;, buf, &quot;\\-&quot;);
+-	  sprintf(buf, &quot;%s%s&quot;, buf, &quot;\\fBM\\fP&quot;);
++	    strcat(buf, &quot;\\-&quot;);
++	  strcat(buf, &quot;\\fBM\\fP&quot;);
+ 	}
+ 	if(k[i]-&gt;modifier &amp; KEYMOD_MOD3) {
+ 	  if(strlen(buf))
+-	    sprintf(buf, &quot;%s%s&quot;, buf, &quot;\\-&quot;);
+-	  sprintf(buf, &quot;%s%s&quot;, buf, &quot;\\fBM3\\fP&quot;);
++	    strcat(buf, &quot;\\-&quot;);
++	  strcat(buf, &quot;\\fBM3\\fP&quot;);
+ 	}
+ 	if(k[i]-&gt;modifier &amp; KEYMOD_MOD4) {
+ 	  if(strlen(buf))
+-	    sprintf(buf, &quot;%s%s&quot;, buf, &quot;\\-&quot;);
+-	  sprintf(buf, &quot;%s%s&quot;, buf, &quot;\\fBM4\\fP&quot;);
++	    strcat(buf, &quot;\\-&quot;);
++	  strcat(buf, &quot;\\fBM4\\fP&quot;);
+ 	}
+ 	if(k[i]-&gt;modifier &amp; KEYMOD_MOD5) {
+ 	  if(strlen(buf))
+-	    sprintf(buf, &quot;%s%s&quot;, buf, &quot;\\-&quot;);
+-	  sprintf(buf, &quot;%s%s&quot;, buf, &quot;\\fBM5\\fP&quot;);
++	    strcat(buf, &quot;\\-&quot;);
++	  strcat(buf, &quot;\\fBM5\\fP&quot;);
+ 	}
+ 	printf(&quot;%s\\-&quot;, buf);
+       }
+diff -ur xine-ui-0.99.3/src/xitk/main.c xine-ui-0.99.3.sprintf/src/xitk/main.c
+--- xine-ui-0.99.3/src/xitk/main.c	2004-12-15 13:10:45.000000000 -0800
++++ xine-ui-0.99.3.sprintf/src/xitk/main.c	2005-07-06 12:56:14.000000000 -0700
+@@ -463,11 +463,12 @@
+     len = strlen(buffer);
+     
+     if((len + (strlen(plugin) + 3)) &lt; 80) {
+-      sprintf(buffer, &quot;%s%s%s&quot;, buffer, (strlen(buffer) == strlen(blanks)) ? &quot;&quot; : &quot;, &quot;, plugin);
++      if (len != strlen(blanks))
++        strcat(buffer, &quot;, &quot;);
++      strcat(buffer, plugin);
+     }
+     else {
+-      printf(buffer);
+-      printf(&quot;,\n&quot;);
++      printf(&quot;%s,\n&quot;, buffer);
+       snprintf(buffer, sizeof(buffer), &quot;%s%s&quot;, blanks, plugin);
+     }
+     
+@@ -1090,9 +1091,9 @@
+ 		 &quot;%s:&quot;, _(&quot;*drum roll*, xine lib wants to take your attention &quot;
+ 			  &quot;to deliver an important message to you ;-):&quot;));
+ 	if(data-&gt;explanation)
+-	  sprintf(buffer, &quot;%s %s %s&quot;, buffer, (char *) data + data-&gt;explanation, (char *) data + data-&gt;parameters);
++	  sprintf(buffer+strlen(buffer), &quot; %s %s&quot;, (char *) data + data-&gt;explanation, (char *) data + data-&gt;parameters);
+ 	else
+-	  sprintf(buffer, &quot;%s %s&quot;, buffer, _(&quot;No Information available.&quot;));
++	  sprintf(buffer+strlen(buffer), &quot; %s&quot;, _(&quot;No Information available.&quot;));
+ 	  
+ 	break;
+ 
+@@ -1101,14 +1102,14 @@
+ 	snprintf(buffer, sizeof(buffer), &quot;%s&quot;, _(&quot;The host you're trying to connect is unknown.\n&quot;
+ 						 &quot;Check the validity of the specified hostname.&quot;));
+ 	if(data-&gt;explanation)
+-	  sprintf(buffer, &quot;%s (%s)&quot;, buffer, (char *) data + data-&gt;parameters);
++	  sprintf(buffer+strlen(buffer), &quot; (%s)&quot;, (char *) data + data-&gt;parameters);
+ 	break;
+ 	
+ 	/* (device name) */
+       case XINE_MSG_UNKNOWN_DEVICE:
+ 	snprintf(buffer, sizeof(buffer), &quot;%s&quot;, _(&quot;The device name you specified seems invalid.&quot;));
+ 	if(data-&gt;explanation)
+-	  sprintf(buffer, &quot;%s (%s)&quot;, buffer, (char *) data + data-&gt;parameters);
++	  sprintf(buffer+strlen(buffer), &quot; (%s)&quot;, (char *) data + data-&gt;parameters);
+ 	break;
+ 
+ 	/* none */
+@@ -1116,21 +1117,21 @@
+ 	snprintf(buffer, sizeof(buffer), &quot;%s&quot;, _(&quot;The network looks unreachable.\nCheck your network &quot;
+ 						 &quot;setup and/or the server name.&quot;));
+ 	if(data-&gt;explanation)
+-	  sprintf(buffer, &quot;%s (%s)&quot;, buffer, (char *) data + data-&gt;parameters);
++	  sprintf(buffer+strlen(buffer), &quot; (%s)&quot;, (char *) data + data-&gt;parameters);
+ 	break;
+ 
+ 	/* (host name) */
+       case XINE_MSG_CONNECTION_REFUSED:
+ 	snprintf(buffer, sizeof(buffer), &quot;%s&quot;, _(&quot;The connection was refused.\nCheck the host name.&quot;));
+ 	if(data-&gt;explanation)
+-	  sprintf(buffer, &quot;%s (%s)&quot;, buffer, (char *) data + data-&gt;parameters);
++	  sprintf(buffer+strlen(buffer), &quot; (%s)&quot;, (char *) data + data-&gt;parameters);
+ 	break;
+ 
+ 	/* (file name or mrl) */
+       case XINE_MSG_FILE_NOT_FOUND:
+ 	snprintf(buffer, sizeof(buffer), &quot;%s&quot;, _(&quot;The specified file or mrl is not found. Please check it twice.&quot;));
+ 	if(data-&gt;explanation)
+-	  sprintf(buffer, &quot;%s (%s)&quot;, buffer, (char *) data + data-&gt;parameters);
++	  sprintf(buffer+strlen(buffer), &quot; (%s)&quot;, (char *) data + data-&gt;parameters);
+ 	break;
+ 
+ 	/* (device/file/mrl) */
+@@ -1139,27 +1140,27 @@
+ 						 &quot;rights for this, or source doesn't contain data &quot;
+ 						 &quot;(e.g: not disc in drive).&quot;));
+ 	if(data-&gt;explanation)
+-	  sprintf(buffer, &quot;%s (%s)&quot;, buffer, (char *) data + data-&gt;parameters);
++	  sprintf(buffer+strlen(buffer), &quot; (%s)&quot;, (char *) data + data-&gt;parameters);
+ 	break;
+ 	
+ 	/* (library/decoder) */
+       case XINE_MSG_LIBRARY_LOAD_ERROR:
+ 	snprintf(buffer, sizeof(buffer), &quot;%s&quot;, _(&quot;A problem occur while loading a library or a decoder&quot;));
+ 	if(data-&gt;explanation)
+-	  sprintf(buffer, &quot;%s: %s&quot;, buffer, (char *) data + data-&gt;parameters);
++	  sprintf(buffer+strlen(buffer), &quot;: %s&quot;, (char *) data + data-&gt;parameters);
+ 	break;
+ 
+ 	/* none */
+       case XINE_MSG_ENCRYPTED_SOURCE:
+ 	snprintf(buffer, sizeof(buffer), &quot;%s&quot;, _(&quot;The source seems encrypted, and can't be read.&quot;));
+ 	if(!strncasecmp(gGui-&gt;mmk.mrl, &quot;dvd:/&quot;, 5)) {
+-	  sprintf(buffer, &quot;%s%s&quot;, buffer, _(&quot;\nYour DVD is probably crypted. &quot;
+-					    &quot;According to your country laws, you can or can't &quot;
+-					    &quot;install/use libdvdcss to be able to read this disc, &quot;
+-					    &quot;which you bought.&quot;));
++	  strcat(buffer, _(&quot;\nYour DVD is probably crypted. &quot;
++			   &quot;According to your country laws, you can or can't &quot;
++			   &quot;install/use libdvdcss to be able to read this disc, &quot;
++			   &quot;which you bought.&quot;));
+ 	}
+ 	if(data-&gt;explanation)
+-	  sprintf(buffer, &quot;%s (%s)&quot;, buffer, (char *) data + data-&gt;parameters);
++	  sprintf(buffer+strlen(buffer), &quot; (%s)&quot;, (char *) data + data-&gt;parameters);
+ 	break;
+ 
+ 	/* (warning message) */
+@@ -1180,17 +1181,17 @@
+       default:
+ 	snprintf(buffer, sizeof(buffer), &quot;%s&quot;, _(&quot;*sight*, unkown error.&quot;));
+ 	if(data-&gt;explanation)
+-	  sprintf(buffer, &quot;%s (%s %s)&quot;, buffer, (char *) data + data-&gt;explanation, (char *) data + data-&gt;parameters);
++	  sprintf(buffer+strlen(buffer), &quot; (%s %s)&quot;, (char *) data + data-&gt;explanation, (char *) data + data-&gt;parameters);
+ 	break;
+       }
+       
+       if(gGui-&gt;verbosity &gt;= XINE_VERBOSITY_DEBUG) {
+-	sprintf(buffer, &quot;%s\n\n[&quot;, buffer);
++	strcat(buffer, &quot;\n\n[&quot;);
+ 	
+ 	if(data-&gt;explanation)
+-	  sprintf(buffer, &quot;%s'%s' '%s'&quot;, buffer, (char *) data + data-&gt;explanation, (char *) data + data-&gt;parameters);
++	  sprintf(buffer+strlen(buffer), &quot;'%s' '%s'&quot;, (char *) data + data-&gt;explanation, (char *) data + data-&gt;parameters);
+ 	
+-	sprintf(buffer, &quot;%s]&quot;, buffer);
++	strcat(buffer, &quot;]&quot;);
+       }
+       
+       if(strlen(buffer))
+diff -ur xine-ui-0.99.3/src/xitk/mediamark.c xine-ui-0.99.3.sprintf/src/xitk/mediamark.c
+--- xine-ui-0.99.3/src/xitk/mediamark.c	2004-12-15 23:14:26.000000000 -0800
++++ xine-ui-0.99.3.sprintf/src/xitk/mediamark.c	2005-07-06 12:58:03.000000000 -0700
+@@ -561,7 +561,7 @@
+ 		    if((buffer[strlen(buffer) - 1] == '/') &amp;&amp; (*ln == '/'))
+ 		      buffer[strlen(buffer) - 1] = '\0';
+ 		    
+-		    sprintf(buffer, &quot;%s%s&quot;, buffer, ln);
++		    strcat(buffer, ln);
+ 		    
+ 		    if(_file_exist(buffer))
+ 		      entry = buffer;
+@@ -681,7 +681,7 @@
+ 			  if((buffer[strlen(buffer) - 1] == '/') &amp;&amp; (*ln == '/'))
+ 			    buffer[strlen(buffer) - 1] = '\0';
+ 			  
+-			  sprintf(buffer, &quot;%s%s&quot;, buffer, ln);
++			  strcat(buffer, ln);
+ 			  
+ 			  if(_file_exist(buffer))
+ 			    entry = buffer;
+@@ -774,7 +774,7 @@
+ 		  if((buffer[strlen(buffer) - 1] == '/') &amp;&amp; (*ln == '/'))
+ 		    buffer[strlen(buffer) - 1] = '\0';
+ 		  
+-		  sprintf(buffer, &quot;%s%s&quot;, buffer, ln);
++		  strcat(buffer, ln);
+ 		  
+ 		  if(_file_exist(buffer))
+ 		    entry = buffer;
+@@ -1125,7 +1125,7 @@
+ 		  sprintf(real_title, &quot;%s&quot;, atitle);
+ 		    
+ 		  if(aauthor &amp;&amp; strlen(aauthor))
+-		    sprintf(real_title, &quot;%s (%s)&quot;, real_title, aauthor);
++		    sprintf(real_title+strlen(real_title), &quot; (%s)&quot;, aauthor);
+ 		}
+ 		  
+ 		mmk = (mediamark_t **) realloc(mmk, sizeof(mediamark_t *) * (entries_asx + 2));
+diff -ur xine-ui-0.99.3/src/xitk/network.c xine-ui-0.99.3.sprintf/src/xitk/network.c
+--- xine-ui-0.99.3/src/xitk/network.c	2004-08-24 13:06:26.000000000 -0700
++++ xine-ui-0.99.3.sprintf/src/xitk/network.c	2005-07-06 13:08:58.000000000 -0700
+@@ -550,7 +550,7 @@
+   /* Each line sent is '\n' terminated */
+   if(cr) {
+     if((buf[strlen(buf)] == '\0') &amp;&amp; (buf[strlen(buf) - 1] != '\n'))
+-      sprintf(buf, &quot;%s%c&quot;, buf, '\n');
++      strcat(buf, &quot;\n&quot;);
+   }
+   
+   return _sock_write(socket, buf, strlen(buf));
+@@ -746,15 +746,15 @@
+   while(session_commands[i]-&gt;command != NULL) {
+     if(session_commands[i]-&gt;enable) {
+       if((curpos + maxlen) &gt;= 80) {
+-	sprintf(buf, &quot;%s\n       &quot;, buf);
++	strcat(buf, &quot;\n       &quot;);
+ 	curpos = 7;
+       }
+       
+-      sprintf(buf, &quot;%s%s&quot;, buf, session_commands[i]-&gt;command);
++      strcat(buf, session_commands[i]-&gt;command);
+       curpos += strlen(session_commands[i]-&gt;command);
+       
+       for(j = 0; j &lt; (maxlen - strlen(session_commands[i]-&gt;command)); j++) {
+-	sprintf(buf, &quot;%s &quot;, buf);
++	strcat(buf, &quot; &quot;);
+ 	curpos++;
+       }
+     }
+@@ -1111,10 +1111,9 @@
+   memset(&amp;buf, 0, sizeof(buf));
+ 
+   for(i = 0; i &lt; num_commands; i++) {
+-    if(strlen(buf))
+-      sprintf(buf, &quot;%s %s&quot;, buf, commands[i]);
+-    else
+-      snprintf(buf, sizeof(buf), &quot;%s&quot;, commands[i]);
++    if(i)
++      strcat(buf, &quot; &quot;);
++    strcat(buf, commands[i]);
+   }
+ 
+   client_handle_command(session, buf);
+@@ -1709,11 +1708,11 @@
+   
+   while(commands[i].command != NULL) {
+     if(commands[i].public) {
+-      sprintf(buf, &quot;%s\t%s&quot;, buf, commands[i].command);
++      sprintf(buf+strlen(buf), &quot;\t%s&quot;, commands[i].command);
+     }
+     i++;
+   }
+-  sprintf(buf, &quot;%s.\n&quot;, buf);
++  strcat(buf, &quot;.\n&quot;);
+   sock_write(client_info-&gt;socket, buf);
+ }
+ 
+@@ -1744,22 +1743,22 @@
+     while(commands[i].command != NULL) {
+       if(commands[i].public) {
+ 	if((curpos + maxlen) &gt;= 80) {
+-	  sprintf(buf, &quot;%s\n       &quot;, buf);
++	  strcat(buf, &quot;\n       &quot;);
+ 	  curpos = 7;
+ 	}
+ 	
+-	sprintf(buf, &quot;%s%s&quot;, buf, commands[i].command);
++	strcat(buf, commands[i].command);
+ 	curpos += strlen(commands[i].command);
+ 	
+ 	for(j = 0; j &lt; (maxlen - strlen(commands[i].command)); j++) {
+-	  sprintf(buf, &quot;%s &quot;, buf);
++	  strcat(buf, &quot; &quot;);
+ 	  curpos++;
+ 	}
+       }
+       i++;
+     }
+     
+-    sprintf(buf, &quot;%s\n&quot;, buf);
++    strcat(buf, &quot;\n&quot;);
+     sock_write(client_info-&gt;socket, buf);
+   }
+   else {
+@@ -2091,11 +2090,11 @@
+ 	status = xine_get_status(gGui-&gt;stream);
+ 	
+ 	if(status &lt;= XINE_STATUS_QUIT)
+-	  sprintf(buf, &quot;%s%s&quot;, buf, status_struct[status].name);
++	  strcat(buf, status_struct[status].name);
+ 	else
+-	  sprintf(buf, &quot;%s%s&quot;, buf, &quot;*UNKNOWN*&quot;);
++	  strcat(buf, &quot;*UNKNOWN*&quot;);
+ 	
+-	sprintf(buf, &quot;%s%c&quot;, buf, '\n');
++	strcat(buf, &quot;\n&quot;);
+ 	sock_write(client_info-&gt;socket, buf);
+       }
+       else if(is_arg_contain(client_info, 1, &quot;speed&quot;)) {
+@@ -2111,11 +2110,11 @@
+ 	}
+ 	
+ 	if(i &lt; ((sizeof(speeds_struct) / sizeof(speeds_struct[0])) - 1))
+-	  sprintf(buf, &quot;%s%s&quot;, buf, speeds_struct[i].name);
++	  strcat(buf, speeds_struct[i].name);
+ 	else
+-	  sprintf(buf, &quot;%s%s&quot;, buf, &quot;*UNKNOWN*&quot;);
++	  strcat(buf, &quot;*UNKNOWN*&quot;);
+ 	
+-	sprintf(buf, &quot;%s%c&quot;, buf, '\n');
++	strcat(buf, &quot;\n&quot;);
+ 	sock_write(client_info-&gt;socket, buf);
+       }
+       else if(is_arg_contain(client_info, 1, &quot;position&quot;)) {
+@@ -2149,26 +2148,26 @@
+ 
+ 	switch(gGui-&gt;playlist.loop) {
+ 	case PLAYLIST_LOOP_NO_LOOP:
+-	  sprintf(buf, &quot;%s%s&quot;, buf, &quot;'No Loop'&quot;);
++	  strcat(buf, &quot;'No Loop'&quot;);
+ 	  break;
+ 	case PLAYLIST_LOOP_LOOP:
+-	  sprintf(buf, &quot;%s%s&quot;, buf, &quot;'Loop'&quot;);
++	  strcat(buf, &quot;'Loop'&quot;);
+ 	  break;
+ 	case PLAYLIST_LOOP_REPEAT:
+-	  sprintf(buf, &quot;%s%s&quot;, buf, &quot;'Repeat'&quot;);
++	  strcat(buf, &quot;'Repeat'&quot;);
+ 	  break;
+ 	case PLAYLIST_LOOP_SHUFFLE:
+-	  sprintf(buf, &quot;%s%s&quot;, buf, &quot;'Shuffle'&quot;);
++	  strcat(buf, &quot;'Shuffle'&quot;);
+ 	  break;
+ 	case PLAYLIST_LOOP_SHUF_PLUS:	
+-	  sprintf(buf, &quot;%s%s&quot;, buf, &quot;'Shuffle forever'&quot;);
++	  strcat(buf, &quot;'Shuffle forever'&quot;);
+ 	  break;
+ 	default:
+-	  sprintf(buf, &quot;%s%s&quot;, buf, &quot;'!!Unknown!!'&quot;);
++	  strcat(buf, &quot;'!!Unknown!!'&quot;);
+ 	  break;
+ 	}
+ 
+-	sprintf(buf, &quot;%s.\n&quot;, buf);
++	strcat(buf, &quot;.\n&quot;);
+ 	sock_write(client_info-&gt;socket, buf);
+       }
+     }
+diff -ur xine-ui-0.99.3/src/xitk/osd.c xine-ui-0.99.3.sprintf/src/xitk/osd.c
+--- xine-ui-0.99.3/src/xitk/osd.c	2004-11-15 13:43:20.000000000 -0800
++++ xine-ui-0.99.3.sprintf/src/xitk/osd.c	2005-07-06 17:20:30.000000000 -0700
+@@ -338,34 +338,34 @@
+     len = strlen(buffer);
+     switch(audiochannel) {
+     case -2:
+-      sprintf(buffer, &quot;%s%s&quot;, buffer, &quot;off&quot;);
++      strcat(buffer, &quot;off&quot;);
+       break;
+     case -1:
+       if(!xine_get_audio_lang (gGui-&gt;stream, audiochannel, &amp;buffer[len]))
+-	sprintf(buffer, &quot;%s%s&quot;, buffer, &quot;auto&quot;);
++	strcat(buffer, &quot;auto&quot;);
+       break;
+     default:
+       if(!xine_get_audio_lang (gGui-&gt;stream, audiochannel, &amp;buffer[len]))
+-	sprintf(buffer, &quot;%s%3d&quot;, buffer, audiochannel);
++	sprintf(buffer+strlen(buffer), &quot;%3d&quot;, audiochannel);
+       break;
+     }
+ 
+-    sprintf(buffer, &quot;%s%s&quot;, buffer, &quot;, Spu: &quot;);
++    strcat(buffer, &quot;, Spu: &quot;);
+     len = strlen(buffer);
+     switch (spuchannel) {
+     case -2:
+-      sprintf(buffer, &quot;%s%s&quot;, buffer, &quot;off&quot;);
++      strcat(buffer, &quot;off&quot;);
+       break;
+     case -1:
+       if(!xine_get_spu_lang (gGui-&gt;stream, spuchannel, &amp;buffer[len]))
+-	sprintf(buffer, &quot;%s%s&quot;, buffer, &quot;auto&quot;);
++	strcat(buffer, &quot;auto&quot;);
+       break;
+     default:
+       if(!xine_get_spu_lang (gGui-&gt;stream, spuchannel, &amp;buffer[len]))
+-        sprintf(buffer, &quot;%s%3d&quot;, buffer, spuchannel);
++        sprintf(buffer+strlen(buffer), &quot;%3d&quot;, spuchannel);
+       break;
+     }
+-    sprintf(buffer, &quot;%s.&quot;, buffer);
++    strcat(buffer, &quot;.&quot;);
+     xine_osd_draw_text(gGui-&gt;osd.sinfo.osd[0], x, y, buffer, XINE_OSD_TEXT1);
+     xine_osd_get_text_size(gGui-&gt;osd.sinfo.osd[0], buffer, &amp;w, &amp;h);
+     if(w &gt; osdw)
+@@ -384,12 +384,12 @@
+       int totaldays;
+       
+       totaldays  = totaltime / (3600 * 24);
+-      sprintf(buffer, &quot;%s(%.0f%%) %s &quot;, buffer, ((float)playedtime / (float)totaltime) * 100, _(&quot;of&quot;));
++      sprintf(buffer+strlen(buffer), &quot;(%.0f%%) %s &quot;, ((float)playedtime / (float)totaltime) * 100, _(&quot;of&quot;));
+       
+       if(totaldays &gt; 0)
+-	sprintf(buffer, &quot;%s%d::%02d&quot;, buffer, totaldays, totaltime / 3600);
++	sprintf(buffer+strlen(buffer), &quot;%d::%02d&quot;, totaldays, totaltime / 3600);
+       else
+-	sprintf(buffer, &quot;%s%d:%02d:%02d&quot;, buffer, totaltime / 3600, (totaltime % 3600) / 60, totaltime % 60);
++	sprintf(buffer+strlen(buffer), &quot;%d:%02d:%02d&quot;, totaltime / 3600, (totaltime % 3600) / 60, totaltime % 60);
+     }
+     
+     xine_osd_draw_text(gGui-&gt;osd.sinfo.osd[0], x, y, buffer, XINE_OSD_TEXT1);
+diff -ur xine-ui-0.99.3/src/xitk/stream_infos.c xine-ui-0.99.3.sprintf/src/xitk/stream_infos.c
+--- xine-ui-0.99.3/src/xitk/stream_infos.c	2004-12-15 13:10:46.000000000 -0800
++++ xine-ui-0.99.3.sprintf/src/xitk/stream_infos.c	2005-07-06 17:21:22.000000000 -0700
+@@ -265,11 +265,11 @@
+     if((aartist &amp;&amp; strlen(aartist)) || (aalbum &amp;&amp; strlen(aalbum))) {
+       strcat(ident, &quot; (&quot;);
+       if(aartist &amp;&amp; strlen(aartist))
+-	sprintf(ident, &quot;%s%s&quot;, ident, aartist);
++	strcat(ident, aartist);
+       if((aartist &amp;&amp; strlen(aartist)) &amp;&amp; (aalbum &amp;&amp; strlen(aalbum)))
+ 	strcat(ident, &quot; - &quot;);
+       if(aalbum &amp;&amp; strlen(aalbum))
+-	sprintf(ident, &quot;%s%s&quot;, ident, aalbum);
++	strcat(ident, aalbum);
+       strcat(ident, &quot;)&quot;);
+     }
+   }
+diff -ur xine-ui-0.99.3/src/xitk/viewlog.c xine-ui-0.99.3.sprintf/src/xitk/viewlog.c
+--- xine-ui-0.99.3/src/xitk/viewlog.c	2004-12-15 13:10:46.000000000 -0800
++++ xine-ui-0.99.3.sprintf/src/xitk/viewlog.c	2005-07-06 17:23:03.000000000 -0700
+@@ -229,7 +229,7 @@
+ 	    break;
+ 	    
+ 	  default:
+-	    sprintf(buf, &quot;%s%c&quot;, buf, *p);
++	    sprintf(buf+strlen(buf), &quot;%c&quot;, *p);
+ 	    break;
+ 	  }
+ 	  
+diff -ur xine-ui-0.99.3/src/xitk/xine-remote.c xine-ui-0.99.3.sprintf/src/xitk/xine-remote.c
+--- xine-ui-0.99.3/src/xitk/xine-remote.c	2004-08-24 13:06:26.000000000 -0700
++++ xine-ui-0.99.3.sprintf/src/xitk/xine-remote.c	2005-07-06 17:36:35.000000000 -0700
+@@ -550,7 +550,7 @@
+   /* Each line sent is '\n' terminated */
+   if(cr) {
+     if((buf[strlen(buf)] == '\0') &amp;&amp; (buf[strlen(buf) - 1] != '\n'))
+-      sprintf(buf, &quot;%s%c&quot;, buf, '\n');
++      strcat(buf, &quot;\n&quot;);
+   }
+   
+   return _sock_write(socket, buf, strlen(buf));
+@@ -746,15 +746,15 @@
+   while(session_commands[i]-&gt;command != NULL) {
+     if(session_commands[i]-&gt;enable) {
+       if((curpos + maxlen) &gt;= 80) {
+-	sprintf(buf, &quot;%s\n       &quot;, buf);
++	strcat(buf, &quot;\n       &quot;);
+ 	curpos = 7;
+       }
+       
+-      sprintf(buf, &quot;%s%s&quot;, buf, session_commands[i]-&gt;command);
++      strcat(buf, session_commands[i]-&gt;command);
+       curpos += strlen(session_commands[i]-&gt;command);
+       
+       for(j = 0; j &lt; (maxlen - strlen(session_commands[i]-&gt;command)); j++) {
+-	sprintf(buf, &quot;%s &quot;, buf);
++	strcat(buf, &quot; &quot;);
+ 	curpos++;
+       }
+     }
+@@ -1111,10 +1111,9 @@
+   memset(&amp;buf, 0, sizeof(buf));
+ 
+   for(i = 0; i &lt; num_commands; i++) {
+-    if(strlen(buf))
+-      sprintf(buf, &quot;%s %s&quot;, buf, commands[i]);
+-    else
+-      snprintf(buf, sizeof(buf), &quot;%s&quot;, commands[i]);
++    if(i)
++      strcat(buf, &quot; &quot;);
++    strcat(buf, commands[i]);
+   }
+ 
+   client_handle_command(session, buf);
+@@ -1709,11 +1708,11 @@
+   
+   while(commands[i].command != NULL) {
+     if(commands[i].public) {
+-      sprintf(buf, &quot;%s\t%s&quot;, buf, commands[i].command);
++      sprintf(buf+strlen(buf), &quot;\t%s&quot;, commands[i].command);
+     }
+     i++;
+   }
+-  sprintf(buf, &quot;%s.\n&quot;, buf);
++  strcat(buf, &quot;.\n&quot;);
+   sock_write(client_info-&gt;socket, buf);
+ }
+ 
+@@ -1744,22 +1743,22 @@
+     while(commands[i].command != NULL) {
+       if(commands[i].public) {
+ 	if((curpos + maxlen) &gt;= 80) {
+-	  sprintf(buf, &quot;%s\n       &quot;, buf);
++	  strcat(buf, &quot;\n       &quot;);
+ 	  curpos = 7;
+ 	}
+ 	
+-	sprintf(buf, &quot;%s%s&quot;, buf, commands[i].command);
++	strcat(buf, commands[i].command);
+ 	curpos += strlen(commands[i].command);
+ 	
+ 	for(j = 0; j &lt; (maxlen - strlen(commands[i].command)); j++) {
+-	  sprintf(buf, &quot;%s &quot;, buf);
++	  strcat(buf, &quot; &quot;);
+ 	  curpos++;
+ 	}
+       }
+       i++;
+     }
+     
+-    sprintf(buf, &quot;%s\n&quot;, buf);
++    strcat(buf, &quot;\n&quot;);
+     sock_write(client_info-&gt;socket, buf);
+   }
+   else {
+@@ -2091,11 +2090,11 @@
+ 	status = xine_get_status(gGui-&gt;stream);
+ 	
+ 	if(status &lt;= XINE_STATUS_QUIT)
+-	  sprintf(buf, &quot;%s%s&quot;, buf, status_struct[status].name);
++	  strcat(buf, status_struct[status].name);
+ 	else
+-	  sprintf(buf, &quot;%s%s&quot;, buf, &quot;*UNKNOWN*&quot;);
++	  strcat(buf, &quot;*UNKNOWN*&quot;);
+ 	
+-	sprintf(buf, &quot;%s%c&quot;, buf, '\n');
++	strcat(buf, &quot;\n&quot;);
+ 	sock_write(client_info-&gt;socket, buf);
+       }
+       else if(is_arg_contain(client_info, 1, &quot;speed&quot;)) {
+@@ -2111,11 +2110,11 @@
+ 	}
+ 	
+ 	if(i &lt; ((sizeof(speeds_struct) / sizeof(speeds_struct[0])) - 1))
+-	  sprintf(buf, &quot;%s%s&quot;, buf, speeds_struct[i].name);
++	  strcat(buf, speeds_struct[i].name);
+ 	else
+-	  sprintf(buf, &quot;%s%s&quot;, buf, &quot;*UNKNOWN*&quot;);
++	  strcat(buf, &quot;*UNKNOWN*&quot;);
+ 	
+-	sprintf(buf, &quot;%s%c&quot;, buf, '\n');
++	strcat(buf, &quot;\n&quot;);
+ 	sock_write(client_info-&gt;socket, buf);
+       }
+       else if(is_arg_contain(client_info, 1, &quot;position&quot;)) {
+@@ -2149,26 +2148,26 @@
+ 
+ 	switch(gGui-&gt;playlist.loop) {
+ 	case PLAYLIST_LOOP_NO_LOOP:
+-	  sprintf(buf, &quot;%s%s&quot;, buf, &quot;'No Loop'&quot;);
++	  strcat(buf, &quot;'No Loop'&quot;);
+ 	  break;
+ 	case PLAYLIST_LOOP_LOOP:
+-	  sprintf(buf, &quot;%s%s&quot;, buf, &quot;'Loop'&quot;);
++	  strcat(buf, &quot;'Loop'&quot;);
+ 	  break;
+ 	case PLAYLIST_LOOP_REPEAT:
+-	  sprintf(buf, &quot;%s%s&quot;, buf, &quot;'Repeat'&quot;);
++	  strcat(buf, &quot;'Repeat'&quot;);
+ 	  break;
+ 	case PLAYLIST_LOOP_SHUFFLE:
+-	  sprintf(buf, &quot;%s%s&quot;, buf, &quot;'Shuffle'&quot;);
++	  strcat(buf, &quot;'Shuffle'&quot;);
+ 	  break;
+ 	case PLAYLIST_LOOP_SHUF_PLUS:	
+-	  sprintf(buf, &quot;%s%s&quot;, buf, &quot;'Shuffle forever'&quot;);
++	  strcat(buf, &quot;'Shuffle forever'&quot;);
+ 	  break;
+ 	default:
+-	  sprintf(buf, &quot;%s%s&quot;, buf, &quot;'!!Unknown!!'&quot;);
++	  strcat(buf, &quot;'!!Unknown!!'&quot;);
+ 	  break;
+ 	}
+ 
+-	sprintf(buf, &quot;%s.\n&quot;, buf);
++	strcat(buf, &quot;.\n&quot;);
+ 	sock_write(client_info-&gt;socket, buf);
+       }
+     }
+diff -ur xine-ui-0.99.3/src/xitk/xine-toolkit/image.c xine-ui-0.99.3.sprintf/src/xitk/xine-toolkit/image.c
+--- xine-ui-0.99.3/src/xitk/xine-toolkit/image.c	2004-12-16 13:35:30.000000000 -0800
++++ xine-ui-0.99.3.sprintf/src/xitk/xine-toolkit/image.c	2005-07-06 17:37:27.000000000 -0700
+@@ -1334,7 +1334,7 @@
+       /* Cut title, add three dots a the end */
+       nchar -= 4;
+       snprintf(buf, nchar, &quot;%s&quot;, title);
+-      sprintf(buf, &quot;%s%s&quot;, buf, &quot;...&quot;);
++      strcat(buf, &quot;...&quot;);
+     }
+     else
+       sprintf(buf, &quot;%s&quot;, title);
+diff -ur xine-ui-0.99.3/src/xitk/xine-toolkit/skin.c xine-ui-0.99.3.sprintf/src/xitk/xine-toolkit/skin.c
+--- xine-ui-0.99.3/src/xitk/xine-toolkit/skin.c	2004-11-22 00:45:26.000000000 -0800
++++ xine-ui-0.99.3.sprintf/src/xitk/xine-toolkit/skin.c	2005-07-06 17:40:32.000000000 -0700
+@@ -149,44 +149,44 @@
+ 		snprintf(ppath, sizeof(ppath), &quot;%s&quot;, skonfig-&gt;path);
+ 		if((z = strrchr(ppath, '/')) != NULL) {
+ 		  *z = '\0';
+-		  sprintf(buf2, &quot;%s%s&quot;, buf2, ppath);
++		  strcat(buf2, ppath);
+ 		}
+ 	      }
+ 	    }
+ 	    else if(!strncmp(&quot;SKIN_VERSION&quot;, var, strlen(var))) {
+ 	      if(skonfig-&gt;version &gt;= 0)
+-		sprintf(buf2, &quot;%s%d&quot;, buf2, skonfig-&gt;version);
++		sprintf(buf2+strlen(buf2), &quot;%d&quot;, skonfig-&gt;version);
+ 	    }
+ 	    else if(!strncmp(&quot;SKIN_AUTHOR&quot;, var, strlen(var))) {
+ 	      if(skonfig-&gt;author)
+-		sprintf(buf2, &quot;%s%s&quot;, buf2, skonfig-&gt;author);
++		strcat(buf2, skonfig-&gt;author);
+ 	    }
+ 	    else if(!strncmp(&quot;SKIN_PATH&quot;, var, strlen(var))) {
+ 	      if(skonfig-&gt;path)
+-		sprintf(buf2, &quot;%s%s&quot;, buf2, skonfig-&gt;path);
++		strcat(buf2, skonfig-&gt;path);
+ 	    }
+ 	    else if(!strncmp(&quot;SKIN_NAME&quot;, var, strlen(var))) {
+ 	      if(skonfig-&gt;name)
+-		sprintf(buf2, &quot;%s%s&quot;, buf2, skonfig-&gt;name);
++		strcat(buf2, skonfig-&gt;name);
+ 	    }
+ 	    else if(!strncmp(&quot;SKIN_DATE&quot;, var, strlen(var))) {
+ 	      if(skonfig-&gt;date)
+-		sprintf(buf2, &quot;%s%s&quot;, buf2, skonfig-&gt;date);
++		strcat(buf2, skonfig-&gt;date);
+ 	    }
+ 	    else if(!strncmp(&quot;SKIN_URL&quot;, var, strlen(var))) {
+ 	      if(skonfig-&gt;url)
+-		sprintf(buf2, &quot;%s%s&quot;, buf2, skonfig-&gt;url);
++		strcat(buf2, skonfig-&gt;url);
+ 	    }
+ 	    else if(!strncmp(&quot;HOME&quot;, var, strlen(var))) {
+ 	      if(skonfig-&gt;url)
+-		sprintf(buf2, &quot;%s%s&quot;, buf2, xitk_get_homedir());
++		strcat(buf2, xitk_get_homedir());
+ 	    }
+ 	    /* else ignore */
+ 	  }
+ 	  break;
+ 	  
+ 	default:
+-	  sprintf(buf2, &quot;%s%c&quot;, buf2, *p);
++	  sprintf(buf2+strlen(buf2), &quot;%c&quot;, *p);
+ 	  break;
+ 	}
+ 	p++;
+diff -ur xine-ui-0.99.3/src/xitk/xine-toolkit/xitk.c xine-ui-0.99.3.sprintf/src/xitk/xine-toolkit/xitk.c
+--- xine-ui-0.99.3/src/xitk/xine-toolkit/xitk.c	2004-12-15 13:10:48.000000000 -0800
++++ xine-ui-0.99.3.sprintf/src/xitk/xine-toolkit/xitk.c	2005-07-07 01:32:18.000000000 -0700
+@@ -1828,7 +1828,7 @@
+ 	    gXitk-&gt;use_xshm = 0;
+ 	  else {
+ 	    XShmDetach(display, &amp;shminfo);
+-	    sprintf(buffer, &quot;%s%s&quot;, buffer, &quot;[XShm]&quot;);
++	    strcat(buffer, &quot;[XShm]&quot;);
+ 	  }
+ 	  
+ 	  XDestroyImage(xim);
+@@ -1844,12 +1844,12 @@
+ #endif
+ 
+ #ifdef WITH_XFT
+-  sprintf(buffer, &quot;%s%s&quot;, buffer, &quot;[XFT]&quot;);
++  strcat(buffer, &quot;[XFT]&quot;);
+ #elif defined(WITH_XMB)
+-  sprintf(buffer, &quot;%s%s&quot;, buffer, &quot;[XMB]&quot;);
++  strcat(buffer, &quot;[XMB]&quot;);
+ #endif
+   
+-  sprintf(buffer, &quot;%s%s&quot;, buffer, &quot; ]-&quot;);
++  strcat(buffer, &quot; ]-&quot;);
+ 
+   if(verbosity)
+     printf(buffer);

Added: trunk/rpms/xine/xine-ui-0.99.3-uifixups.patch
===================================================================
--- trunk/rpms/xine/xine-ui-0.99.3-uifixups.patch	2005-07-30 09:41:33 UTC (rev 3442)
+++ trunk/rpms/xine/xine-ui-0.99.3-uifixups.patch	2005-07-30 14:09:55 UTC (rev 3443)
@@ -0,0 +1,104 @@
+diff -ur xine-ui-0.99.3/src/xitk/help.c xine-ui-0.99.3-uifixups/src/xitk/help.c
+--- xine-ui-0.99.3/src/xitk/help.c	2004-12-15 13:10:44.000000000 -0800
++++ xine-ui-0.99.3-uifixups/src/xitk/help.c	2005-07-07 15:44:39.000000000 -0700
+@@ -392,7 +392,7 @@
+   xitk_list_append_content ((XITK_WIDGET_LIST_LIST(help-&gt;widget_list)),
+     (help-&gt;tabs = 
+      xitk_noskin_tabs_create(help-&gt;widget_list, 
+-			     &amp;tab, 20, 24, WINDOW_WIDTH - 40, tabsfontname)));
++			     &amp;tab, 20, 24, WINDOW_WIDTH - 40, 28, tabsfontname)));
+   
+   xitk_enable_and_show_widget(help-&gt;tabs);
+ 
+diff -ur xine-ui-0.99.3/src/xitk/setup.c xine-ui-0.99.3-uifixups/src/xitk/setup.c
+--- xine-ui-0.99.3/src/xitk/setup.c	2004-12-15 13:10:46.000000000 -0800
++++ xine-ui-0.99.3-uifixups/src/xitk/setup.c	2005-07-12 17:49:15.000000000 -0700
+@@ -56,7 +56,7 @@
+     int                  lbearing, rbearing, width, ascent, descent;                            \
+     xitk_font_t         *fs;                                                                    \
+                                                                                                 \
+-    image = xitk_image_create_image(gGui-&gt;imlib_data, FRAME_WIDTH + 1, FRAME_HEIGHT + 1);       \
++    image = xitk_image_create_image(gGui-&gt;imlib_data, FRAME_WIDTH + 1, FRAME_HEIGHT + 2);       \
+                                                                                                 \
+     fs = xitk_font_load_font(gGui-&gt;display, boldfontname);                                      \
+     xitk_font_set_font(fs, (XITK_WIDGET_LIST_GC(setup-&gt;widget_list)));                          \
+@@ -1006,7 +1006,7 @@
+   tab.userdata          = NULL;
+   xitk_list_append_content ((XITK_WIDGET_LIST_LIST(setup-&gt;widget_list)),
+     (setup-&gt;tabs = 
+-     xitk_noskin_tabs_create(setup-&gt;widget_list, &amp;tab, 20, 24, WINDOW_WIDTH - 40, tabsfontname)));
++     xitk_noskin_tabs_create(setup-&gt;widget_list, &amp;tab, 20, 24, WINDOW_WIDTH - 40, 28, tabsfontname)));
+   
+   xitk_enable_and_show_widget(setup-&gt;tabs);
+ 
+@@ -1047,7 +1047,6 @@
+ 
+   if(rpos != setup-&gt;first_displayed) {
+     setup-&gt;first_displayed = rpos;
+-    setup_clear_tab();
+     setup_paint_widgets();
+   }
+ }
+diff -ur xine-ui-0.99.3/src/xitk/viewlog.c xine-ui-0.99.3-uifixups/src/xitk/viewlog.c
+--- xine-ui-0.99.3/src/xitk/viewlog.c	2004-12-15 13:10:46.000000000 -0800
++++ xine-ui-0.99.3-uifixups/src/xitk/viewlog.c	2005-07-07 15:44:39.000000000 -0700
+@@ -319,7 +319,7 @@
+   tab.userdata          = NULL;
+   xitk_list_append_content ((XITK_WIDGET_LIST_LIST(viewlog-&gt;widget_list)),
+     (viewlog-&gt;tabs = 
+-     xitk_noskin_tabs_create(viewlog-&gt;widget_list, &amp;tab, 20, 24, WINDOW_WIDTH - 40, tabsfontname)));
++     xitk_noskin_tabs_create(viewlog-&gt;widget_list, &amp;tab, 20, 24, WINDOW_WIDTH - 40, 28, tabsfontname)));
+   xitk_enable_and_show_widget(viewlog-&gt;tabs);
+ 
+   bg = xitk_image_create_xitk_pixmap(gGui-&gt;imlib_data, WINDOW_WIDTH, WINDOW_HEIGHT);
+diff -ur xine-ui-0.99.3/src/xitk/xine-toolkit/tabs.c xine-ui-0.99.3-uifixups/src/xitk/xine-toolkit/tabs.c
+--- xine-ui-0.99.3/src/xitk/xine-toolkit/tabs.c	2004-04-13 12:55:50.000000000 -0700
++++ xine-ui-0.99.3-uifixups/src/xitk/xine-toolkit/tabs.c	2005-07-07 15:44:39.000000000 -0700
+@@ -323,7 +323,8 @@
+  */
+ xitk_widget_t *xitk_noskin_tabs_create(xitk_widget_list_t *wl,
+ 				       xitk_tabs_widget_t *t, 
+-				       int x, int y, int width, char *fontname) {
++				       int x, int y, int width, int height,
++				       char *fontname) {
+   xitk_widget_t         *mywidget;
+   tabs_private_data_t   *private_data;
+   
+@@ -367,7 +368,10 @@
+     XITK_WIDGET_INIT(&amp;lb, t-&gt;imlibdata);
+     XITK_WIDGET_INIT(&amp;b, t-&gt;imlibdata);
+ 
+-    private_data-&gt;bheight = fheight * 2;
++    if (height == 0)
++      private_data-&gt;bheight = fheight * 2;
++    else
++      private_data-&gt;bheight = height;
+ 
+     for(i = 0; i &lt; t-&gt;num_entries; i++) {
+ 
+diff -ur xine-ui-0.99.3/src/xitk/xine-toolkit/test.c xine-ui-0.99.3-uifixups/src/xitk/xine-toolkit/test.c
+--- xine-ui-0.99.3/src/xitk/xine-toolkit/test.c	2004-07-25 17:43:47.000000000 -0700
++++ xine-ui-0.99.3-uifixups/src/xitk/xine-toolkit/test.c	2005-07-07 15:44:39.000000000 -0700
+@@ -509,7 +509,7 @@
+   t.userdata          = NULL;
+   xitk_list_append_content (XITK_WIDGET_LIST_LIST(test-&gt;widget_list),
+ 		    (test-&gt;tabs = 
+-		     xitk_noskin_tabs_create(test-&gt;widget_list, &amp;t, x, y, w, fontname)));
++		     xitk_noskin_tabs_create(test-&gt;widget_list, &amp;t, x, y, w, 0, fontname)));
+   xitk_enable_and_show_widget(test-&gt;tabs);
+ 
+ }
+diff -ur xine-ui-0.99.3/src/xitk/xine-toolkit/xitk.h xine-ui-0.99.3-uifixups/src/xitk/xine-toolkit/xitk.h
+--- xine-ui-0.99.3/src/xitk/xine-toolkit/xitk.h	2004-12-16 13:35:30.000000000 -0800
++++ xine-ui-0.99.3-uifixups/src/xitk/xine-toolkit/xitk.h	2005-07-07 15:44:39.000000000 -0700
+@@ -2351,7 +2351,8 @@
+ 
+ xitk_widget_t *xitk_noskin_tabs_create(xitk_widget_list_t *wl,
+ 				       xitk_tabs_widget_t *t, 
+-				       int x, int y, int width, char *fontname);
++				       int x, int y, int width, int height,
++				       char *fontname);
+ int xitk_tabs_get_current_selected(xitk_widget_t *w);
+ char *xitk_tabs_get_current_tab_selected(xitk_widget_t *w);
+ void xitk_tabs_set_current_selected(xitk_widget_t *w, int select);
+

Added: trunk/rpms/xine/xine-ui-0.99.3-xftfontsize.patch
===================================================================
--- trunk/rpms/xine/xine-ui-0.99.3-xftfontsize.patch	2005-07-30 09:41:33 UTC (rev 3442)
+++ trunk/rpms/xine/xine-ui-0.99.3-xftfontsize.patch	2005-07-30 14:09:55 UTC (rev 3443)
@@ -0,0 +1,64 @@
+diff -ur xine-ui-0.99.3/src/xitk/xine-toolkit/font.c xine-ui-0.99.3-xftfontsize/src/xitk/xine-toolkit/font.c
+--- xine-ui-0.99.3/src/xitk/xine-toolkit/font.c	2004-05-07 14:06:54.000000000 -0700
++++ xine-ui-0.99.3-xftfontsize/src/xitk/xine-toolkit/font.c	2005-07-12 18:18:53.000000000 -0700
+@@ -320,7 +320,8 @@
+       || strncmp(old_name, &quot;-&quot;, 1) == 0 || strncmp(old_name, &quot;*&quot;, 1) == 0) {
+     char  font[50];
+     char  style[15];
+-    char  *psize = &quot;*&quot;, size[5], ptsize[5], pxsize[5];
++    char  ptsize[5], pxsize[5];
++    int   xft_pxsize;
+     
+     if( old_name[0] == '-' )
+       old_name++;
+@@ -330,27 +331,18 @@
+     sscanf( old_name, &quot;%*[^-]-%*[^-]-%*[^-]-%*[^-]-%*[^-]-%*[^-]-%[^-]&quot;, pxsize);
+     sscanf( old_name, &quot;%*[^-]-%*[^-]-%*[^-]-%*[^-]-%*[^-]-%*[^-]-%*[^-]-%[^-]&quot;, ptsize);
+ 
+-    /* Xft doesn't have lucida, which is a small font;
+-     * thus we make whatever is chosen 2 sizes smaller */
+-    if(strlen(pxsize) &amp;&amp; strcmp(pxsize, &quot;*&quot;))
+-      psize = pxsize;
+-    else if(strlen(ptsize) &amp;&amp; strcmp(ptsize, &quot;*&quot;))
+-      psize = ptsize;
++    if (!strcmp(style, &quot;*&quot;))
++      style[0] = 0;
+ 
+-    if( strcmp( font, &quot;lucida&quot; ) == 0 ) {
+-      int  sz = strtol(psize, &amp;psize, 10);
++    if(strlen(pxsize) &amp;&amp; strcmp(pxsize, &quot;*&quot;)) {
++      /* Xft fonts usually come out looking slightly smaller at a given pixel
++       * size, so bump the px size up by 1 to get a more consistent appearance.
++       */
++      xft_pxsize = atoi(pxsize) + 1;
++      snprintf(new_name, sizeof(new_name)-5, &quot;%s:pixelsize=%d:%s&quot;, font, xft_pxsize, style);
++    } else if(strlen(ptsize) &amp;&amp; strcmp(ptsize, &quot;*&quot;))
++      snprintf(new_name, sizeof(new_name)-5, &quot;%s-%s:%s&quot;, font, ptsize, style);
+ 
+-      sz -= 2;
+-      snprintf(size , sizeof(size), &quot;%i&quot;, sz);
+-    }
+-    else
+-      snprintf(size, sizeof(size), &quot;%s&quot;, psize);
+-    
+-    if( strcmp( style , &quot;bold&quot; ) != 0 )
+-      snprintf( new_name, sizeof(new_name), &quot;%s-%s&quot;, font, size );
+-    else
+-      snprintf( new_name, sizeof(new_name), &quot;%s-%s:%s&quot;, font, size, style );
+- 
+     return new_name;
+   }
+ 
+@@ -1096,8 +1088,11 @@
+   XUNLOCK(xtfs-&gt;display);
+   free(encoded_text);
+ 
++  /* Note: the fact that we have to fudge ascent so much means we're doing
++   * something wrong somewhere.  I don't have time to figure it out right now,
++   * and this makes everything look about right onscreen, at least... --AS */
+   if (width) *width       = xft_extents.width;
+-  if (ascent) *ascent     = xtfs-&gt;font-&gt;ascent - 1;
++  if (ascent) *ascent     = xtfs-&gt;font-&gt;ascent - 4;
+   if (descent) *descent   = xtfs-&gt;font-&gt;descent;
+   if (lbearing) *lbearing = 0;
+   if (rbearing) *rbearing = 0;

Modified: trunk/rpms/xine/xine.spec
===================================================================
--- trunk/rpms/xine/xine.spec	2005-07-30 09:41:33 UTC (rev 3442)
+++ trunk/rpms/xine/xine.spec	2005-07-30 14:09:55 UTC (rev 3443)
@@ -10,8 +10,8 @@
 
 Summary: Free multimedia player
 Name: xine
-Version: 0.99.3
-Release: 5
+Version: 0.99.4
+Release: 1
 License: GPL
 Group: Applications/Multimedia
 URL: <A HREF="http://xinehq.de/">http://xinehq.de/</A>
@@ -19,8 +19,9 @@
 Source1: xine.png
 Source2: <A HREF="http://www.bluebeamentertainment.com/xine/smokeyglass_splash.png">http://www.bluebeamentertainment.com/xine/smokeyglass_splash.png</A>
 Source3: <A HREF="http://www.bluebeamentertainment.com/xine/smokeyglass_logo.m1v">http://www.bluebeamentertainment.com/xine/smokeyglass_logo.m1v</A>
-Patch0: xine-ui-0.99.3-gcc4.patch
-Patch1: xine-ui-0.99.3-menucrash.patch
+Patch0: xine-ui-0.99.3-sprintf.patch
+Patch1: xine-ui-0.99.3-xftfontsize.patch
+Patch2: xine-ui-0.99.3-uifixups.patch
 BuildRoot: %{_tmppath}/%{name}-%{version}-%{release}-root
 Requires: xine-lib &gt;= 1.0.0
 BuildRequires: gcc-c++, XFree86-devel, libpng-devel, xine-lib-devel &gt;= 1.0.0
@@ -46,8 +47,9 @@
 
 %prep
 %setup -n xine-ui-%{version}
-%patch0 -p1 -b .gcc4
-%patch1 -p1 -b .menucrash
+%patch0 -p1 -b .strintf
+%patch1 -p1 -b .xftfontsize
+%patch2 -p1 -b .uifixups
 # Fix for lirc needed to be searched for in lib64
 %{__perl} -pi.orig -e 's|(lirc_libprefix /lib) /usr/lib|$1 %{_libdir}|g' \
     configure
@@ -149,6 +151,13 @@
 
 
 %changelog
+* Sat Jul 30 2005 Matthias Saou &lt;<A HREF="http://freshrpms.net/">http://freshrpms.net/</A>&gt; 0.99.4-1
+- Update to 0.99.4, which includes gcc4 fixes.
+
+* Wed Jul 13 2005 Matthias Saou &lt;<A HREF="http://freshrpms.net/">http://freshrpms.net/</A>&gt; 0.99.3-6
+- More patches from Alex Stewart : sprintf, xftfontsize and uifixups. These
+  should fix many bugs, including broken dialog boxes and broken menus.
+
 * Tue Jul  5 2005 Matthias Saou &lt;<A HREF="http://freshrpms.net/">http://freshrpms.net/</A>&gt; 0.99.3-5
 - Add menucrash patch from Alex Stewart, at last! :-) (for x86_64)
 

Deleted: trunk/rpms/xine-lib/xine-lib-1.0.1-gcc4.patch
===================================================================
--- trunk/rpms/xine-lib/xine-lib-1.0.1-gcc4.patch	2005-07-30 09:41:33 UTC (rev 3442)
+++ trunk/rpms/xine-lib/xine-lib-1.0.1-gcc4.patch	2005-07-30 14:09:55 UTC (rev 3443)
@@ -1,223 +0,0 @@
-diff -urN xine-lib-1.0/src/libffmpeg/libavcodec/avcodec.h ./src/libffmpeg/libavcodec/avcodec.h
---- xine-lib-1.0/src/libffmpeg/libavcodec/avcodec.h	2004-05-30 21:24:19.000000000 +0200
-+++ xine-lib-1.0/src/libffmpeg/libavcodec/avcodec.h	2005-03-19 12:02:44.000000000 +0100
-@@ -1639,6 +1639,14 @@
- #define FF_OPT_MAX_DEPTH 10
- } AVOption;
- 
-+#ifdef HAVE_MMX
-+extern const struct AVOption avoptions_common[3 + 5];
-+#else
-+extern const struct AVOption avoptions_common[3];
-+#endif
-+extern const struct AVOption avoptions_workaround_bug[11];
-+
-+
- /**
-  * Parse option(s) and sets fields in passed structure
-  * @param strct	structure where the parsed results will be written
-diff -urN xine-lib-1.0/src/libffmpeg/libavcodec/common.h ./src/libffmpeg/libavcodec/common.h
---- xine-lib-1.0/src/libffmpeg/libavcodec/common.h	2004-05-30 21:24:19.000000000 +0200
-+++ xine-lib-1.0/src/libffmpeg/libavcodec/common.h	2005-03-19 12:02:32.000000000 +0100
-@@ -65,15 +65,6 @@
-     { name, help, offsetof(AVCodecContext, field), FF_OPT_TYPE_RCOVERRIDE, .defval = 0, .defstr = NULL }
- #define AVOPTION_SUB(ptr) { .name = NULL, .help = (const char*)ptr }
- #define AVOPTION_END() AVOPTION_SUB(NULL)
--
--struct AVOption;
--#ifdef HAVE_MMX
--extern const struct AVOption avoptions_common[3 + 5];
--#else
--extern const struct AVOption avoptions_common[3];
--#endif
--extern const struct AVOption avoptions_workaround_bug[11];
--
- #endif /* HAVE_AV_CONFIG_H */
- 
- /* Suppress restrict if it was not defined in config.h.  */
-diff -urN xine-lib-1.0/src/libxineadec/nosefart/nes_apu.c ./src/libxineadec/nosefart/nes_apu.c
---- xine-lib-1.0/src/libxineadec/nosefart/nes_apu.c	2004-12-12 07:55:59.000000000 +0100
-+++ xine-lib-1.0/src/libxineadec/nosefart/nes_apu.c	2005-03-19 12:39:50.000000000 +0100
-@@ -1011,10 +1011,13 @@
-          accum = -0x8000;
- 
-       /* signed 16-bit output, unsigned 8-bit */
--      if (16 == apu-&gt;sample_bits)
--         *((int16 *) buffer)++ = (int16) accum;
--      else
--         *((uint8 *) buffer)++ = (accum &gt;&gt; 8) ^ 0x80;
-+      if (16 == apu-&gt;sample_bits) {
-+         *((int16 *) buffer) = (int16) accum; 
-+         buffer = (int16 *) buffer + 1;
-+      } else {
-+         *((uint8 *) buffer) = (accum &gt;&gt; 8) ^ 0x80; 
-+         buffer = (int8 *) buffer + 1;
-+      }
-    }
- 
-    /* resync cycle counter */
-diff -urN xine-lib-1.0/src/post/audio/stretch.c ./src/post/audio/stretch.c
---- xine-lib-1.0/src/post/audio/stretch.c	2004-10-30 01:11:38.000000000 +0200
-+++ xine-lib-1.0/src/post/audio/stretch.c	2005-03-19 13:26:56.068300815 +0100
-@@ -476,7 +476,7 @@
-     memcpy( outbuf-&gt;mem, data_out, 
-             outbuf-&gt;num_frames * this-&gt;bytes_per_frame );
-     num_frames_out -= outbuf-&gt;num_frames;
--    (uint8_t *)data_out += outbuf-&gt;num_frames * this-&gt;bytes_per_frame;
-+    data_out = (uint8_t *)data_out + outbuf-&gt;num_frames * this-&gt;bytes_per_frame;
-                 
-     outbuf-&gt;vpts        = this-&gt;pts;
-     this-&gt;pts           = 0;
-@@ -587,7 +587,7 @@
-     memcpy( (uint8_t *)this-&gt;audiofrag + this-&gt;num_frames * this-&gt;bytes_per_frame,
-             data_in, frames_to_copy * this-&gt;bytes_per_frame );
-     
--    (uint8_t *)data_in += frames_to_copy * this-&gt;bytes_per_frame;
-+    data_in = (uint8_t *)data_in + frames_to_copy * this-&gt;bytes_per_frame;
-     this-&gt;num_frames += frames_to_copy;
-     buf-&gt;num_frames -= frames_to_copy;
- 
-diff -urN xine-lib-1.0/src/xine-engine/post.c ./src/xine-engine/post.c
---- xine-lib-1.0/src/xine-engine/post.c	2004-10-17 21:14:30.000000000 +0200
-+++ xine-lib-1.0/src/xine-engine/post.c	2005-03-19 12:33:22.000000000 +0100
-@@ -241,7 +241,7 @@
-     if (!*input) return port;
-     (*input)-&gt;xine_in.name = &quot;video in&quot;;
-     (*input)-&gt;xine_in.type = XINE_POST_DATA_VIDEO;
--    (xine_video_port_t *)(*input)-&gt;xine_in.data = &amp;port-&gt;new_port;
-+    (*input)-&gt;xine_in.data = &amp;port-&gt;new_port;
-     (*input)-&gt;post = post;
-     xine_list_append_content(post-&gt;input, *input);
-   }
-@@ -251,7 +251,7 @@
-     if (!*output) return port;
-     (*output)-&gt;xine_out.name = &quot;video out&quot;;
-     (*output)-&gt;xine_out.type = XINE_POST_DATA_VIDEO;
--    (xine_video_port_t **)(*output)-&gt;xine_out.data = &amp;port-&gt;original_port;
-+    (*output)-&gt;xine_out.data = &amp;port-&gt;original_port;
-     (*output)-&gt;xine_out.rewire = post_video_rewire;
-     (*output)-&gt;post = post;
-     (*output)-&gt;user_data = port;
-@@ -718,7 +718,7 @@
-     if (!*input) return port;
-     (*input)-&gt;xine_in.name = &quot;audio in&quot;;
-     (*input)-&gt;xine_in.type = XINE_POST_DATA_AUDIO;
--    (xine_audio_port_t *)(*input)-&gt;xine_in.data = &amp;port-&gt;new_port;
-+    (*input)-&gt;xine_in.data = &amp;port-&gt;new_port;
-     (*input)-&gt;post = post;
-     xine_list_append_content(post-&gt;input, *input);
-   }
-@@ -728,7 +728,7 @@
-     if (!*output) return port;
-     (*output)-&gt;xine_out.name = &quot;audio out&quot;;
-     (*output)-&gt;xine_out.type = XINE_POST_DATA_AUDIO;
--    (xine_audio_port_t **)(*output)-&gt;xine_out.data = &amp;port-&gt;original_port;
-+    (*output)-&gt;xine_out.data = &amp;port-&gt;original_port;
-     (*output)-&gt;xine_out.rewire = post_audio_rewire;
-     (*output)-&gt;post = post;
-     (*output)-&gt;user_data = port;
-diff -urN xine-lib-1.0/src/xine-utils/color.c ./src/xine-utils/color.c
---- xine-lib-1.0/src/xine-utils/color.c	2003-12-09 01:02:38.000000000 +0100
-+++ xine-lib-1.0/src/xine-utils/color.c	2005-03-19 12:29:52.000000000 +0100
-@@ -495,8 +495,8 @@
- 
-   /* process blocks of 4 pixels */
-   for (x=0; x &lt; (width / 4); x++) {
--    n1  = *(((unsigned int *) src1)++);
--    n2  = *(((unsigned int *) src2)++);
-+    n1  = *(((unsigned int *) src1)); src1 = ((unsigned int *) src1) + 1;
-+    n2  = *(((unsigned int *) src2)); src2 = ((unsigned int *) src2) + 1;
-     n3  = (n1 &amp; 0xFF00FF00) &gt;&gt; 8;
-     n4  = (n2 &amp; 0xFF00FF00) &gt;&gt; 8;
-     n1 &amp;= 0x00FF00FF;
-diff -urN xine-lib-1.0/src/xine-utils/memcpy.c ./src/xine-utils/memcpy.c
---- xine-lib-1.0/src/xine-utils/memcpy.c	2004-12-20 22:22:22.000000000 +0100
-+++ xine-lib-1.0/src/xine-utils/memcpy.c	2005-03-19 12:31:11.000000000 +0100
-@@ -218,8 +218,8 @@
-         &quot;movntps %%xmm2, 32(%1)\n&quot;
-         &quot;movntps %%xmm3, 48(%1)\n&quot;
-         :: &quot;r&quot; (from), &quot;r&quot; (to) : &quot;memory&quot;);
--        ((const unsigned char *)from)+=64;
--        ((unsigned char *)to)+=64;
-+        from = ((const unsigned char *)from) + 64;
-+        to = ((unsigned char *)to) + 64;
-       }
-     else
-       /*
-@@ -241,8 +241,8 @@
-         &quot;movntps %%xmm2, 32(%1)\n&quot;
-         &quot;movntps %%xmm3, 48(%1)\n&quot;
-         :: &quot;r&quot; (from), &quot;r&quot; (to) : &quot;memory&quot;);
--        ((const unsigned char *)from)+=64;
--        ((unsigned char *)to)+=64;
-+        from = ((const unsigned char *)from) + 64;
-+        to = ((unsigned char *)to) + 64;
-       }
-     /* since movntq is weakly-ordered, a &quot;sfence&quot;
-      * is needed to become ordered again. */
-@@ -296,8 +296,8 @@
-       &quot;movq %%mm6, 48(%1)\n&quot;
-       &quot;movq %%mm7, 56(%1)\n&quot;
-       :: &quot;r&quot; (from), &quot;r&quot; (to) : &quot;memory&quot;);
--      ((const unsigned char *)from)+=64;
--      ((unsigned char *)to)+=64;
-+      from = ((const unsigned char *)from) + 64;
-+      to = ((unsigned char *)to) + 64;
-     }
-     __asm__ __volatile__ (&quot;emms&quot;:::&quot;memory&quot;);
-   }
-@@ -363,8 +363,8 @@
-       &quot;movntq %%mm6, 48(%1)\n&quot;
-       &quot;movntq %%mm7, 56(%1)\n&quot;
-       :: &quot;r&quot; (from), &quot;r&quot; (to) : &quot;memory&quot;);
--      ((const unsigned char *)from)+=64;
--      ((unsigned char *)to)+=64;
-+      from = ((const unsigned char *)from) + 64;
-+      to = ((unsigned char *)to) + 64;
-     }
-      /* since movntq is weakly-ordered, a &quot;sfence&quot;
-      * is needed to become ordered again. */
---- xine-lib-1.0/src/video_out/vidix/drivers/pm3_vid.c.orig	2005-04-26 12:54:21.000000000 +0200
-+++ xine-lib-1.0/src/video_out/vidix/drivers/pm3_vid.c	2005-04-26 12:54:25.000000000 +0200
-@@ -51,7 +51,6 @@
- 
- static pciinfo_t pci_info;
- 
--static void *pm3_reg_base;
- static void *pm3_mem;
- 
- static int pm3_vidmem = PM3_VIDMEM;
---- xine-lib-1.0/src/libw32dll/wine/ext.c.orig	2005-04-30 18:12:35.000000000 +0200
-+++ xine-lib-1.0/src/libw32dll/wine/ext.c	2005-04-30 18:13:01.000000000 +0200
-@@ -469,7 +469,7 @@
- 
-     if (type&amp;MEM_RESERVE &amp;&amp; (unsigned)address&amp;0xffff) {
-        size += (unsigned)address&amp;0xffff;
--       (unsigned)address &amp;= ~0xffff;
-+       address = (unsigned)address &amp; ~0xffff;
-     }
-     pgsz = sysconf(_SC_PAGESIZE);
-     if (type&amp;MEM_COMMIT &amp;&amp; (unsigned)address%pgsz) {
---- xine-lib-1.0/src/libw32dll/wine/win32.c.orig	2005-04-30 18:13:41.000000000 +0200
-+++ xine-lib-1.0/src/libw32dll/wine/win32.c	2005-04-30 18:15:17.000000000 +0200
-@@ -2623,7 +2623,7 @@
-     dbgprintf(&quot;GetWindowThreadProcessId(0x%x, 0x%x) =&gt; %d\n&quot;,
- 	win, pid_data, tid);
-     if (pid_data)
--	(int)*pid_data = tid;
-+	*pid_data = tid;
-     return tid;
- }
- 
-diff -Naupr xine-lib-1.0.1.orig/src/libw32dll/wine/loader.h xine-lib-1.0.1/src/libw32dll/wine/loader.h
---- xine-lib-1.0.1.orig/src/libw32dll/wine/loader.h	2005-04-26 10:09:14.000000000 +0200
-+++ xine-lib-1.0.1/src/libw32dll/wine/loader.h	2005-05-03 03:08:57.000000000 +0200
-@@ -17,7 +17,7 @@
- extern &quot;C&quot; {
- #endif
- 
--extern char* win32_codec_name;  // must be set before calling DrvOpen() !!!
-+static char* win32_codec_name;  // must be set before calling DrvOpen() !!!
- 
- unsigned int _GetPrivateProfileIntA(const char* appname, const char* keyname, int default_value, const char* filename);
- int _GetPrivateProfileStringA(const char* appname, const char* keyname,

Modified: trunk/rpms/xine-lib/xine-lib.spec
===================================================================
--- trunk/rpms/xine-lib/xine-lib.spec	2005-07-30 09:41:33 UTC (rev 3442)
+++ trunk/rpms/xine-lib/xine-lib.spec	2005-07-30 14:09:55 UTC (rev 3443)
@@ -41,14 +41,13 @@
 
 Summary: Core library of the xine multimedia player
 Name: xine-lib
-Version: 1.0.1
-Release: 2
+Version: 1.1.0
+Release: 1
 License: GPL
 Group: Applications/Multimedia
 URL: <A HREF="http://xinehq.de/">http://xinehq.de/</A>
 Source: <A HREF="http://dl.sf.net/xine/xine-lib-%{version">http://dl.sf.net/xine/xine-lib-%{version</A>}.tar.gz
 Patch0: xine-lib-1.0-unbreak-64bit-faad.patch
-Patch1: xine-lib-1.0.1-gcc4.patch
 BuildRoot: %{_tmppath}/%{name}-%{version}-%{release}-root
 Requires: libdvdcss
 BuildRequires: gcc-c++, pkgconfig, XFree86-devel, zlib-devel
@@ -113,7 +112,6 @@
 %prep
 %setup
 %patch0 -p1 -b .faad
-%patch1 -p1 -b .gcc4
 
 
 %build
@@ -165,6 +163,9 @@
 
 
 %changelog
+* Sat Jul 30 2005 Matthias Saou &lt;<A HREF="http://freshrpms.net/">http://freshrpms.net/</A>&gt; 1.1.0-1
+- Update to 1.1.0, which includes gcc4 fixes.
+
 * Tue May  3 2005 Matthias Saou &lt;<A HREF="http://freshrpms.net/">http://freshrpms.net/</A>&gt; 1.0.1-2
 - Remove ffmpeg MMX disabling, it works, go figure.
 - No longer run autogen.sh or libtool. Same, it works... confusing.


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002244.html">[svn] r3442 - trunk/rpms/mathomatic
</A></li>
	<LI>Next message: <A HREF="002246.html">[svn] r3444 - in trunk/tools/pydar2: pydar scripts
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2245">[ date ]</a>
              <a href="thread.html#2245">[ thread ]</a>
              <a href="subject.html#2245">[ subject ]</a>
              <a href="author.html#2245">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.repoforge.org/mailman/listinfo/commits">More information about the commits
mailing list</a><br>
</body></html>
