<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [svn] r5176 - in trunk/rpms: . unixbench
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:commits%40lists.repoforge.org?Subject=Re:%20Re%3A%20%5Bsvn%5D%20r5176%20-%20in%20trunk/rpms%3A%20.%20unixbench&In-Reply-To=%3C20070216113624.ED3FA944AA1%40pooch.vmhosting.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003974.html">
   <LINK REL="Next"  HREF="003976.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[svn] r5176 - in trunk/rpms: . unixbench</H1>
    <B>packagers at lists.rpmforge.net</B> 
    <A HREF="mailto:commits%40lists.repoforge.org?Subject=Re:%20Re%3A%20%5Bsvn%5D%20r5176%20-%20in%20trunk/rpms%3A%20.%20unixbench&In-Reply-To=%3C20070216113624.ED3FA944AA1%40pooch.vmhosting.org%3E"
       TITLE="[svn] r5176 - in trunk/rpms: . unixbench">packagers at lists.rpmforge.net
       </A><BR>
    <I>Fri Feb 16 12:36:24 CET 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="003974.html">[svn] r5175 - trunk/rpms/dkms-kqemu
</A></li>
        <LI>Next message: <A HREF="003976.html">[svn] r5177 - in trunk/rpms: . dejavu-fonts gktools spamassassin	wifiscanner
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3975">[ date ]</a>
              <a href="thread.html#3975">[ thread ]</a>
              <a href="subject.html#3975">[ subject ]</a>
              <a href="author.html#3975">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: dag
Date: 2007-02-16 12:36:22 +0100 (Fri, 16 Feb 2007)
New Revision: 5176

Added:
   trunk/rpms/unixbench/
   trunk/rpms/unixbench/unixbench-4.0.1-altpackage.patch
   trunk/rpms/unixbench/unixbench-4.0.1-buildflags.patch
   trunk/rpms/unixbench/unixbench.spec
Log:
Updates

Added: trunk/rpms/unixbench/unixbench-4.0.1-altpackage.patch
===================================================================
--- trunk/rpms/unixbench/unixbench-4.0.1-altpackage.patch	                        (rev 0)
+++ trunk/rpms/unixbench/unixbench-4.0.1-altpackage.patch	2007-02-16 11:36:22 UTC (rev 5176)
@@ -0,0 +1,95 @@
+--- unixbench-4.0.1.orig/Run	1997-06-21 00:55:32 +0400
++++ unixbench-4.0.1/Run	2003-10-29 16:12:32 +0300
+@@ -1,5 +1,11 @@
+ #! /bin/sh
+ 
++HOMEDIR=$HOME
++BINDIR=/usr/lib/unixbench/pgms
++SCRPDIR=/usr/lib/unixbench/pgms
++TESTDIR=/usr/lib/unixbench/testdir
++TMPDIR=$TMPDIR
++
+ #################### set your defaults here ##############
+ #FLAVOR= # flavor of UNIX: if not determined by script: SysV or BSD
+ FULL_SUITE=&quot;dhry2reg double syscall pipe context1 spawn execl \
+@@ -57,18 +63,7 @@
+ #end Jon mods
+ umask 022    # at least mortals can read root's files this way
+ #
+-if [ -z &quot;${FLAVOR-}&quot; ]; then
+-	# determine flavor of UNIX from number of lines generated by &quot;time&quot;
+-	Fcount=`/usr/bin/time date 2&gt;&amp;1 | wc -l | sed 's/ //g'`
+-	case &quot;$Fcount&quot; in
+-	2) FLAVOR=BSD ;;
+-	3) FLAVOR=Linux ;;
+-	5) FLAVOR=SysV ;;
+-	*) echo &quot;Flavor of UNIX is not known.&quot;
+-	   echo &quot;Please define FLAVOR in Run script&quot;
+-	   exit;;
+-	esac
+-fi
++FLAVOR=Linux
+ export FLAVOR
+ TIME=&quot;        %e real        %U user        %S sys&quot;
+ export TIME
+@@ -80,14 +75,6 @@
+ 	UNAME=&quot;uname -a&quot;
+ fi
+ 
+-# check that the required files are in the proper places
+-if make check; then
+-        :
+-else
+-	make all
+-fi
+-
+-
+ # establish full paths to directories
+ _WD=`pwd`
+ HOMEDIR=${HOMEDIR-.}
+@@ -107,12 +94,8 @@
+ SCRPDIR=`pwd`
+ cd $_WD
+ 
+-TMPDIR=${HOMEDIR}/tmp
+-cd $TMPDIR
+-TMPDIR=`pwd`
+-cd $_WD
+-
+-RESULTDIR=${RESULTDIR-${HOMEDIR}/results}
++RESULTDIR=${RESULTDIR-${HOMEDIR}/.unixbench/results}
++[ -d &quot;$RESULTDIR&quot; ] || mkdir -p &quot;$RESULTDIR&quot;
+ cd $RESULTDIR
+ RESULTDIR=`pwd`
+ cd $_WD
+@@ -124,7 +107,7 @@
+ TESTDIR=`pwd`
+ cd $_WD
+ 
+-export BINDIR TMPDIR RESULTDIR PATH TESTDIR TIMEACCUM
++export BINDIR RESULTDIR PATH TESTDIR TIMEACCUM
+ #
+ cat ${BINDIR}/unixbench.logo # display banner
+ rm -f ${TIMEACCUM}      # clean out old time accumulation file
+@@ -356,11 +339,10 @@
+ 	C)  
+ 		logmsg=&quot;C Compiler Throughput&quot;
+ 		repeat=$shortloop
+-		prog=&quot;looper ${looper-60} ${CC} cctest.c&quot;
++		prog=&quot;looper ${looper-60} ${CC} -o $TMPDIR/a.out cctest.c&quot;
+ 		stdout=/dev/null
+ 		repeat=&quot;$shortloop&quot;
+ 		cleanopt=&quot;-m $TMPTIMES&quot;
+-		rm -f ${TESTDIR}/cctest.o ${TESTDIR}/a.out
+ 		;;
+ 
+ 	arithoh)
+@@ -492,7 +474,7 @@
+     ########### some specific cleanup routines ##############
+     case $bench in
+       C)
+-      rm -f ${TESTDIR}/cctest.o ${TESTDIR}/a.out
++      rm -f ${TMPDIR}/a.out
+       ;;
+ 
+       fstime | fsbuffer | fsdisk)

Added: trunk/rpms/unixbench/unixbench-4.0.1-buildflags.patch
===================================================================
--- trunk/rpms/unixbench/unixbench-4.0.1-buildflags.patch	                        (rev 0)
+++ trunk/rpms/unixbench/unixbench-4.0.1-buildflags.patch	2007-02-16 11:36:22 UTC (rev 5176)
@@ -0,0 +1,11 @@
+--- unixbench-4.0.1.orig/Makefile	1997-06-21 02:11:16 +0400
++++ unixbench-4.0.1/Makefile	2003-10-29 15:38:23 +0300
+@@ -35,7 +35,7 @@
+ #OPTON = -O2 -fomit-frame-pointer -fforce-addr -fforce-mem -ffast-math \
+ #	-m486 -malign-loops=2 -malign-jumps=2 -malign-functions=2
+ ## For Linux, GCC previous to 2.7.0
+-OPTON = -O2 -fomit-frame-pointer -fforce-addr -fforce-mem -ffast-math -m486
++OPTON = -O2 -fomit-frame-pointer -fforce-addr -fforce-mem -ffast-math $(RPM_OPT_FLAGS)
+ 
+ #OPTON = -O2 -fomit-frame-pointer -fforce-addr -fforce-mem -ffast-math \
+ #	-m386 -malign-loops=1 -malign-jumps=1 -malign-functions=1

Added: trunk/rpms/unixbench/unixbench.spec
===================================================================
--- trunk/rpms/unixbench/unixbench.spec	                        (rev 0)
+++ trunk/rpms/unixbench/unixbench.spec	2007-02-16 11:36:22 UTC (rev 5176)
@@ -0,0 +1,53 @@
+# $Id$
+# Authority: dag
+
+Summary: BYTE's UNIX Benchmarks
+Name: unixbench
+Version: 4.0.1
+Release: 1
+License: Distributable
+Group: Applications/System
+URL: <A HREF="http://www.tux.org/pub/tux/niemi/unixbench/">http://www.tux.org/pub/tux/niemi/unixbench/</A>
+
+Source: <A HREF="http://www.tux.org/pub/tux/niemi/unixbench/unixbench-%{version">http://www.tux.org/pub/tux/niemi/unixbench/unixbench-%{version</A>}.tgz
+Patch0: unixbench-4.0.1-altpackage.patch
+Patch1: unixbench-4.0.1-buildflags.patch
+Buildroot: %{_tmppath}/%{name}-%{version}-%{release}-root
+
+Requires: gcc
+
+%description
+The BYTE Unix benchmarks that we published in March, 1990, we
+expected that they fill our needs for several years. It was only a
+few months before we started to see that UNIX workstation performance
+was going to make the benchmark design questionable.
+
+The design flaw was that the benchmarks timed a fixed number of loops;
+if there were too few loops, the times were too small to be reliable.
+Perhaps we could have increased the number of loops and been safe for
+another few years (months?). But with IBM's introduction of the RS/6000,
+it became obvious that we needed to redesign our benchmarks.
+
+%prep
+%setup
+%patch0 -p1
+%patch1 -p1
+
+%build
+%{__make} %{?_smp_mflags}
+
+%install
+%{__rm} -rf %{buildroot}
+%{__install} -Dp -m0755 Run %{buildroot}%{_bindir}/unixbench
+
+%{__install} -d -m0755 %{buildroot}%{_libdir}/unixbench/
+%{__cp} -av pgms/ testdir/ %{buildroot}%{_libdir}/unixbench/
+
+%files
+%doc README old-doc/bench.doc old-doc/bench3.doc
+%{_bindir}/unixbench
+%{_libdir}/unixbench/
+
+%changelog
+* Fri Feb 16 2007 Dag Wieers &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>&gt; - 4.0.1-1
+- Initial package. (using DAR)


Property changes on: trunk/rpms/unixbench/unixbench.spec
___________________________________________________________________
Name: svn:keywords
   + Id Revision
Name: svn:eol-style
   + native


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003974.html">[svn] r5175 - trunk/rpms/dkms-kqemu
</A></li>
	<LI>Next message: <A HREF="003976.html">[svn] r5177 - in trunk/rpms: . dejavu-fonts gktools spamassassin	wifiscanner
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3975">[ date ]</a>
              <a href="thread.html#3975">[ thread ]</a>
              <a href="subject.html#3975">[ subject ]</a>
              <a href="author.html#3975">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.repoforge.org/mailman/listinfo/commits">More information about the commits
mailing list</a><br>
</body></html>
