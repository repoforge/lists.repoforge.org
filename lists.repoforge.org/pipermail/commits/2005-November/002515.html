<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [svn] r3715 - trunk/rpms/armagetronad
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:commits%40lists.repoforge.org?Subject=Re:%20Re%3A%20%5Bsvn%5D%20r3715%20-%20trunk/rpms/armagetronad&In-Reply-To=%3C20051114152125.DE0453180E7%40pooch.vmhosting.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002514.html">
   <LINK REL="Next"  HREF="002516.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[svn] r3715 - trunk/rpms/armagetronad</H1>
    <B>packagers at lists.rpmforge.net</B> 
    <A HREF="mailto:commits%40lists.repoforge.org?Subject=Re:%20Re%3A%20%5Bsvn%5D%20r3715%20-%20trunk/rpms/armagetronad&In-Reply-To=%3C20051114152125.DE0453180E7%40pooch.vmhosting.org%3E"
       TITLE="[svn] r3715 - trunk/rpms/armagetronad">packagers at lists.rpmforge.net
       </A><BR>
    <I>Mon Nov 14 16:21:25 CET 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="002514.html">[svn] r3714 - trunk/rpms/squale
</A></li>
        <LI>Next message: <A HREF="002516.html">[svn] r3716 - trunk/rpms/httping
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2515">[ date ]</a>
              <a href="thread.html#2515">[ thread ]</a>
              <a href="subject.html#2515">[ subject ]</a>
              <a href="author.html#2515">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: thias
Date: 2005-11-14 16:21:25 +0100 (Mon, 14 Nov 2005)
New Revision: 3715

Added:
   trunk/rpms/armagetronad/armagetronad-0.2.8_beta3-desktop.patch
   trunk/rpms/armagetronad/armagetronad-0.2.8_beta3-gcc4.patch
Removed:
   trunk/rpms/armagetronad/armagetronad-0.2.7.1-gcc4.patch
Modified:
   trunk/rpms/armagetronad/armagetronad.spec
Log:
Update armagetronad to 0.2.8_beta3.


Deleted: trunk/rpms/armagetronad/armagetronad-0.2.7.1-gcc4.patch
===================================================================
--- trunk/rpms/armagetronad/armagetronad-0.2.7.1-gcc4.patch	2005-11-14 14:35:24 UTC (rev 3714)
+++ trunk/rpms/armagetronad/armagetronad-0.2.7.1-gcc4.patch	2005-11-14 15:21:25 UTC (rev 3715)
@@ -1,264 +0,0 @@
-diff -Naupr armagetronad-0.2.7.1.orig/src/engine/eCamera.cpp armagetronad-0.2.7.1/src/engine/eCamera.cpp
---- armagetronad-0.2.7.1.orig/src/engine/eCamera.cpp	2005-02-28 19:22:53.000000000 +0100
-+++ armagetronad-0.2.7.1/src/engine/eCamera.cpp	2005-04-22 10:50:54.000000000 +0200
-@@ -25,6 +25,8 @@ Foundation, Inc., 59 Temple Place - Suit
- 
- */
- 
-+#include &quot;rSDL.h&quot;
-+
- #include &quot;eSensor.h&quot;
- #include &quot;eCamera.h&quot;
- #include &quot;rScreen.h&quot;
-diff -Naupr armagetronad-0.2.7.1.orig/src/engine/eDisplay.cpp armagetronad-0.2.7.1/src/engine/eDisplay.cpp
---- armagetronad-0.2.7.1.orig/src/engine/eDisplay.cpp	2005-02-22 23:29:00.000000000 +0100
-+++ armagetronad-0.2.7.1/src/engine/eDisplay.cpp	2005-04-22 10:51:40.000000000 +0200
-@@ -25,6 +25,8 @@ Foundation, Inc., 59 Temple Place - Suit
- 
- */
- 
-+#include &quot;rSDL.h&quot;
-+
- //void se_FetchAndStoreSDLInput();
- 
- #include &quot;tConfiguration.h&quot;
-diff -Naupr armagetronad-0.2.7.1.orig/src/engine/eNetGameObject.cpp armagetronad-0.2.7.1/src/engine/eNetGameObject.cpp
---- armagetronad-0.2.7.1.orig/src/engine/eNetGameObject.cpp	2004-11-29 11:26:42.000000000 +0100
-+++ armagetronad-0.2.7.1/src/engine/eNetGameObject.cpp	2005-04-22 10:52:10.000000000 +0200
-@@ -25,6 +25,8 @@ Foundation, Inc., 59 Temple Place - Suit
- 
- */
- 
-+#include &quot;rSDL.h&quot;
-+
- #include &quot;eNetGameObject.h&quot;
- #include &quot;ePlayer.h&quot;
- #include &quot;eTimer.h&quot;
-diff -Naupr armagetronad-0.2.7.1.orig/src/engine/eSound.cpp armagetronad-0.2.7.1/src/engine/eSound.cpp
---- armagetronad-0.2.7.1.orig/src/engine/eSound.cpp	2005-02-26 19:26:52.000000000 +0100
-+++ armagetronad-0.2.7.1/src/engine/eSound.cpp	2005-04-22 10:52:50.000000000 +0200
-@@ -25,6 +25,8 @@ Foundation, Inc., 59 Temple Place - Suit
- 
- */
- 
-+#include &quot;rSDL.h&quot;
-+
- #include &quot;config.h&quot;
- #include &quot;tMemManager.h&quot;
- #include &quot;tDirectories.h&quot;
-diff -Naupr armagetronad-0.2.7.1.orig/src/engine/eVoter.cpp armagetronad-0.2.7.1/src/engine/eVoter.cpp
---- armagetronad-0.2.7.1.orig/src/engine/eVoter.cpp	2005-03-02 23:25:18.000000000 +0100
-+++ armagetronad-0.2.7.1/src/engine/eVoter.cpp	2005-04-22 10:53:24.000000000 +0200
-@@ -25,6 +25,8 @@ Foundation, Inc., 59 Temple Place - Suit
- 
- */
- 
-+#include &quot;rSDL.h&quot;
-+
- #include &quot;eVoter.h&quot;
- 
- #include &quot;tMemManager.h&quot;
-diff -Naupr armagetronad-0.2.7.1.orig/src/render/rScreen.cpp armagetronad-0.2.7.1/src/render/rScreen.cpp
---- armagetronad-0.2.7.1.orig/src/render/rScreen.cpp	2005-02-28 00:10:51.000000000 +0100
-+++ armagetronad-0.2.7.1/src/render/rScreen.cpp	2005-04-22 10:56:56.000000000 +0200
-@@ -25,6 +25,8 @@ Foundation, Inc., 59 Temple Place - Suit
- 
- */
- 
-+#include &quot;rSDL.h&quot;
-+
- #include &quot;defs.h&quot;
- 
- 
-diff -Naupr armagetronad-0.2.7.1.orig/src/render/rTexture.cpp armagetronad-0.2.7.1/src/render/rTexture.cpp
---- armagetronad-0.2.7.1.orig/src/render/rTexture.cpp	2004-11-29 11:26:42.000000000 +0100
-+++ armagetronad-0.2.7.1/src/render/rTexture.cpp	2005-04-22 10:56:24.000000000 +0200
-@@ -25,6 +25,8 @@ Foundation, Inc., 59 Temple Place - Suit
- 
- */
- 
-+#include &quot;rSDL.h&quot;
-+
- #include &quot;config.h&quot;
- 
- #include &quot;rTexture.h&quot;
-diff -Naupr armagetronad-0.2.7.1.orig/src/tron/gAIBase.cpp armagetronad-0.2.7.1/src/tron/gAIBase.cpp
---- armagetronad-0.2.7.1.orig/src/tron/gAIBase.cpp	2005-01-26 16:06:33.000000000 +0100
-+++ armagetronad-0.2.7.1/src/tron/gAIBase.cpp	2005-04-22 10:45:28.000000000 +0200
-@@ -25,6 +25,8 @@ Foundation, Inc., 59 Temple Place - Suit
- 
- */
- 
-+#include &quot;rSDL.h&quot;
-+
- #include &quot;gAIBase.h&quot;
- #include &quot;gArena.h&quot;
- #include &quot;eGrid.h&quot;
-diff -Naupr armagetronad-0.2.7.1.orig/src/tron/gArmagetron.cpp armagetronad-0.2.7.1/src/tron/gArmagetron.cpp
---- armagetronad-0.2.7.1.orig/src/tron/gArmagetron.cpp	2005-03-02 23:25:18.000000000 +0100
-+++ armagetronad-0.2.7.1/src/tron/gArmagetron.cpp	2005-04-22 10:46:00.000000000 +0200
-@@ -25,6 +25,8 @@ Foundation, Inc., 59 Temple Place - Suit
- 
- */
- 
-+#include &quot;rSDL.h&quot;
-+
- #include &quot;gStuff.h&quot;
- #include &quot;tSysTime.h&quot;
- #include &quot;tDirectories.h&quot;
-diff -Naupr armagetronad-0.2.7.1.orig/src/tron/gCamera.cpp armagetronad-0.2.7.1/src/tron/gCamera.cpp
---- armagetronad-0.2.7.1.orig/src/tron/gCamera.cpp	2004-12-07 18:39:00.000000000 +0100
-+++ armagetronad-0.2.7.1/src/tron/gCamera.cpp	2005-04-22 10:47:44.000000000 +0200
-@@ -25,6 +25,8 @@ Foundation, Inc., 59 Temple Place - Suit
- 
- */
- 
-+#include &quot;rSDL.h&quot;
-+
- #include &quot;tMemManager.h&quot;
- #include &quot;gCycle.h&quot;
- #include &quot;gCamera.h&quot;
-diff -Naupr armagetronad-0.2.7.1.orig/src/tron/gCycle.cpp armagetronad-0.2.7.1/src/tron/gCycle.cpp
---- armagetronad-0.2.7.1.orig/src/tron/gCycle.cpp	2005-03-06 09:51:22.000000000 +0100
-+++ armagetronad-0.2.7.1/src/tron/gCycle.cpp	2005-04-22 10:46:26.000000000 +0200
-@@ -25,6 +25,8 @@ Foundation, Inc., 59 Temple Place - Suit
- 
- */
- 
-+#include &quot;rSDL.h&quot;
-+
- #include &quot;gCycle.h&quot;
- #include &quot;nConfig.h&quot;
- #include &quot;rModel.h&quot;
-diff -Naupr armagetronad-0.2.7.1.orig/src/tron/gFloor.cpp armagetronad-0.2.7.1/src/tron/gFloor.cpp
---- armagetronad-0.2.7.1.orig/src/tron/gFloor.cpp	2005-02-20 11:48:15.000000000 +0100
-+++ armagetronad-0.2.7.1/src/tron/gFloor.cpp	2005-04-22 10:41:40.000000000 +0200
-@@ -25,6 +25,8 @@ Foundation, Inc., 59 Temple Place - Suit
- 
- */
- 
-+#include &quot;rSDL.h&quot;
-+
- #include &quot;defs.h&quot;
- #include &quot;gStuff.h&quot;
- #include &quot;gLogo.h&quot;
-diff -Naupr armagetronad-0.2.7.1.orig/src/tron/gLanguageMenu.cpp armagetronad-0.2.7.1/src/tron/gLanguageMenu.cpp
---- armagetronad-0.2.7.1.orig/src/tron/gLanguageMenu.cpp	2004-11-29 11:26:43.000000000 +0100
-+++ armagetronad-0.2.7.1/src/tron/gLanguageMenu.cpp	2005-04-22 10:48:44.000000000 +0200
-@@ -25,6 +25,8 @@ Foundation, Inc., 59 Temple Place - Suit
- 
- */
- 
-+#include &quot;rSDL.h&quot;
-+
- #include &quot;gLanguageMenu.h&quot;
- #include &quot;uMenu.h&quot;
- #include &quot;tLocale.h&quot;
-diff -Naupr armagetronad-0.2.7.1.orig/src/tron/gLogo.cpp armagetronad-0.2.7.1/src/tron/gLogo.cpp
---- armagetronad-0.2.7.1.orig/src/tron/gLogo.cpp	2004-11-29 11:26:43.000000000 +0100
-+++ armagetronad-0.2.7.1/src/tron/gLogo.cpp	2005-04-22 10:49:10.000000000 +0200
-@@ -25,6 +25,8 @@ Foundation, Inc., 59 Temple Place - Suit
- 
- */
- 
-+#include &quot;rSDL.h&quot;
-+
- #include &quot;gLogo.h&quot;
- 
- #include &quot;gStuff.h&quot;
-diff -Naupr armagetronad-0.2.7.1.orig/src/tron/gMenus.cpp armagetronad-0.2.7.1/src/tron/gMenus.cpp
---- armagetronad-0.2.7.1.orig/src/tron/gMenus.cpp	2005-02-26 22:25:36.000000000 +0100
-+++ armagetronad-0.2.7.1/src/tron/gMenus.cpp	2005-04-22 10:48:14.000000000 +0200
-@@ -25,6 +25,8 @@ Foundation, Inc., 59 Temple Place - Suit
- 
- */
- 
-+#include &quot;rSDL.h&quot;
-+
- #include &quot;gMenus.h&quot;
- #include &quot;ePlayer.h&quot;
- #include &quot;rScreen.h&quot;
-diff -Naupr armagetronad-0.2.7.1.orig/src/tron/gServerBrowser.cpp armagetronad-0.2.7.1/src/tron/gServerBrowser.cpp
---- armagetronad-0.2.7.1.orig/src/tron/gServerBrowser.cpp	2005-01-25 18:21:53.000000000 +0100
-+++ armagetronad-0.2.7.1/src/tron/gServerBrowser.cpp	2005-04-22 10:39:33.000000000 +0200
-@@ -25,6 +25,8 @@ Foundation, Inc., 59 Temple Place - Suit
- 
- */
- 
-+#include &quot;rSDL.h&quot;
-+
- #include &quot;gServerBrowser.h&quot;
- #include &quot;gGame.h&quot;
- #include &quot;gLogo.h&quot;
-diff -Naupr armagetronad-0.2.7.1.orig/src/tron/gStuff.cpp armagetronad-0.2.7.1/src/tron/gStuff.cpp
---- armagetronad-0.2.7.1.orig/src/tron/gStuff.cpp	2004-11-29 11:26:43.000000000 +0100
-+++ armagetronad-0.2.7.1/src/tron/gStuff.cpp	2005-04-22 10:47:15.000000000 +0200
-@@ -25,6 +25,8 @@ Foundation, Inc., 59 Temple Place - Suit
- 
- */
- 
-+#include &quot;rSDL.h&quot;
-+
- #include &quot;gStuff.h&quot;
- #include &quot;eCoord.h&quot;
- #include &quot;tConfiguration.h&quot;
-diff -Naupr armagetronad-0.2.7.1.orig/src/tron/gTeam.cpp armagetronad-0.2.7.1/src/tron/gTeam.cpp
---- armagetronad-0.2.7.1.orig/src/tron/gTeam.cpp	2004-11-29 11:26:43.000000000 +0100
-+++ armagetronad-0.2.7.1/src/tron/gTeam.cpp	2005-04-22 10:49:41.000000000 +0200
-@@ -25,6 +25,8 @@ Foundation, Inc., 59 Temple Place - Suit
- 
- */
- 
-+#include &quot;rSDL.h&quot;
-+
- #include &quot;gTeam.h&quot;
- #include &quot;uMenu.h&quot;
- #include &quot;ePlayer.h&quot;
-diff -Naupr armagetronad-0.2.7.1.orig/src/tron/gWall.cpp armagetronad-0.2.7.1/src/tron/gWall.cpp
---- armagetronad-0.2.7.1.orig/src/tron/gWall.cpp	2005-03-04 21:20:45.000000000 +0100
-+++ armagetronad-0.2.7.1/src/tron/gWall.cpp	2005-04-22 10:42:47.000000000 +0200
-@@ -25,6 +25,8 @@ Foundation, Inc., 59 Temple Place - Suit
- 
- */
- 
-+#include &quot;rSDL.h&quot;
-+
- #include &quot;gStuff.h&quot;
- #include &quot;eGrid.h&quot;
- #include &quot;eWall.h&quot;
-diff -Naupr armagetronad-0.2.7.1.orig/src/tron/gWinZone.cpp armagetronad-0.2.7.1/src/tron/gWinZone.cpp
---- armagetronad-0.2.7.1.orig/src/tron/gWinZone.cpp	2004-11-29 11:26:43.000000000 +0100
-+++ armagetronad-0.2.7.1/src/tron/gWinZone.cpp	2005-04-22 10:50:09.000000000 +0200
-@@ -25,6 +25,8 @@ Foundation, Inc., 59 Temple Place - Suit
- 
- */
- 
-+#include &quot;rSDL.h&quot;
-+
- #include &quot;gWinZone.h&quot;
- #include &quot;eTimer.h&quot;
- #include &quot;gCycle.h&quot;
-diff -Naupr armagetronad-0.2.7.1.orig/src/ui/uInput.cpp armagetronad-0.2.7.1/src/ui/uInput.cpp
---- armagetronad-0.2.7.1.orig/src/ui/uInput.cpp	2004-11-29 11:26:44.000000000 +0100
-+++ armagetronad-0.2.7.1/src/ui/uInput.cpp	2005-04-22 10:55:48.000000000 +0200
-@@ -25,6 +25,8 @@ Foundation, Inc., 59 Temple Place - Suit
- 
- */
- 
-+#include &quot;rSDL.h&quot;
-+
- #include &quot;tMemManager.h&quot;
- #include &quot;rScreen.h&quot;
- #include &quot;tInitExit.h&quot;
-diff -Naupr armagetronad-0.2.7.1.orig/src/ui/uMenu.cpp armagetronad-0.2.7.1/src/ui/uMenu.cpp
---- armagetronad-0.2.7.1.orig/src/ui/uMenu.cpp	2005-03-06 18:17:52.000000000 +0100
-+++ armagetronad-0.2.7.1/src/ui/uMenu.cpp	2005-04-22 10:55:16.000000000 +0200
-@@ -26,6 +26,8 @@ Foundation, Inc., 59 Temple Place - Suit
- 
- */
- 
-+#include &quot;rSDL.h&quot;
-+
- #include &quot;tSysTime.h&quot;
- #include &quot;uMenu.h&quot;
- #include &quot;rSysdep.h&quot;

Added: trunk/rpms/armagetronad/armagetronad-0.2.8_beta3-desktop.patch
===================================================================
--- trunk/rpms/armagetronad/armagetronad-0.2.8_beta3-desktop.patch	2005-11-14 14:35:24 UTC (rev 3714)
+++ trunk/rpms/armagetronad/armagetronad-0.2.8_beta3-desktop.patch	2005-11-14 15:21:25 UTC (rev 3715)
@@ -0,0 +1,21 @@
+diff -Naupr armagetronad-0.2.8_beta3.orig/desktop/armagetronad.desktop.in armagetronad-0.2.8_beta3/desktop/armagetronad.desktop.in
+--- armagetronad-0.2.8_beta3.orig/desktop/armagetronad.desktop.in	2005-10-22 02:31:26.000000000 +0200
++++ armagetronad-0.2.8_beta3/desktop/armagetronad.desktop.in	2005-11-14 14:29:12.000000000 +0100
+@@ -1,14 +1,11 @@
+ [Desktop Entry]
+-Type=Application
+-Version=@version@
+ Encoding=UTF-8
+ Name=@progtitle@@progtitle_server@
+ Exec=@progname@
+-Comment=3d light cycle game
++Comment=Multiplayer 3D light cycle game
+ Icon=@<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">progname at .png</A>
+ Terminal=@build_dedicated@
+ Path=@prefix@/bin
+ Type=Application
+-Categories=Application;Game;ActionGame;GameAction;ActionGames;GamesAction
+-StartupNotify=@build_dedicated@
+-MimeType=application/x-armagetronad;
++Categories=Application;Game;
++StartupNotify=false

Added: trunk/rpms/armagetronad/armagetronad-0.2.8_beta3-gcc4.patch
===================================================================
--- trunk/rpms/armagetronad/armagetronad-0.2.8_beta3-gcc4.patch	2005-11-14 14:35:24 UTC (rev 3714)
+++ trunk/rpms/armagetronad/armagetronad-0.2.8_beta3-gcc4.patch	2005-11-14 15:21:25 UTC (rev 3715)
@@ -0,0 +1,11 @@
+diff -Naupr armagetronad-0.2.8_beta3.orig/src/tron/gParser.cpp armagetronad-0.2.8_beta3/src/tron/gParser.cpp
+--- armagetronad-0.2.8_beta3.orig/src/tron/gParser.cpp	2005-10-22 02:31:29.000000000 +0200
++++ armagetronad-0.2.8_beta3/src/tron/gParser.cpp	2005-11-14 13:42:41.000000000 +0100
+@@ -6,6 +6,7 @@
+ #include &lt;string.h&gt;
+ #include &lt;sys/types.h&gt;
+ 
++#include &quot;rSDL.h&quot;
+ #include &quot;eCoord.h&quot;
+ #include &quot;eGrid.h&quot;
+ #include &quot;gWall.h&quot;

Modified: trunk/rpms/armagetronad/armagetronad.spec
===================================================================
--- trunk/rpms/armagetronad/armagetronad.spec	2005-11-14 14:35:24 UTC (rev 3714)
+++ trunk/rpms/armagetronad/armagetronad.spec	2005-11-14 15:21:25 UTC (rev 3715)
@@ -13,24 +13,24 @@
 %{?yd3:%define _without_xorg 1}
 
 %define desktop_vendor rpmforge
-%define prefix %{_prefix}/games/armagetronad
+%define prever beta3
 
 Summary: Multiplayer 'Tron' 3D racing game
 Name: armagetronad
-Version: 0.2.7.1
-Release: 2
+Version: 0.2.8
+Release: 0.1%{?prever:.%{prever}}
 License: GPL
 Group: Amusements/Games
 URL: <A HREF="http://armagetronad.sourceforge.net/">http://armagetronad.sourceforge.net/</A>
-Source: <A HREF="http://dl.sf.net/armagetronad/armagetronad-%{version">http://dl.sf.net/armagetronad/armagetronad-%{version</A>}.tar.bz2
-Patch: armagetronad-0.2.7.1-gcc4.patch
+Source: <A HREF="http://dl.sf.net/armagetronad/armagetronad-%{version">http://dl.sf.net/armagetronad/armagetronad-%{version</A>}%{?prever:_%{prever}}.src.tar.bz2
+Patch0: armagetronad-0.2.8_beta3-gcc4.patch
+Patch1: armagetronad-0.2.8_beta3-desktop.patch
 BuildRoot: %{_tmppath}/%{name}-%{version}-%{release}-root
-Requires: SDL_image &gt;= 1.2.0, esound
-BuildRequires: gcc-c++, libstdc++-devel, zlib-devel, libpng-devel, libjpeg-devel
-BuildRequires: XFree86-devel, SDL_image-devel, SDL-devel, esound-devel
-BuildRequires: /usr/bin/find, unzip, ImageMagick
-%{?_without_xorg:BuildRequires: XFree86-Mesa-libGLU}
-%{!?_without_xorg:BuildRequires: xorg-x11-Mesa-libGLU}
+BuildRequires: libstdc++-devel, zlib-devel, libpng-devel, libjpeg-devel
+BuildRequires: SDL_image-devel, SDL-devel, esound-devel, libxml2-devel
+BuildRequires: /usr/bin/find, unzip
+%{?_without_xorg:BuildRequires: XFree86-devel, XFree86-Mesa-libGLU}
+%{!?_without_xorg:BuildRequires: xorg-x11-devel, xorg-x11-Mesa-libGLU}
 %{!?_without_freedesktop:BuildRequires: desktop-file-utils}
 Obsoletes: armagetron &lt;= 0.2.6.1
 Provides: armagetron = %{version}-%{release}
@@ -47,12 +47,16 @@
 
 
 %prep
-%setup
-%patch -p1 -b .gcc4
+%setup -n armagetronad-%{version}%{?prever:_%{prever}}
+%patch0 -p1 -b .gcc4
+%patch1 -p1 -b .desktop
 
 
 %build
-%configure
+%configure \
+    --enable-music \
+    --disable-uninstall \
+    --disable-games
 %{__make} %{?_smp_mflags}
 
 
@@ -61,84 +65,78 @@
 %makeinstall
 
 # Put the docs where we include them with %%doc
-%{__mv} %{buildroot}%{prefix}/doc _docs
+%{__mv} %{buildroot}%{_datadir}/doc/armagetronad/html _docs
 
-# Yeah, add an icon for the menu entry!
-%{__mkdir_p} %{buildroot}%{_datadir}/pixmaps
-convert tron.ico %{buildroot}%{_datadir}/pixmaps/armagetron.png
+# Yeah, add icons for the menu entry!
+# New freedesktop locations
+%{__install} -D -p -m 0644 desktop/icons/large/armagetronad.png \
+    %{buildroot}%{_datadir}/icons/hicolor/48x48/armagetronad.png
+%{__install} -D -p -m 0644 desktop/icons/medium/armagetronad.png \
+    %{buildroot}%{_datadir}/icons/hicolor/32x32/armagetronad.png
+%{__install} -D -p -m 0644 desktop/icons/small/armagetronad.png \
+    %{buildroot}%{_datadir}/icons/hicolor/16x16/armagetronad.png
+# Legacy location (put 32 x 32 in there)
+%{__install} -D -p -m 0644 desktop/icons/medium/armagetronad.png \
+    %{buildroot}%{_datadir}/pixmaps/armagetronad.png
 
-## The wrapper script (overwrite the default)
-#%{__cat} &gt; %{buildroot}%{_bindir}/armagetron &lt;&lt; 'EOF'
-##!/bin/sh -e
-#
-#INSTALL=%{prefix}
-#VARDIR=$HOME/.armagetron/var
-#
-#if test ! -d $VARDIR ; then
-#    mkdir -p $VARDIR
-#        
-#    # Migrate old configuration
-#    files=$( find $HOME/.armagetron -type f -maxdepth 1 )
-# 
-#    test &quot;$files&quot; != &quot;&quot; &amp;&amp; echo &quot;Porting old configuration...&quot; &amp;&amp; mv $files $VARDIR
-#fi
-#
-#$INSTALL/bin/armagetron --datadir $INSTALL --configdir %{_sysconfdir}/armagetron --userconfigdir $HOME/.armagetron --vardir $VARDIR &quot;$@&quot;
-#
-#EOF
-
-%{__cat} &gt; %{name}.desktop &lt;&lt; EOF
-[Desktop Entry]
-Name=Armagetron Advanced
-Comment=Multiplayer 'Tron' 3D racing game
-Exec=%{_bindir}/armagetronad
-Icon=armagetron.png
-Terminal=false
-Type=Application
-Categories=Application;Game;
-Encoding=UTF-8
-EOF
-
 %if %{!?_without_freedesktop:1}%{?_without_freedesktop:0}
 %{__mkdir_p} %{buildroot}%{_datadir}/applications
 desktop-file-install --vendor %{desktop_vendor} \
-    --dir %{buildroot}%{_datadir}/applications \
-    %{name}.desktop
+    --dir %{buildroot}%{_datadir}/applications  \
+    desktop/armagetronad.desktop
 %else
-%{__install} -Dp -m 644 %{name}.desktop \
-  %{buildroot}/etc/X11/applnk/Games/%{name}.desktop
+%{__install} -D -p -m 0644 desktop/armagetronad.desktop \
+    %{buildroot}/etc/X11/applnk/Games/armagetronad.desktop
 %endif
 
+# Workaround for 0.2.8_beta3 not finding the config files in /etc/
+%{__ln_s} /etc/armagetronad %{buildroot}%{_datadir}/armagetronad/config
 
+
 %clean
 %{__rm} -rf %{buildroot}
 
 
+%post
+gtk-update-icon-cache || :
+
+%postun
+gtk-update-icon-cache || :
+
+
 %files
 %defattr(-, root, root, 0755)
 %doc _docs/*
 %dir %{_sysconfdir}/armagetronad/
 %config(noreplace) %{_sysconfdir}/armagetronad/*
-%{_sysconfdir}/armagetronad/.orig/
 %{_bindir}/armagetronad
-%{_bindir}/armagetronad-stat
-%dir %{prefix}
-%exclude %{prefix}/COPYING.txt
-%{prefix}/arenas/
-%{prefix}/bin/
-%exclude %{prefix}/bin/uninstall
-%{prefix}/language/
-%exclude %{prefix}/log/
-%{prefix}/models/
-%{prefix}/music/
-%{prefix}/sound/
-%{prefix}/textures/
-%{_datadir}/pixmaps/armagetron.png
-%{!?_without_freedesktop:%{_datadir}/applications/%{desktop_vendor}-%{name}.desktop}
-%{?_without_freedesktop:/etc/X11/applnk/Games/%{name}.desktop}
+%dir %{_datadir}/armagetronad/
+%{_datadir}/armagetronad/config
+%exclude %{_datadir}/armagetronad/desktop/
+%{_datadir}/armagetronad/language/
+%{_datadir}/armagetronad/models/
+%{_datadir}/armagetronad/resource/
+%exclude %{_datadir}/armagetronad/scripts/
+%{_datadir}/armagetronad/sound/
+%{_datadir}/armagetronad/textures/
+%{_datadir}/icons/hicolor/*/armagetronad.png
+%{_datadir}/pixmaps/armagetronad.png
+%{!?_without_freedesktop:%{_datadir}/applications/%{desktop_vendor}-armagetronad.desktop}
+%{?_without_freedesktop:/etc/X11/applnk/Games/armagetronad.desktop}
 
 
 %changelog
+* Mon Nov 14 2005 Matthias Saou &lt;<A HREF="http://freshrpms.net/">http://freshrpms.net/</A>&gt; 0.2.8-0.1.beta3
+- Update to 0.2.8_beta3.
+- Update gcc4 patch (only one line left now).
+- Add new libxml2-devel build dependency.
+- Use included desktop icons, no longer convert the .ico file.
+- Use included desktop file, but patch it first (fixes + enhancements).
+- Add gtk-update-icon-cache scriplets.
+- Enable music.
+- Disable the &quot;games path&quot;.
+- Add &quot;config&quot; symlink to workaround the config files not found (ugly, but...).
+
 * Fri Apr 22 2005 Matthias Saou &lt;<A HREF="http://freshrpms.net/">http://freshrpms.net/</A>&gt; 0.2.7.1-2
 - Added gcc4 patch (sf.net bug 1187292).
 


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002514.html">[svn] r3714 - trunk/rpms/squale
</A></li>
	<LI>Next message: <A HREF="002516.html">[svn] r3716 - trunk/rpms/httping
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2515">[ date ]</a>
              <a href="thread.html#2515">[ thread ]</a>
              <a href="subject.html#2515">[ subject ]</a>
              <a href="author.html#2515">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.repoforge.org/mailman/listinfo/commits">More information about the commits
mailing list</a><br>
</body></html>
