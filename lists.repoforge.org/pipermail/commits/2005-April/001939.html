<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [svn] r3137 - in trunk/tools/pydar2: . perlpackages php pydar sql
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:commits%40lists.repoforge.org?Subject=Re:%20Re%3A%20%5Bsvn%5D%20r3137%20-%20in%20trunk/tools/pydar2%3A%20.%20perlpackages%20php%20pydar%20sql&In-Reply-To=%3C20050418203619.8B6F95C40E5%40pooch.vmhosting.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001938.html">
   <LINK REL="Next"  HREF="001940.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[svn] r3137 - in trunk/tools/pydar2: . perlpackages php pydar sql</H1>
    <B>packagers at lists.rpmforge.net</B> 
    <A HREF="mailto:commits%40lists.repoforge.org?Subject=Re:%20Re%3A%20%5Bsvn%5D%20r3137%20-%20in%20trunk/tools/pydar2%3A%20.%20perlpackages%20php%20pydar%20sql&In-Reply-To=%3C20050418203619.8B6F95C40E5%40pooch.vmhosting.org%3E"
       TITLE="[svn] r3137 - in trunk/tools/pydar2: . perlpackages php pydar sql">packagers at lists.rpmforge.net
       </A><BR>
    <I>Mon Apr 18 22:36:19 CEST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="001938.html">[svn] r3136 - in trunk/rpms: . perl-Tie-DBI perl-Tie-DB_Lock	perl-Tie-Dir perl-Tie-EncryptedHash perl-Tie-LLHash	perl-Tie-STDERR perl-Tie-Scalar-Timeout perl-Tie-Syslog	perl-Tie-TwoLevelHash perl-Time-Beat perl-Time-modules	perl-Tk-FileDialog perl-Tk-FontDialog perl-Tk-HTML	perl-Tk-MListbox perl-Tk-WaitBox perl-Tree-DAG_Node	perl-Tree-MultiNode perl-Tree-Nary perl-Tree-RedBlack	perl-Tree-Trie perl-UNIVERSAL-exports perl-Unicode-Lite	perl-Unix-Processors perl-VCS perl-VRML	perl-Video-Capture-V4l perl-WWW-Babelfish perl-WWW-Poll	perl-WWW-Robot perl-Want perl-XML-DOMHandler	perl-XML-Handler-YAWriter perl-XML-Mini perl-XML-QL	perl-XML-SimpleObject perl-XMLNews-HTMLTemplate perl-XMLNews-Meta
</A></li>
        <LI>Next message: <A HREF="001940.html">[svn] r3138 - trunk/tools/pydar2/pydar
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1939">[ date ]</a>
              <a href="thread.html#1939">[ thread ]</a>
              <a href="subject.html#1939">[ subject ]</a>
              <a href="author.html#1939">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: dries
Date: 2005-04-18 22:36:17 +0200 (Mon, 18 Apr 2005)
New Revision: 3137

Added:
   trunk/tools/pydar2/classdiagram.xmi
   trunk/tools/pydar2/log4py.conf
   trunk/tools/pydar2/pydar-master-update.py
   trunk/tools/pydar2/pydar/cvsbasedspecrepository.py
   trunk/tools/pydar2/pydar/filesbasedspecrepository.py
   trunk/tools/pydar2/pydar/memorystorage.py
   trunk/tools/pydar2/pydar/postgresqlstorage.py
   trunk/tools/pydar2/pydar/pydarclient.py
   trunk/tools/pydar2/pydar/specrepository.py
   trunk/tools/pydar2/pydar/specrepositoryfactory.py
   trunk/tools/pydar2/pydar/specrepositorylist.py
   trunk/tools/pydar2/pydar/specrepositoryspecfile.py
   trunk/tools/pydar2/pydar/storage.py
   trunk/tools/pydar2/pydar/storagefactory.py
   trunk/tools/pydar2/pydar/svnbasedspecrepository.py
Modified:
   trunk/tools/pydar2/perlpackages/check.pl
   trunk/tools/pydar2/perlpackages/perltemplate.spec
   trunk/tools/pydar2/php/el4x86driestodo.php
   trunk/tools/pydar2/php/navigation.php
   trunk/tools/pydar2/pydar-buildserver-master.py
   trunk/tools/pydar2/pydar-buildserver-slave.py
   trunk/tools/pydar2/pydar/buildroot.py
   trunk/tools/pydar2/pydar/buildrootresult.py
   trunk/tools/pydar2/pydar/config.py
   trunk/tools/pydar2/pydar/yumbasedbuildroot.py
   trunk/tools/pydar2/sql/svncheck.sql
Log:
update, but far from working

Added: trunk/tools/pydar2/classdiagram.xmi
===================================================================
--- trunk/tools/pydar2/classdiagram.xmi	2005-04-16 09:25:14 UTC (rev 3136)
+++ trunk/tools/pydar2/classdiagram.xmi	2005-04-18 20:36:17 UTC (rev 3137)
@@ -0,0 +1,309 @@
+&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
+&lt;XMI xmlns:UML=&quot;<A HREF="http://schema.omg.org/spec/UML/1.3">http://schema.omg.org/spec/UML/1.3</A>&quot; verified=&quot;false&quot; timestamp=&quot;2005-04-10T22:36:21&quot; xmi.version=&quot;1.2&quot; &gt;
+ &lt;XMI.header&gt;
+  &lt;XMI.documentation&gt;
+   &lt;XMI.exporter&gt;umbrello uml modeller <A HREF="http://uml.sf.net&lt;/XMI.exporter">http://uml.sf.net&lt;/XMI.exporter</A>&gt;
+   &lt;XMI.exporterVersion&gt;1.4&lt;/XMI.exporterVersion&gt;
+   &lt;XMI.exporterEncoding&gt;UnicodeUTF8&lt;/XMI.exporterEncoding&gt;
+  &lt;/XMI.documentation&gt;
+  &lt;XMI.metamodel xmi.name=&quot;UML&quot; href=&quot;UML.xml&quot; xmi.version=&quot;1.3&quot; /&gt;
+ &lt;/XMI.header&gt;
+ &lt;XMI.content&gt;
+  &lt;UML:Model isSpecification=&quot;false&quot; isLeaf=&quot;false&quot; isRoot=&quot;false&quot; isAbstract=&quot;false&quot; &gt;
+   &lt;UML:Namespace.ownedElement&gt;
+    &lt;UML:Stereotype isSpecification=&quot;false&quot; isLeaf=&quot;false&quot; visibility=&quot;public&quot; xmi.id=&quot;20&quot; isRoot=&quot;false&quot; isAbstract=&quot;false&quot; name=&quot;interface&quot; /&gt;
+    &lt;UML:Stereotype isSpecification=&quot;false&quot; isLeaf=&quot;false&quot; visibility=&quot;public&quot; xmi.id=&quot;23&quot; isRoot=&quot;false&quot; isAbstract=&quot;false&quot; name=&quot;datatype&quot; /&gt;
+    &lt;UML:DataType stereotype=&quot;23&quot; isSpecification=&quot;false&quot; isLeaf=&quot;false&quot; visibility=&quot;public&quot; xmi.id=&quot;22&quot; isRoot=&quot;false&quot; isAbstract=&quot;false&quot; name=&quot;void&quot; /&gt;
+    &lt;UML:Interface stereotype=&quot;20&quot; isSpecification=&quot;false&quot; isLeaf=&quot;false&quot; visibility=&quot;public&quot; xmi.id=&quot;19&quot; isRoot=&quot;false&quot; isAbstract=&quot;true&quot; name=&quot;BuildRoot&quot; &gt;
+     &lt;UML:Classifier.feature&gt;
+      &lt;UML:Operation isSpecification=&quot;false&quot; isLeaf=&quot;false&quot; visibility=&quot;public&quot; xmi.id=&quot;21&quot; isRoot=&quot;false&quot; isAbstract=&quot;false&quot; name=&quot;__init__&quot; /&gt;
+      &lt;UML:Operation isSpecification=&quot;false&quot; isLeaf=&quot;false&quot; visibility=&quot;public&quot; xmi.id=&quot;24&quot; isRoot=&quot;false&quot; isAbstract=&quot;false&quot; name=&quot;cleanRoot&quot; /&gt;
+      &lt;UML:Operation isSpecification=&quot;false&quot; isLeaf=&quot;false&quot; visibility=&quot;public&quot; xmi.id=&quot;25&quot; isRoot=&quot;false&quot; isAbstract=&quot;false&quot; name=&quot;prepareRoot&quot; /&gt;
+      &lt;UML:Operation isSpecification=&quot;false&quot; isLeaf=&quot;false&quot; visibility=&quot;public&quot; xmi.id=&quot;26&quot; isRoot=&quot;false&quot; isAbstract=&quot;false&quot; name=&quot;installRpms&quot; &gt;
+       &lt;UML:BehavioralFeature.parameter&gt;
+        &lt;UML:Parameter isSpecification=&quot;false&quot; isLeaf=&quot;false&quot; visibility=&quot;private&quot; xmi.id=&quot;28&quot; isRoot=&quot;false&quot; value=&quot;&quot; type=&quot;22&quot; isAbstract=&quot;false&quot; name=&quot;rpms&quot; /&gt;
+       &lt;/UML:BehavioralFeature.parameter&gt;
+      &lt;/UML:Operation&gt;
+      &lt;UML:Operation isSpecification=&quot;false&quot; isLeaf=&quot;false&quot; visibility=&quot;public&quot; xmi.id=&quot;29&quot; isRoot=&quot;false&quot; isAbstract=&quot;false&quot; name=&quot;buildRpm&quot; &gt;
+       &lt;UML:BehavioralFeature.parameter&gt;
+        &lt;UML:Parameter isSpecification=&quot;false&quot; isLeaf=&quot;false&quot; visibility=&quot;private&quot; xmi.id=&quot;30&quot; isRoot=&quot;false&quot; value=&quot;&quot; type=&quot;22&quot; isAbstract=&quot;false&quot; name=&quot;spec&quot; /&gt;
+       &lt;/UML:BehavioralFeature.parameter&gt;
+      &lt;/UML:Operation&gt;
+     &lt;/UML:Classifier.feature&gt;
+    &lt;/UML:Interface&gt;
+    &lt;UML:Class isSpecification=&quot;false&quot; isLeaf=&quot;false&quot; visibility=&quot;public&quot; xmi.id=&quot;27&quot; isRoot=&quot;false&quot; isAbstract=&quot;false&quot; name=&quot;int&quot; /&gt;
+    &lt;UML:Class isSpecification=&quot;false&quot; isLeaf=&quot;false&quot; visibility=&quot;public&quot; xmi.id=&quot;31&quot; isRoot=&quot;false&quot; isAbstract=&quot;false&quot; name=&quot;YumBasedBuildRoot&quot; &gt;
+     &lt;UML:Classifier.feature&gt;
+      &lt;UML:Operation isSpecification=&quot;false&quot; isLeaf=&quot;false&quot; visibility=&quot;public&quot; xmi.id=&quot;35&quot; isRoot=&quot;false&quot; isAbstract=&quot;false&quot; name=&quot;__init__&quot; /&gt;
+      &lt;UML:Operation isSpecification=&quot;false&quot; isLeaf=&quot;false&quot; visibility=&quot;public&quot; xmi.id=&quot;36&quot; isRoot=&quot;false&quot; isAbstract=&quot;false&quot; name=&quot;cleanRoot&quot; /&gt;
+      &lt;UML:Operation isSpecification=&quot;false&quot; isLeaf=&quot;false&quot; visibility=&quot;protected&quot; xmi.id=&quot;37&quot; isRoot=&quot;false&quot; isAbstract=&quot;false&quot; name=&quot;setVars&quot; /&gt;
+      &lt;UML:Operation isSpecification=&quot;false&quot; isLeaf=&quot;false&quot; visibility=&quot;public&quot; xmi.id=&quot;38&quot; isRoot=&quot;false&quot; isAbstract=&quot;false&quot; name=&quot;installRpms&quot; /&gt;
+      &lt;UML:Operation isSpecification=&quot;false&quot; isLeaf=&quot;false&quot; visibility=&quot;public&quot; xmi.id=&quot;39&quot; isRoot=&quot;false&quot; isAbstract=&quot;false&quot; name=&quot;prepareRoot&quot; /&gt;
+      &lt;UML:Operation isSpecification=&quot;false&quot; isLeaf=&quot;false&quot; visibility=&quot;protected&quot; xmi.id=&quot;40&quot; isRoot=&quot;false&quot; isAbstract=&quot;false&quot; name=&quot;logCommands&quot; /&gt;
+      &lt;UML:Operation isSpecification=&quot;false&quot; isLeaf=&quot;false&quot; visibility=&quot;protected&quot; xmi.id=&quot;41&quot; isRoot=&quot;false&quot; isAbstract=&quot;false&quot; name=&quot;logCommand&quot; /&gt;
+      &lt;UML:Operation isSpecification=&quot;false&quot; isLeaf=&quot;false&quot; visibility=&quot;protected&quot; xmi.id=&quot;42&quot; isRoot=&quot;false&quot; isAbstract=&quot;false&quot; name=&quot;logCommandWithoutErrors&quot; /&gt;
+      &lt;UML:Operation isSpecification=&quot;false&quot; isLeaf=&quot;false&quot; visibility=&quot;protected&quot; xmi.id=&quot;43&quot; isRoot=&quot;false&quot; isAbstract=&quot;false&quot; name=&quot;createScript&quot; /&gt;
+      &lt;UML:Operation isSpecification=&quot;false&quot; isLeaf=&quot;false&quot; visibility=&quot;protected&quot; xmi.id=&quot;44&quot; isRoot=&quot;false&quot; isAbstract=&quot;false&quot; name=&quot;callBuildScript&quot; /&gt;
+     &lt;/UML:Classifier.feature&gt;
+    &lt;/UML:Class&gt;
+    &lt;UML:Class isSpecification=&quot;false&quot; isLeaf=&quot;false&quot; visibility=&quot;public&quot; xmi.id=&quot;45&quot; isRoot=&quot;false&quot; isAbstract=&quot;false&quot; name=&quot;BuildRootResult&quot; &gt;
+     &lt;UML:Classifier.feature&gt;
+      &lt;UML:Operation isSpecification=&quot;false&quot; isLeaf=&quot;false&quot; visibility=&quot;public&quot; xmi.id=&quot;46&quot; isRoot=&quot;false&quot; isAbstract=&quot;false&quot; name=&quot;__init__&quot; /&gt;
+      &lt;UML:Operation isSpecification=&quot;false&quot; isLeaf=&quot;false&quot; visibility=&quot;public&quot; xmi.id=&quot;47&quot; isRoot=&quot;false&quot; isAbstract=&quot;false&quot; name=&quot;logErrorLine&quot; /&gt;
+      &lt;UML:Operation isSpecification=&quot;false&quot; isLeaf=&quot;false&quot; visibility=&quot;public&quot; xmi.id=&quot;48&quot; isRoot=&quot;false&quot; isAbstract=&quot;false&quot; name=&quot;logDebugLine&quot; /&gt;
+     &lt;/UML:Classifier.feature&gt;
+    &lt;/UML:Class&gt;
+    &lt;UML:Class isSpecification=&quot;false&quot; isLeaf=&quot;false&quot; visibility=&quot;public&quot; xmi.id=&quot;49&quot; isRoot=&quot;false&quot; isAbstract=&quot;false&quot; name=&quot;Command&quot; &gt;
+     &lt;UML:Classifier.feature&gt;
+      &lt;UML:Attribute isSpecification=&quot;false&quot; isLeaf=&quot;false&quot; visibility=&quot;private&quot; xmi.id=&quot;50&quot; isRoot=&quot;false&quot; initialValue=&quot;&quot; type=&quot;22&quot; isAbstract=&quot;false&quot; name=&quot;commandName&quot; /&gt;
+      &lt;UML:Attribute isSpecification=&quot;false&quot; isLeaf=&quot;false&quot; visibility=&quot;private&quot; xmi.id=&quot;51&quot; isRoot=&quot;false&quot; initialValue=&quot;&quot; type=&quot;22&quot; isAbstract=&quot;false&quot; name=&quot;userId&quot; /&gt;
+      &lt;UML:Attribute isSpecification=&quot;false&quot; isLeaf=&quot;false&quot; visibility=&quot;private&quot; xmi.id=&quot;52&quot; isRoot=&quot;false&quot; initialValue=&quot;&quot; type=&quot;22&quot; isAbstract=&quot;false&quot; name=&quot;specName&quot; /&gt;
+      &lt;UML:Attribute isSpecification=&quot;false&quot; isLeaf=&quot;false&quot; visibility=&quot;private&quot; xmi.id=&quot;53&quot; isRoot=&quot;false&quot; initialValue=&quot;&quot; type=&quot;22&quot; isAbstract=&quot;false&quot; name=&quot;toEmail&quot; /&gt;
+      &lt;UML:Attribute isSpecification=&quot;false&quot; isLeaf=&quot;false&quot; visibility=&quot;private&quot; xmi.id=&quot;54&quot; isRoot=&quot;false&quot; initialValue=&quot;&quot; type=&quot;22&quot; isAbstract=&quot;false&quot; name=&quot;releaseTag&quot; /&gt;
+      &lt;UML:Attribute isSpecification=&quot;false&quot; isLeaf=&quot;false&quot; visibility=&quot;private&quot; xmi.id=&quot;55&quot; isRoot=&quot;false&quot; initialValue=&quot;&quot; type=&quot;22&quot; isAbstract=&quot;false&quot; name=&quot;machRoot&quot; /&gt;
+      &lt;UML:Attribute isSpecification=&quot;false&quot; isLeaf=&quot;false&quot; visibility=&quot;private&quot; xmi.id=&quot;56&quot; isRoot=&quot;false&quot; initialValue=&quot;&quot; type=&quot;22&quot; isAbstract=&quot;false&quot; name=&quot;priority&quot; /&gt;
+     &lt;/UML:Classifier.feature&gt;
+    &lt;/UML:Class&gt;
+    &lt;UML:Class isSpecification=&quot;false&quot; isLeaf=&quot;false&quot; visibility=&quot;public&quot; xmi.id=&quot;57&quot; isRoot=&quot;false&quot; isAbstract=&quot;false&quot; name=&quot;Config&quot; &gt;
+     &lt;UML:Classifier.feature&gt;
+      &lt;UML:Operation isSpecification=&quot;false&quot; isLeaf=&quot;false&quot; visibility=&quot;public&quot; xmi.id=&quot;102&quot; isRoot=&quot;false&quot; isAbstract=&quot;false&quot; name=&quot;getSpecRepositoryByName&quot; /&gt;
+     &lt;/UML:Classifier.feature&gt;
+     &lt;UML:Namespace.ownedElement&gt;
+      &lt;UML:Class isSpecification=&quot;false&quot; isLeaf=&quot;false&quot; visibility=&quot;public&quot; xmi.id=&quot;75&quot; isRoot=&quot;false&quot; isAbstract=&quot;false&quot; name=&quot;SpecRepository&quot; &gt;
+       &lt;UML:Classifier.feature&gt;
+        &lt;UML:Operation isSpecification=&quot;false&quot; isLeaf=&quot;false&quot; visibility=&quot;public&quot; xmi.id=&quot;87&quot; isRoot=&quot;false&quot; isAbstract=&quot;false&quot; name=&quot;getUpdateCommand&quot; /&gt;
+        &lt;UML:Operation isSpecification=&quot;false&quot; isLeaf=&quot;false&quot; visibility=&quot;public&quot; xmi.id=&quot;95&quot; isRoot=&quot;false&quot; isAbstract=&quot;false&quot; name=&quot;getType&quot; /&gt;
+        &lt;UML:Operation isSpecification=&quot;false&quot; isLeaf=&quot;false&quot; visibility=&quot;public&quot; xmi.id=&quot;96&quot; isRoot=&quot;false&quot; isAbstract=&quot;false&quot; name=&quot;getName&quot; /&gt;
+        &lt;UML:Operation isSpecification=&quot;false&quot; isLeaf=&quot;false&quot; visibility=&quot;public&quot; xmi.id=&quot;97&quot; isRoot=&quot;false&quot; isAbstract=&quot;false&quot; name=&quot;getRootDirectory&quot; /&gt;
+       &lt;/UML:Classifier.feature&gt;
+      &lt;/UML:Class&gt;
+     &lt;/UML:Namespace.ownedElement&gt;
+    &lt;/UML:Class&gt;
+    &lt;UML:Class isSpecification=&quot;false&quot; isLeaf=&quot;false&quot; visibility=&quot;public&quot; xmi.id=&quot;58&quot; isRoot=&quot;false&quot; isAbstract=&quot;false&quot; name=&quot;TagsFile&quot; &gt;
+     &lt;UML:Classifier.feature&gt;
+      &lt;UML:Attribute isSpecification=&quot;false&quot; isLeaf=&quot;false&quot; visibility=&quot;private&quot; xmi.id=&quot;60&quot; isRoot=&quot;false&quot; initialValue=&quot;&quot; type=&quot;22&quot; isAbstract=&quot;false&quot; name=&quot;rpmforgetags&quot; /&gt;
+      &lt;UML:Attribute isSpecification=&quot;false&quot; isLeaf=&quot;false&quot; visibility=&quot;private&quot; xmi.id=&quot;61&quot; isRoot=&quot;false&quot; initialValue=&quot;&quot; type=&quot;27&quot; isAbstract=&quot;false&quot; name=&quot;standardtags&quot; /&gt;
+      &lt;UML:Operation isSpecification=&quot;false&quot; isLeaf=&quot;false&quot; visibility=&quot;public&quot; xmi.id=&quot;59&quot; isRoot=&quot;false&quot; isAbstract=&quot;false&quot; name=&quot;getStandardTags&quot; /&gt;
+     &lt;/UML:Classifier.feature&gt;
+    &lt;/UML:Class&gt;
+    &lt;UML:Class isSpecification=&quot;false&quot; isLeaf=&quot;false&quot; visibility=&quot;public&quot; xmi.id=&quot;62&quot; isRoot=&quot;false&quot; isAbstract=&quot;false&quot; name=&quot;SpecFile&quot; &gt;
+     &lt;UML:GeneralizableElement.generalization&gt;
+      &lt;UML:Generalization xmi.idref=&quot;63&quot; /&gt;
+     &lt;/UML:GeneralizableElement.generalization&gt;
+    &lt;/UML:Class&gt;
+    &lt;UML:Class isSpecification=&quot;false&quot; isLeaf=&quot;false&quot; visibility=&quot;public&quot; xmi.id=&quot;66&quot; isRoot=&quot;false&quot; isAbstract=&quot;false&quot; name=&quot;RpmFile&quot; &gt;
+     &lt;UML:GeneralizableElement.generalization&gt;
+      &lt;UML:Generalization xmi.idref=&quot;67&quot; /&gt;
+     &lt;/UML:GeneralizableElement.generalization&gt;
+    &lt;/UML:Class&gt;
+    &lt;UML:Class isSpecification=&quot;false&quot; isLeaf=&quot;false&quot; visibility=&quot;public&quot; xmi.id=&quot;70&quot; isRoot=&quot;false&quot; isAbstract=&quot;false&quot; name=&quot;SvnWrapper&quot; &gt;
+     &lt;UML:Classifier.feature&gt;
+      &lt;UML:Operation isSpecification=&quot;false&quot; isLeaf=&quot;false&quot; visibility=&quot;public&quot; xmi.id=&quot;71&quot; isRoot=&quot;false&quot; isAbstract=&quot;false&quot; name=&quot;startTransaction&quot; /&gt;
+      &lt;UML:Operation isSpecification=&quot;false&quot; isLeaf=&quot;false&quot; visibility=&quot;public&quot; xmi.id=&quot;72&quot; isRoot=&quot;false&quot; isAbstract=&quot;false&quot; name=&quot;stopTransaction&quot; /&gt;
+      &lt;UML:Operation isSpecification=&quot;false&quot; isLeaf=&quot;false&quot; visibility=&quot;public&quot; xmi.id=&quot;73&quot; isRoot=&quot;false&quot; isAbstract=&quot;false&quot; name=&quot;updateLocalCopy&quot; /&gt;
+      &lt;UML:Operation isSpecification=&quot;false&quot; isLeaf=&quot;false&quot; visibility=&quot;public&quot; xmi.id=&quot;74&quot; isRoot=&quot;false&quot; isAbstract=&quot;false&quot; name=&quot;getLastCommitRev&quot; /&gt;
+     &lt;/UML:Classifier.feature&gt;
+    &lt;/UML:Class&gt;
+    &lt;UML:Class isSpecification=&quot;false&quot; isLeaf=&quot;false&quot; visibility=&quot;public&quot; xmi.id=&quot;76&quot; isRoot=&quot;false&quot; isAbstract=&quot;false&quot; name=&quot;SvnBasedSpecRepository&quot; &gt;
+     &lt;UML:GeneralizableElement.generalization&gt;
+      &lt;UML:Generalization xmi.idref=&quot;78&quot; /&gt;
+     &lt;/UML:GeneralizableElement.generalization&gt;
+     &lt;UML:Classifier.feature&gt;
+      &lt;UML:Operation isSpecification=&quot;false&quot; isLeaf=&quot;false&quot; visibility=&quot;public&quot; xmi.id=&quot;88&quot; isRoot=&quot;false&quot; isAbstract=&quot;false&quot; name=&quot;getUpdateCommand&quot; /&gt;
+     &lt;/UML:Classifier.feature&gt;
+    &lt;/UML:Class&gt;
+    &lt;UML:Class isSpecification=&quot;false&quot; isLeaf=&quot;false&quot; visibility=&quot;public&quot; xmi.id=&quot;77&quot; isRoot=&quot;false&quot; isAbstract=&quot;false&quot; name=&quot;CvsBasedSpecRepository&quot; &gt;
+     &lt;UML:GeneralizableElement.generalization&gt;
+      &lt;UML:Generalization xmi.idref=&quot;81&quot; /&gt;
+     &lt;/UML:GeneralizableElement.generalization&gt;
+     &lt;UML:Classifier.feature&gt;
+      &lt;UML:Operation isSpecification=&quot;false&quot; isLeaf=&quot;false&quot; visibility=&quot;public&quot; xmi.id=&quot;89&quot; isRoot=&quot;false&quot; isAbstract=&quot;false&quot; name=&quot;getUpdateCommand&quot; /&gt;
+     &lt;/UML:Classifier.feature&gt;
+    &lt;/UML:Class&gt;
+    &lt;UML:Class isSpecification=&quot;false&quot; isLeaf=&quot;false&quot; visibility=&quot;public&quot; xmi.id=&quot;90&quot; isRoot=&quot;false&quot; isAbstract=&quot;false&quot; name=&quot;FilesBasedSpecRepository&quot; &gt;
+     &lt;UML:GeneralizableElement.generalization&gt;
+      &lt;UML:Generalization xmi.idref=&quot;91&quot; /&gt;
+     &lt;/UML:GeneralizableElement.generalization&gt;
+     &lt;UML:Classifier.feature&gt;
+      &lt;UML:Operation isSpecification=&quot;false&quot; isLeaf=&quot;false&quot; visibility=&quot;public&quot; xmi.id=&quot;94&quot; isRoot=&quot;false&quot; isAbstract=&quot;false&quot; name=&quot;getUpdateCommand&quot; /&gt;
+     &lt;/UML:Classifier.feature&gt;
+    &lt;/UML:Class&gt;
+    &lt;UML:Class isSpecification=&quot;false&quot; isLeaf=&quot;false&quot; visibility=&quot;public&quot; xmi.id=&quot;103&quot; isRoot=&quot;false&quot; isAbstract=&quot;false&quot; name=&quot;SpecRepositoryFactory&quot; &gt;
+     &lt;UML:Classifier.feature&gt;
+      &lt;UML:Operation isSpecification=&quot;false&quot; isLeaf=&quot;false&quot; visibility=&quot;public&quot; xmi.id=&quot;104&quot; isRoot=&quot;false&quot; isAbstract=&quot;false&quot; name=&quot;getInstance&quot; /&gt;
+      &lt;UML:Operation isSpecification=&quot;false&quot; isLeaf=&quot;false&quot; visibility=&quot;public&quot; xmi.id=&quot;105&quot; isRoot=&quot;false&quot; isAbstract=&quot;false&quot; name=&quot;createSpecRepository&quot; /&gt;
+     &lt;/UML:Classifier.feature&gt;
+    &lt;/UML:Class&gt;
+    &lt;UML:Generalization isSpecification=&quot;false&quot; child=&quot;31&quot; visibility=&quot;public&quot; xmi.id=&quot;32&quot; parent=&quot;19&quot; discriminator=&quot;&quot; name=&quot;&quot; /&gt;
+    &lt;UML:Generalization isSpecification=&quot;false&quot; child=&quot;62&quot; visibility=&quot;public&quot; xmi.id=&quot;63&quot; parent=&quot;58&quot; discriminator=&quot;&quot; name=&quot;&quot; /&gt;
+    &lt;UML:Generalization isSpecification=&quot;false&quot; child=&quot;66&quot; visibility=&quot;public&quot; xmi.id=&quot;67&quot; parent=&quot;58&quot; discriminator=&quot;&quot; name=&quot;&quot; /&gt;
+    &lt;UML:Generalization isSpecification=&quot;false&quot; child=&quot;76&quot; visibility=&quot;public&quot; xmi.id=&quot;78&quot; parent=&quot;75&quot; discriminator=&quot;&quot; name=&quot;&quot; /&gt;
+    &lt;UML:Generalization isSpecification=&quot;false&quot; child=&quot;77&quot; visibility=&quot;public&quot; xmi.id=&quot;81&quot; parent=&quot;75&quot; discriminator=&quot;&quot; name=&quot;&quot; /&gt;
+    &lt;UML:Generalization isSpecification=&quot;false&quot; child=&quot;31&quot; visibility=&quot;public&quot; xmi.id=&quot;84&quot; parent=&quot;19&quot; discriminator=&quot;&quot; name=&quot;&quot; /&gt;
+    &lt;UML:Generalization isSpecification=&quot;false&quot; child=&quot;90&quot; visibility=&quot;public&quot; xmi.id=&quot;91&quot; parent=&quot;75&quot; discriminator=&quot;&quot; name=&quot;&quot; /&gt;
+   &lt;/UML:Namespace.ownedElement&gt;
+  &lt;/UML:Model&gt;
+ &lt;/XMI.content&gt;
+ &lt;XMI.extensions xmi.extender=&quot;umbrello&quot; &gt;
+  &lt;docsettings viewid=&quot;18&quot; documentation=&quot;&quot; uniqueid=&quot;107&quot; /&gt;
+  &lt;diagrams&gt;
+   &lt;diagram snapgrid=&quot;0&quot; showattsig=&quot;1&quot; fillcolor=&quot;#ffffc0&quot; linewidth=&quot;0&quot; zoom=&quot;100&quot; showgrid=&quot;0&quot; showopsig=&quot;1&quot; usefillcolor=&quot;1&quot; snapx=&quot;10&quot; canvaswidth=&quot;976&quot; snapy=&quot;10&quot; showatts=&quot;1&quot; xmi.id=&quot;18&quot; documentation=&quot;&quot; type=&quot;402&quot; showops=&quot;1&quot; showpackage=&quot;0&quot; name=&quot;class diagram&quot; localid=&quot;900000&quot; showstereotype=&quot;0&quot; showscope=&quot;1&quot; snapcsgrid=&quot;0&quot; font=&quot;Sans,8,-1,5,50,0,0,0,0,0&quot; linecolor=&quot;#ff0000&quot; canvasheight=&quot;1019&quot; &gt;
+    &lt;widgets&gt;
+     &lt;interfacewidget usesdiagramfillcolour=&quot;1&quot; width=&quot;150&quot; usesdiagramusefillcolour=&quot;1&quot; x=&quot;471&quot; linecolour=&quot;none&quot; y=&quot;206&quot; drawascircle=&quot;0&quot; showopsigs=&quot;601&quot; linewidth=&quot;none&quot; usesdiagramlinewidth=&quot;1&quot; usesdiagramlinecolour=&quot;1&quot; fillcolour=&quot;none&quot; height=&quot;105&quot; usefillcolor=&quot;1&quot; isinstance=&quot;0&quot; xmi.id=&quot;19&quot; showoperations=&quot;1&quot; showpackage=&quot;0&quot; showscope=&quot;1&quot; font=&quot;Sans,8,-1,5,75,1,0,0,0,0&quot; /&gt;
+     &lt;classwidget usesdiagramfillcolour=&quot;1&quot; width=&quot;173&quot; showattsigs=&quot;601&quot; usesdiagramusefillcolour=&quot;1&quot; x=&quot;705&quot; linecolour=&quot;none&quot; y=&quot;352&quot; showopsigs=&quot;601&quot; linewidth=&quot;none&quot; usesdiagramlinewidth=&quot;1&quot; usesdiagramlinecolour=&quot;1&quot; fillcolour=&quot;none&quot; height=&quot;172&quot; usefillcolor=&quot;1&quot; showpubliconly=&quot;0&quot; showattributes=&quot;1&quot; isinstance=&quot;0&quot; xmi.id=&quot;31&quot; showoperations=&quot;1&quot; showpackage=&quot;0&quot; showscope=&quot;1&quot; showstereotype=&quot;0&quot; font=&quot;Sans,8,-1,5,75,0,0,0,0,0&quot; /&gt;
+     &lt;classwidget usesdiagramfillcolour=&quot;1&quot; width=&quot;102&quot; showattsigs=&quot;601&quot; usesdiagramusefillcolour=&quot;1&quot; x=&quot;185&quot; linecolour=&quot;none&quot; y=&quot;224&quot; showopsigs=&quot;601&quot; linewidth=&quot;none&quot; usesdiagramlinewidth=&quot;1&quot; usesdiagramlinecolour=&quot;1&quot; fillcolour=&quot;none&quot; height=&quot;67&quot; usefillcolor=&quot;1&quot; showpubliconly=&quot;0&quot; showattributes=&quot;1&quot; isinstance=&quot;0&quot; xmi.id=&quot;45&quot; showoperations=&quot;1&quot; showpackage=&quot;0&quot; showscope=&quot;1&quot; showstereotype=&quot;0&quot; font=&quot;Sans,8,-1,5,75,0,0,0,0,0&quot; /&gt;
+     &lt;classwidget usesdiagramfillcolour=&quot;1&quot; width=&quot;123&quot; showattsigs=&quot;601&quot; usesdiagramusefillcolour=&quot;1&quot; x=&quot;321&quot; linecolour=&quot;none&quot; y=&quot;63&quot; showopsigs=&quot;601&quot; linewidth=&quot;none&quot; usesdiagramlinewidth=&quot;1&quot; usesdiagramlinecolour=&quot;1&quot; fillcolour=&quot;none&quot; height=&quot;127&quot; usefillcolor=&quot;1&quot; showpubliconly=&quot;0&quot; showattributes=&quot;1&quot; isinstance=&quot;0&quot; xmi.id=&quot;49&quot; showoperations=&quot;1&quot; showpackage=&quot;0&quot; showscope=&quot;1&quot; showstereotype=&quot;0&quot; font=&quot;Sans,8,-1,5,75,0,0,0,0,0&quot; /&gt;
+     &lt;classwidget usesdiagramfillcolour=&quot;1&quot; width=&quot;172&quot; showattsigs=&quot;601&quot; usesdiagramusefillcolour=&quot;1&quot; x=&quot;211&quot; linecolour=&quot;none&quot; y=&quot;371&quot; showopsigs=&quot;601&quot; linewidth=&quot;none&quot; usesdiagramlinewidth=&quot;1&quot; usesdiagramlinecolour=&quot;1&quot; fillcolour=&quot;none&quot; height=&quot;37&quot; usefillcolor=&quot;1&quot; showpubliconly=&quot;0&quot; showattributes=&quot;1&quot; isinstance=&quot;0&quot; xmi.id=&quot;57&quot; showoperations=&quot;1&quot; showpackage=&quot;0&quot; showscope=&quot;1&quot; showstereotype=&quot;0&quot; font=&quot;Sans,8,-1,5,75,0,0,0,0,0&quot; /&gt;
+     &lt;classwidget usesdiagramfillcolour=&quot;1&quot; width=&quot;118&quot; showattsigs=&quot;601&quot; usesdiagramusefillcolour=&quot;1&quot; x=&quot;651&quot; linecolour=&quot;none&quot; y=&quot;589&quot; showopsigs=&quot;601&quot; linewidth=&quot;none&quot; usesdiagramlinewidth=&quot;1&quot; usesdiagramlinecolour=&quot;1&quot; fillcolour=&quot;none&quot; height=&quot;60&quot; usefillcolor=&quot;1&quot; showpubliconly=&quot;0&quot; showattributes=&quot;1&quot; isinstance=&quot;0&quot; xmi.id=&quot;58&quot; showoperations=&quot;1&quot; showpackage=&quot;0&quot; showscope=&quot;1&quot; showstereotype=&quot;0&quot; font=&quot;Sans,8,-1,5,75,0,0,0,0,0&quot; /&gt;
+     &lt;classwidget usesdiagramfillcolour=&quot;1&quot; width=&quot;55&quot; showattsigs=&quot;601&quot; usesdiagramusefillcolour=&quot;1&quot; x=&quot;581&quot; linecolour=&quot;none&quot; y=&quot;711&quot; showopsigs=&quot;601&quot; linewidth=&quot;none&quot; usesdiagramlinewidth=&quot;1&quot; usesdiagramlinecolour=&quot;1&quot; fillcolour=&quot;none&quot; height=&quot;29&quot; usefillcolor=&quot;1&quot; showpubliconly=&quot;0&quot; showattributes=&quot;1&quot; isinstance=&quot;0&quot; xmi.id=&quot;62&quot; showoperations=&quot;1&quot; showpackage=&quot;0&quot; showscope=&quot;1&quot; showstereotype=&quot;0&quot; font=&quot;Sans,8,-1,5,75,0,0,0,0,0&quot; /&gt;
+     &lt;classwidget usesdiagramfillcolour=&quot;1&quot; width=&quot;53&quot; showattsigs=&quot;601&quot; usesdiagramusefillcolour=&quot;1&quot; x=&quot;785&quot; linecolour=&quot;none&quot; y=&quot;719&quot; showopsigs=&quot;601&quot; linewidth=&quot;none&quot; usesdiagramlinewidth=&quot;1&quot; usesdiagramlinecolour=&quot;1&quot; fillcolour=&quot;none&quot; height=&quot;29&quot; usefillcolor=&quot;1&quot; showpubliconly=&quot;0&quot; showattributes=&quot;1&quot; isinstance=&quot;0&quot; xmi.id=&quot;66&quot; showoperations=&quot;1&quot; showpackage=&quot;0&quot; showscope=&quot;1&quot; showstereotype=&quot;0&quot; font=&quot;Sans,8,-1,5,75,0,0,0,0,0&quot; /&gt;
+     &lt;classwidget usesdiagramfillcolour=&quot;1&quot; width=&quot;129&quot; showattsigs=&quot;601&quot; usesdiagramusefillcolour=&quot;1&quot; x=&quot;819&quot; linecolour=&quot;none&quot; y=&quot;133&quot; showopsigs=&quot;601&quot; linewidth=&quot;none&quot; usesdiagramlinewidth=&quot;1&quot; usesdiagramlinecolour=&quot;1&quot; fillcolour=&quot;none&quot; height=&quot;82&quot; usefillcolor=&quot;1&quot; showpubliconly=&quot;0&quot; showattributes=&quot;1&quot; isinstance=&quot;0&quot; xmi.id=&quot;70&quot; showoperations=&quot;1&quot; showpackage=&quot;0&quot; showscope=&quot;1&quot; showstereotype=&quot;0&quot; font=&quot;Sans,8,-1,5,75,0,0,0,0,0&quot; /&gt;
+     &lt;classwidget usesdiagramfillcolour=&quot;1&quot; width=&quot;137&quot; showattsigs=&quot;601&quot; usesdiagramusefillcolour=&quot;1&quot; x=&quot;231&quot; linecolour=&quot;none&quot; y=&quot;621&quot; showopsigs=&quot;601&quot; linewidth=&quot;none&quot; usesdiagramlinewidth=&quot;1&quot; usesdiagramlinecolour=&quot;1&quot; fillcolour=&quot;none&quot; height=&quot;82&quot; usefillcolor=&quot;1&quot; showpubliconly=&quot;0&quot; showattributes=&quot;1&quot; isinstance=&quot;0&quot; xmi.id=&quot;75&quot; showoperations=&quot;1&quot; showpackage=&quot;0&quot; showscope=&quot;1&quot; showstereotype=&quot;0&quot; font=&quot;Sans,8,-1,5,75,0,0,0,0,0&quot; /&gt;
+     &lt;classwidget usesdiagramfillcolour=&quot;1&quot; width=&quot;147&quot; showattsigs=&quot;601&quot; usesdiagramusefillcolour=&quot;1&quot; x=&quot;225&quot; linecolour=&quot;none&quot; y=&quot;802&quot; showopsigs=&quot;601&quot; linewidth=&quot;none&quot; usesdiagramlinewidth=&quot;1&quot; usesdiagramlinecolour=&quot;1&quot; fillcolour=&quot;none&quot; height=&quot;37&quot; usefillcolor=&quot;1&quot; showpubliconly=&quot;0&quot; showattributes=&quot;1&quot; isinstance=&quot;0&quot; xmi.id=&quot;76&quot; showoperations=&quot;1&quot; showpackage=&quot;0&quot; showscope=&quot;1&quot; showstereotype=&quot;0&quot; font=&quot;Sans,8,-1,5,75,0,0,0,0,0&quot; /&gt;
+     &lt;classwidget usesdiagramfillcolour=&quot;1&quot; width=&quot;147&quot; showattsigs=&quot;601&quot; usesdiagramusefillcolour=&quot;1&quot; x=&quot;401&quot; linecolour=&quot;none&quot; y=&quot;800&quot; showopsigs=&quot;601&quot; linewidth=&quot;none&quot; usesdiagramlinewidth=&quot;1&quot; usesdiagramlinecolour=&quot;1&quot; fillcolour=&quot;none&quot; height=&quot;37&quot; usefillcolor=&quot;1&quot; showpubliconly=&quot;0&quot; showattributes=&quot;1&quot; isinstance=&quot;0&quot; xmi.id=&quot;77&quot; showoperations=&quot;1&quot; showpackage=&quot;0&quot; showscope=&quot;1&quot; showstereotype=&quot;0&quot; font=&quot;Sans,8,-1,5,75,0,0,0,0,0&quot; /&gt;
+     &lt;classwidget usesdiagramfillcolour=&quot;1&quot; width=&quot;151&quot; showattsigs=&quot;601&quot; usesdiagramusefillcolour=&quot;1&quot; x=&quot;47&quot; linecolour=&quot;none&quot; y=&quot;800&quot; showopsigs=&quot;601&quot; linewidth=&quot;none&quot; usesdiagramlinewidth=&quot;1&quot; usesdiagramlinecolour=&quot;1&quot; fillcolour=&quot;none&quot; height=&quot;37&quot; usefillcolor=&quot;1&quot; showpubliconly=&quot;0&quot; showattributes=&quot;1&quot; isinstance=&quot;0&quot; xmi.id=&quot;90&quot; showoperations=&quot;1&quot; showpackage=&quot;0&quot; showscope=&quot;1&quot; showstereotype=&quot;0&quot; font=&quot;Sans,8,-1,5,75,0,0,0,0,0&quot; /&gt;
+     &lt;classwidget usesdiagramfillcolour=&quot;0&quot; width=&quot;143&quot; showattsigs=&quot;601&quot; usesdiagramusefillcolour=&quot;0&quot; x=&quot;385&quot; linecolour=&quot;#ff0000&quot; y=&quot;620&quot; showopsigs=&quot;601&quot; linewidth=&quot;none&quot; usesdiagramlinewidth=&quot;1&quot; usesdiagramlinecolour=&quot;0&quot; fillcolour=&quot;#ffffc0&quot; height=&quot;52&quot; usefillcolor=&quot;1&quot; showpubliconly=&quot;0&quot; showattributes=&quot;1&quot; isinstance=&quot;0&quot; xmi.id=&quot;103&quot; showoperations=&quot;1&quot; showpackage=&quot;0&quot; showscope=&quot;1&quot; showstereotype=&quot;0&quot; font=&quot;Sans,8,-1,5,75,0,0,0,0,0&quot; /&gt;
+     &lt;notewidget usesdiagramfillcolour=&quot;1&quot; width=&quot;100&quot; usesdiagramusefillcolour=&quot;1&quot; x=&quot;479&quot; linecolour=&quot;none&quot; y=&quot;498&quot; linewidth=&quot;none&quot; usesdiagramlinewidth=&quot;1&quot; usesdiagramlinecolour=&quot;1&quot; fillcolour=&quot;none&quot; height=&quot;80&quot; usefillcolor=&quot;1&quot; isinstance=&quot;0&quot; xmi.id=&quot;107&quot; text=&quot;SpecRepositoryFactory is a singleton which creates SpecRepository objects&quot; font=&quot;Sans,8,-1,5,50,0,0,0,0,0&quot; /&gt;
+    &lt;/widgets&gt;
+    &lt;messages/&gt;
+    &lt;associations&gt;
+     &lt;assocwidget totalcounta=&quot;2&quot; indexa=&quot;1&quot; totalcountb=&quot;3&quot; indexb=&quot;1&quot; widgetbid=&quot;58&quot; widgetaid=&quot;62&quot; xmi.id=&quot;63&quot; &gt;
+      &lt;linepath&gt;
+       &lt;startpoint startx=&quot;608&quot; starty=&quot;711&quot; /&gt;
+       &lt;endpoint endx=&quot;690&quot; endy=&quot;649&quot; /&gt;
+      &lt;/linepath&gt;
+     &lt;/assocwidget&gt;
+     &lt;assocwidget totalcounta=&quot;2&quot; indexa=&quot;1&quot; totalcountb=&quot;3&quot; indexb=&quot;2&quot; widgetbid=&quot;58&quot; widgetaid=&quot;66&quot; xmi.id=&quot;67&quot; &gt;
+      &lt;linepath&gt;
+       &lt;startpoint startx=&quot;811&quot; starty=&quot;719&quot; /&gt;
+       &lt;endpoint endx=&quot;729&quot; endy=&quot;649&quot; /&gt;
+      &lt;/linepath&gt;
+     &lt;/assocwidget&gt;
+     &lt;assocwidget totalcounta=&quot;2&quot; indexa=&quot;1&quot; totalcountb=&quot;4&quot; indexb=&quot;2&quot; widgetbid=&quot;75&quot; widgetaid=&quot;76&quot; xmi.id=&quot;78&quot; &gt;
+      &lt;linepath&gt;
+       &lt;startpoint startx=&quot;298&quot; starty=&quot;802&quot; /&gt;
+       &lt;endpoint endx=&quot;299&quot; endy=&quot;703&quot; /&gt;
+      &lt;/linepath&gt;
+     &lt;/assocwidget&gt;
+     &lt;assocwidget totalcounta=&quot;2&quot; indexa=&quot;1&quot; totalcountb=&quot;4&quot; indexb=&quot;3&quot; widgetbid=&quot;75&quot; widgetaid=&quot;77&quot; xmi.id=&quot;81&quot; &gt;
+      &lt;linepath&gt;
+       &lt;startpoint startx=&quot;474&quot; starty=&quot;800&quot; /&gt;
+       &lt;endpoint endx=&quot;333&quot; endy=&quot;703&quot; /&gt;
+      &lt;/linepath&gt;
+     &lt;/assocwidget&gt;
+     &lt;assocwidget totalcounta=&quot;2&quot; indexa=&quot;1&quot; totalcountb=&quot;2&quot; indexb=&quot;1&quot; widgetbid=&quot;19&quot; widgetaid=&quot;31&quot; xmi.id=&quot;84&quot; &gt;
+      &lt;linepath&gt;
+       &lt;startpoint startx=&quot;705&quot; starty=&quot;438&quot; /&gt;
+       &lt;endpoint endx=&quot;546&quot; endy=&quot;311&quot; /&gt;
+      &lt;/linepath&gt;
+     &lt;/assocwidget&gt;
+     &lt;assocwidget totalcounta=&quot;2&quot; indexa=&quot;1&quot; totalcountb=&quot;4&quot; indexb=&quot;1&quot; widgetbid=&quot;75&quot; widgetaid=&quot;90&quot; xmi.id=&quot;91&quot; &gt;
+      &lt;linepath&gt;
+       &lt;startpoint startx=&quot;122&quot; starty=&quot;800&quot; /&gt;
+       &lt;endpoint endx=&quot;265&quot; endy=&quot;703&quot; /&gt;
+      &lt;/linepath&gt;
+     &lt;/assocwidget&gt;
+     &lt;assocwidget totalcounta=&quot;2&quot; indexa=&quot;1&quot; visibilityB=&quot;200&quot; totalcountb=&quot;2&quot; indexb=&quot;1&quot; widgetbid=&quot;75&quot; widgetaid=&quot;57&quot; roleBdoc=&quot;&quot; documentation=&quot;&quot; roleAdoc=&quot;&quot; type=&quot;509&quot; changeabilityA=&quot;900&quot; changeabilityB=&quot;900&quot; visibilityA=&quot;200&quot; &gt;
+      &lt;linepath&gt;
+       &lt;startpoint startx=&quot;297&quot; starty=&quot;408&quot; /&gt;
+       &lt;endpoint endx=&quot;299&quot; endy=&quot;621&quot; /&gt;
+      &lt;/linepath&gt;
+      &lt;floatingtext usesdiagramfillcolour=&quot;1&quot; width=&quot;14&quot; usesdiagramusefillcolour=&quot;1&quot; x=&quot;281&quot; linecolour=&quot;none&quot; y=&quot;410&quot; linewidth=&quot;none&quot; usesdiagramlinewidth=&quot;1&quot; posttext=&quot;&quot; usesdiagramlinecolour=&quot;1&quot; role=&quot;701&quot; fillcolour=&quot;none&quot; height=&quot;19&quot; usefillcolor=&quot;1&quot; pretext=&quot;&quot; isinstance=&quot;0&quot; xmi.id=&quot;99&quot; text=&quot;1&quot; font=&quot;Sans,8,-1,5,50,0,0,0,0,0&quot; /&gt;
+      &lt;floatingtext usesdiagramfillcolour=&quot;1&quot; width=&quot;12&quot; usesdiagramusefillcolour=&quot;1&quot; x=&quot;301&quot; linecolour=&quot;none&quot; y=&quot;600&quot; linewidth=&quot;none&quot; usesdiagramlinewidth=&quot;1&quot; posttext=&quot;&quot; usesdiagramlinecolour=&quot;1&quot; role=&quot;702&quot; fillcolour=&quot;none&quot; height=&quot;19&quot; usefillcolor=&quot;1&quot; pretext=&quot;&quot; isinstance=&quot;0&quot; xmi.id=&quot;101&quot; text=&quot;*&quot; font=&quot;Sans,8,-1,5,50,0,0,0,0,0&quot; /&gt;
+     &lt;/assocwidget&gt;
+     &lt;assocwidget totalcounta=&quot;2&quot; indexa=&quot;1&quot; visibilityB=&quot;200&quot; totalcountb=&quot;2&quot; indexb=&quot;1&quot; widgetbid=&quot;103&quot; widgetaid=&quot;107&quot; roleBdoc=&quot;&quot; documentation=&quot;&quot; roleAdoc=&quot;&quot; type=&quot;513&quot; changeabilityA=&quot;900&quot; changeabilityB=&quot;900&quot; visibilityA=&quot;200&quot; &gt;
+      &lt;linepath&gt;
+       &lt;startpoint startx=&quot;529&quot; starty=&quot;578&quot; /&gt;
+       &lt;endpoint endx=&quot;456&quot; endy=&quot;620&quot; /&gt;
+      &lt;/linepath&gt;
+     &lt;/assocwidget&gt;
+    &lt;/associations&gt;
+   &lt;/diagram&gt;
+  &lt;/diagrams&gt;
+  &lt;listview&gt;
+   &lt;listitem open=&quot;1&quot; type=&quot;800&quot; label=&quot;Views&quot; &gt;
+    &lt;listitem open=&quot;1&quot; type=&quot;801&quot; label=&quot;Logical View&quot; &gt;
+     &lt;listitem open=&quot;1&quot; type=&quot;813&quot; id=&quot;45&quot; &gt;
+      &lt;listitem open=&quot;0&quot; type=&quot;815&quot; id=&quot;46&quot; /&gt;
+      &lt;listitem open=&quot;0&quot; type=&quot;815&quot; id=&quot;47&quot; /&gt;
+      &lt;listitem open=&quot;0&quot; type=&quot;815&quot; id=&quot;48&quot; /&gt;
+     &lt;/listitem&gt;
+     &lt;listitem open=&quot;1&quot; type=&quot;813&quot; id=&quot;49&quot; &gt;
+      &lt;listitem open=&quot;0&quot; type=&quot;814&quot; id=&quot;50&quot; /&gt;
+      &lt;listitem open=&quot;0&quot; type=&quot;814&quot; id=&quot;51&quot; /&gt;
+      &lt;listitem open=&quot;0&quot; type=&quot;814&quot; id=&quot;52&quot; /&gt;
+      &lt;listitem open=&quot;0&quot; type=&quot;814&quot; id=&quot;53&quot; /&gt;
+      &lt;listitem open=&quot;0&quot; type=&quot;814&quot; id=&quot;54&quot; /&gt;
+      &lt;listitem open=&quot;0&quot; type=&quot;814&quot; id=&quot;55&quot; /&gt;
+      &lt;listitem open=&quot;0&quot; type=&quot;814&quot; id=&quot;56&quot; /&gt;
+     &lt;/listitem&gt;
+     &lt;listitem open=&quot;1&quot; type=&quot;813&quot; id=&quot;57&quot; &gt;
+      &lt;listitem open=&quot;1&quot; type=&quot;813&quot; id=&quot;75&quot; &gt;
+       &lt;listitem open=&quot;0&quot; type=&quot;815&quot; id=&quot;87&quot; /&gt;
+       &lt;listitem open=&quot;0&quot; type=&quot;815&quot; id=&quot;95&quot; /&gt;
+       &lt;listitem open=&quot;0&quot; type=&quot;815&quot; id=&quot;96&quot; /&gt;
+       &lt;listitem open=&quot;0&quot; type=&quot;815&quot; id=&quot;97&quot; /&gt;
+      &lt;/listitem&gt;
+      &lt;listitem open=&quot;0&quot; type=&quot;815&quot; id=&quot;102&quot; /&gt;
+     &lt;/listitem&gt;
+     &lt;listitem open=&quot;1&quot; type=&quot;813&quot; id=&quot;77&quot; &gt;
+      &lt;listitem open=&quot;0&quot; type=&quot;815&quot; id=&quot;89&quot; /&gt;
+     &lt;/listitem&gt;
+     &lt;listitem open=&quot;1&quot; type=&quot;813&quot; id=&quot;90&quot; &gt;
+      &lt;listitem open=&quot;0&quot; type=&quot;815&quot; id=&quot;94&quot; /&gt;
+     &lt;/listitem&gt;
+     &lt;listitem open=&quot;1&quot; type=&quot;813&quot; id=&quot;66&quot; /&gt;
+     &lt;listitem open=&quot;1&quot; type=&quot;813&quot; id=&quot;62&quot; /&gt;
+     &lt;listitem open=&quot;1&quot; type=&quot;813&quot; id=&quot;103&quot; &gt;
+      &lt;listitem open=&quot;0&quot; type=&quot;815&quot; id=&quot;104&quot; /&gt;
+      &lt;listitem open=&quot;0&quot; type=&quot;815&quot; id=&quot;105&quot; /&gt;
+     &lt;/listitem&gt;
+     &lt;listitem open=&quot;1&quot; type=&quot;813&quot; id=&quot;76&quot; &gt;
+      &lt;listitem open=&quot;0&quot; type=&quot;815&quot; id=&quot;88&quot; /&gt;
+     &lt;/listitem&gt;
+     &lt;listitem open=&quot;1&quot; type=&quot;813&quot; id=&quot;70&quot; &gt;
+      &lt;listitem open=&quot;0&quot; type=&quot;815&quot; id=&quot;71&quot; /&gt;
+      &lt;listitem open=&quot;0&quot; type=&quot;815&quot; id=&quot;72&quot; /&gt;
+      &lt;listitem open=&quot;0&quot; type=&quot;815&quot; id=&quot;73&quot; /&gt;
+      &lt;listitem open=&quot;0&quot; type=&quot;815&quot; id=&quot;74&quot; /&gt;
+     &lt;/listitem&gt;
+     &lt;listitem open=&quot;1&quot; type=&quot;813&quot; id=&quot;58&quot; &gt;
+      &lt;listitem open=&quot;0&quot; type=&quot;814&quot; id=&quot;60&quot; /&gt;
+      &lt;listitem open=&quot;0&quot; type=&quot;814&quot; id=&quot;61&quot; /&gt;
+      &lt;listitem open=&quot;0&quot; type=&quot;815&quot; id=&quot;59&quot; /&gt;
+     &lt;/listitem&gt;
+     &lt;listitem open=&quot;1&quot; type=&quot;813&quot; id=&quot;31&quot; &gt;
+      &lt;listitem open=&quot;0&quot; type=&quot;815&quot; id=&quot;35&quot; /&gt;
+      &lt;listitem open=&quot;0&quot; type=&quot;815&quot; id=&quot;36&quot; /&gt;
+      &lt;listitem open=&quot;0&quot; type=&quot;815&quot; id=&quot;37&quot; /&gt;
+      &lt;listitem open=&quot;0&quot; type=&quot;815&quot; id=&quot;38&quot; /&gt;
+      &lt;listitem open=&quot;0&quot; type=&quot;815&quot; id=&quot;39&quot; /&gt;
+      &lt;listitem open=&quot;0&quot; type=&quot;815&quot; id=&quot;40&quot; /&gt;
+      &lt;listitem open=&quot;0&quot; type=&quot;815&quot; id=&quot;41&quot; /&gt;
+      &lt;listitem open=&quot;0&quot; type=&quot;815&quot; id=&quot;42&quot; /&gt;
+      &lt;listitem open=&quot;0&quot; type=&quot;815&quot; id=&quot;43&quot; /&gt;
+      &lt;listitem open=&quot;0&quot; type=&quot;815&quot; id=&quot;44&quot; /&gt;
+     &lt;/listitem&gt;
+     &lt;listitem open=&quot;1&quot; type=&quot;813&quot; id=&quot;27&quot; /&gt;
+     &lt;listitem open=&quot;1&quot; type=&quot;817&quot; id=&quot;19&quot; &gt;
+      &lt;listitem open=&quot;0&quot; type=&quot;815&quot; id=&quot;21&quot; /&gt;
+      &lt;listitem open=&quot;0&quot; type=&quot;815&quot; id=&quot;24&quot; /&gt;
+      &lt;listitem open=&quot;0&quot; type=&quot;815&quot; id=&quot;25&quot; /&gt;
+      &lt;listitem open=&quot;0&quot; type=&quot;815&quot; id=&quot;26&quot; /&gt;
+      &lt;listitem open=&quot;0&quot; type=&quot;815&quot; id=&quot;29&quot; /&gt;
+     &lt;/listitem&gt;
+     &lt;listitem open=&quot;1&quot; type=&quot;830&quot; label=&quot;Datatypes&quot; &gt;
+      &lt;listitem open=&quot;1&quot; type=&quot;829&quot; id=&quot;22&quot; /&gt;
+     &lt;/listitem&gt;
+    &lt;/listitem&gt;
+    &lt;listitem open=&quot;1&quot; type=&quot;802&quot; label=&quot;Use Case View&quot; /&gt;
+    &lt;listitem open=&quot;1&quot; type=&quot;821&quot; label=&quot;Component View&quot; /&gt;
+    &lt;listitem open=&quot;1&quot; type=&quot;827&quot; label=&quot;Deployment View&quot; /&gt;
+    &lt;listitem open=&quot;1&quot; type=&quot;836&quot; label=&quot;Entity Relationship Model&quot; /&gt;
+   &lt;/listitem&gt;
+  &lt;/listview&gt;
+  &lt;codegeneration&gt;
+   &lt;codegenerator language=&quot;Python&quot; /&gt;
+  &lt;/codegeneration&gt;
+ &lt;/XMI.extensions&gt;
+&lt;/XMI&gt;

Added: trunk/tools/pydar2/log4py.conf
===================================================================
--- trunk/tools/pydar2/log4py.conf	2005-04-16 09:25:14 UTC (rev 3136)
+++ trunk/tools/pydar2/log4py.conf	2005-04-18 20:36:17 UTC (rev 3137)
@@ -0,0 +1,96 @@
+# Log4Py configuration file
+#
+# The &quot;Default&quot; Sections contains default settings which can be overwritten
+# by settings for different instances (see bottom of file)
+
+[Default]
+
+# Format is the output format of the lines.
+#
+# Possible parameters are:
+#
+#    %C ..... class-name
+#    %D ..... program duration
+#    %d ..... duration for the last step (last output)
+#    %F ..... function name
+#    %L ..... logtype (Error, Warning, ...)
+#    %M ..... message
+#    %N ..... Line-number
+#    %T ..... current time
+#
+# Example formats are:
+#
+#    Short:           %M
+#    Medium:          [ %C.%F ] %D: %M
+#    Long (default):  %T %L %C [%F] - %M
+#    Debug:           %T [%D (%d)] %L %C [%F (%N)] - %M
+
+Format: %T %L %C [%F:%N] - %M
+
+# Target controls the output medium of the logging
+#
+# Possible values are:
+#
+#    stdout (default): Standard output stream
+#    stderr:           Error stream
+#    &lt;filename&gt;        Any other filename
+#
+# Multiple targets can be specified as comma seperated list
+
+Target: stdout
+
+# Use ansi colors. Possible values are True or False (default)
+
+Ansi: False
+
+# TimeFormat is the format of the date and time as used by the
+# Python strftime() function
+
+# TimeFormat: %d.%m.%Y %H:%M:%S
+
+# LogLevel controls the level of what you want to see
+#
+# Possible values are:
+#
+#    None:             No output (silent mode)
+#    Normal (default): Information- and Errormessages
+#    Verbose:          Information-, Error- and Warningmessages
+#    Debug:            Information-, Error-, Warning- and Debugmessages
+
+LogLevel: Debug
+
+# This is a section for the Log4PyTest class.
+
+[Log4PyTest]
+SpecFile: Debug
+foo: Debug
+SvnCheck: Debug
+Store: Debug
+SpecRepository: Debug
+Config: Debug
+Storage: Debug
+PostgresqlStorage: Debug
+SpecRepositoryFactory: Debug
+BuildRoot: Debug
+BuildRootResult: Debug
+Command: Debug
+Config: Debug
+CvsBasedSpecRepository: Debug
+FilesBasedSpecRepository:: Debug
+MemoryStorage:: Debug
+PostgresqlStorage:: Debug
+PydarClient: Debug
+RpmFile: Debug
+RpmsCheck: Debug
+SpecFile: Debug
+SpecRepositoryFactory: Debug
+SpecRepositoryList: Debug
+SpecRepository: Debug
+SpecRepositorySpecFile: Debug
+StorageFactory: Debug
+Storage: Debug
+SvnBasedSpecRepository:  Debug
+SvnCheck: Debug
+SvnWrapper: Debug
+TagsFile: Debug
+YumBasedBuildRoot: Debug

Modified: trunk/tools/pydar2/perlpackages/check.pl
===================================================================
--- trunk/tools/pydar2/perlpackages/check.pl	2005-04-16 09:25:14 UTC (rev 3136)
+++ trunk/tools/pydar2/perlpackages/check.pl	2005-04-18 20:36:17 UTC (rev 3137)
@@ -15,6 +15,9 @@
 # This list can be generated with packageslist.sh from 
 # the spec files
 
+
+my $currentperlpackage = &quot;&quot;;
+
 sub geturl {
 	my $url = pop(@_);
 	my $u = URI::URL-&gt;new($url, &quot;&quot;);
@@ -77,7 +80,7 @@
 	} else {
 		print &quot;first href not found&quot;;
 	}
-	die &quot;could not get the name + email&quot;;
+	die $currentperlpackage . &quot;: could not get the name + email&quot;;
 }
 
 sub createspec {
@@ -99,12 +102,25 @@
 		$sourceurlpart = &quot;<A HREF="http://search.cpan.org">http://search.cpan.org</A>&quot; . $1;
 		$speccontents =~ s|Source: |Source: $sourceurlpart|g;
 	}
-
+	$readmecontents = &quot;&quot;;
+        if ($urlcontents =~ /&lt;a href=&quot;(\/src\/.*?\/README)&quot;&gt;README&lt;\/a&gt;&lt;br&gt;/) {
+                $readmeurl = &quot;<A HREF="http://search.cpan.org">http://search.cpan.org</A>&quot; . $1;
+                $readmecontents = geturl($readmeurl);
+                
+        }
+	
 	#print $speccontents;
-	mkdir(&quot;../../../rpms/perl-$packagename&quot;);
-	open (TMP, &quot;&gt;&quot; . $specfilename . &quot;.autocreate&quot;) or die &quot;could not write to &quot; . $specfilename . &quot;.autocreate&quot;;
+	mkdir(&quot;../../../rpms/newperlpackages/perl-$packagename&quot;);
+	open (TMP, &quot;&gt;&quot; . $specfilename) or die &quot;could not write to &quot; . $specfilename;
 	print TMP  $speccontents;
 	close(TMP);
+	open (TMP, &quot;&gt;&quot; . &quot;../../../rpms/newperlpackages/perl-$packagename/perlpage.html&quot;) or die &quot;perlpage.html&quot;;
+	print TMP $urlcontents;
+	close (TMP);
+	open (TMP, &quot;&gt;&quot; . &quot;../../../rpms/newperlpackages/perl-$packagename/README&quot;) or die &quot;README&quot;;
+	print TMP $readmecontents;
+	close (TMP);
+	
 	print &quot;cd perl-$packagename; mv perl-$packagename.spec.autocreate perl-$packagename.spec; spectool perl-$packagename.spec;\n&quot;;
 
 }
@@ -118,7 +134,7 @@
 	if ($urlcontents =~ /&lt;td class=cell&gt;$packagename-(.*?)&lt;\/td&gt;/) {
 		$latestversion = $1;
 	}
-	my $specfilename = &quot;../../../rpms/perl-$packagename/perl-$packagename.spec&quot;;
+	my $specfilename = &quot;../../../rpms/newperlpackages/perl-$packagename/perl-$packagename.spec&quot;;
 
 	if ( -e $specfilename ) {
 		updatespec($url,$urlcontents,$latestversion,$specfilename,$packagename);
@@ -131,6 +147,7 @@
 # read the list from stdin
 while ($packagename = &lt;&gt;) {
 	chomp $packagename;
-#	print &quot;package: &quot; . $packagename .  &quot;\n&quot;;
+	print &quot;package: &quot; . $packagename .  &quot;\n&quot;;
+	$currentperlpackage = $packagename;
 	checkspec ($packagename);
 }
\ No newline at end of file

Modified: trunk/tools/pydar2/perlpackages/perltemplate.spec
===================================================================
--- trunk/tools/pydar2/perlpackages/perltemplate.spec	2005-04-16 09:25:14 UTC (rev 3136)
+++ trunk/tools/pydar2/perlpackages/perltemplate.spec	2005-04-18 20:36:17 UTC (rev 3137)
@@ -1,28 +1,24 @@
 # $Id$
-
 # Authority: dries
 # Upstream: UPSTREAMTAG
 
-%define real_name NNAAMMEE
 %define perl_vendorlib %(eval &quot;`perl -V:installvendorlib`&quot;; echo $installvendorlib)
 %define perl_vendorarch %(eval &quot;`perl -V:installvendorarch`&quot;; echo $installvendorarch)
-%define perl_archlib %(eval &quot;`perl -V:archlib`&quot;; echo $archlib)
-%define perl_privlib %(eval &quot;`perl -V:privlib`&quot;; echo $privlib)
 
+%define real_name NNAAMMEE
+
 Summary: 
 Name: perl-NNAAMMEE
 Version: 
 Release: 1
-License: Artistic
+License: Artistic/GPL
 Group: Applications/CPAN
 URL: <A HREF="http://search.cpan.org/dist/NNAAMMEE/">http://search.cpan.org/dist/NNAAMMEE/</A>
 
-Packager: Dries Verachtert &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dries at ulyssis.org</A>&gt;
-Vendor: Dries Apt/Yum Repository <A HREF="http://dries.ulyssis.org/ayo/">http://dries.ulyssis.org/ayo/</A>
-
 Source: NNAAMMEE-%{version}.tar.gz
 BuildRoot: %{_tmppath}/%{name}-%{version}-%{release}-root
 
+#BuildArch: noarch
 BuildRequires: perl
 
 %description
@@ -31,19 +27,20 @@
 %setup -n %{real_name}-%{version}
 
 %build
-%{__perl} Makefile.PL INSTALLDIRS=&quot;vendor&quot; destdir=%{buildroot}
+%{__perl} Makefile.PL INSTALLDIRS=&quot;vendor&quot; PREFIX=&quot;%{buildroot}%{_prefix}&quot;
 %{__make} %{?_smp_mflags}
 
 %install
 %{__rm} -rf %{buildroot}
 %makeinstall
+#%{__rm} -rf %{buildroot}%{perl_archlib} %{buildroot}%{perl_vendorarch}
 
 %clean
 %{__rm} -rf %{buildroot}
 
 %files
 %defattr(-, root, root, 0755)
-%doc README Changes
+%doc Changes README
 %doc %{_mandir}/man3/*
 #%{perl_vendorlib}/NAMEDIR.pm
 #%{perl_vendorlib}/NAMEDIR/*

Modified: trunk/tools/pydar2/php/el4x86driestodo.php
===================================================================
--- trunk/tools/pydar2/php/el4x86driestodo.php	2005-04-16 09:25:14 UTC (rev 3136)
+++ trunk/tools/pydar2/php/el4x86driestodo.php	2005-04-18 20:36:17 UTC (rev 3137)
@@ -1,7 +1,7 @@
 &lt;?php
     $fullname = &quot;Red Hat Enterprise Linux 4 x86 (dries)&quot;;
     $buildscript = &quot;./el4build&quot;;
-    $releasetag = &quot;.1.el4.rf&quot;;
+    $releasetag = &quot;.2.el4.rf&quot;;
     $authority = &quot;dries&quot;;
     include(&quot;stats.php&quot;);
 ?&gt;
\ No newline at end of file

Modified: trunk/tools/pydar2/php/navigation.php
===================================================================
--- trunk/tools/pydar2/php/navigation.php	2005-04-16 09:25:14 UTC (rev 3136)
+++ trunk/tools/pydar2/php/navigation.php	2005-04-18 20:36:17 UTC (rev 3137)
@@ -8,6 +8,7 @@
     &lt;div class=&quot;navitem&quot;&gt;&lt;a class=&quot;navitem&quot; href=&quot;<A HREF="http://dries.ulyssis.org/ayo/fedora/fc2/i386/RPMS.dries">http://dries.ulyssis.org/ayo/fedora/fc2/i386/RPMS.dries</A>&quot;&gt;fc2 i386 rpms&lt;/a&gt;&lt;/div&gt;
     &lt;div class=&quot;navitem&quot;&gt;&lt;a class=&quot;navitem&quot; href=&quot;<A HREF="http://dries.ulyssis.org/ayo/fedora/fc1/i386/RPMS.dries">http://dries.ulyssis.org/ayo/fedora/fc1/i386/RPMS.dries</A>&quot;&gt;fc1 i386 rpms&lt;/a&gt;&lt;/div&gt;
     &lt;div class=&quot;navitem&quot;&gt;&lt;a class=&quot;navitem&quot; href=&quot;<A HREF="http://dries.ulyssis.org/ayo/redhat/el3/en/i386/RPMS.dries">http://dries.ulyssis.org/ayo/redhat/el3/en/i386/RPMS.dries</A>&quot;&gt;el3 i386 rpms&lt;/a&gt;&lt;/div&gt;
+    &lt;div class=&quot;navitem&quot;&gt;&lt;a class=&quot;navitem&quot; href=&quot;<A HREF="http://dries.ulyssis.org/ayo/redhat/el4/en/i386/RPMS.dries">http://dries.ulyssis.org/ayo/redhat/el4/en/i386/RPMS.dries</A>&quot;&gt;el4 i386 rpms&lt;/a&gt;&lt;/div&gt;
     &lt;div class=&quot;navitem&quot;&gt;&lt;a class=&quot;navitem&quot; href=&quot;<A HREF="http://dries.ulyssis.org/ayo/aurora/1.92/sparc/RPMS.dries">http://dries.ulyssis.org/ayo/aurora/1.92/sparc/RPMS.dries</A>&quot;&gt;au 1.92 rpms&lt;/a&gt;&lt;/div&gt;
     &lt;div class=&quot;navitem&quot;&gt;&lt;a class=&quot;navitem&quot; href=&quot;<A HREF="http://dries.ulyssis.org/ayo/aurora/1.91/sparc/RPMS.dries">http://dries.ulyssis.org/ayo/aurora/1.91/sparc/RPMS.dries</A>&quot;&gt;au 1.91 rpms&lt;/a&gt;&lt;/div&gt;
     &lt;div class=&quot;navpart&quot;&gt;Build system:&lt;/div&gt;
@@ -20,6 +21,7 @@
     &lt;div class=&quot;navitem&quot;&gt;&lt;a class=&quot;navitem&quot; href=&quot;<A HREF="http://pydar2.vmhosting.org/auroratodo.php">http://pydar2.vmhosting.org/auroratodo.php</A>&quot;&gt;Todo au1.92&lt;/a&gt;&lt;/div&gt;
     &lt;div class=&quot;navitem&quot;&gt;&lt;a class=&quot;navitem&quot; href=&quot;<A HREF="http://pydar2.vmhosting.org/auroradriestodo.php">http://pydar2.vmhosting.org/auroradriestodo.php</A>&quot;&gt;Todo au1.92/dries&lt;/a&gt;&lt;/div&gt;
     &lt;div class=&quot;navitem&quot;&gt;&lt;a class=&quot;navitem&quot; href=&quot;<A HREF="http://pydar2.vmhosting.org/el3x86driestodo.php">http://pydar2.vmhosting.org/el3x86driestodo.php</A>&quot;&gt;Todo el3/x86/dries&lt;/a&gt;&lt;/div&gt;
+    &lt;div class=&quot;navitem&quot;&gt;&lt;a class=&quot;navitem&quot; href=&quot;<A HREF="http://pydar2.vmhosting.org/el4x86driestodo.php">http://pydar2.vmhosting.org/el4x86driestodo.php</A>&quot;&gt;Todo el4/x86/dries&lt;/a&gt;&lt;/div&gt;
     &lt;div class=&quot;navpart&quot;&gt;Other repo's:&lt;/div&gt;
     &lt;div class=&quot;navitem&quot;&gt;&lt;a class=&quot;navitem&quot; href=&quot;<A HREF="http://dag.wieers.com/home-made/apt">http://dag.wieers.com/home-made/apt</A>&quot;&gt;DAG&lt;/a&gt;&lt;/div&gt;
     &lt;div class=&quot;navitem&quot;&gt;&lt;a class=&quot;navitem&quot; href=&quot;<A HREF="http://freshrpms.net">http://freshrpms.net</A>&quot;&gt;Freshrpms&lt;/a&gt;&lt;/div&gt;

Modified: trunk/tools/pydar2/pydar/buildroot.py
===================================================================
--- trunk/tools/pydar2/pydar/buildroot.py	2005-04-16 09:25:14 UTC (rev 3136)
+++ trunk/tools/pydar2/pydar/buildroot.py	2005-04-18 20:36:17 UTC (rev 3137)
@@ -18,7 +18,7 @@
 
 # normally you don't use this class but a subclass which implements 
 # these functions
-# for example: YmBasedBuildRoot
+# for example: YumBasedBuildRoot
 
 # example usage:
 # fc3br = BlaBlaBuildRoot(cfg,'fedora-3-i386-core')

Modified: trunk/tools/pydar2/pydar/buildrootresult.py
===================================================================
--- trunk/tools/pydar2/pydar/buildrootresult.py	2005-04-16 09:25:14 UTC (rev 3136)
+++ trunk/tools/pydar2/pydar/buildrootresult.py	2005-04-18 20:36:17 UTC (rev 3137)
@@ -20,23 +20,34 @@
 
 
 class BuildRootResult:
-    __init__(self,buildrootobj):
-        self.buildrootobj = buildrootobj
-        self.containsErrors = 0
-        self.containsWarnings = 0
-        self.logText = &quot;&quot;
-        self.srpm = &quot;&quot;
-        self.rpms = []
-        self.buildlog = &quot;&quot;
-        self.configlog = &quot;&quot;
+    def __init__(self,buildrootobj):
+        self.__buildrootobj = buildrootobj
+        self.__containsErrors = 0
+        self.__containsWarnings = 0
+        self.__logText = &quot;&quot;
+        self.__srpm = &quot;&quot;
+        self.__rpms = []
+        self.__buildlog = &quot;&quot;
+        self.__configlog = &quot;&quot;
         
     def logErrorLine(self,line):
-        self.logText = self.logText + &quot;ERROR:&quot; + line + &quot;\n&quot;
+        self.__logText = self.__logText + &quot;ERROR:&quot; + line + &quot;\n&quot;
         print &quot;ERROR:&quot; + line
-        self.containsErrors = 1
+        self.__containsErrors = 1
         
     def logDebugLine(self,line):
-        self.logText = self.logText + line + &quot;\n&quot;
+        self.__logText = self.__logText + line + &quot;\n&quot;
         print line
         
+    def getRpms(self):
+        return self.__rpms
+
+    def getSrpm(self):
+        return self.__srpm
+    
+    def getBuildLog(self):
+        return self.__buildlog
         
+    def getConfigLog(self):
+        return self.__configlog
+    

Modified: trunk/tools/pydar2/pydar/config.py
===================================================================
--- trunk/tools/pydar2/pydar/config.py	2005-04-16 09:25:14 UTC (rev 3136)
+++ trunk/tools/pydar2/pydar/config.py	2005-04-18 20:36:17 UTC (rev 3137)
@@ -1,4 +1,3 @@
-
 #!/usr/bin/python
 
 &quot;&quot;&quot; Contains some settings for pydar &quot;&quot;&quot;
@@ -18,11 +17,53 @@
 # Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
 # Copyright 2004 Dries Verachtert
 
-import ConfigParser, os
+import ConfigParser, os, posixpath, sys
+sys.path.append(&quot;pydar&quot;)
+sys.path.append(&quot;.&quot;)
+from specrepository import SpecRepository
+from specrepositoryfactory import SpecRepositoryFactory
+from specrepositorylist import SpecRepositoryList
+from log4py import Logger
 
 class Config:
+    __myInstance = None
+    __fullInitDone = False
+    __withinFullInit = False
+    
     def __init__(self):
-               
+        if Config.__myInstance != None:
+            raise Exception(&quot;use Config.getInstance()&quot;)
+        Config.__myInstance = self
+        print &quot;Config::__init__ __myInstance=&quot; + str(self.__myInstance)
+    
+    def getInstance(cls):
+        if cls.__myInstance == None:
+            unused = Config()
+        print &quot;Config::getInstance __myInstance=&quot; + str(cls.__myInstance)
+        return cls.__myInstance
+    getInstance = classmethod(getInstance)
+    
+    def getSpecReposRootDir(self):
+        self.__fullInit()
+        return self.__specreposrootdir
+    
+    def getPostgresqlConnectString(self):
+        self.__fullInit()
+        # @todo
+        return self.__dbconnectstring
+        
+    
+    def __fullInit(self):
+        if Config.__fullInitDone or Config.__withinFullInit:
+            return
+        Config.__withinFullInit = True
+        self.__cat = Logger().get_instance(self)
+        self.__cat.debug(&quot;start&quot;)
+        
+        # the userid which is used by the pydar-master-update.py program
+        self.updateUserId = 0
+ 
+        # old stuff
         myParser = ConfigParser.ConfigParser()
         try:
             myParser.readfp(open('/usr/share/pydar/defaults.conf'))
@@ -44,7 +85,8 @@
         self.releaseTag = myParser.get('client','defaultreleasetag')
         self.machRoot = myParser.get('client','defaultmachroot')
         self.userid = myParser.get('client','userid')
-        self.dbconnectstring = myParser.get('master','dbconnectstring')
+        self.__dbconnectstring = myParser.get('master','dbconnectstring')
+        self.__cat.debug('dbconnectstring set to:' + self.__dbconnectstring)
         self.buildmachineid = myParser.get('slave','buildmachineid')
         self.dirtestbuilds = myParser.get('slave','dirtestbuilds')
 
@@ -53,4 +95,40 @@
         # get the supported machroots
         self.machroots = []
         for key in myParser.options('machroots'):
-            self.machroots.append(myParser.get('machroots',key))
\ No newline at end of file
+            self.machroots.append(myParser.get('machroots',key))
+        
+        
+        
+        
+        # todo: rewrite this stuff so everything is read from some nice configuration files
+        self.__specreposrootdir=&quot;/var/lib/pydar2/specrepos&quot;
+        self.__specRepositoryList = SpecRepositoryList()
+        
+        # some default info, should be read from some files
+        #sr = SpecRepository(&quot;rpmforge&quot;,SpecRepository.TYPE_SVN,self.specreposrootdir + &quot;/rpmforge/rpms&quot;)
+        srf = SpecRepositoryFactory.getInstance();
+        sr = srf.createSpecRepository(&quot;rpmforge&quot;,SpecRepository.TYPE_SVN,self.__specreposrootdir + &quot;/rpmforge/rpms&quot;)
+        self.getSpecRepositoryList().add(sr)
+        #sr = SpecRepository(&quot;pld&quot;,SpecRepository.TYPE_CVS,self.specreposrootdir + &quot;/pld/SPECS&quot;)
+        sr = srf.createSpecRepository(&quot;pld&quot;,SpecRepository.TYPE_CVS,self.__specreposrootdir + &quot;/pld/SPECS&quot;)
+        self.getSpecRepositoryList().add(sr)
+        #sr = SpecRepository(&quot;fedoraextrasdevel&quot;,SpecRepository.TYPE_CVS,self.specreposrootdir + &quot;/fedoraextrasdevel&quot;)
+        #self.specrepositories.append(sr)
+        #sr = SpecRepository(&quot;local&quot;,SpecRepositoryFactory.TYPE_FILES,self.specreposrootdir + &quot;/local&quot;)
+        sr = srf.createSpecRepository(&quot;local&quot;,SpecRepository.TYPE_FILES,self.__specreposrootdir + &quot;/local&quot;)
+        self.getSpecRepositoryList().add(sr)
+ 
+        __withinFullInit = False
+        __fullInitDone = True
+        self.__cat.debug('end')
+        
+
+    # must be able to respond to this function without a loaded Storage instance!
+    def getStorageType(self):
+        #self.__fullInit()
+        return 1;
+            
+    def getSpecRepositoryList(self):
+        self.__fullInit()
+        return self.__specRepositoryList
+        

Added: trunk/tools/pydar2/pydar/cvsbasedspecrepository.py
===================================================================
--- trunk/tools/pydar2/pydar/cvsbasedspecrepository.py	2005-04-16 09:25:14 UTC (rev 3136)
+++ trunk/tools/pydar2/pydar/cvsbasedspecrepository.py	2005-04-18 20:36:17 UTC (rev 3137)
@@ -0,0 +1,37 @@
+#!/usr/bin/python
+
+&quot;&quot;&quot; Contains the information about a cvs source of spec files &quot;&quot;&quot;
+
+# This program is free software; you can redistribute it and/or modify
+# it under the terms of the GNU General Public License as published by
+# the Free Software Foundation; either version 2 of the License, or
+# (at your option) any later version.
+#
+# This program is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+# GNU Library General Public License for more details.
+#
+# You should have received a copy of the GNU General Public License
+# along with this program; if not, write to the Free Software
+# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
+# Copyright 2004 Dries Verachtert
+
+import ConfigParser, os, posixpath, sys
+sys.path.append(&quot;pydar&quot;)
+sys.path.append(&quot;.&quot;)
+from log4py import Logger
+from specrepository import SpecRepository
+#from specrepositoryfactory import SpecRepositoryFactory
+
+class CvsBasedSpecRepository(SpecRepository):
+    # name: ascii name, for example 'rpmforge'
+    # type: a constant, can be one of &quot;SVN&quot;, &quot;CVS&quot;, &quot;FILES&quot;
+    def __init__(self, name, rootdirectory):
+        SpecRepository.__init__(self, name, rootdirectory)
+        self.__cat = Logger().get_instance(self)
+        self._setType(SpecRepository.TYPE_CVS)
+        self.__cat.debug(&quot;initialized&quot;)
+        
+    def getUpdateCommand(self):
+        return &quot;cd &quot; + self.getRootDirectory() + &quot;; cvs update&quot;

Added: trunk/tools/pydar2/pydar/filesbasedspecrepository.py
===================================================================
--- trunk/tools/pydar2/pydar/filesbasedspecrepository.py	2005-04-16 09:25:14 UTC (rev 3136)
+++ trunk/tools/pydar2/pydar/filesbasedspecrepository.py	2005-04-18 20:36:17 UTC (rev 3137)
@@ -0,0 +1,37 @@
+#!/usr/bin/python
+
+&quot;&quot;&quot; Contains the information about a files source of spec files &quot;&quot;&quot;
+
+# This program is free software; you can redistribute it and/or modify
+# it under the terms of the GNU General Public License as published by
+# the Free Software Foundation; either version 2 of the License, or
+# (at your option) any later version.
+#
+# This program is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+# GNU Library General Public License for more details.
+#
+# You should have received a copy of the GNU General Public License
+# along with this program; if not, write to the Free Software
+# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
+# Copyright 2004 Dries Verachtert
+
+import ConfigParser, os, posixpath, sys
+sys.path.append(&quot;pydar&quot;)
+sys.path.append(&quot;.&quot;)
+from log4py import Logger
+from specrepository import SpecRepository
+#from specrepositoryfactory import SpecRepositoryFactory
+
+class FilesBasedSpecRepository(SpecRepository):
+    # name: ascii name, for example 'rpmforge'
+    # type: a constant, can be one of &quot;SVN&quot;, &quot;CVS&quot;, &quot;FILES&quot;
+    def __init__(self, name, rootdirectory):
+        SpecRepository.__init__(self, name, rootdirectory)
+        self.__cat = Logger().get_instance(self)
+        self._setType(SpecRepository.TYPE_FILES)
+        self.__cat.debug(&quot;initialized&quot;)
+        
+    def getUpdateCommand(self):
+        return &quot;&quot;

Added: trunk/tools/pydar2/pydar/memorystorage.py
===================================================================
--- trunk/tools/pydar2/pydar/memorystorage.py	2005-04-16 09:25:14 UTC (rev 3136)
+++ trunk/tools/pydar2/pydar/memorystorage.py	2005-04-18 20:36:17 UTC (rev 3137)
@@ -0,0 +1,30 @@
+
+&quot;&quot;&quot; This class contains all the functions for storing stuff in memory &quot;&quot;&quot;
+
+# This program is free software; you can redistribute it and/or modify
+# it under the terms of the GNU General Public License as published by
+# the Free Software Foundation; either version 2 of the License, or
+# (at your option) any later version.
+#
+# This program is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+# GNU Library General Public License for more details.
+#
+# You should have received a copy of the GNU General Public License
+# along with this program; if not, write to the Free Software
+# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
+# Copyright 2004 Dries Verachtert
+
+from command import Command
+from log4py import Logger
+import pgdb, posixpath, posix, string
+
+# needs to be rewritten so it uses only arrays/hashes
+
+class MemoryStorage(Storage):
+    def __init__(self,myconfig):
+        self.cat = Logger().get_instance(self)
+        self.config = myconfig
+        self.cat.debug(&quot;initialized&quot;)
+        raise Exception(&quot;MemoryStorage is not yet implemented&quot;)

Added: trunk/tools/pydar2/pydar/postgresqlstorage.py
===================================================================
--- trunk/tools/pydar2/pydar/postgresqlstorage.py	2005-04-16 09:25:14 UTC (rev 3136)
+++ trunk/tools/pydar2/pydar/postgresqlstorage.py	2005-04-18 20:36:17 UTC (rev 3137)
@@ -0,0 +1,253 @@
+
+&quot;&quot;&quot; This class contains all the functions for storing stuff in the database &quot;&quot;&quot;
+
+# This program is free software; you can redistribute it and/or modify
+# it under the terms of the GNU General Public License as published by
+# the Free Software Foundation; either version 2 of the License, or
+# (at your option) any later version.
+#
+# This program is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+# GNU Library General Public License for more details.
+#
+# You should have received a copy of the GNU General Public License
+# along with this program; if not, write to the Free Software
+# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
+# Copyright 2004 Dries Verachtert
+
+# if you want to have a pydar which works without a database or with another type of database
+# then you have to write a new subclass of Storage
+
+import sys
+sys.path.append(&quot;pydar&quot;)
+sys.path.append(&quot;.&quot;)
+from command import Command
+from log4py import Logger
+import config
+from storage import Storage
+import pgdb, posixpath, posix, string
+
+class PostgresqlStorage(Storage):
+    def __init__(self):
+        self.cat = Logger().get_instance(self)
+        self.cat.debug(&quot;initialized&quot;)
+    
+    def getConfig():
+        raise Exception(&quot;todo getConfig&quot;)
+
+    def getSpecRepositoryFileListToIds(self,specRepo):
+        retval = {}
+        conn = self.__getConnection()
+        cursor = conn.cursor()
+        sql = &quot;select subdir, filename, id from pydar2_specfile where specrepoid=&quot; + str(specRepo.getId())
+        cursor.execute(sql)
+        if cursor.rowcount &gt; 0:
+            arr = cursor.fetchall()
+            for row in arr:
+                subdir = row[0]
+                filename = row[1]
+                id = row[2]
+                retval[subdir + '/' + filename] = id
+        cursor.close()
+        self.__releaseConnection(conn)
+        return retval
+        
+        
+    def saveSpecRepositorySpecFile(self, specRepo, specRepoSpecFile):
+        conn = self.__getConnection()
+        cursor = conn.cursor()
+        if specRepoSpecFile.getId() != None and specRepoSpecFile.getId() &gt;= 0:
+            # it should be in the database..
+            sql = &quot;update pydar2_specfile set filename='&quot; + str(specRepoSpecFile.getFileName()) + &quot;', &quot;
+            sql = sql + &quot; subdir='&quot; + str(specRepoSpecFile.getSubDir()) + &quot;', &quot;
+            sql = sql + &quot; specrepoid=&quot; + str(specRepo.getId()) + &quot;, &quot;
+            sql = sql + &quot; checksum='&quot; + str(specRepoSpecFile.getCheckSum()) + &quot;', &quot;
+            sql = sql + &quot; where id=&quot; + str(specRepoSpecFile.getId())
+            cursor.execute(sql)
+            conn.commit()
+        else:
+            # new spec file, insert it
+            sql = &quot;insert into pydar2_specfile (specrepoid, filename, subdir, checksum) values (&quot;
+            sql = sql + &quot;&quot; + str(specRepo.getId()) + &quot;,&quot;
+            sql = sql + &quot;'&quot; + str(specRepoSpecFile.getFileName()) + &quot;',&quot;
+            sql = sql + &quot;'&quot; + str(specRepoSpecFile.getSubDir()) + &quot;',&quot;
+            sql = sql + &quot;'&quot; + str(specRepoSpecFile.getCheckSum()) + &quot;')&quot;
+            cursor.execute(sql)
+            conn.commit()
+        # now get the id so we can return it
+        cursor.execute(&quot;select id from pydar2_specfile where filename='&quot; + str(specRepoSpecFile.getFileName()) + &quot;' and subdir='&quot; + str(specRepoSpecFile.getSubDir()) + &quot;' and specrepoid=&quot; + str(specRepo.getId()))
+        retval = None
+        if cursor.rowcount &gt; 0:
+            arr = cursor.fetchall()
+            for row in arr:
+                retval = row[0]
+        cursor.close()
+        self.__releaseConnection(conn)
+        return retval
+    
+    def saveSpecRepository(self,specRepo):
+        conn = self.__getConnection()
+        cursor = conn.cursor()
+        cursor.execute(&quot;select * from pydar2_specrepo where name='&quot; + str(specRepo.getName()) + &quot;'&quot;)
+        if cursor.rowcount &gt; 0:
+            # specrepo exists, update it
+            sql = &quot;update pydar2_specrepo set rootdirectory='&quot; + str(specRepo.getRootDirectory()) + &quot;', type='&quot;
+            sql = sql + str(specRepo.getType()) + &quot;', deleted='0' where name='&quot; + str(specRepo.getName()) + &quot;'&quot;
+            cursor.execute(sql)
+            conn.commit()
+        else:
+            # specrepo does not exist, add it
+            sql = &quot;insert into pydar2_specrepo (name, rootdirectory, type) values ('&quot; + str(specRepo.getName()) + &quot;','&quot; + str(specRepo.getRootDirectory()) + &quot;','&quot; + str(specRepo.getType()) + &quot;')&quot;
+            cursor.execute(sql)
+            conn.commit()
+        # now get the id again
+        cursor.execute(&quot;select id from pydar2_specrepo where name='&quot; + str(specRepo.getName()) + &quot;'&quot;)
+        retval = None
+        arr = cursor.fetchall()
+        for row in arr:
+            retval = row[0]
+        cursor.close()
+        self.__releaseConnection(conn)
+        return retval
+        
+    # @todo add some type of connection pooling 
+    def __getConnection(self):
+        conn = pgdb.connect(config.Config.getInstance().getPostgresqlConnectString())
+        return conn
+        
+    def __releaseConnection(self,conn):
+        conn.close()
+    
+    # returns a hash with ( __subDir + '/' + __fileName ) =&gt; ( checksum )
+    def getSpecRepositoryFileListToChecksum(self,specRepo):
+        retval = {}
+        conn = self.__getConnection()
+        cursor = conn.cursor()
+        sql = &quot;select subdir, filename, checksum from pydar2_specfile where specrepoid &quot;
+        sql = sql + &quot;in (select id from pydar2_specrepo where name='&quot; + specRepo.getName() + &quot;')&quot;
+        cursor.execute(sql)
+        if cursor.rowcount &gt; 0:
+            arr = cursor.fetchall()
+            for row in arr:
+                subdir = row[0]
+                filename = row[1]
+                checksum = row[2]
+                retval[subdir + '/' + filename] = checksum
+        cursor.close()
+        self.__releaseConnection(conn)
+        return retval
+        
+    def createCommand(self,commandName,userId,specName,toEmail,releaseTag,machRoot,priority):
+        # spec name can also be the contents of a specfile...
+        self.cat.debug(&quot;start&quot;)
+        aCommand = Command(commandName,userId,specName,toEmail,releaseTag,machRoot,priority)
+        conn = pgdb.connect(self.config.dbconnectstring)
+        cursor = conn.cursor()
+        cursor.execute(&quot;insert into pydar_commands (commandname,userid,specname,toemail,releasetag,machroot,priority) values ('&quot;
+        + aCommand.commandName + &quot;','&quot;
+        + aCommand.userId + &quot;','&quot;
+        + aCommand.specName + &quot;','&quot;
+        + aCommand.toEmail + &quot;','&quot;
+        + aCommand.releaseTag + &quot;','&quot;
+        + aCommand.machRoot + &quot;',&quot;
+        + aCommand.priority + &quot;)&quot;)
+        conn.commit()
+        cursor.close()
+        conn.close()
+
+    def checkIfValidUserId(self, userId):
+        self.cat.debug(&quot;start, userId=&quot; + str(userId))
+        retval = 0
+        conn = pgdb.connect(self.config.dbconnectstring)
+        cursor = conn.cursor()
+        cursor.execute(&quot;select * from pydar_users where id='&quot; + str(userId) + &quot;'&quot;)
+        if cursor.rowcount &gt; 0:
+            retval = 1
+        cursor.close()
+        conn.close()
+        self.cat.debug(&quot;retval=&quot; + str(retval))
+        return retval
+
+    def checkIfValidBuildMachineId(self, buildmachineid):
+        self.cat.debug(&quot;start, id=&quot; + buildmachineid)
+        conn = pgdb.connect(self.config.dbconnectstring)
+        retval = 0
+        cursor = conn.cursor()
+        cursor.execute(&quot;select * from pydar_buildmachines where id='&quot; + buildmachineid + &quot;'&quot;)
+        if cursor.rowcount &gt; 0:
+            retval = 1
+        cursor.close()
+        conn.close()
+        self.cat.debug(&quot;retval=&quot; + str(retval))
+        return retval
+
+    def registerSlave(self, buildmachineid):
+        self.cat.debug(&quot;start, buildmachineid=&quot; + buildmachineid)
+        conn = pgdb.connect(self.config.dbconnectstring)
+        cursor = conn.cursor()
+        cursor.execute(&quot;insert into pydar_buildmachine_registrations (id) values ('&quot; + buildmachineid + &quot;')&quot;)
+        cursor.execute(&quot;delete from pydar_buildmachine_machroots where buildmachineid='&quot; + buildmachineid + &quot;'&quot;)
+        conn.commit()
+        cursor.close()
+        conn.close()
+
+    def addMachRoot(self, buildmachineid, machroot):
+        self.cat.debug(&quot;start, id=&quot; + buildmachineid + &quot;,machroot=&quot; + machroot)
+        conn = pgdb.connect(self.config.dbconnectstring)
+        cursor = conn.cursor()
+        cursor.execute(&quot;insert into pydar_buildmachine_machroots (buildmachineid,machroot) values ('&quot; + buildmachineid + &quot;','&quot; + machroot + &quot;')&quot;)
+        conn.commit()
+        cursor.close()
+        conn.close()
+
+    def addResultFileName(self,buildmachineid,commandId,fileName):
+        # no check on buildmachineid yet...
+        conn = pgdb.connect(self.config.dbconnectstring)
+        cursor = conn.cursor()
+        cursor.execute(&quot;insert into pydar_actions_files (commandid,filename) values (&quot; + str(commandId) + &quot;,'&quot; + fileName + &quot;')&quot;)
+        conn.commit()
+        cursor.close()
+        conn.close()
+
+    def setBuildResult(self,buildmachineid,commandId,buildResult):
+        conn = pgdb.connect(self.config.dbconnectstring)
+        cursor = conn.cursor()
+        cursor.execute(&quot;insert into pydar_actions (buildmachineid,commandid,statusid) values ('&quot; + buildmachineid + &quot;',&quot; + str(commandId) + &quot;,&quot; + str(buildResult+1) + &quot;)&quot;)
+        cursor.execute(&quot;update pydar_commands set handled=true,inprogress=false where id=&quot; + str(commandId))
+        conn.commit()
+        cursor.close()
+        conn.close()
+
+    # a seperate program updates the spec file repositories.
+    # result: the commands which have to be executed to update all the spec file repositories
+    # example:  &quot;cd /a/b/c; svn update&quot;
+    def getSpecRepositoriesUpdateCommands(self):
+        self.cat.debug(&quot;start&quot;)
+        retval = &quot;&quot;
+        for repo in self.config.specrepositories:
+            retval = retval + repo.getUpdateCommand() + &quot;\n&quot;
+        return retval
+    
+
+    def reserveCommand(self, buildmachineid):
+        self.cat.debug(&quot;start, buildmachineid=&quot; + buildmachineid)
+        conn = pgdb.connect(self.config.dbconnectstring)
+        cursor = conn.cursor()
+        cursor.execute(&quot;select pc.id, pc.specname, pc.toemail, pc.releasetag, pc.machroot, pc.commandname from pydar_commands pc where (pc.commandname='BUILD' or pc.commandname='TESTBUILD') and not pc.handled and not pc.inprogress and pc.machroot in (select machroot from pydar_buildmachine_machroots where buildmachineid='&quot; + buildmachineid + &quot;')  order by pc.priority desc, pc.machroot desc, pc.id asc&quot;)
+        retval = &quot;&quot;
+        if cursor.rowcount &gt; 0:
+            rs = cursor.fetchone()
+            self.cat.debug(&quot;command found for buildmachineid=&quot; + buildmachineid + &quot;,rs=&quot; + str(rs))
+            aCommand = Command(rs[5],'-1',rs[1],rs[2],rs[3],rs[4])
+            aCommand.setCommandId(rs[0])
+            cursor.execute(&quot;update pydar_commands set inprogress=true where id=&quot; + str(aCommand.commandId))
+            cursor.execute(&quot;insert into pydar_actions (commandid, statusid, buildmachineid) values (&quot; + str(aCommand.commandId) + &quot;,0,'&quot; + buildmachineid + &quot;')&quot;)
+            retval = aCommand
+        else:
+            self.cat.debug(&quot;nothing to do for buildmachineid=&quot; + buildmachineid)
+            retval = &quot;&quot;
+        conn.commit()
+        cursor.close()
+        conn.close()
+        return retval

Added: trunk/tools/pydar2/pydar/pydarclient.py
===================================================================
--- trunk/tools/pydar2/pydar/pydarclient.py	2005-04-16 09:25:14 UTC (rev 3136)
+++ trunk/tools/pydar2/pydar/pydarclient.py	2005-04-18 20:36:17 UTC (rev 3137)
@@ -0,0 +1,41 @@
+#!/usr/bin/python
+
+&quot;&quot;&quot; helper class for calling functions on the master &quot;&quot;&quot;
+
+# This program is free software; you can redistribute it and/or modify
+# it under the terms of the GNU General Public License as published by
+# the Free Software Foundation; either version 2 of the License, or
+# (at your option) any later version.
+#
+# This program is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+# GNU Library General Public License for more details.
+#
+# You should have received a copy of the GNU General Public License
+# along with this program; if not, write to the Free Software
+# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
+# Copyright 2004 Dries Verachtert
+
+
+import getopt, os, sys
+sys.path.append(&quot;/usr/share/pydar/pydar&quot;)
+sys.path.append(&quot;pydar&quot;)
+from xmlrpclib import Server
+from log4py import Logger
+
+class PydarClient:
+    def __init__(self,buildmasterurl):
+        self.cat = Logger().get_instance(self)
+        self.buildmasterurl = buildmasterurl
+        self.cat.debug(&quot;initialised, buildmasterurl=&quot; + self.buildmasterurl)
+        
+    def getSpecRepositoriesUpdateCommands(self,userId):
+        myserverclient = Server(self.buildmasterurl)
+        retval = myserverclient.getSpecRepositoriesUpdateCommands(userId)
+        return retval
+
+    def updateAllSpecRepositoriesFileLists(self,userId):
+        myserverclient = Server(self.buildmasterurl)
+        retval = myserverclient.updateAllSpecRepositoriesFileLists(userId)
+        return retval


Property changes on: trunk/tools/pydar2/pydar/pydarclient.py
___________________________________________________________________
Name: svn:executable
   + *

Added: trunk/tools/pydar2/pydar/specrepository.py
===================================================================
--- trunk/tools/pydar2/pydar/specrepository.py	2005-04-16 09:25:14 UTC (rev 3136)
+++ trunk/tools/pydar2/pydar/specrepository.py	2005-04-18 20:36:17 UTC (rev 3137)
@@ -0,0 +1,143 @@
+#!/usr/bin/python
+
+&quot;&quot;&quot; Contains the information about 1 source of spec files &quot;&quot;&quot;
+
+# This program is free software; you can redistribute it and/or modify
+# it under the terms of the GNU General Public License as published by
+# the Free Software Foundation; either version 2 of the License, or
+# (at your option) any later version.
+#
+# This program is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+# GNU Library General Public License for more details.
+#
+# You should have received a copy of the GNU General Public License
+# along with this program; if not, write to the Free Software
+# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
+# Copyright 2004 Dries Verachtert
+
+from log4py import Logger
+from storagefactory import StorageFactory
+from specrepositoryspecfile import SpecRepositorySpecFile
+import posixpath, posix, string
+
+# A specrepository has some attributes (a name, the root directory)
+# and a list of objects which represent 1 spec file within this specrepository
+# The StoreFactory is used to create a store object so this list of spec files can be saved 
+# within a database if you use the right type of store
+
+class SpecRepository:
+    TYPE_SVN = &quot;SVN&quot;
+    TYPE_CVS = &quot;CVS&quot;
+    TYPE_FILES = &quot;FILES&quot;
+    TYPE_UNKNOWN = &quot;UNKNOWN&quot;
+
+    # name: ascii name, for example 'rpmforge'
+    # type: a constant, can be one of &quot;SVN&quot;, &quot;CVS&quot;, &quot;FILES&quot;
+    def __init__(self, name, rootdirectory):
+        self.__cat = Logger().get_instance(self)
+        self.__name = name
+        self.__rootdirectory = rootdirectory
+        self._setType(SpecRepository.TYPE_UNKNOWN)
+        self.__cat.debug(&quot;initialized&quot;)
+        self.__specFiles = [];
+        self.__storage = StorageFactory.getStorage()
+        self.__id = None
+        
+    def getUpdateCommand(self):
+        return &quot;&quot;
+    
+    def getName(self):
+        return self.__name
+
+    def getRootDirectory(self):
+        return self.__rootdirectory
+    
+    def getType(self):
+        return self.__type
+    
+    def _setType(self,myType):
+        self.__type = myType
+        
+    # first get the list of files which have to be updated,
+    # then update every file which has been changed
+    def __updateFileListInStorage(self):
+        arr = self.__getListOfModifiedFiles()
+        for modFile in arr:
+            self.__updateFileInStorage(modFile)
+    
+    # the storage class assigns a unique id to each specrepository
+    def getId(self):
+        self.__cat.debug(&quot;returnval:&quot; + str(self.__id))
+        return self.__id
+        
+    def setId(self,newId):
+        self.__cat.debug(&quot;id set to: &quot; + str(newId))
+        self.__id = newId
+    
+    def __updateFileInStorage(self, specfile):
+        self.__cat.debug(&quot;start, specfile=&quot; + specfile.getFileName())
+        specfile.setId(self.__storage.saveSpecRepositorySpecFile(self, specfile))
+    
+    # normally the checksums are also stored in storage,
+    # this function is only called at the end of updateFileList
+    # so we can compare the checksums of  __specFiles with 
+    # the contents of the store
+    def __getListOfModifiedFiles(self):
+        self.__cat.debug(&quot;start&quot;)
+        # we return an array of SpecRepositorySpecFile objects
+        retval = []
+        myFileNameToCheckSumHash = self.__storage.getSpecRepositoryFileListToChecksum(self)
+        for diskSpecFile in self.__specFiles:
+            if (diskSpecFile.getPathFromRoot() in myFileNameToCheckSumHash.keys()):
+                # this specrepositoryspecfile is already in the storage
+                if (diskSpecFile.getCheckSum() != myFileNameToCheckSumHash[diskSpecFile.getPathFromRoot()]):
+                    retval.append(diskSpecFile)
+            else:
+                # new file
+                retval.append(diskSpecFile)
+        return retval
+        
+    def updateFileList(self):
+        self.__cat.debug(&quot;start&quot;)
+        dirname = self.getRootDirectory()
+        # generate a list of all found spec files in this repository and store it in the database
+        # then the master can accept commands to build one of those spec files
+        self.__specFiles = self.__recursiveFindFiles(dirname, &quot;&quot;)
+        self.__assignIdsFromStorage()
+        self.__updateFileListInStorage()
+        return len(self.__specFiles);
+    
+    # storage maybe has unique ids about the spec files: ask the storage for a hash subdir +/+filename =&gt; unique id so we can assign them
+    def __assignIdsFromStorage(self):
+        self.__cat.debug(&quot;start&quot;)
+        myFileNameToIdHash = self.__storage.getSpecRepositoryFileListToIds(self)
+        for diskSpecFile in self.__specFiles:
+            if (diskSpecFile.getPathFromRoot() in myFileNameToIdHash.keys()):
+                # this specrepositoryspecfile is already in the storage
+                pathFromRoot = diskSpecFile.getPathFromRoot()
+                id = myFileNameToIdHash[pathFromRoot]
+                diskSpecFile.setId(id)
+        
+    def __recursiveFindFiles(self,topDir,startDir):
+        #self.cat.debug(&quot;start, startDir=&quot; + startDir)
+        arr = []
+        fullDir = posixpath.join(topDir,startDir)
+        topDirList = posix.listdir(fullDir)
+        for entryInDir in topDirList:
+            #self.cat.debug(&quot;entryInDir=&quot; + entryInDir)
+            fullEntryInDir = posixpath.join(fullDir,entryInDir)
+            if posixpath.isdir(fullEntryInDir):
+                #self.cat.debug(&quot;it's a dir!&quot;)
+                # recurse
+                tmpArr = self.__recursiveFindFiles(topDir,posixpath.join(startDir,entryInDir))
+                arr = arr + tmpArr
+            else:
+                # it's not a dir
+                rindex = string.rfind(entryInDir,'.spec')
+                if rindex &gt; 0 and rindex == len(entryInDir) - len('.spec'):
+                    #self.cat.debug(&quot;spec match, entryInDir=&quot; + entryInDir)
+                    spf = SpecRepositorySpecFile(self,startDir,entryInDir)
+                    arr.append(spf)
+        return arr

Added: trunk/tools/pydar2/pydar/specrepositoryfactory.py
===================================================================
--- trunk/tools/pydar2/pydar/specrepositoryfactory.py	2005-04-16 09:25:14 UTC (rev 3136)
+++ trunk/tools/pydar2/pydar/specrepositoryfactory.py	2005-04-18 20:36:17 UTC (rev 3137)
@@ -0,0 +1,52 @@
+#!/usr/bin/python
+
+&quot;&quot;&quot; Creates types of spec repository objects &quot;&quot;&quot;
+
+# This program is free software; you can redistribute it and/or modify
+# it under the terms of the GNU General Public License as published by
+# the Free Software Foundation; either version 2 of the License, or
+# (at your option) any later version.
+#
+# This program is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+# GNU Library General Public License for more details.
+#
+# You should have received a copy of the GNU General Public License
+# along with this program; if not, write to the Free Software
+# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
+# Copyright 2004 Dries Verachtert
+
+from log4py import Logger
+from svnbasedspecrepository import SvnBasedSpecRepository
+from cvsbasedspecrepository import CvsBasedSpecRepository
+from filesbasedspecrepository import FilesBasedSpecRepository
+from specrepository import SpecRepository
+
+## SINGLETON: so use the getInstance() method
+
+class SpecRepositoryFactory:
+    __myInstance = None
+    # TODO, make static
+    def __init__(self):
+        if SpecRepositoryFactory.__myInstance != None:
+            raise Exception(&quot;use getInstance() of SpecRepositoryFactory&quot;)
+        else:
+            SpecRepositoryFactory.__myInstance = self
+
+    #@classmethod
+    def getInstance(cls):
+        if cls.__myInstance == None:
+            unused = SpecRepositoryFactory()
+        return cls.__myInstance
+    getInstance = classmethod(getInstance)
+
+    def createSpecRepository(self,name, type, rootdirectory):
+        if type == SpecRepository.TYPE_SVN:
+            return SvnBasedSpecRepository(name, rootdirectory)
+        if type == SpecRepository.TYPE_CVS:
+            return CvsBasedSpecRepository(name, rootdirectory)
+        if type == SpecRepository.TYPE_FILES:
+            return FilesBasedSpecRepository(name, rootdirectory)
+        # oops, error
+        raise Exception, &quot;unknown type &quot; + str(type)

Added: trunk/tools/pydar2/pydar/specrepositorylist.py
===================================================================
--- trunk/tools/pydar2/pydar/specrepositorylist.py	2005-04-16 09:25:14 UTC (rev 3136)
+++ trunk/tools/pydar2/pydar/specrepositorylist.py	2005-04-18 20:36:17 UTC (rev 3137)
@@ -0,0 +1,72 @@
+#!/usr/bin/python
+
+&quot;&quot;&quot; Contains the specrepository objects &quot;&quot;&quot;
+
+# This program is free software; you can redistribute it and/or modify
+# it under the terms of the GNU General Public License as published by
+# the Free Software Foundation; either version 2 of the License, or
+# (at your option) any later version.
+#
+# This program is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+# GNU Library General Public License for more details.
+#
+# You should have received a copy of the GNU General Public License
+# along with this program; if not, write to the Free Software
+# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
+# Copyright 2004 Dries Verachtert
+
+from log4py import Logger
+from storagefactory import StorageFactory
+
+class SpecRepositoryList:
+    def __init__(self):
+        self.__cat = Logger().get_instance(self)
+        # configuration about each source (source of spec files)
+        self.__specrepositories = []
+        # this array contains an array of SpecRepoFileList objects for each specrepo name
+        #self.__specRepoFileListBySpecRepoName = {};
+        self.__myStorage = StorageFactory.getStorage()
+    
+    def add(self,specRepo):
+        if specRepo != None:
+            self.__specrepositories.append(specRepo)
+        self.__storeSpecRepo(specRepo)
+    
+    def __storeSpecRepo(self, specRepo):
+        id = self.__myStorage.saveSpecRepository(specRepo)
+        specRepo.setId(id)
+        
+    
+    def getSpecRepositoryByName(self,name):
+        for sr in self.__specrepositories:
+            if sr.getName() == name:
+                return sr
+        self.cat.warn(&quot;no SpecRepository found with name: &quot; + name)
+        raise Exception, &quot;no SpecRepository &quot; + str(type)
+
+    def getSpecRepoStats(self, sreponame):
+        repo = self.getSpecRepositoryByName(sreponame)
+        retval = repo.getName() + &quot; (&quot; + repo.getType() + &quot;): &quot; + str(len(self.specRepoFileListBySpecRepoName[sreponame])) + &quot;\n&quot;
+        return retval
+    
+    def getConfig(self):
+        retval = &quot;&quot;
+        cnt = 0
+        for srepo in self.__specrepositories:
+            retval = retval + &quot;SpecRepository &quot; + str(cnt)
+            retval = retval + &quot;: name=&quot; + srepo.getName() + &quot;, type=&quot;
+            retval = retval + srepo.getType() + &quot;, rootdirectory=&quot; + srepo.getRootDirectory() + &quot;\n&quot;
+            rootdir = srepo.getRootDirectory()
+            if posixpath.isdir(rootdir):
+                retval = retval + &quot;this rootdirectory exists\n&quot;
+            else:
+                retval = retval + &quot;this rootdir does not exist\n&quot;
+            cnt = cnt + 1
+        return retval
+ 
+    def updateAllFileLists(self):
+        for i in self.__specrepositories:
+            i.updateFileList()
+ 

Added: trunk/tools/pydar2/pydar/specrepositoryspecfile.py
===================================================================
--- trunk/tools/pydar2/pydar/specrepositoryspecfile.py	2005-04-16 09:25:14 UTC (rev 3136)
+++ trunk/tools/pydar2/pydar/specrepositoryspecfile.py	2005-04-18 20:36:17 UTC (rev 3137)
@@ -0,0 +1,71 @@
+
+&quot;&quot;&quot; Represents one spec file within a SpecRepository &quot;&quot;&quot;
+
+# This program is free software; you can redistribute it and/or modify
+# it under the terms of the GNU General Public License as published by
+# the Free Software Foundation; either version 2 of the License, or
+# (at your option) any later version.
+#
+# This program is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+# GNU Library General Public License for more details.
+#
+# You should have received a copy of the GNU General Public License
+# along with this program; if not, write to the Free Software
+# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
+# Copyright 2004 Dries Verachtert
+
+# a place holder for some values/information about 1 spec file in one of the SpecRepository objects
+# also calculates the SHA1 checksum so it is easy to check if a file is changed or not
+
+from log4py import Logger
+import sha
+
+class SpecRepositorySpecFile:
+    def __init__(self, specRepository,subDir,fileName):
+        self.__cat = Logger().get_instance(self)
+        self.__specRepository = specRepository
+        self.__subDir = subDir
+        self.__fileName = fileName
+        self.__checksum = self.__calculateCheckSum()
+        self.__id = None
+        #self.cat.debug(&quot;start, specRepositoryName=&quot; + self.specRepositoryName + &quot;,specRepositoryRootDir=&quot; + self.specRepositoryRootDir + &quot;,subDir=&quot; + self.subDir + &quot;,fileName=&quot; + self.fileName)
+
+    def getCheckSum(self):
+        return self.__checksum
+        
+        
+    def __calculateCheckSum(self):
+        s = sha.new()
+        fullFileName = self.__specRepository.getRootDirectory() + &quot;/&quot; + self.__subDir + &quot;/&quot; + self.__fileName
+        f = open(fullFileName, 'r')
+        line = f.readline()
+        while line != '':
+            s.update(line)
+            line = f.readline()
+        f.close()
+        return s.hexdigest()
+    
+    def getSpecRepository(self):
+        return self.__specRepository
+        
+    def getSubDir(self):
+        return self.__subDir
+        
+    def getFileName(self):
+        return self.__fileName
+    
+    # the following should be unique within one specrepository!!
+    def getPathFromRoot(self):
+        return self.__subDir + '/' + self.__fileName
+
+    def setId(self, newId):
+        self.__id = newId
+        
+    def getId(self):
+        return self.__id
+    
+    def toString(self):
+        return &quot;SpecRepositorySpecFile: subDir=&quot; + str(self.getSubDir()) + &quot;,fileName=&quot; + str(self.getFileName()) + &quot;,specRepository.name=&quot; + str(self.getSpecRepository().getName())
+        

Added: trunk/tools/pydar2/pydar/storage.py
===================================================================
--- trunk/tools/pydar2/pydar/storage.py	2005-04-16 09:25:14 UTC (rev 3136)
+++ trunk/tools/pydar2/pydar/storage.py	2005-04-18 20:36:17 UTC (rev 3137)
@@ -0,0 +1,87 @@
+
+&quot;&quot;&quot; This class contains all the functions for storing stuff &quot;&quot;&quot;
+
+# This program is free software; you can redistribute it and/or modify
+# it under the terms of the GNU General Public License as published by
+# the Free Software Foundation; either version 2 of the License, or
+# (at your option) any later version.
+#
+# This program is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+# GNU Library General Public License for more details.
+#
+# You should have received a copy of the GNU General Public License
+# along with this program; if not, write to the Free Software
+# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
+# Copyright 2004 Dries Verachtert
+
+# normally you dont use this class directly but a subclass
+# use getInstance() to get the correct type of subclass (defined by a config parameter)
+# PostgresqlStorage: store everything in a pgsql database
+# MemoryStorage: store everything in memory
+
+import posixpath, posix, string, sys, config
+sys.path.append(&quot;pydar&quot;)
+sys.path.append(&quot;.&quot;)
+from command import Command
+from log4py import Logger
+
+# SINGLETON, so use getInstance()
+
+
+class Storage:
+    __myInstance = None
+    
+    def __init__(self):
+        raise Exception(&quot;use getStorage() on StorageFactory&quot;)
+    
+    ## classmethod
+    #def getInstance(cls):
+    #    if cls.__myInstance == None:
+    #        unused = Storage()
+    #    return cls.__myInstance
+    #getInstance = classmethod(getInstance)
+    
+    def getSpecRepositoryFileListToIds(self,specRepo):
+        raise Exception(&quot;Dont use Storage but a subclass of Storage, use getInstance()&quot;)
+    
+    def saveSpecRepositorySpecFile(self, specRepo, specRepoSpecFile):
+        raise Exception(&quot;Dont use Storage but a subclass of Storage, use getInstance()&quot;)
+    
+    def saveSpecRepository(self,specRepo):
+        raise Exception(&quot;Dont use Storage but a subclass of Storage, use getInstance()&quot;)
+      
+    def getSpecRepositoryFileListToChecksum(self,specRepo):
+        raise Exception(&quot;Dont use Storage but a subclass of Storage, use getInstance()&quot;)
+        
+    def createCommand(self,commandName,userId,specName,toEmail,releaseTag,machRoot,priority):
+        raise Exception(&quot;Dont use Storage but a subclass of Storage, use getInstance()&quot;)
+        
+    def checkIfValidUserId(self, userId):
+        raise Exception(&quot;Dont use Storage but a subclass of Storage, use getInstance()&quot;)
+
+    def checkIfValidBuildMachineId(self, buildmachineid):
+        raise Exception(&quot;Dont use Storage but a subclass of Storage, use getInstance()&quot;)
+
+    def registerSlave(self, buildmachineid):
+        raise Exception(&quot;Dont use Storage but a subclass of Storage, use getInstance()&quot;)
+
+    def addMachRoot(self, buildmachineid, machroot):
+        raise Exception(&quot;Dont use Storage but a subclass of Storage, use getInstance()&quot;)
+
+    def addResultFileName(self,buildmachineid,commandId,fileName):
+        raise Exception(&quot;Dont use Storage but a subclass of Storage, use getInstance()&quot;)
+
+    def setBuildResult(self,buildmachineid,commandId,buildResult):
+        raise Exception(&quot;Dont use Storage but a subclass of Storage, use getInstance()&quot;)
+
+    # a seperate program updates the spec file repositories.
+    # result: the commands which have to be executed to update all the spec file repositories
+    # example:  &quot;cd /a/b/c; svn update&quot;
+    def getSpecRepositoriesUpdateCommands(self):
+        raise Exception(&quot;Dont use Storage but a subclass of Storage, use getInstance()&quot;)
+    
+
+    def reserveCommand(self, buildmachineid):
+        raise Exception(&quot;Dont use Storage but a subclass of Storage, use getInstance()&quot;)

Added: trunk/tools/pydar2/pydar/storagefactory.py
===================================================================
--- trunk/tools/pydar2/pydar/storagefactory.py	2005-04-16 09:25:14 UTC (rev 3136)
+++ trunk/tools/pydar2/pydar/storagefactory.py	2005-04-18 20:36:17 UTC (rev 3137)
@@ -0,0 +1,47 @@
+#!/usr/bin/python
+
+&quot;&quot;&quot; Creates types of storage objects &quot;&quot;&quot;
+
+# This program is free software; you can redistribute it and/or modify
+# it under the terms of the GNU General Public License as published by
+# the Free Software Foundation; either version 2 of the License, or
+# (at your option) any later version.
+#
+# This program is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+# GNU Library General Public License for more details.
+#
+# You should have received a copy of the GNU General Public License
+# along with this program; if not, write to the Free Software
+# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
+# Copyright 2004 Dries Verachtert
+
+from log4py import Logger
+from postgresqlstorage import PostgresqlStorage
+
+## SINGLETON: so use the getInstance() or immediately the getStorage() method
+
+class StorageFactory:
+    __myInstance = None
+    __myStorageInstance = None
+    
+    def __init__(self):
+        if StorageFactory.__myInstance != None:
+            raise Exception(&quot;use getInstance() of StorageFactory&quot;)
+        else:
+            StorageFactory.__myInstance = self
+
+    #@classmethod
+    def getInstance(cls):
+        if cls.__myInstance == None:
+            unused = StorageFactory()
+        return cls.__myInstance
+    getInstance = classmethod(getInstance)
+
+    def getStorage(cls):
+        if cls.__myStorageInstance == None:
+            cls.__myStorageInstance = PostgresqlStorage()
+        return cls.__myStorageInstance
+    getStorage = classmethod(getStorage)
+    

Added: trunk/tools/pydar2/pydar/svnbasedspecrepository.py
===================================================================
--- trunk/tools/pydar2/pydar/svnbasedspecrepository.py	2005-04-16 09:25:14 UTC (rev 3136)
+++ trunk/tools/pydar2/pydar/svnbasedspecrepository.py	2005-04-18 20:36:17 UTC (rev 3137)
@@ -0,0 +1,37 @@
+#!/usr/bin/python
+
+&quot;&quot;&quot; Contains the information about a svn source of spec files &quot;&quot;&quot;
+
+# This program is free software; you can redistribute it and/or modify
+# it under the terms of the GNU General Public License as published by
+# the Free Software Foundation; either version 2 of the License, or
+# (at your option) any later version.
+#
+# This program is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+# GNU Library General Public License for more details.
+#
+# You should have received a copy of the GNU General Public License
+# along with this program; if not, write to the Free Software
+# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
+# Copyright 2004 Dries Verachtert
+
+import ConfigParser, os, posixpath, sys
+sys.path.append(&quot;pydar&quot;)
+sys.path.append(&quot;.&quot;)
+from log4py import Logger
+from specrepository import SpecRepository
+#from specrepositoryfactory import SpecRepositoryFactory
+
+class SvnBasedSpecRepository(SpecRepository):
+    # name: ascii name, for example 'rpmforge'
+    # type: a constant, can be one of &quot;SVN&quot;, &quot;CVS&quot;, &quot;FILES&quot;
+    def __init__(self, name, rootdirectory):
+        SpecRepository.__init__(self, name, rootdirectory)
+        self.__cat = Logger().get_instance(self)
+        self._setType(SpecRepository.TYPE_SVN)
+        self.__cat.debug(&quot;initialized&quot;)
+        
+    def getUpdateCommand(self):
+        return &quot;cd &quot; + self.getRootDirectory() + &quot;; svn update&quot;

Modified: trunk/tools/pydar2/pydar/yumbasedbuildroot.py
===================================================================
--- trunk/tools/pydar2/pydar/yumbasedbuildroot.py	2005-04-16 09:25:14 UTC (rev 3136)
+++ trunk/tools/pydar2/pydar/yumbasedbuildroot.py	2005-04-18 20:36:17 UTC (rev 3137)
@@ -150,11 +150,11 @@
         # todo: the sources should be available in a certain dir
         self.cat.debug(&quot;start&quot;)
         
-    def copySpecFile(spec,brr)
+    def copySpecFile(spec,brr):
         # todo
         self.cat.debug(&quot;start&quot;)
         
-    def createScript(spec,brr)
+    def createScript(spec,brr):
         # todo
         self.cat.debug(&quot;start&quot;)
         script = &quot;#!/bin/bash\n&quot;
@@ -165,7 +165,7 @@
         script = script + &quot;done\n&quot;
 
         
-    def callBuildScript(brr)
+    def callBuildScript(brr):
         cmd = &quot;sudo chroot &quot; + self.rootdir + &quot;/bin/bash /pydar2build.sh&quot;
         self.logCommand(cmd,brr)
     
@@ -175,7 +175,7 @@
 myRoot.prepareRoot()
 spec = SpecFile('/home/dries/projects/rap-svn/svn/trunk/rpms/aldo/aldo.spec',' --define &quot;fc3 1&quot; ')
 myRoot.installRpms(spec.getBuildRequires())
-myRoot.
+#myRoot.
 print myRoot.logText
 
 

Modified: trunk/tools/pydar2/pydar-buildserver-master.py
===================================================================
--- trunk/tools/pydar2/pydar-buildserver-master.py	2005-04-16 09:25:14 UTC (rev 3136)
+++ trunk/tools/pydar2/pydar-buildserver-master.py	2005-04-18 20:36:17 UTC (rev 3137)
@@ -26,7 +26,8 @@
 from config import Config
 from thread import start_new_thread
 from command import Command
-from store import Store
+from storagefactory import StorageFactory
+from specrepositoryfactory import SpecRepositoryFactory
 import time
 
 
@@ -36,10 +37,10 @@
 # these functions must check if the caller has a valid ID
 
 class MasterRpc:
-    def __init__(self,myconfig,mystore):
+    def __init__(self):
         self.cat = Logger().get_instance(self)
-        self.config = myconfig
-        self.store = mystore
+        self.config = Config.getInstance()
+        self.store = StorageFactory.getStorage()
         self.cat.debug(&quot;initialized&quot;)
 
     # a slave wants to register itself (timestamp is saved)
@@ -111,15 +112,50 @@
             return &quot;OK&quot;
         else:
             return &quot;UNKNOWN USERID&quot;
+    
+    def getConfig(self,userId):
+        self.cat.debug(&quot;start, userId=&quot; + userId)
+        if self.store.checkIfValidUserId(userId):
+            return self.config.getConfig()
+        else:
+            return &quot;UNKNOWN USERID&quot;
+    
+    def updateSpecRepositoriesFileList(self,userId,specRepoName):
+        self.cat.debug(&quot;start,userId=&quot; + str(userId))
+        if self.store.checkIfValidUserId(userId):
+            return self.store.updateSpecRepositoriesFileList(specRepoName)
+        else:
+            return &quot;UNKNOWN USERID&quot;
+        
+    def updateAllSpecRepositoriesFileLists(self,userId):
+        self.cat.debug(&quot;start,userId=&quot; + str(userId))
+        if self.store.checkIfValidUserId(userId):
+            retval = &quot;&quot;
+            for repo in self.config.specrepositories:
+                retval = retval + str(self.store.updateSpecRepositoriesFileList(repo.getName()))
+            return retval
+        else:
+            return &quot;UNKNOWN USERID&quot;
+    
+    def getSpecRepositoriesUpdateCommands(self,userId):
+        self.cat.debug(&quot;start,userId=&quot; + str(userId))
+        if self.store.checkIfValidUserId(userId):
+            return self.store.getSpecRepositoriesUpdateCommands()
+        else:
+            return &quot;UNKNOWN USERID&quot;
 
 
 class Master:
     def __init__(self,myconfig):
         self.cat = Logger().get_instance(self)
         self.config = myconfig
-        # open a connection to the db
-        self.store = Store(self.config)
         self.cat.debug(&quot;initialized&quot;)
+        # update the list of known spec files
+        self.config.getSpecRepositoryList().updateAllFileLists()
+        self.cat.debug(&quot;file lists updated&quot;)
+        #for testing some stuff:
+        #tmp = MasterRpc(self.config,self.store)
+        #print tmp.getSpecRepositoriesUpdateCommands(self.config.updateUserId)
 
     def run(self):
         self.cat.debug(&quot;start&quot;)
@@ -129,15 +165,21 @@
         # open a listen socket and wait for commands from the master
         self.cat.debug(&quot;buildmasterhostname=&quot; +self.config.buildmasterhostname + &quot;,buildmasterport=&quot; + str(self.config.buildmasterport))
         myslaveserver = SimpleXMLRPCServer((self.config.buildmasterhostname,self.config.buildmasterport))
-        myslaveserver.register_instance(MasterRpc(self.config,self.store))
+        myslaveserver.register_instance(MasterRpc())
         myslaveserver.serve_forever()
 
 
 def main():
-        myConfig = Config()
+        checkSingletons()
+        myConfig = Config.getInstance()
         myInstance = Master(myConfig)
         myInstance.run()
 
+def checkSingletons():
+    # call getInstance once for each of the singletons, so any following call of their constructors will failed
+    unused = Config.getInstance()
+    unused = StorageFactory.getInstance()
+    unused = SpecRepositoryFactory.getInstance()
 
 # code from <A HREF="http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/66012">http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/66012</A>
 if __name__ == &quot;__main__&quot;:

Modified: trunk/tools/pydar2/pydar-buildserver-slave.py
===================================================================
--- trunk/tools/pydar2/pydar-buildserver-slave.py	2005-04-16 09:25:14 UTC (rev 3136)
+++ trunk/tools/pydar2/pydar-buildserver-slave.py	2005-04-18 20:36:17 UTC (rev 3137)
@@ -101,10 +101,7 @@
 
     def doBuildSpec(self,command):
         # choose one implementation
-        doBuildSpecRsyncYumBased(self,command):
-        specFileName = command.specName
-        lastChangedSvnRevId = self.getLastChangedSvnRevId(self.dirMapping[specFileName], command.specName)
-        self.cat.debug(&quot;start, specFileName=&quot; + specFileName)
+        self.doBuildSpecRsyncYumBased(command)
         
     
     def doBuildSpecRsyncYumBased(self,command):

Added: trunk/tools/pydar2/pydar-master-update.py
===================================================================
--- trunk/tools/pydar2/pydar-master-update.py	2005-04-16 09:25:14 UTC (rev 3136)
+++ trunk/tools/pydar2/pydar-master-update.py	2005-04-18 20:36:17 UTC (rev 3137)
@@ -0,0 +1,47 @@
+#!/usr/bin/python
+
+&quot;&quot;&quot; update the spec file repositories &quot;&quot;&quot;
+
+# This program is free software; you can redistribute it and/or modify
+# it under the terms of the GNU General Public License as published by
+# the Free Software Foundation; either version 2 of the License, or
+# (at your option) any later version.
+#
+# This program is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+# GNU Library General Public License for more details.
+#
+# You should have received a copy of the GNU General Public License
+# along with this program; if not, write to the Free Software
+# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
+# Copyright 2004 Dries Verachtert
+
+import ConfigParser, os, posixpath, sys, commands
+sys.path.append(&quot;pydar&quot;)
+sys.path.append(&quot;.&quot;)
+
+from pydarclient import PydarClient
+from config import Config
+
+# updates the spec file repositories on the master
+
+# - get the commands to execute from the master
+# - use those commands
+# - informs the master when the update is done -&gt; rechecks spec files
+
+# get  the url of the master and a userId
+
+conf = Config()
+pc = PydarClient(conf.buildmasterurl)
+commandlines = pc.getSpecRepositoriesUpdateCommands(conf.updateUserId)
+lines = commandlines.split(&quot;\n&quot;)
+for line in lines:
+    print &quot;line: &quot; + line + &quot;\n&quot;
+    (status, output) = commands.getstatusoutput(&quot;/bin/bash -c \&quot;&quot;+line+&quot;\&quot;&quot;)
+    print &quot;status: &quot; + str(status)
+    print &quot;output: &quot; + output
+    
+# now ask the master to update the lists about the spec files
+pc.updateAllSpecRepositoriesFileLists(conf.updateUserId)
+

Modified: trunk/tools/pydar2/sql/svncheck.sql
===================================================================
--- trunk/tools/pydar2/sql/svncheck.sql	2005-04-16 09:25:14 UTC (rev 3136)
+++ trunk/tools/pydar2/sql/svncheck.sql	2005-04-18 20:36:17 UTC (rev 3137)
@@ -1,4 +1,4 @@
-p
+
 drop sequence pydar2_specfile_idseq;
 drop sequence pydar2_distro_idseq;
 create sequence pydar2_specfile_idseq;
@@ -8,13 +8,29 @@
 drop table pydar2_specfile_tags;
 drop table pydar2_specfile;
 drop table pydar2_distro;
+drop table pydar2_specrepo;
 
+create table pydar2_specrepo (
+	id integer unique not null default nextval('pydar2_specrepo_idseq'),
+	name varchar(512) unique not null,
+	rootdirectory varchar(512) not null,
+	type varchar(32) not null,
+	addtimestamp timestamp not null default current_timestamp,
+	deleted bool not null default false
+);
+create sequence pydar2_specrepo_idseq;
+
+
 create table pydar2_specfile (
 	id	integer unique not null default nextval('pydar2_specfile_idseq'),
-	name	varchar(512) unique not null,
-	path	varchar(512) not null,
+	specrepoid integer not null,
+	filename varchar(512) not null,
+	subdir	varchar(512) not null,
+	checksum varchar(512) not null,
         addtimestamp TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP
 );
+create sequence pydar2_specfile_idseq;
+-- todo create constraint specfile_specrepoid 
 create index pydar2_specfile__id on pydar2_specfile(id);
 create index pydar2_specfile__name on pydar2_specfile(name);
 create index pydar2_specfile__both on pydar2_specfile(id,name);


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001938.html">[svn] r3136 - in trunk/rpms: . perl-Tie-DBI perl-Tie-DB_Lock	perl-Tie-Dir perl-Tie-EncryptedHash perl-Tie-LLHash	perl-Tie-STDERR perl-Tie-Scalar-Timeout perl-Tie-Syslog	perl-Tie-TwoLevelHash perl-Time-Beat perl-Time-modules	perl-Tk-FileDialog perl-Tk-FontDialog perl-Tk-HTML	perl-Tk-MListbox perl-Tk-WaitBox perl-Tree-DAG_Node	perl-Tree-MultiNode perl-Tree-Nary perl-Tree-RedBlack	perl-Tree-Trie perl-UNIVERSAL-exports perl-Unicode-Lite	perl-Unix-Processors perl-VCS perl-VRML	perl-Video-Capture-V4l perl-WWW-Babelfish perl-WWW-Poll	perl-WWW-Robot perl-Want perl-XML-DOMHandler	perl-XML-Handler-YAWriter perl-XML-Mini perl-XML-QL	perl-XML-SimpleObject perl-XMLNews-HTMLTemplate perl-XMLNews-Meta
</A></li>
	<LI>Next message: <A HREF="001940.html">[svn] r3138 - trunk/tools/pydar2/pydar
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1939">[ date ]</a>
              <a href="thread.html#1939">[ thread ]</a>
              <a href="subject.html#1939">[ subject ]</a>
              <a href="author.html#1939">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.repoforge.org/mailman/listinfo/commits">More information about the commits
mailing list</a><br>
</body></html>
