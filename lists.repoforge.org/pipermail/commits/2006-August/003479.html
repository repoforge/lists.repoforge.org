<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [svn] r4679 - in trunk/tools/yam: . config/dists
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:commits%40lists.repoforge.org?Subject=Re:%20Re%3A%20%5Bsvn%5D%20r4679%20-%20in%20trunk/tools/yam%3A%20.%20config/dists&In-Reply-To=%3C20060820014333.64916944C54%40pooch.vmhosting.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003478.html">
   <LINK REL="Next"  HREF="003480.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[svn] r4679 - in trunk/tools/yam: . config/dists</H1>
    <B>packagers at lists.rpmforge.net</B> 
    <A HREF="mailto:commits%40lists.repoforge.org?Subject=Re:%20Re%3A%20%5Bsvn%5D%20r4679%20-%20in%20trunk/tools/yam%3A%20.%20config/dists&In-Reply-To=%3C20060820014333.64916944C54%40pooch.vmhosting.org%3E"
       TITLE="[svn] r4679 - in trunk/tools/yam: . config/dists">packagers at lists.rpmforge.net
       </A><BR>
    <I>Sun Aug 20 03:43:33 CEST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="003478.html">[svn] r4678 - trunk/tools/yam/config/dists
</A></li>
        <LI>Next message: <A HREF="003480.html">[svn] r4680 - in trunk/tools/yam: . config
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3479">[ date ]</a>
              <a href="thread.html#3479">[ thread ]</a>
              <a href="subject.html#3479">[ subject ]</a>
              <a href="author.html#3479">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: dag
Date: 2006-08-20 03:43:31 +0200 (Sun, 20 Aug 2006)
New Revision: 4679

Modified:
   trunk/tools/yam/ChangeLog
   trunk/tools/yam/config/dists/centos3.conf
   trunk/tools/yam/config/dists/fc5.conf
   trunk/tools/yam/config/dists/rhel4as.conf
   trunk/tools/yam/yam
Log:
Minor fixes

Modified: trunk/tools/yam/ChangeLog
===================================================================
--- trunk/tools/yam/ChangeLog	2006-08-20 01:26:06 UTC (rev 4678)
+++ trunk/tools/yam/ChangeLog	2006-08-20 01:43:31 UTC (rev 4679)
@@ -38,6 +38,7 @@
 - Improved finding ISO files
 - Added locking support so that running multiple Yam instances is possible
 - Added /etc/yam.conf.d/ to allow configuration components to reside in seperate files
+- Added distribution template config files for RHEL, CentOS and FC
 - Make seperate createrepo cachedir for dist/repo (Craig Trader)
 
 * 0.8.0 - Meerenhof - released 09/03/2006

Modified: trunk/tools/yam/config/dists/centos3.conf
===================================================================
--- trunk/tools/yam/config/dists/centos3.conf	2006-08-20 01:26:06 UTC (rev 4678)
+++ trunk/tools/yam/config/dists/centos3.conf	2006-08-20 01:43:31 UTC (rev 4679)
@@ -25,8 +25,3 @@
 
 ### RPMforge repository
 rpmforge = <A HREF="rsync://apt.sw.be/pub/freshrpms/pub/dag/redhat/el3/en/$arch/RPMS.dag/">rsync://apt.sw.be/pub/freshrpms/pub/dag/redhat/el3/en/$arch/RPMS.dag/</A>
-
-### OpenVZ repositories
-#ovzkernel = <A HREF="http://download.openvz.org/kernel/rhel4/">http://download.openvz.org/kernel/rhel4/</A>
-#ovztemplate = <A HREF="http://download.openvz.org/template/">http://download.openvz.org/template/</A>
-#ovzutils = <A HREF="http://download.openvz.org/utils/">http://download.openvz.org/utils/</A>

Modified: trunk/tools/yam/config/dists/fc5.conf
===================================================================
--- trunk/tools/yam/config/dists/fc5.conf	2006-08-20 01:26:06 UTC (rev 4678)
+++ trunk/tools/yam/config/dists/fc5.conf	2006-08-20 01:43:31 UTC (rev 4679)
@@ -18,4 +18,4 @@
 extras = <A HREF="http://download.fedora.redhat.com/pub/fedora/linux/extras/$version/$arch/">http://download.fedora.redhat.com/pub/fedora/linux/extras/$version/$arch/</A>
 
 ### RPMforge
-rpmforge = <A HREF="rsync://apt.sw.be/pub/freshrpms/pub/dag/fedora/$release/en/$arch/RPMS.dries/">rsync://apt.sw.be/pub/freshrpms/pub/dag/fedora/$release/en/$arch/RPMS.dries/</A>
+rpmforge = <A HREF="rsync://apt.sw.be/pub/freshrpms/pub/dag/fedora/$release/en/$arch/dries/RPMS/">rsync://apt.sw.be/pub/freshrpms/pub/dag/fedora/$release/en/$arch/dries/RPMS/</A>

Modified: trunk/tools/yam/config/dists/rhel4as.conf
===================================================================
--- trunk/tools/yam/config/dists/rhel4as.conf	2006-08-20 01:26:06 UTC (rev 4678)
+++ trunk/tools/yam/config/dists/rhel4as.conf	2006-08-20 01:43:31 UTC (rev 4679)
@@ -23,3 +23,8 @@
 ### RPMforge repository
 rpmforge = <A HREF="rsync://apt.sw.be/pub/freshrpms/pub/dag/redhat/el$release/en/$arch/RPMS.dag/">rsync://apt.sw.be/pub/freshrpms/pub/dag/redhat/el$release/en/$arch/RPMS.dag/</A>
 #rpmforge = <A HREF="http://apt.sw.be/redhat/el$release/en/$arch/RPMS.dag/">http://apt.sw.be/redhat/el$release/en/$arch/RPMS.dag/</A>
+
+### OpenVZ repositories
+#ovzkernel = <A HREF="http://download.openvz.org/kernel/rhel4/">http://download.openvz.org/kernel/rhel4/</A>
+#ovztemplate = <A HREF="http://download.openvz.org/template/">http://download.openvz.org/template/</A>
+#ovzutils = <A HREF="http://download.openvz.org/utils/">http://download.openvz.org/utils/</A>

Modified: trunk/tools/yam/yam
===================================================================
--- trunk/tools/yam/yam	2006-08-20 01:26:06 UTC (rev 4678)
+++ trunk/tools/yam/yam	2006-08-20 01:43:31 UTC (rev 4679)
@@ -351,10 +351,11 @@
 			info(4, '%s: No ISO files found !' % self.nick)
 
 	def lock(self, path):
+		mkdir(path)
 		lockfile = os.path.join(path, '.lock')
 		try:
 			fd = os.open(lockfile, os.O_CREAT | os.O_EXCL | os.O_WRONLY)
-			info(5, '%s: Setting lock %s' % (self.nick, lockfile))
+			info(6, '%s: Setting lock %s' % (self.nick, lockfile))
 			os.write(fd, '%d' % os.getpid())
 			os.close(fd)
 			return True
@@ -364,7 +365,7 @@
 				if os.path.exists('/proc/%s' % pid):
 					info(1, '%s: Found existing lock %s owned by pid %s' % (self.nick, lockfile, pid))
 				else:
-					info(5, '%s: Removing stale lock %s' % (self.nick, lockfile))
+					info(6, '%s: Removing stale lock %s' % (self.nick, lockfile))
 					os.unlink(lockfile)
 					self.lock(path)
 					return True
@@ -374,7 +375,7 @@
 
 	def unlock(self, path):
 		lockfile = os.path.join(path, '.lock')
-		info(5, '%s: Removing lock %s' % (self.nick, lockfile))
+		info(6, '%s: Removing lock %s' % (self.nick, lockfile))
 		if os.path.exists(lockfile):
 			pid = open(lockfile).read()
 			if pid == '%s' % os.getpid():
@@ -577,6 +578,7 @@
 				repoopts = opts
 				if cf.cachedir:
 					cachedir = os.path.join(cf.cachedir, self.dist, repo)
+					mkdir(cachedir)
 					repoopts = repoopts + ' --cachedir &quot;%s&quot;' % cachedir
 				if os.path.isdir(os.path.join(repodir, '.olddata')):
 					remove(os.path.join(repodir, '.olddata'))


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003478.html">[svn] r4678 - trunk/tools/yam/config/dists
</A></li>
	<LI>Next message: <A HREF="003480.html">[svn] r4680 - in trunk/tools/yam: . config
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3479">[ date ]</a>
              <a href="thread.html#3479">[ thread ]</a>
              <a href="subject.html#3479">[ subject ]</a>
              <a href="author.html#3479">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.repoforge.org/mailman/listinfo/commits">More information about the commits
mailing list</a><br>
</body></html>
