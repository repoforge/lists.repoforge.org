<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [svn] r3610 - in trunk/rpms: libfame libsndfile
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:commits%40lists.repoforge.org?Subject=Re:%20Re%3A%20%5Bsvn%5D%20r3610%20-%20in%20trunk/rpms%3A%20libfame%20libsndfile&In-Reply-To=%3C20050930093312.F1A17318222%40pooch.vmhosting.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002409.html">
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[svn] r3610 - in trunk/rpms: libfame libsndfile</H1>
    <B>packagers at lists.rpmforge.net</B> 
    <A HREF="mailto:commits%40lists.repoforge.org?Subject=Re:%20Re%3A%20%5Bsvn%5D%20r3610%20-%20in%20trunk/rpms%3A%20libfame%20libsndfile&In-Reply-To=%3C20050930093312.F1A17318222%40pooch.vmhosting.org%3E"
       TITLE="[svn] r3610 - in trunk/rpms: libfame libsndfile">packagers at lists.rpmforge.net
       </A><BR>
    <I>Fri Sep 30 11:33:12 CEST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="002409.html">[svn] r3609 - in trunk/rpms: fish klavaro muttprint texmacs
</A></li>
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2410">[ date ]</a>
              <a href="thread.html#2410">[ thread ]</a>
              <a href="subject.html#2410">[ subject ]</a>
              <a href="author.html#2410">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: thias
Date: 2005-09-30 11:33:11 +0200 (Fri, 30 Sep 2005)
New Revision: 3610

Added:
   trunk/rpms/libfame/libfame-0.9.1-x86_64.patch
Modified:
   trunk/rpms/libfame/libfame-0.9.1-underquoted.patch
   trunk/rpms/libfame/libfame.spec
   trunk/rpms/libsndfile/libsndfile.spec
Log:
Update libsndfile to 1.0.12 and include x86_64 fix for libfame.


Modified: trunk/rpms/libfame/libfame-0.9.1-underquoted.patch
===================================================================
--- trunk/rpms/libfame/libfame-0.9.1-underquoted.patch	2005-09-29 22:54:57 UTC (rev 3609)
+++ trunk/rpms/libfame/libfame-0.9.1-underquoted.patch	2005-09-30 09:33:11 UTC (rev 3610)
@@ -1,6 +1,171 @@
+diff -Naupr libfame-0.9.1.orig/acinclude.m4 libfame-0.9.1/acinclude.m4
+--- libfame-0.9.1.orig/acinclude.m4	2001-06-22 13:11:03.000000000 +0200
++++ libfame-0.9.1/acinclude.m4	2005-09-30 11:15:38.000000000 +0200
+@@ -3,7 +3,7 @@
+ 
+ dnl Function to link an architecture specific file
+ dnl LINK_ARCH_SRC(source_dir, arch, source_file)
+-AC_DEFUN(COPY_ARCH_SRC,
++AC_DEFUN([COPY_ARCH_SRC],
+ [
+   echo &quot;Copying $1/$2/$3 -&gt; $1/$3&quot;
+   old=&quot;$srcdir/$1/$2/$3&quot;
+@@ -40,7 +40,7 @@ __EOF__
+ ## the same distribution terms that you use for the rest of that program.
+ 
+ # serial 40 AC_PROG_LIBTOOL
+-AC_DEFUN(AC_PROG_LIBTOOL,
++AC_DEFUN([AC_PROG_LIBTOOL],
+ [AC_REQUIRE([AC_LIBTOOL_SETUP])dnl
+ 
+ # Save cache, so that ltconfig can load it
+@@ -70,7 +70,7 @@ AC_SUBST(LIBTOOL)dnl
+ exec 5&gt;&gt;./config.log
+ ])
+ 
+-AC_DEFUN(AC_LIBTOOL_SETUP,
++AC_DEFUN([AC_LIBTOOL_SETUP],
+ [AC_PREREQ(2.13)dnl
+ AC_REQUIRE([AC_ENABLE_SHARED])dnl
+ AC_REQUIRE([AC_ENABLE_STATIC])dnl
+@@ -150,16 +150,16 @@ esac
+ ])
+ 
+ # AC_LIBTOOL_DLOPEN - enable checks for dlopen support
+-AC_DEFUN(AC_LIBTOOL_DLOPEN, [AC_BEFORE([$0],[AC_LIBTOOL_SETUP])])
++AC_DEFUN([AC_LIBTOOL_DLOPEN], [AC_BEFORE([$0],[AC_LIBTOOL_SETUP])])
+ 
+ # AC_LIBTOOL_WIN32_DLL - declare package support for building win32 dll's
+-AC_DEFUN(AC_LIBTOOL_WIN32_DLL, [AC_BEFORE([$0], [AC_LIBTOOL_SETUP])])
++AC_DEFUN([AC_LIBTOOL_WIN32_DLL], [AC_BEFORE([$0], [AC_LIBTOOL_SETUP])])
+ 
+ # AC_ENABLE_SHARED - implement the --enable-shared flag
+ # Usage: AC_ENABLE_SHARED[(DEFAULT)]
+ #   Where DEFAULT is either `yes' or `no'.  If omitted, it defaults to
+ #   `yes'.
+-AC_DEFUN(AC_ENABLE_SHARED, [dnl
++AC_DEFUN([AC_ENABLE_SHARED], [dnl
+ define([AC_ENABLE_SHARED_DEFAULT], ifelse($1, no, no, yes))dnl
+ AC_ARG_ENABLE(shared,
+ changequote(&lt;&lt;, &gt;&gt;)dnl
+@@ -185,14 +185,14 @@ enable_shared=AC_ENABLE_SHARED_DEFAULT)d
+ ])
+ 
+ # AC_DISABLE_SHARED - set the default shared flag to --disable-shared
+-AC_DEFUN(AC_DISABLE_SHARED, [AC_BEFORE([$0],[AC_LIBTOOL_SETUP])dnl
++AC_DEFUN([AC_DISABLE_SHARED], [AC_BEFORE([$0],[AC_LIBTOOL_SETUP])dnl
+ AC_ENABLE_SHARED(no)])
+ 
+ # AC_ENABLE_STATIC - implement the --enable-static flag
+ # Usage: AC_ENABLE_STATIC[(DEFAULT)]
+ #   Where DEFAULT is either `yes' or `no'.  If omitted, it defaults to
+ #   `yes'.
+-AC_DEFUN(AC_ENABLE_STATIC, [dnl
++AC_DEFUN([AC_ENABLE_STATIC], [dnl
+ define([AC_ENABLE_STATIC_DEFAULT], ifelse($1, no, no, yes))dnl
+ AC_ARG_ENABLE(static,
+ changequote(&lt;&lt;, &gt;&gt;)dnl
+@@ -218,7 +218,7 @@ enable_static=AC_ENABLE_STATIC_DEFAULT)d
+ ])
+ 
+ # AC_DISABLE_STATIC - set the default static flag to --disable-static
+-AC_DEFUN(AC_DISABLE_STATIC, [AC_BEFORE([$0],[AC_LIBTOOL_SETUP])dnl
++AC_DEFUN([AC_DISABLE_STATIC], [AC_BEFORE([$0],[AC_LIBTOOL_SETUP])dnl
+ AC_ENABLE_STATIC(no)])
+ 
+ 
+@@ -226,7 +226,7 @@ AC_ENABLE_STATIC(no)])
+ # Usage: AC_ENABLE_FAST_INSTALL[(DEFAULT)]
+ #   Where DEFAULT is either `yes' or `no'.  If omitted, it defaults to
+ #   `yes'.
+-AC_DEFUN(AC_ENABLE_FAST_INSTALL, [dnl
++AC_DEFUN([AC_ENABLE_FAST_INSTALL], [dnl
+ define([AC_ENABLE_FAST_INSTALL_DEFAULT], ifelse($1, no, no, yes))dnl
+ AC_ARG_ENABLE(fast-install,
+ changequote(&lt;&lt;, &gt;&gt;)dnl
+@@ -252,11 +252,11 @@ enable_fast_install=AC_ENABLE_FAST_INSTA
+ ])
+ 
+ # AC_ENABLE_FAST_INSTALL - set the default to --disable-fast-install
+-AC_DEFUN(AC_DISABLE_FAST_INSTALL, [AC_BEFORE([$0],[AC_LIBTOOL_SETUP])dnl
++AC_DEFUN([AC_DISABLE_FAST_INSTALL], [AC_BEFORE([$0],[AC_LIBTOOL_SETUP])dnl
+ AC_ENABLE_FAST_INSTALL(no)])
+ 
+ # AC_PROG_LD - find the path to the GNU or non-GNU linker
+-AC_DEFUN(AC_PROG_LD,
++AC_DEFUN([AC_PROG_LD],
+ [AC_ARG_WITH(gnu-ld,
+ [  --with-gnu-ld           assume the C compiler uses GNU ld [default=no]],
+ test &quot;$withval&quot; = no || with_gnu_ld=yes, with_gnu_ld=no)
+@@ -327,7 +327,7 @@ test -z &quot;$LD&quot; &amp;&amp; AC_MSG_ERROR([no accept
+ AC_PROG_LD_GNU
+ ])
+ 
+-AC_DEFUN(AC_PROG_LD_GNU,
++AC_DEFUN([AC_PROG_LD_GNU],
+ [AC_CACHE_CHECK([if the linker ($LD) is GNU ld], ac_cv_prog_gnu_ld,
+ [# I'd rather use --version here, but apparently some GNU ld's only accept -v.
+ if $LD -v 2&gt;&amp;1 &lt;/dev/null | egrep '(GNU|with BFD)' 1&gt;&amp;5; then
+@@ -338,7 +338,7 @@ fi])
+ ])
+ 
+ # AC_PROG_NM - find the path to a BSD-compatible name lister
+-AC_DEFUN(AC_PROG_NM,
++AC_DEFUN([AC_PROG_NM],
+ [AC_MSG_CHECKING([for BSD-compatible nm])
+ AC_CACHE_VAL(ac_cv_path_NM,
+ [if test -n &quot;$NM&quot;; then
+@@ -372,7 +372,7 @@ AC_MSG_RESULT([$NM])
+ ])
+ 
+ # AC_CHECK_LIBM - check for math library
+-AC_DEFUN(AC_CHECK_LIBM,
++AC_DEFUN([AC_CHECK_LIBM],
+ [AC_REQUIRE([AC_CANONICAL_HOST])dnl
+ LIBM=
+ case &quot;$lt_target&quot; in
+@@ -399,7 +399,7 @@ esac
+ # '${top_srcdir}/' (note the single quotes!).  If your package is not
+ # flat and you're not using automake, define top_builddir and
+ # top_srcdir appropriately in the Makefiles.
+-AC_DEFUN(AC_LIBLTDL_CONVENIENCE, [AC_BEFORE([$0],[AC_LIBTOOL_SETUP])dnl
++AC_DEFUN([AC_LIBLTDL_CONVENIENCE], [AC_BEFORE([$0],[AC_LIBTOOL_SETUP])dnl
+   case &quot;$enable_ltdl_convenience&quot; in
+   no) AC_MSG_ERROR([this package needs a convenience libltdl]) ;;
+   &quot;&quot;) enable_ltdl_convenience=yes
+@@ -420,7 +420,7 @@ AC_DEFUN(AC_LIBLTDL_CONVENIENCE, [AC_BEF
+ # not flat and you're not using automake, define top_builddir and
+ # top_srcdir appropriately in the Makefiles.
+ # In the future, this macro may have to be called after AC_PROG_LIBTOOL.
+-AC_DEFUN(AC_LIBLTDL_INSTALLABLE, [AC_BEFORE([$0],[AC_LIBTOOL_SETUP])dnl
++AC_DEFUN([AC_LIBLTDL_INSTALLABLE], [AC_BEFORE([$0],[AC_LIBTOOL_SETUP])dnl
+   AC_CHECK_LIB(ltdl, main,
+   [test x&quot;$enable_ltdl_install&quot; != xyes &amp;&amp; enable_ltdl_install=no],
+   [if test x&quot;$enable_ltdl_install&quot; = xno; then
+@@ -441,13 +441,13 @@ AC_DEFUN(AC_LIBLTDL_INSTALLABLE, [AC_BEF
+ ])
+ 
+ dnl old names
+-AC_DEFUN(AM_PROG_LIBTOOL, [indir([AC_PROG_LIBTOOL])])dnl
+-AC_DEFUN(AM_ENABLE_SHARED, [indir([AC_ENABLE_SHARED], $@)])dnl
+-AC_DEFUN(AM_ENABLE_STATIC, [indir([AC_ENABLE_STATIC], $@)])dnl
+-AC_DEFUN(AM_DISABLE_SHARED, [indir([AC_DISABLE_SHARED], $@)])dnl
+-AC_DEFUN(AM_DISABLE_STATIC, [indir([AC_DISABLE_STATIC], $@)])dnl
+-AC_DEFUN(AM_PROG_LD, [indir([AC_PROG_LD])])dnl
+-AC_DEFUN(AM_PROG_NM, [indir([AC_PROG_NM])])dnl
++AC_DEFUN([AM_PROG_LIBTOOL], [indir([AC_PROG_LIBTOOL])])dnl
++AC_DEFUN([AM_ENABLE_SHARED], [indir([AC_ENABLE_SHARED], $@)])dnl
++AC_DEFUN([AM_ENABLE_STATIC], [indir([AC_ENABLE_STATIC], $@)])dnl
++AC_DEFUN([AM_DISABLE_SHARED], [indir([AC_DISABLE_SHARED], $@)])dnl
++AC_DEFUN([AM_DISABLE_STATIC], [indir([AC_DISABLE_STATIC], $@)])dnl
++AC_DEFUN([AM_PROG_LD], [indir([AC_PROG_LD])])dnl
++AC_DEFUN([AM_PROG_NM], [indir([AC_PROG_NM])])dnl
+ 
+ dnl This is just to silence aclocal about the macro not being used
+ ifelse([AC_DISABLE_FAST_INSTALL])dnl
 diff -Naupr libfame-0.9.1.orig/libfame.m4 libfame-0.9.1/libfame.m4
 --- libfame-0.9.1.orig/libfame.m4	2004-02-11 14:13:23.000000000 +0100
-+++ libfame-0.9.1/libfame.m4	2005-06-05 20:26:21.000000000 +0200
++++ libfame-0.9.1/libfame.m4	2005-09-30 11:13:11.000000000 +0200
 @@ -3,7 +3,7 @@ dnl Test for libfame, and define LIBFAME
  dnl Vivien Chappelier 12/11/00
  dnl stolen from ORBit autoconf
@@ -12,7 +177,7 @@
  dnl
 diff -Naupr libfame-0.9.1.orig/libfame.m4.in libfame-0.9.1/libfame.m4.in
 --- libfame-0.9.1.orig/libfame.m4.in	2001-11-20 12:56:37.000000000 +0100
-+++ libfame-0.9.1/libfame.m4.in	2005-06-05 20:26:08.000000000 +0200
++++ libfame-0.9.1/libfame.m4.in	2005-09-30 11:13:11.000000000 +0200
 @@ -3,7 +3,7 @@ dnl Test for libfame, and define LIBFAME
  dnl Vivien Chappelier 12/11/00
  dnl stolen from ORBit autoconf

Added: trunk/rpms/libfame/libfame-0.9.1-x86_64.patch
===================================================================
--- trunk/rpms/libfame/libfame-0.9.1-x86_64.patch	2005-09-29 22:54:57 UTC (rev 3609)
+++ trunk/rpms/libfame/libfame-0.9.1-x86_64.patch	2005-09-30 09:33:11 UTC (rev 3610)
@@ -0,0 +1,15 @@
+diff -Naupr libfame-0.9.1.orig/src/fame_malloc.c libfame-0.9.1/src/fame_malloc.c
+--- libfame-0.9.1.orig/src/fame_malloc.c	2003-06-20 14:40:30.000000000 +0200
++++ libfame-0.9.1/src/fame_malloc.c	2005-09-30 11:08:48.000000000 +0200
+@@ -36,9 +36,9 @@ void* fame_malloc(size_t size)
+    */  
+ 
+   ptr = (unsigned char*) malloc(size+ALIGN);
+-  aligned = (unsigned char*) (((unsigned int)ptr &amp; (~(ALIGN-1))) + ALIGN );
++  aligned = (unsigned char*) (((unsigned long)ptr &amp;(~(ALIGN-1))) + ALIGN );
+   padding = aligned - 1;
+-  *padding = (ALIGN-1) - ((unsigned int)ptr &amp; (ALIGN-1));
++  *padding = (ALIGN-1) - ((unsigned long)ptr &amp; (ALIGN-1));
+ 
+   return ((void*)aligned);
+ }

Modified: trunk/rpms/libfame/libfame.spec
===================================================================
--- trunk/rpms/libfame/libfame.spec	2005-09-29 22:54:57 UTC (rev 3609)
+++ trunk/rpms/libfame/libfame.spec	2005-09-30 09:33:11 UTC (rev 3610)
@@ -4,7 +4,7 @@
 Summary: Fast Assembly MPEG Encoding library
 Name: libfame
 Version: 0.9.1
-Release: 7
+Release: 8
 License: LGPL
 Group: System Environment/Libraries
 URL: <A HREF="http://fame.sourceforge.net/">http://fame.sourceforge.net/</A>
@@ -12,6 +12,7 @@
 Patch0: libfame-0.9.1-fstrict-aliasing.patch
 Patch1: <A HREF="http://www.linuxfromscratch.org/blfs/downloads/svn/libfame-0.9.1-gcc34-1.patch">http://www.linuxfromscratch.org/blfs/downloads/svn/libfame-0.9.1-gcc34-1.patch</A>
 Patch2: libfame-0.9.1-underquoted.patch
+Patch3: libfame-0.9.1-x86_64.patch
 BuildRoot: %{_tmppath}/%{name}-%{version}-%{release}-root
 
 %description
@@ -40,6 +41,7 @@
 %patch0 -p1 -b .fstrict-aliasing
 %patch1 -p1 -b .mmxone
 %patch2 -p1 -b .m4
+%patch3 -p1 -b .x86_64
 ./autogen.sh
 
 # Fix lib stuff for lib64
@@ -104,6 +106,10 @@
 
 
 %changelog
+* Fri Sep 30 2005 Matthias Saou &lt;<A HREF="http://freshrpms.net/">http://freshrpms.net/</A>&gt; 0.9.1-8
+- Include x86_64 patch from Andy Loening, fixes some segfaults.
+- Update underquoted patch to also remove warnings at libfame build time.
+
 * Sun Jun  5 2005 Matthias Saou &lt;<A HREF="http://freshrpms.net/">http://freshrpms.net/</A>&gt; 0.9.1-7
 - Make the underquoted patch apply to the .in file too, so it actually works.
 - Put ldconfig calls back as programs to have rpm's deps pick them up.

Modified: trunk/rpms/libsndfile/libsndfile.spec
===================================================================
--- trunk/rpms/libsndfile/libsndfile.spec	2005-09-29 22:54:57 UTC (rev 3609)
+++ trunk/rpms/libsndfile/libsndfile.spec	2005-09-30 09:33:11 UTC (rev 3610)
@@ -11,7 +11,7 @@
 
 Summary: Library for reading and writing files containing sampled sound
 Name: libsndfile
-Version: 1.0.11
+Version: 1.0.12
 Release: 1
 License: LGPL
 Group: System Environment/Libraries
@@ -20,6 +20,7 @@
 BuildRoot: %{_tmppath}/%{name}-%{version}-%{release}-root
 BuildRequires: gcc-c++
 %{!?_without_alsa:BuildRequires: alsa-lib-devel}
+%{!?_without_flac:BuildRequires: flac-devel}
 
 %description
 Libsndfile is a C library for reading and writing files containing
@@ -87,6 +88,10 @@
 
 
 %changelog
+* Fri Sep 30 2005 Matthias Saou &lt;<A HREF="http://freshrpms.net/">http://freshrpms.net/</A>&gt; 1.0.12-1
+- Update to 1.0.12.
+- Enabled new FLAC support (not sqlite3, though).
+
 * Mon Dec 13 2004 Matthias Saou &lt;<A HREF="http://freshrpms.net/">http://freshrpms.net/</A>&gt; 1.0.11-2
 - No longer exclude octave *.m files: Can't find the reason why they were,
   maybe in the PLD spec used as the starting point?


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002409.html">[svn] r3609 - in trunk/rpms: fish klavaro muttprint texmacs
</A></li>
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2410">[ date ]</a>
              <a href="thread.html#2410">[ thread ]</a>
              <a href="subject.html#2410">[ subject ]</a>
              <a href="author.html#2410">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.repoforge.org/mailman/listinfo/commits">More information about the commits
mailing list</a><br>
</body></html>
