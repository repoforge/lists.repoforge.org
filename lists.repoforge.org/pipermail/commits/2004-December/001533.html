<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [SVN] r2728 - trunk/tools/yam
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:commits%40lists.repoforge.org?Subject=Re:%20Re%3A%20%5BSVN%5D%20r2728%20-%20trunk/tools/yam&In-Reply-To=%3C20041231213442.0D43817F5E%40web22.us.megagiga.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001532.html">
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[SVN] r2728 - trunk/tools/yam</H1>
    <B>svn-commits at rpmforge.net</B> 
    <A HREF="mailto:commits%40lists.repoforge.org?Subject=Re:%20Re%3A%20%5BSVN%5D%20r2728%20-%20trunk/tools/yam&In-Reply-To=%3C20041231213442.0D43817F5E%40web22.us.megagiga.com%3E"
       TITLE="[SVN] r2728 - trunk/tools/yam">svn-commits at rpmforge.net
       </A><BR>
    <I>Fri Dec 31 22:34:42 CET 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="001532.html">[SVN] r2727 - trunk/tools/dstat
</A></li>
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1533">[ date ]</a>
              <a href="thread.html#1533">[ thread ]</a>
              <a href="subject.html#1533">[ subject ]</a>
              <a href="author.html#1533">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: dag
Date: 2004-12-31 22:34:40 +0100 (Fri, 31 Dec 2004)
New Revision: 2728

Modified:
   trunk/tools/yam/ChangeLog
   trunk/tools/yam/README.dirs
   trunk/tools/yam/README.dnsmasq
   trunk/tools/yam/README.quickstart
   trunk/tools/yam/README.usage
   trunk/tools/yam/README.web
   trunk/tools/yam/yam
   trunk/tools/yam/yam-complex.conf
   trunk/tools/yam/yam-example.conf
   trunk/tools/yam/yam.httpd
   trunk/tools/yam/yam.spec
Log:
Updates. Prepare 0.7.2.

Modified: trunk/tools/yam/ChangeLog
===================================================================
--- trunk/tools/yam/ChangeLog	2004-12-31 21:05:54 UTC (rev 2727)
+++ trunk/tools/yam/ChangeLog	2004-12-31 21:34:40 UTC (rev 2728)
@@ -8,6 +8,7 @@
 - Added lftp-options and rsync-options so people can fine-tune (David Dollar)
 - Recurse <A HREF="yam://">yam://</A> links more than 1 level deep (David Dollar)
 - Documentation fixes (Dries Verachtert)
+- VirtualHost now only uses hostname 'yam', please define on your network or disable it
 
 * 0.7.1
 - Number the ISOs in the order they are listed (globs are sorted)

Modified: trunk/tools/yam/README.dirs
===================================================================
--- trunk/tools/yam/README.dirs	2004-12-31 21:05:54 UTC (rev 2727)
+++ trunk/tools/yam/README.dirs	2004-12-31 21:34:40 UTC (rev 2728)
@@ -6,12 +6,10 @@
 	/all		-	- Global directory
 		/local		- Directory for custom packages
 
-	/$dist		-	- Per distribution directory
+	/$dist		-	- Per distribution directory (put ISOs here)
 		/local		- Directory for custom packages
 		/$repo		- Per repository directory
 
-	/iso		-	- Manually managed (add your dist ISOs here)
-
 wwwdir = /var/www/yam
 
 	/$dist
@@ -23,11 +21,11 @@
 
 	eg.
 		/el3-x86_64	- Enterprise Linux 3 / x86_64
-		/fc2-i386	- Fedora Core 2 / i386
+		/fc3-i386	- Fedora Core 3 / i386
 
 	per dist-arch one directory, autogenerated
 	you can remove everything from here and regenerated with Yam
-	please don't add packages here, see /var/yam/local !
+	please don't add packages here, see /var/yam/all !
 
 ---
 Please send me improvements to this document.

Modified: trunk/tools/yam/README.dnsmasq
===================================================================
--- trunk/tools/yam/README.dnsmasq	2004-12-31 21:05:54 UTC (rev 2727)
+++ trunk/tools/yam/README.dnsmasq	2004-12-31 21:34:40 UTC (rev 2728)
@@ -1,10 +1,15 @@
-To set up yam with dnsmasq, put the example dnsmasq-yam.conf configfile
-as /etc/dnsmasq-yam.conf and add the following line to /etc/dnsmasq.conf:
+To set up yam with dnsmasq, put the following lines in /etc/dnsmasq.conf:
 
-	conf-file /etc/dnsmasq-yam.conf
+	### Red Hat Enterprise 3 for x86
+	dhcp-boot=/yam/rhes3-i386/pxelinux.0,emyn,10.0.0.1
 
-Then adapt /etc/dnsmasq-yam.conf to your preferences.
+	### Fedora Core 2 for x86
+	#dhcp-boot=/yam/fc2-i386/pxelinux.0,emyn,10.0.0.1
 
+The syntax is:
+
+	dhcp-boot=&lt;path-to-pxelinux.0&gt;,&lt;hostname-of-tftp-server&gt;,&lt;ip-address-of-tftp-server&gt;
+
 For DNS to work, add all systems to /etc/hosts. To map a host to a fixed
 IP address with DHCP, add the MAC-address and hostname/ip-address to
 /etc/ethers. eg.

Modified: trunk/tools/yam/README.quickstart
===================================================================
--- trunk/tools/yam/README.quickstart	2004-12-31 21:05:54 UTC (rev 2727)
+++ trunk/tools/yam/README.quickstart	2004-12-31 21:34:40 UTC (rev 2728)
@@ -27,9 +27,9 @@
 
   1. Start with collecting the existing ISO files you have of the
      different distributions you want to put into a repository.
-     Put these into:
+     Put these into eg:
 
-		/var/yam/fc2-i386/
+		/var/yam/fc3-i386/
 	or eg.
 		/var/yam/iso/
 
@@ -44,18 +44,18 @@
 
      a. Add them to /var/yam/&lt;distro&gt;-&lt;arch&gt;/local/
 
-		eg. /var/yam/fc2-i386/local/
+		eg. /var/yam/fc3-i386/local/
 
 	or add them to /var/yam/all/local/ to add them to all.
 
      b. Specify the directory of your choice in a new repository,
 	eg. called 'myrepo'
 
-		[fc2]
+		[fc3]
 		arch = i386
 		.
 		.
-		myrepo = <A HREF="file:///var/ftp/pub/my-rpms/fc2/i386/">file:///var/ftp/pub/my-rpms/fc2/i386/</A>
+		myrepo = <A HREF="file:///var/ftp/pub/my-rpms/fc3/i386/">file:///var/ftp/pub/my-rpms/fc3/i386/</A>
 
 	eg. you can rewrite this as:
 

Modified: trunk/tools/yam/README.usage
===================================================================
--- trunk/tools/yam/README.usage	2004-12-31 21:05:54 UTC (rev 2727)
+++ trunk/tools/yam/README.usage	2004-12-31 21:34:40 UTC (rev 2728)
@@ -131,9 +131,9 @@
 specify the exact distribution and URLs to download from. Let me demonstrate
 with a little example:
 
-	[fc2]
+	[fc3]
 	name=Fedora Core $release ($arch)
-	release=2
+	release=3
 	arch=i386 x86_64
 	iso=FC$release-$arch-disc?.iso
 	core=<A HREF="rsync://ayo.freshrpms.net/pub/freshrpms/pub/freshrpms/ayo/fedora/linux/$release/$arch/RPMS.$repo/">rsync://ayo.freshrpms.net/pub/freshrpms/pub/freshrpms/ayo/fedora/linux/$release/$arch/RPMS.$repo/</A>
@@ -162,9 +162,11 @@
 
 Other special variables include:
 
-	$dist is set to the distribution section name (eg. fc2)
-	$nick is set to $dist-$arch
-	$repo is set to the current repo-name (will only work on the same line)
+	$srcdir	is set to the srcdir variable from yam.conf
+	$dist 	is set to the distribution section name (eg. fc2)
+	$arch	is set to the architecture within this section context
+	$nick 	is set to $dist-$arch within this section context
+	$repo 	is set to the current repo-name within this repo context
 
 Yam can use several types of protocols or URL identifiers:
 
@@ -175,7 +177,7 @@
 	<A HREF="https://">https://</A>	- handled by lftp
 	<A HREF="rsync://">rsync://</A>	- handled by rsync
 	<A HREF="sftp://">sftp://</A>		- handled by lftp
-	<A HREF="yam://">yam://</A>		- handled by yam, symlink to other dist directory in /var/yam (srcdir)
+	<A HREF="yam://">yam://</A>		- handled by yam, equivalent to <A HREF="file://$srcdir/">file://$srcdir/</A>
 
 
 I hope that I gave you some help hints and tips on using yam

Modified: trunk/tools/yam/README.web
===================================================================
--- trunk/tools/yam/README.web	2004-12-31 21:05:54 UTC (rev 2727)
+++ trunk/tools/yam/README.web	2004-12-31 21:34:40 UTC (rev 2728)
@@ -12,9 +12,11 @@
 
 The config file provided is just a default that helps to set
 up your initial environment and it is there to be adapted.
+It uses by default the hostname 'yam' and if you define 'yam'
+as a name on your local network, it may work without change.
 
 For browsing and remote network installations via HTTP the
-webserver can be accessed at
+webserver can be accessed at:
 
 	<A HREF="http://localhost/yam/">http://localhost/yam/</A>
 or
@@ -31,7 +33,7 @@
 	<A HREF="http://httpd.apache.org/docs-2.0/howto/auth.html">http://httpd.apache.org/docs-2.0/howto/auth.html</A>
 
 Of course, to make it work you need to start Apache
-by doing eg.:
+by doing eg:
 
 	service httpd start
 

Modified: trunk/tools/yam/yam
===================================================================
--- trunk/tools/yam/yam	2004-12-31 21:05:54 UTC (rev 2727)
+++ trunk/tools/yam/yam	2004-12-31 21:34:40 UTC (rev 2728)
@@ -1,19 +1,19 @@
 #!/usr/bin/python
-#
-# This program is free software; you can redistribute it and/or modify
-# it under the terms of the GNU Library General Public License as published by
-# the Free Software Foundation; version 2 only
-#
-# This program is distributed in the hope that it will be useful,
-# but WITHOUT ANY WARRANTY; without even the implied warranty of
-# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-# GNU Library General Public License for more details.
-#
-# You should have received a copy of the GNU Library General Public License
-# along with this program; if not, write to the Free Software
-# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
-# Copyright 2004 Dag Wieers &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>&gt;
 
+### This program is free software; you can redistribute it and/or modify
+### it under the terms of the GNU Library General Public License as published by
+### the Free Software Foundation; version 2 only
+###
+### This program is distributed in the hope that it will be useful,
+### but WITHOUT ANY WARRANTY; without even the implied warranty of
+### MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+### GNU Library General Public License for more details.
+###
+### You should have received a copy of the GNU Library General Public License
+### along with this program; if not, write to the Free Software
+### Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
+### Copyright 2004 Dag Wieers &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>&gt;
+
 import os, sys, glob, re, shutil, getopt, popen2
 import ConfigParser, urlparse
 

Modified: trunk/tools/yam/yam-complex.conf
===================================================================
--- trunk/tools/yam/yam-complex.conf	2004-12-31 21:05:54 UTC (rev 2727)
+++ trunk/tools/yam/yam-complex.conf	2004-12-31 21:34:40 UTC (rev 2728)
@@ -13,9 +13,9 @@
 
 ### Any other section is considered a definition for a distribution
 ### Below are a few examples to show the possibilities
-[fc2]
+[fc3]
 name = Fedora Core $release ($arch)
-release = 2
+release = 3
 iso = FC$release-$arch-disc?.iso
 core = <A HREF="rsync://ayo.freshrpms.net/pub/freshrpms/pub/freshrpms/ayo/fedora/linux/$release/$arch/RPMS.$repo/">rsync://ayo.freshrpms.net/pub/freshrpms/pub/freshrpms/ayo/fedora/linux/$release/$arch/RPMS.$repo/</A>
 updates = <A HREF="rsync://ayo.freshrpms.net/pub/freshrpms/pub/freshrpms/ayo/fedora/linux/$release/$arch/RPMS.$repo/">rsync://ayo.freshrpms.net/pub/freshrpms/pub/freshrpms/ayo/fedora/linux/$release/$arch/RPMS.$repo/</A>
@@ -27,7 +27,7 @@
 #[rhes3]
 #name = Red Hat Enterprise Server $release U3 ($arch)
 #release = 3
-#iso = rhel-$release-U3-$arch-es-disc?.iso
+#iso = rhel-$release-U4-$arch-es-disc?.iso
 #updates = <A HREF="file:///var/spool/up2date/">file:///var/spool/up2date/</A>
 #dag = <A HREF="rsync://apt.sw.be/pub/freshrpms/pub/dag/redhat/el$release/en/$arch/RPMS.$repo/">rsync://apt.sw.be/pub/freshrpms/pub/dag/redhat/el$release/en/$arch/RPMS.$repo/</A>
 
@@ -45,13 +45,13 @@
 
 #[centos3]
 #name = CentOS $release ($arch)
-#release = 3.1
-#iso = CentOS-3.1-$arch.disc?.iso
-#os = <A HREF="rsync://ibiblio.org/distros/caoslinux/centos-3/$release/$repo/$arch/RedHat/RPMS/">rsync://ibiblio.org/distros/caoslinux/centos-3/$release/$repo/$arch/RedHat/RPMS/</A>
-#updates = <A HREF="rsync://ibiblio.org/distros/caoslinux/centos-3/$release/$repo/$arch/RPMS/">rsync://ibiblio.org/distros/caoslinux/centos-3/$release/$repo/$arch/RPMS/</A>
-#extras = <A HREF="rsync://ibiblio.org/distros/caoslinux/centos-3/$release/$repo/$arch/RPMS/">rsync://ibiblio.org/distros/caoslinux/centos-3/$release/$repo/$arch/RPMS/</A>
-#addons = <A HREF="rsync://ibiblio.org/distros/caoslinux/centos-3/$release/$repo/$arch/RPMS/">rsync://ibiblio.org/distros/caoslinux/centos-3/$release/$repo/$arch/RPMS/</A>
-#contrib = <A HREF="rsync://ibiblio.org/distros/caoslinux/centos-3/$release/$repo/$arch/RPMS/">rsync://ibiblio.org/distros/caoslinux/centos-3/$release/$repo/$arch/RPMS/</A>
+#release = 3.3
+#iso = CentOS-$version-$arch.disc?.iso
+#os = <A HREF="rsync://ftp.heanet.ie/pub/cAos/centos/$release/$repo/$arch/RedHat/RPMS/">rsync://ftp.heanet.ie/pub/cAos/centos/$release/$repo/$arch/RedHat/RPMS/</A>
+#updates = <A HREF="rsync://ftp.heanet.ie/pub/cAos/centos/$release/$repo/$arch/RPMS/">rsync://ftp.heanet.ie/pub/cAos/centos/$release/$repo/$arch/RPMS/</A>
+#extras = <A HREF="rsync://ftp.heanet.ie/pub/cAos/centos/$release/$repo/$arch/RPMS/">rsync://ftp.heanet.ie/pub/cAos/centos/$release/$repo/$arch/RPMS/</A>
+#addons = <A HREF="rsync://ftp.heanet.ie/pub/cAos/centos/$release/$repo/$arch/RPMS/">rsync://ftp.heanet.ie/pub/cAos/centos/$release/$repo/$arch/RPMS/</A>
+#contrib = <A HREF="rsync://ftp.heanet.ie/pub/cAos/centos/$release/$repo/$arch/RPMS/">rsync://ftp.heanet.ie/pub/cAos/centos/$release/$repo/$arch/RPMS/</A>
 #dag = <A HREF="rsync://apt.sw.be/pub/freshrpms/pub/dag/redhat/el3/en/$arch/RPMS.$repo/">rsync://apt.sw.be/pub/freshrpms/pub/dag/redhat/el3/en/$arch/RPMS.$repo/</A>
 
 #[rh73]

Modified: trunk/tools/yam/yam-example.conf
===================================================================
--- trunk/tools/yam/yam-example.conf	2004-12-31 21:05:54 UTC (rev 2727)
+++ trunk/tools/yam/yam-example.conf	2004-12-31 21:34:40 UTC (rev 2728)
@@ -87,20 +87,20 @@
 freshrpms = <A HREF="rsync://ayo.freshrpms.net/pub/freshrpms/pub/freshrpms/redhat/">rsync://ayo.freshrpms.net/pub/freshrpms/pub/freshrpms/redhat/</A>
 newrpms = <A HREF="rsync://newrpms.sunsite.dk/projects/newrpms/www/htdocs/apt/redhat/en/$arch/">rsync://newrpms.sunsite.dk/projects/newrpms/www/htdocs/apt/redhat/en/$arch/</A>
 
-### Dist1 comes with ISO files (i386 is default)
+### Example1: Using ISO files (put ISOs in /var/yam/dist1-i386), i386 is default arch
 [dist1]
 release = 1
 iso = dist$release-$arch-disc?.iso
 updates = <A HREF="rsync://rsync.dist1.org/pub/dist/$release/$arch/$repo/">rsync://rsync.dist1.org/pub/dist/$release/$arch/$repo/</A>
 
-### Dist2 is synced with a mirror, has multiple archs
+### Example2: Using multiple archs for a single definition
 [dist2]
 release = 2
 arch = i386 i586 i686 x86_64
 os = <A HREF="rsync://rsync.dist2.org/pub/dist/$release/$arch/$repo/">rsync://rsync.dist2.org/pub/dist/$release/$arch/$repo/</A>
 updates = <A HREF="rsync://rsync.dist2.org/pub/dist/$release/$arch/$repo/">rsync://rsync.dist2.org/pub/dist/$release/$arch/$repo/</A>
 
-### Dist3 has extra repositories, updates use updates from dist1
+### Example3: Using extra repositories and updates from Example1
 [dist3]
 release = 3
 arch = x86_64
@@ -108,3 +108,11 @@
 os = <A HREF="rsync://rsync.dist3.org/pub/dist/$release/$arch/$repo/">rsync://rsync.dist3.org/pub/dist/$release/$arch/$repo/</A>
 updates = <A HREF="yam://dist1-$arch/$repo/">yam://dist1-$arch/$repo/</A>
 contrib = <A HREF="rsync://rsync.dist3.org/pub/dist/$release/$arch/$repo/">rsync://rsync.dist3.org/pub/dist/$release/$arch/$repo/</A>
+
+### Example4: Merging repositories
+[dist4]
+release = 4
+contrib = <A HREF="rsync://rsync.dist4.org/dist/$release/$arch/$repo/">rsync://rsync.dist4.org/dist/$release/$arch/$repo/</A>
+extras = <A HREF="rsync://rsync.dist4.org/dist/$release/$arch/$repo/">rsync://rsync.dist4.org/dist/$release/$arch/$repo/</A>
+merge = <A HREF="yam://$nick/contrib/">yam://$nick/contrib/</A>
+	<A HREF="yam://$nick/extras/">yam://$nick/extras/</A>

Modified: trunk/tools/yam/yam.httpd
===================================================================
--- trunk/tools/yam/yam.httpd	2004-12-31 21:05:54 UTC (rev 2727)
+++ trunk/tools/yam/yam.httpd	2004-12-31 21:34:40 UTC (rev 2728)
@@ -1,3 +1,4 @@
+### Directory-based for the main server
 Alias /yam /var/www/yam
 #Alias /yamiso /var/yam/iso
 
@@ -5,14 +6,15 @@
 	Options Indexes FollowSymlinks SymLinksifOwnerMatch IncludesNOEXEC
 	IndexOptions NameWidth=* DescriptionWidth=*
 
-#	order deny,allow
-#	deny from all
-#	allow from 127.0.0.1
-#	allow from horsea.3ti.be
-#	allow from pikachu.3ti.be
+	### Authentication options
+	#order deny,allow
+	#deny from all
+	#allow from 127.0.0.1
+	#allow from horsea.3ti.be
+	#allow from pikachu.3ti.be
 
-#	AuthUserFile /var/yam/auth/.htpasswd
-#	Require user bert dag dries thias
+	#AuthUserFile /var/yam/auth/.htpasswd
+	#Require user bert dag dries thias
 	
 	HeaderName HEADER.shtml
 	ReadmeName README.shtml
@@ -61,9 +63,12 @@
 	AddDescription &quot;Yellow Dog Linux 4.0 for PPC&quot; yd4-ppc
 &lt;/Directory&gt;
 
-&lt;VirtualHost *:80&gt;
+### Name based virtual-host
+NameVirtualHost yam:80
+
+&lt;VirtualHost yam:80&gt;
 	ServerName yam
-	ServerAlias 127.0.0.1 localhost
+	ServerAlias yam.3ti.be yam.localdomain
 	DocumentRoot /var/www/yam
 	ErrorLog logs/yam-error_log
 	CustomLog logs/yam-access_log combined

Modified: trunk/tools/yam/yam.spec
===================================================================
--- trunk/tools/yam/yam.spec	2004-12-31 21:05:54 UTC (rev 2727)
+++ trunk/tools/yam/yam.spec	2004-12-31 21:34:40 UTC (rev 2728)
@@ -17,6 +17,7 @@
 BuildRoot: %{_tmppath}/%{name}-%{version}-%{release}-root
 
 BuildArch: noarch
+BuildRequires: /usr/bin/python2
 Requires: python &gt;= 2.0
 
 %description


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001532.html">[SVN] r2727 - trunk/tools/dstat
</A></li>
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1533">[ date ]</a>
              <a href="thread.html#1533">[ thread ]</a>
              <a href="subject.html#1533">[ subject ]</a>
              <a href="author.html#1533">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.repoforge.org/mailman/listinfo/commits">More information about the commits
mailing list</a><br>
</body></html>
