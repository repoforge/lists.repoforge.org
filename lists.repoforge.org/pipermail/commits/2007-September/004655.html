<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [svn] r5856 - in trunk/rpms: fltk libmovtar lmbench plib powertop	python-adns rfb rrdtool tightvnc
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:commits%40lists.repoforge.org?Subject=Re:%20Re%3A%20%5Bsvn%5D%20r5856%20-%20in%20trunk/rpms%3A%20fltk%20libmovtar%20lmbench%20plib%20powertop%0A%09python-adns%20rfb%20rrdtool%20tightvnc&In-Reply-To=%3C20070920135353.DD34C944A75%40pooch.vmhosting.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004654.html">
   <LINK REL="Next"  HREF="004656.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[svn] r5856 - in trunk/rpms: fltk libmovtar lmbench plib powertop	python-adns rfb rrdtool tightvnc</H1>
    <B>packagers at lists.rpmforge.net</B> 
    <A HREF="mailto:commits%40lists.repoforge.org?Subject=Re:%20Re%3A%20%5Bsvn%5D%20r5856%20-%20in%20trunk/rpms%3A%20fltk%20libmovtar%20lmbench%20plib%20powertop%0A%09python-adns%20rfb%20rrdtool%20tightvnc&In-Reply-To=%3C20070920135353.DD34C944A75%40pooch.vmhosting.org%3E"
       TITLE="[svn] r5856 - in trunk/rpms: fltk libmovtar lmbench plib powertop	python-adns rfb rrdtool tightvnc">packagers at lists.rpmforge.net
       </A><BR>
    <I>Thu Sep 20 15:53:53 CEST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="004654.html">[svn] r5855 - in trunk/rpms: openrm perl-Mail-ClamAV xawtv
</A></li>
        <LI>Next message: <A HREF="004656.html">[svn] r5857 - trunk/rpms/figlet
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4655">[ date ]</a>
              <a href="thread.html#4655">[ thread ]</a>
              <a href="subject.html#4655">[ subject ]</a>
              <a href="author.html#4655">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: dries
Date: 2007-09-20 15:53:50 +0200 (Thu, 20 Sep 2007)
New Revision: 5856

Added:
   trunk/rpms/fltk/fltk-1.1.7-config.patch
   trunk/rpms/fltk/fltk-1.1.7-test.patch
   trunk/rpms/libmovtar/jpeg-mmx-0.1.5.patch
   trunk/rpms/libmovtar/libmovtar-0.1.3.patch
   trunk/rpms/lmbench/lmbench-3.0-a7-bw_tcp.patch
   trunk/rpms/lmbench/lmbench-3.0-a7-clean_script_warnings.patch
   trunk/rpms/lmbench/lmbench-3.0-a7-man_pages.patch
   trunk/rpms/lmbench/lmbench-3.0-a7-run.sh
   trunk/rpms/plib/plib-1.8.4-autorepeat.patch
   trunk/rpms/plib/plib-1.8.4-extraqualif.patch
   trunk/rpms/plib/plib-1.8.4-fullscreen.patch
   trunk/rpms/plib/plib-1.8.4-js.patch
   trunk/rpms/powertop/powertop-1.8-usb.patch
   trunk/rpms/python-adns/python-adns-1.1.0-srv.patch
   trunk/rpms/rfb/rfb-0.6.1-11-debian.patch
   trunk/rpms/rrdtool/rrdtool-1.2.19-python.patch
   trunk/rpms/tightvnc/tightvnc-1.2.6-config-x86_64.patch
   trunk/rpms/tightvnc/tightvnc-1.2.9-fix-build-when-fds_bits-not-defined.patch
   trunk/rpms/tightvnc/tightvnc-1.2.9-includes.patch
   trunk/rpms/tightvnc/tightvnc-1.2.9-use-stdlib-malloc.patch
   trunk/rpms/tightvnc/vncserver-halfbaked.patch
   trunk/rpms/tightvnc/vncserver-vncpasswd-1.2.6.patch
   trunk/rpms/tightvnc/vncviewer-fix-crash-when-lose-focus.patch
Log:
missing patches

Added: trunk/rpms/fltk/fltk-1.1.7-config.patch
===================================================================
--- trunk/rpms/fltk/fltk-1.1.7-config.patch	                        (rev 0)
+++ trunk/rpms/fltk/fltk-1.1.7-config.patch	2007-09-20 13:53:50 UTC (rev 5856)
@@ -0,0 +1,15 @@
+--- fltk-1.1.7/fltk-config.in.config	2005-12-07 14:13:12.000000000 -0600
++++ fltk-1.1.7/fltk-config.in	2006-12-11 23:33:40.000000000 -0600
+@@ -52,12 +52,6 @@
+ # post-process command (only needed for MacOS)
+ POSTBUILD=&quot;@POSTBUILD@&quot;
+ 
+-# flags for C++ compiler:
+-CFLAGS=&quot;@CFLAGS@&quot;
+-CXXFLAGS=&quot;@CXXFLAGS@&quot;
+-LDFLAGS=&quot;@LDFLAGS@&quot;
+-LDLIBS=&quot;@LIBS@&quot;
+-
+ # Check for local invocation, and update paths accordingly...
+ if test -f &quot;$selfdir/FL/Fl_Window.H&quot;; then
+ 	bindir=&quot;$selfdir/fluid&quot;

Added: trunk/rpms/fltk/fltk-1.1.7-test.patch
===================================================================
--- trunk/rpms/fltk/fltk-1.1.7-test.patch	                        (rev 0)
+++ trunk/rpms/fltk/fltk-1.1.7-test.patch	2007-09-20 13:53:50 UTC (rev 5856)
@@ -0,0 +1,21 @@
+--- fltk-1.1.7/Makefile.test	2006-01-15 12:36:16.000000000 -0600
++++ fltk-1.1.7/Makefile	2006-12-12 00:34:49.000000000 -0600
+@@ -27,7 +27,7 @@
+ 
+ include makeinclude
+ 
+-DIRS	=	$(IMAGEDIRS) src fluid test documentation
++DIRS	=	$(IMAGEDIRS) src fluid documentation
+ 
+ all: makeinclude
+ 	for dir in $(DIRS); do\
+@@ -35,6 +35,9 @@
+ 		(cd $$dir; $(MAKE) $(MFLAGS)) || break;\
+ 	done
+ 
++test:	
++	(cd test;; $(MAKE) $(MFLAGS)) || exit 1
++
+ install: makeinclude
+ 	-mkdir -p $(DESTDIR)$(bindir)
+ 	$(RM) $(DESTDIR)$(bindir)/fltk-config

Added: trunk/rpms/libmovtar/jpeg-mmx-0.1.5.patch
===================================================================
--- trunk/rpms/libmovtar/jpeg-mmx-0.1.5.patch	                        (rev 0)
+++ trunk/rpms/libmovtar/jpeg-mmx-0.1.5.patch	2007-09-20 13:53:50 UTC (rev 5856)
@@ -0,0 +1,88 @@
+diff -ur jpeg-mmx-0.1.5.orig/jdcolor.c jpeg-mmx-0.1.5/jdcolor.c
+--- jpeg-mmx-0.1.5.orig/jdcolor.c	2001-11-16 09:52:43.000000000 +0100
++++ jpeg-mmx-0.1.5/jdcolor.c	2003-08-13 10:14:32.000000000 +0200
+@@ -125,13 +125,13 @@
+ #endif
+ 
+ #if defined(HAVE_MMX_INTEL_MNEMONICS)
+-static const int64 bpte0 = 0x0080008000800080; // 128
+-static const int64 bpte1 = 0x7168e9f97168e9f9; // for cb (Cb/b, Cb/g, Cb/b, Cb/g)
+-static const int64 bpte2 = 0xd21a59bad21a59ba; // for cr (Cr/g, Cr/r, Cr/g, Cr/r)
++static const int64  __attribute__ ((used)) bpte0 = 0x0080008000800080; // 128
++static const int64  __attribute__ ((used)) bpte1 = 0x7168e9f97168e9f9; // for cb (Cb/b, Cb/g, Cb/b, Cb/g)
++static const int64  __attribute__ ((used)) bpte2 = 0xd21a59bad21a59ba; // for cr (Cr/g, Cr/r, Cr/g, Cr/r)
+ #else
+-static const int64 te0 = 0x0200020002000200; // -128 &lt;&lt; 2
+-static const int64 te1 = 0xe9fa7168e9fa7168; // for cb
+-static const int64 te2 = 0x59bad24d59bad24d; // for cr
++static const int64  __attribute__ ((used)) te0 = 0x0200020002000200; // -128 &lt;&lt; 2
++static const int64  __attribute__ ((used)) te1 = 0xe9fa7168e9fa7168; // for cb
++static const int64  __attribute__ ((used)) te2 = 0x59bad24d59bad24d; // for cr
+ #endif
+ //static const int64 te2 = 0x59ba524b59ba524b; // for cr
+ /* How to calculate the constants (see constants from above for YCbCr-&gt;RGB):
+Only in jpeg-mmx-0.1.5: jdcolor.c.~1~
+Only in jpeg-mmx-0.1.5: jdcolor.c.~2~
+diff -ur jpeg-mmx-0.1.5.orig/jidctint.c jpeg-mmx-0.1.5/jidctint.c
+--- jpeg-mmx-0.1.5.orig/jidctint.c	2000-09-19 18:04:20.000000000 +0200
++++ jpeg-mmx-0.1.5/jidctint.c	2003-08-13 10:13:11.000000000 +0200
+@@ -173,32 +173,32 @@
+  * Perform dequantization and inverse DCT on one block of coefficients.
+  */
+ #define __int64 unsigned long long
+-	static	__int64 fix_029_n089n196	= 0x098ea46e098ea46e;
+-	static	__int64 fix_n196_n089		= 0xc13be333c13be333;
+-	static	__int64 fix_205_n256n039	= 0x41b3a18141b3a181;
+-	static	__int64 fix_n039_n256		= 0xf384adfdf384adfd;
+-	static	__int64 fix_307n256_n196	= 0x1051c13b1051c13b;
+-	static	__int64 fix_n256_n196		= 0xadfdc13badfdc13b;
+-	static	__int64 fix_150_n089n039	= 0x300bd6b7300bd6b7;
+-	static	__int64 fix_n039_n089		= 0xf384e333f384e333;
+-	static	__int64 fix_117_117			= 0x25a125a125a125a1;
+-	static	__int64 fix_054_054p076		= 0x115129cf115129cf;
+-	static	__int64 fix_054n184_054		= 0xd6301151d6301151;
+-
+-	static	__int64 fix_054n184 		= 0xd630d630d630d630;
+-	static	__int64 fix_054				= 0x1151115111511151;
+-	static	__int64 fix_054p076			= 0x29cf29cf29cf29cf;
+-	static	__int64 fix_n196p307n256	= 0xd18cd18cd18cd18c;
+-	static	__int64 fix_n089n039p150	= 0x06c206c206c206c2;
+-	static	__int64 fix_n256			= 0xadfdadfdadfdadfd;
+-	static	__int64 fix_n039			= 0xf384f384f384f384;
+-	static	__int64 fix_n256n039p205	= 0xe334e334e334e334;
+-	static	__int64 fix_n196			= 0xc13bc13bc13bc13b;
+-	static	__int64 fix_n089			= 0xe333e333e333e333;
+-	static	__int64 fixn089n196p029		= 0xadfcadfcadfcadfc;
++	static	__int64 __attribute__ ((used)) fix_029_n089n196	= 0x098ea46e098ea46e;
++	static	__int64 __attribute__ ((used)) fix_n196_n089		= 0xc13be333c13be333;
++	static	__int64 __attribute__ ((used)) fix_205_n256n039	= 0x41b3a18141b3a181;
++	static	__int64 __attribute__ ((used)) fix_n039_n256		= 0xf384adfdf384adfd;
++	static	__int64 __attribute__ ((used)) fix_307n256_n196	= 0x1051c13b1051c13b;
++	static	__int64 __attribute__ ((used)) fix_n256_n196		= 0xadfdc13badfdc13b;
++	static	__int64 __attribute__ ((used)) fix_150_n089n039	= 0x300bd6b7300bd6b7;
++	static	__int64 __attribute__ ((used)) fix_n039_n089		= 0xf384e333f384e333;
++	static	__int64 __attribute__ ((used)) fix_117_117			= 0x25a125a125a125a1;
++	static	__int64 __attribute__ ((used)) fix_054_054p076		= 0x115129cf115129cf;
++	static	__int64 __attribute__ ((used)) fix_054n184_054		= 0xd6301151d6301151;
++
++	static	__int64 __attribute__ ((used)) fix_054n184 		= 0xd630d630d630d630;
++	static	__int64 __attribute__ ((used)) fix_054				= 0x1151115111511151;
++	static	__int64 __attribute__ ((used)) fix_054p076			= 0x29cf29cf29cf29cf;
++	static	__int64 __attribute__ ((used)) fix_n196p307n256	= 0xd18cd18cd18cd18c;
++	static	__int64 __attribute__ ((used)) fix_n089n039p150	= 0x06c206c206c206c2;
++	static	__int64 __attribute__ ((used)) fix_n256			= 0xadfdadfdadfdadfd;
++	static	__int64 __attribute__ ((used)) fix_n039			= 0xf384f384f384f384;
++	static	__int64 __attribute__ ((used)) fix_n256n039p205	= 0xe334e334e334e334;
++	static	__int64 __attribute__ ((used)) fix_n196			= 0xc13bc13bc13bc13b;
++	static	__int64 __attribute__ ((used)) fix_n089			= 0xe333e333e333e333;
++	static	__int64 __attribute__ ((used)) fixn089n196p029		= 0xadfcadfcadfcadfc;
+ 
+-	static  __int64 const_0x2xx8		= 0x0000010000000100;
+-	static  __int64 const_0x0808		= 0x0808080808080808;
++	static  __int64 __attribute__ ((used)) const_0x2xx8		= 0x0000010000000100;
++	static  __int64 __attribute__ ((used)) const_0x0808		= 0x0808080808080808;
+ 
+ __inline void domidct8x8llmW(short *inptr, short *quantptr, int *wsptr,
+ 				   JSAMPARRAY outptr, int output_col);
+Only in jpeg-mmx-0.1.5: jidctint.c.~1~
+Only in jpeg-mmx-0.1.5: jidctint.c.~2~

Added: trunk/rpms/libmovtar/libmovtar-0.1.3.patch
===================================================================
--- trunk/rpms/libmovtar/libmovtar-0.1.3.patch	                        (rev 0)
+++ trunk/rpms/libmovtar/libmovtar-0.1.3.patch	2007-09-20 13:53:50 UTC (rev 5856)
@@ -0,0 +1,93 @@
+--- jpeg-mmx-0.1.5/jdapimin.c
++++ jpeg-mmx-0.1.5/jdapimin.c
+@@ -22,7 +22,7 @@
+ 
+ #if defined(HAVE_MMX_INTEL_MNEMONICS) || defined(HAVE_MMX_ATT_MNEMONICS)
+ int MMXAvailable;
+-int mmxsupport();
++static int mmxsupport();
+ #endif
+ 
+ /*
+@@ -413,7 +413,7 @@
+ 
+ 
+ static int mmx_supported = 0;
+-int mmxsupport()
++static int mmxsupport()
+ {
+ 
+ #ifdef HAVE_MMX_INTEL_MNEMONICS
+--- movtar_play.c
++++ movtar_play.c
+@@ -260,7 +260,9 @@
+     }
+   }
+ 
++#if defined(HAVE_MMX_ATT_MNEMONICS)
+   asm (&quot;emms&quot;);
++#endif
+ }
+ 
+ static int64 rb16mask = 0x00f800f800f800f8; // just red and blue remain
+@@ -460,7 +462,9 @@
+     }
+   }
+ 
++#if defined(HAVE_MMX_ATT_MNEMONICS)
+   asm (&quot;emms&quot;);
++#endif
+ }
+ #endif // ifndef IRIX
+ 
+--- rtjpeg/RTjpeg.h
++++ rtjpeg/RTjpeg.h
+@@ -25,7 +25,7 @@
+ #ifndef __RTjpeg_h__
+ #define __RTjpeg_h__
+ 
+-#ifndef _I386_TYPES_H
++#if 0
+ typedef unsigned char __u8;
+ typedef unsigned short __u16;
+ typedef unsigned long __u32;
+@@ -33,11 +33,13 @@
+ typedef signed char __s8;
+ typedef signed short __s16;
+ typedef signed long __s32;
++#else
++#include &lt;asm/types.h&gt;
+ #endif
+ 
+ extern void RTjpeg_init_Q(__u8 Q);
+-extern void RTjpeg_init_compress(long unsigned int *buf, int width, int height, __u8 Q);
+-extern void RTjpeg_init_decompress(long unsigned int *buf, int width, int height);
++extern void RTjpeg_init_compress(__u32 *buf, int width, int height, __u8 Q);
++extern void RTjpeg_init_decompress(__u32 *buf, int width, int height);
+ extern int RTjpeg_compressYUV420(__s8 *sp, unsigned char *bp);
+ extern int RTjpeg_compressYUV422(__s8 *sp, unsigned char *bp);
+ extern void RTjpeg_decompressYUV420(__s8 *sp, __u8 *bp);
+--- /movtar_play.c	2001-07-13 23:38:03.000000000 +0200
++++ movtar_play.c	2003-08-18 10:10:16.000000000 +0200
+@@ -141,9 +141,9 @@
+ #if defined(__GNUC__)
+ #define int64 unsigned long long
+ #endif
+-static const int64 te0 = 0x0080008000800080; // -128 &lt;&lt; 2
+-static const int64 te1 = 0xe9fa7168e9fa7168; // for cb 
+-static const int64 te2 = 0x59bad24d59bad24d; // for cr
++static const int64 __attribute__ ((used)) te0 = 0x0080008000800080; // -128 &lt;&lt; 2
++static const int64 __attribute__ ((used)) te1 = 0xe9fa7168e9fa7168; // for cb 
++static const int64 __attribute__ ((used)) te2 = 0x59bad24d59bad24d; // for cr
+ 
+ METHODDEF(void)
+ ycc_rgb32_convert_mmx (j_decompress_ptr cinfo,
+@@ -267,7 +267,7 @@
+ static int64 rb16mult = 0x2000000820000008; // mult/Add factor (see intel appnote 553)
+ static int64 g16mask = 0x0000f8000000f800; // just green remains
+ static int64 rgb16offset = 6; // shift right after the whole stuff
+-static const int64 shiftmask = 0xffff; // shift right after the whole stuff
++static const int64  __attribute__ ((used)) shiftmask = 0xffff; // shift right after the whole stuff
+ 
+ void calc_rgb16_params(struct SDL_PixelFormat *format)
+ {

Added: trunk/rpms/lmbench/lmbench-3.0-a7-bw_tcp.patch
===================================================================
--- trunk/rpms/lmbench/lmbench-3.0-a7-bw_tcp.patch	                        (rev 0)
+++ trunk/rpms/lmbench/lmbench-3.0-a7-bw_tcp.patch	2007-09-20 13:53:50 UTC (rev 5856)
@@ -0,0 +1,9 @@
+--- lmbench-3.0-a7/doc/bw_tcp.8.bw_tcp	2000-10-16 18:14:01.000000000 +0300
++++ lmbench-3.0-a7/doc/bw_tcp.8	2006-11-17 14:29:35.000000000 +0200
+@@ -1,5 +1,5 @@
+ .\&quot; $Id$
+-.TH BW_TCP 1 &quot;$Date$&quot; &quot;(c)1994 Larry McVoy&quot; &quot;LMBENCH&quot;
++.TH BW_TCP 8 &quot;$Date$&quot; &quot;(c)1994 Larry McVoy&quot; &quot;LMBENCH&quot;
+ .SH NAME
+ bw_tcp \- time data movement through TCP/IP sockets
+ .SH SYNOPSIS

Added: trunk/rpms/lmbench/lmbench-3.0-a7-clean_script_warnings.patch
===================================================================
--- trunk/rpms/lmbench/lmbench-3.0-a7-clean_script_warnings.patch	                        (rev 0)
+++ trunk/rpms/lmbench/lmbench-3.0-a7-clean_script_warnings.patch	2007-09-20 13:53:50 UTC (rev 5856)
@@ -0,0 +1,212 @@
+--- lmbench-3.0-a7/scripts/bghtml.clean_script_warnings	2000-02-01 02:29:31.000000000 +0200
++++ lmbench-3.0-a7/scripts/bghtml	2006-11-17 14:24:47.000000000 +0200
+@@ -1,4 +1,4 @@
+-
++#!/usr/bin/env perl
+ # Make HTML files that will point to the right GIF files.
+ # Usage: bghtml file file file....
+ #
+--- lmbench-3.0-a7/scripts/depend.clean_script_warnings	2006-04-30 10:35:59.000000000 +0300
++++ lmbench-3.0-a7/scripts/depend	2006-11-17 14:24:47.000000000 +0200
+@@ -1,4 +1,4 @@
+-
++#!/usr/bin/env perl
+ # Figure out dependencies for lmbench src.
+ #
+ # Hacked into existence by Larry McVoy (<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">lm at sun.com</A> now <A HREF="http://lists.repoforge.org/mailman/listinfo/commits">lm at sgi.com</A>).
+--- lmbench-3.0-a7/scripts/getbw.clean_script_warnings	2000-02-01 02:29:31.000000000 +0200
++++ lmbench-3.0-a7/scripts/getbw	2006-11-17 14:24:47.000000000 +0200
+@@ -1,4 +1,4 @@
+-
++#!/usr/bin/env perl
+ # Extract the bandwith information.
+ # Usage: getbw file file....
+ #
+--- lmbench-3.0-a7/scripts/bargraph.clean_script_warnings	2000-02-01 02:29:31.000000000 +0200
++++ lmbench-3.0-a7/scripts/bargraph	2006-11-17 14:24:47.000000000 +0200
+@@ -1,3 +1,4 @@
++#!/usr/bin/env perl
+ # $Id$
+ eval 'exec perl -Ss $0 &quot;$@&quot;'
+ 	if 0;
+--- lmbench-3.0-a7/scripts/gifs.clean_script_warnings	2000-02-01 02:29:31.000000000 +0200
++++ lmbench-3.0-a7/scripts/gifs	2006-11-17 14:24:47.000000000 +0200
+@@ -1,4 +1,4 @@
+-
++#!/usr/bin/env perl
+ # Make HTML files that will point to the right GIF files.
+ # Usage: bghtml file file file....
+ #
+--- lmbench-3.0-a7/scripts/getctx.clean_script_warnings	2005-09-04 14:04:28.000000000 +0300
++++ lmbench-3.0-a7/scripts/getctx	2006-11-17 14:24:47.000000000 +0200
+@@ -1,4 +1,4 @@
+-
++#!/usr/bin/env perl
+ # Extract the context switching information from lmbench result files.
+ # Usage: getctx file file....
+ #
+--- lmbench-3.0-a7/scripts/getmem.clean_script_warnings	2005-09-04 14:04:28.000000000 +0300
++++ lmbench-3.0-a7/scripts/getmem	2006-11-17 14:24:47.000000000 +0200
+@@ -1,4 +1,4 @@
+-
++#!/usr/bin/env perl
+ # Extract the memory latency graph data from lmbench result files.
+ # 
+ # Hacked into existence by Larry McVoy (<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">lm at sun.com</A> now <A HREF="http://lists.repoforge.org/mailman/listinfo/commits">lm at sgi.com</A>).
+--- lmbench-3.0-a7/scripts/getpercent.clean_script_warnings	2005-09-04 14:04:28.000000000 +0300
++++ lmbench-3.0-a7/scripts/getpercent	2006-11-17 14:24:47.000000000 +0200
+@@ -1,4 +1,4 @@
+-
++#!/usr/bin/env perl
+ # Generate an ascii percentage summary from lmbench result files.
+ # Usage: getpercent file file file...
+ #
+--- lmbench-3.0-a7/scripts/allmem.clean_script_warnings	2006-04-30 10:35:59.000000000 +0300
++++ lmbench-3.0-a7/scripts/allmem	2006-11-17 14:24:47.000000000 +0200
+@@ -1,4 +1,4 @@
+-
++#!/usr/bin/env perl
+ # Extract the memory latency graph data from lmbench result files.
+ # 
+ # Hacked into existence by Larry McVoy (<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">lm at sun.com</A> now <A HREF="http://lists.repoforge.org/mailman/listinfo/commits">lm at sgi.com</A>).
+--- lmbench-3.0-a7/scripts/html-man.clean_script_warnings	2000-02-01 02:29:31.000000000 +0200
++++ lmbench-3.0-a7/scripts/html-man	2006-11-17 14:24:47.000000000 +0200
+@@ -1,3 +1,4 @@
++#!/usr/bin/env perl
+ eval 'exec perl -Ssw $0 &quot;$@&quot;'
+ 	if 0;
+ 
+--- lmbench-3.0-a7/scripts/percent.clean_script_warnings	2000-02-01 02:29:31.000000000 +0200
++++ lmbench-3.0-a7/scripts/percent	2006-11-17 14:24:47.000000000 +0200
+@@ -1,4 +1,4 @@
+-
++#!/usr/bin/env perl
+ eval &quot;exec perl -sS $0 $*&quot;
+ 	if 0;
+ 
+--- lmbench-3.0-a7/scripts/save.clean_script_warnings	2000-02-01 02:29:31.000000000 +0200
++++ lmbench-3.0-a7/scripts/save	2006-11-17 14:24:47.000000000 +0200
+@@ -1,3 +1,4 @@
++#!/usr/bin/env perl
+ # Save the input in the specified file if possible.  If the file exists,
+ # add a numeric suffice, i.e., .1, and increment that until the file
+ # does not exist.  Use the first name found as the file to save.
+--- lmbench-3.0-a7/scripts/new2oldctx.clean_script_warnings	2000-02-01 02:29:31.000000000 +0200
++++ lmbench-3.0-a7/scripts/new2oldctx	2006-11-17 14:24:47.000000000 +0200
+@@ -1,4 +1,4 @@
+-
++#!/usr/bin/env perl
+ # Convert the new format:
+ # Context switch of 8 4k processes: 64.17 (60.02 overhead)
+ # to the old format:
+--- lmbench-3.0-a7/scripts/getbg.clean_script_warnings	2005-09-04 14:04:28.000000000 +0300
++++ lmbench-3.0-a7/scripts/getbg	2006-11-17 14:24:47.000000000 +0200
+@@ -1,4 +1,4 @@
+-
++#!/usr/bin/env perl
+ # Extract bargraph data from lmbench results.
+ # Usage: getbg file file file....
+ #
+--- lmbench-3.0-a7/scripts/allctx.clean_script_warnings	2006-04-30 10:35:59.000000000 +0300
++++ lmbench-3.0-a7/scripts/allctx	2006-11-17 14:24:47.000000000 +0200
+@@ -1,4 +1,4 @@
+-
++#!/usr/bin/env perl
+ # Extract the context switching information from lmbench result files.
+ # Usage: getctx file file....
+ #
+--- lmbench-3.0-a7/scripts/graph.clean_script_warnings	2006-04-30 10:35:59.000000000 +0300
++++ lmbench-3.0-a7/scripts/graph	2006-11-17 14:24:47.000000000 +0200
+@@ -1,4 +1,4 @@
+-
++#!/usr/bin/env perl
+ # $Id$
+ eval &quot;exec perl -Ss $0 $@&quot;
+ 	if 0;
+--- lmbench-3.0-a7/scripts/rccs.clean_script_warnings	2000-02-01 02:29:31.000000000 +0200
++++ lmbench-3.0-a7/scripts/rccs	2006-11-17 14:24:47.000000000 +0200
+@@ -1,4 +1,4 @@
+-
++#!/usr/bin/env perl
+ eval 'exec perl -Ssw $0 &quot;$@&quot;'
+ 	if 0;
+ 
+--- lmbench-3.0-a7/scripts/stats.clean_script_warnings	2006-04-30 10:34:52.000000000 +0300
++++ lmbench-3.0-a7/scripts/stats	2006-11-17 14:24:47.000000000 +0200
+@@ -1,4 +1,4 @@
+-
++#!/usr/bin/env perl
+ # Convert the Y coordinate to an average
+ 
+ eval &quot;exec perl -sS $0 $*&quot;
+--- lmbench-3.0-a7/scripts/man2html.clean_script_warnings	2006-04-30 10:35:13.000000000 +0300
++++ lmbench-3.0-a7/scripts/man2html	2006-11-17 14:24:47.000000000 +0200
+@@ -1,3 +1,4 @@
++#!/usr/bin/env perl
+ eval 'exec perl -Ssw $0 &quot;$@&quot;'
+ 	if 0;
+ 
+--- lmbench-3.0-a7/scripts/statsummary.clean_script_warnings	2000-07-26 18:10:01.000000000 +0300
++++ lmbench-3.0-a7/scripts/statsummary	2006-11-17 14:24:47.000000000 +0200
+@@ -1,4 +1,4 @@
+-
++#!/usr/bin/env perl
+ # Generate an ascii summary from lmbench result files BY HOSTNAME
+ # instead of architecture.  Sorry, I think of these tools as being
+ # used to measure and prototype particular named systems, not as
+--- lmbench-3.0-a7/scripts/getmax.clean_script_warnings	2000-02-01 02:29:31.000000000 +0200
++++ lmbench-3.0-a7/scripts/getmax	2006-11-17 14:24:47.000000000 +0200
+@@ -1,4 +1,4 @@
+-
++#!/usr/bin/env perl
+ # Look at a bunch of bargraph files and figure out the max amongst them all.
+ # Usage: getmax file file file....
+ #
+--- lmbench-3.0-a7/scripts/getdisk.clean_script_warnings	2000-02-01 02:29:31.000000000 +0200
++++ lmbench-3.0-a7/scripts/getdisk	2006-11-17 14:24:47.000000000 +0200
+@@ -1,4 +1,4 @@
+-
++#!/usr/bin/env perl
+ # Extract the disk graph data from lmbench result files.
+ # 
+ # Hacked into existence by Larry McVoy 
+--- lmbench-3.0-a7/scripts/getlist.clean_script_warnings	2000-07-26 18:10:01.000000000 +0300
++++ lmbench-3.0-a7/scripts/getlist	2006-11-17 14:24:47.000000000 +0200
+@@ -1,4 +1,4 @@
+-
++#!/usr/bin/env perl
+ # Find everything in my results directory that looks like lmbench output.
+ #
+ # Hacked into existence by Larry McVoy (<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">lm at bitmover.com</A>)
+--- lmbench-3.0-a7/scripts/getsummary.clean_script_warnings	2005-09-04 14:04:28.000000000 +0300
++++ lmbench-3.0-a7/scripts/getsummary	2006-11-17 14:24:47.000000000 +0200
+@@ -1,4 +1,4 @@
+-
++#!/usr/bin/env perl
+ # Generate an ascii summary from lmbench result files.
+ # Usage: getsummary file file file...
+ #
+--- lmbench-3.0-a7/scripts/opercent.clean_script_warnings	2000-02-01 02:29:31.000000000 +0200
++++ lmbench-3.0-a7/scripts/opercent	2006-11-17 14:24:47.000000000 +0200
+@@ -1,4 +1,4 @@
+-
++#!/usr/bin/env perl
+ eval &quot;exec perl -sS $0 $*&quot;
+ 	if 0;
+ 
+--- lmbench-3.0-a7/scripts/html-list.clean_script_warnings	2000-02-01 02:29:31.000000000 +0200
++++ lmbench-3.0-a7/scripts/html-list	2006-11-17 14:24:47.000000000 +0200
+@@ -1,4 +1,4 @@
+-
++#!/usr/bin/env perl
+ # Take the list of files and turn them into an html file that points
+ # at their context &amp; mem latency GIFs.
+ #
+--- lmbench-3.0-a7/scripts/SHIT.clean_script_warnings	2000-02-01 01:05:45.000000000 +0200
++++ lmbench-3.0-a7/scripts/SHIT	2006-11-17 14:24:47.000000000 +0200
+@@ -1,4 +1,4 @@
+-
++#!/usr/bin/env perl
+ # Go find perl if we are running this as a shell script.
+ eval 'exec perl -Ssw $0 &quot;$@&quot;'
+ 	if 0;

Added: trunk/rpms/lmbench/lmbench-3.0-a7-man_pages.patch
===================================================================
--- trunk/rpms/lmbench/lmbench-3.0-a7-man_pages.patch	                        (rev 0)
+++ trunk/rpms/lmbench/lmbench-3.0-a7-man_pages.patch	2007-09-20 13:53:50 UTC (rev 5856)
@@ -0,0 +1,31 @@
+--- lmbench-3.0-a7/doc/lmbench.8.man_pages	2006-04-30 10:39:18.000000000 +0300
++++ lmbench-3.0-a7/doc/lmbench.8	2006-11-17 14:28:06.000000000 +0200
+@@ -37,7 +37,7 @@
+ .I repetitions
+ is 11.
+ .SH BANDWIDTH MEASUREMENTS
+-Data movement is fundemental to the performance on most computer systems.
++Data movement is fundamental to the performance on most computer systems.
+ The bandwidth measurements are intended to show how the system can move
+ data.  The results of the bandwidth metrics can be compared but care
+ must be taken to understand what it is that is being compared.  The
+@@ -75,7 +75,7 @@
+ bw_unix
+ reading data from a UNIX socket.
+ .SH LATENCY MEASUREMENTS
+-Control messages are also fundemental to the performance on most
++Control messages are also fundamental to the performance on most
+ computer systems.  The latency measurements are intended to show how fast
+ a system can be told to do some operation.  The results of the 
+ latency metrics can be compared to each other
+--- lmbench-3.0-a7/doc/lat_mmap.8.man_pages	2000-10-16 18:14:01.000000000 +0300
++++ lmbench-3.0-a7/doc/lat_mmap.8	2006-11-17 14:28:06.000000000 +0200
+@@ -18,7 +18,7 @@
+ .SH DESCRIPTION
+ .B lat_mmap
+ times how fast a mapping can be made and unmade.  This is useful because it
+-is a fundemental part of processes that use SunOS style shared libraries
++is a fundamental part of processes that use SunOS style shared libraries
+ (the libraries are mapped in at process start up time and unmapped at 
+ process exit).
+ .LP

Added: trunk/rpms/lmbench/lmbench-3.0-a7-run.sh
===================================================================
--- trunk/rpms/lmbench/lmbench-3.0-a7-run.sh	                        (rev 0)
+++ trunk/rpms/lmbench/lmbench-3.0-a7-run.sh	2007-09-20 13:53:50 UTC (rev 5856)
@@ -0,0 +1,19 @@
+#!/bin/sh
+# Wrapper script for lmbench
+
+if [ $(id -u) -gt 0 ]; then
+    echo &quot;You must run this as the root user&quot;
+    exit 0
+fi
+
+cd /usr/lib/lmbench/results
+if [ -n &quot;$1&quot; -a -x ../scripts/${1} ]; then
+    exec ../scripts/$@
+else
+    CONFIG=`../scripts/config`
+    OS=`../scripts/os`
+    [ -f &quot;../bin/$OS/$CONFIG&quot; ] || ../scripts/config-run
+    ../scripts/results
+fi
+cd - &gt;/dev/null
+exit 0

Added: trunk/rpms/plib/plib-1.8.4-autorepeat.patch
===================================================================
--- trunk/rpms/plib/plib-1.8.4-autorepeat.patch	                        (rev 0)
+++ trunk/rpms/plib/plib-1.8.4-autorepeat.patch	2007-09-20 13:53:50 UTC (rev 5856)
@@ -0,0 +1,109 @@
+--- plib-1.8.4/src/pw/pwX11.cxx.key	2006-10-05 19:56:42.000000000 +0200
++++ plib-1.8.4/src/pw/pwX11.cxx	2006-10-05 20:04:19.000000000 +0200
+@@ -117,11 +117,19 @@
+ static XTextProperty *titlePropertyPtr = NULL;
+ 
+ static bool autoRepeat = false ;
++static bool haveFocus = false ;
+ 
+ static void getEvents ();
+ 
+ void pwSetAutoRepeatKey ( bool enable )
+ {
++  if ( (autoRepeat != enable) &amp;&amp; haveFocus )
++  {
++    if ( enable )
++      XAutoRepeatOn ( currDisplay ) ;
++    else
++      XAutoRepeatOff ( currDisplay ) ;
++  }
+   autoRepeat = enable ;
+ }
+ 
+@@ -351,7 +359,7 @@
+                        KeyPressMask        | KeyReleaseMask       |
+ 		       EnterWindowMask     | LeaveWindowMask      |
+                        PointerMotionMask   | ButtonMotionMask     |
+-                       VisibilityChangeMask ;
++                       VisibilityChangeMask| FocusChangeMask;
+ 
+   attribs.background_pixmap = None ;
+   attribs.background_pixel  = 0    ;
+@@ -405,6 +413,10 @@
+   XMapWindow       ( currDisplay, wmWindow ) ;
+   glXMakeCurrent   ( currDisplay, currHandle, currContext ) ;
+ 
++  haveFocus = true;
++  if (!autoRepeat)
++    XAutoRepeatOff ( currDisplay ) ;
++
+   pwSetCursor ( PW_CURSOR_LEFT ) ;
+ 
+ #ifdef GL_MULTISAMPLE_FILTER_HINT_NV
+@@ -717,8 +729,6 @@
+ 
+ static void getEvents ()
+ {
+-  bool repeating = false ;
+-  char keyflags [ 32 ] ;
+   XEvent event ;
+ 
+   insideCallback = true ;
+@@ -770,6 +780,18 @@
+           (*mpCB) ( event.xmotion.x, event.xmotion.y ) ;
+         break ;
+ 
++      case FocusIn:
++        if ( !haveFocus &amp;&amp; !autoRepeat )
++          XAutoRepeatOff ( currDisplay ) ;
++        haveFocus = true;
++        break;
++
++      case FocusOut:
++        if ( haveFocus &amp;&amp; !autoRepeat )
++          XAutoRepeatOn ( currDisplay ) ;
++        haveFocus = false;
++        break;
++
+       case ButtonRelease   :
+         updown = PW_UP ;
+         /* FALLTHROUGH */
+@@ -792,23 +814,9 @@
+ 
+       case KeyRelease      :
+         updown = PW_UP ;
+-
+-        XQueryKeymap ( currDisplay, keyflags ) ;
+-
+-        repeating = ( ( keyflags [ event.xkey.keycode &gt;&gt; 3 ] &amp;
+-                          ( 1 &lt;&lt; ( event.xkey.keycode &amp; 7 ) ) ) != 0 ) ;
+-
+         /* FALLTHROUGH */
+ 
+       case KeyPress        :
+-        /*
+-          Only generate a key up callback if the key is actually up
+-          and not repeating.
+-        */
+-
+-        if ( ! autoRepeat &amp;&amp; repeating )
+-          break ;
+-
+         XComposeStatus composeStatus ;
+         char           asciiCode [ 32 ] ;
+         KeySym         keySym ;
+@@ -1021,10 +1029,14 @@
+   if ( fsWindow != None )
+     pwSetWindowed ( ) ;
+ 
++  if ( haveFocus &amp;&amp; !autoRepeat )
++    XAutoRepeatOn ( currDisplay ) ;
++
+   glXDestroyContext ( currDisplay, currContext ) ;
+   XDestroyWindow    ( currDisplay, currHandle  ) ;
+   XDestroyWindow    ( currDisplay, wmWindow    ) ;
+   XCloseDisplay     ( currDisplay ) ;
++  haveFocus = false;
+   currDisplay = NULL;
+ }
+ 

Added: trunk/rpms/plib/plib-1.8.4-extraqualif.patch
===================================================================
--- trunk/rpms/plib/plib-1.8.4-extraqualif.patch	                        (rev 0)
+++ trunk/rpms/plib/plib-1.8.4-extraqualif.patch	2007-09-20 13:53:50 UTC (rev 5856)
@@ -0,0 +1,21 @@
+diff -Naupr plib-1.8.4.orig/src/ssgAux/ssgaSky.h plib-1.8.4/src/ssgAux/ssgaSky.h
+--- plib-1.8.4.orig/src/ssgAux/ssgaSky.h	2003-09-26 16:54:20.000000000 +0200
++++ plib-1.8.4/src/ssgAux/ssgaSky.h	2006-02-09 18:59:30.000000000 +0100
+@@ -104,7 +104,7 @@ public:
+   ssgaCelestialBodyList ( int init = 3 )
+ 	  : ssgSimpleList ( sizeof(ssgaCelestialBody*), init ) { }
+ 
+-  ssgaCelestialBodyList::~ssgaCelestialBodyList () { removeAll(); }
++  ~ssgaCelestialBodyList () { removeAll(); }
+ 
+   int getNum (void) { return total ; }
+ 
+@@ -192,7 +192,7 @@ public:
+   ssgaCloudLayerList ( int init = 3 )
+ 	  : ssgSimpleList ( sizeof(ssgaCloudLayer*), init ) { }
+ 
+-  ssgaCloudLayerList::~ssgaCloudLayerList () { removeAll(); }
++  ~ssgaCloudLayerList () { removeAll(); }
+ 
+   int getNum (void) { return total ; }
+ 

Added: trunk/rpms/plib/plib-1.8.4-fullscreen.patch
===================================================================
--- trunk/rpms/plib/plib-1.8.4-fullscreen.patch	                        (rev 0)
+++ trunk/rpms/plib/plib-1.8.4-fullscreen.patch	2007-09-20 13:53:50 UTC (rev 5856)
@@ -0,0 +1,677 @@
+--- plib-1.8.4/src/pw/pw.h.fs	2004-04-07 01:45:19.000000000 +0200
++++ plib-1.8.4/src/pw/pw.h	2006-05-17 16:03:09.000000000 +0200
+@@ -54,6 +54,11 @@
+ void pwSetCursor     ( int c ) ;
+ void pwCleanup       () ;
+ void pwSetAutoRepeatKey ( bool enable ) ;
++void pwSetResizable ( bool enable ) ;
++void pwSetCursorEx ( int wm, int fs ) ;
++void pwSetFullscreen () ;
++void pwSetWindowed () ;
++void pwToggleFullscreen () ;
+ 
+ #define PW_CURSOR_NONE    0
+ #define PW_CURSOR_RIGHT   1
+--- plib-1.8.4/src/pw/pwX11.cxx.fs	2004-04-07 01:45:19.000000000 +0200
++++ plib-1.8.4/src/pw/pwX11.cxx	2006-05-17 16:06:07.000000000 +0200
+@@ -74,14 +74,31 @@
+ 
+ #endif
+ 
+-static bool initialised    = false ;
++/* For XF86VIDMODE Support */
++#ifdef XF86VIDMODE
++#include &lt;X11/extensions/xf86vmode.h&gt;   
++
++static struct xf86vidmode_data {
++  int vidmode_available;
++  XF86VidModeModeInfo orig_mode;
++  int orig_viewport_x;
++  int orig_viewport_y;
++} XF86VidModeData = { 1, { 0 }, 0, 0 };
++
++static void xf86_vidmode_init () ;
++#endif
++
+ static bool insideCallback = false ;
++static bool resizable      = true;
++static bool mouse_grabbed  = false;
++static bool keyb_grabbed = false;
+ static int modifiers   = 0 ;
+ static int origin [2]  = {   0,   0 } ;
+ static int size   [2]  = { 640, 480 } ;
+ static int currScreen  = 0 ;
+ static int currConnect = 0 ;
+-static int currCursor  = PW_CURSOR_LEFT ;
++static int wmCursor    = PW_CURSOR_LEFT ;
++static int fsCursor    = PW_CURSOR_LEFT ;
+ 
+ static pwResizeCB     *resizeCB = NULL ;
+ static pwExitCB       *exitCB   = NULL ;
+@@ -92,12 +110,17 @@
+ static Display     *currDisplay = NULL ;
+ static XVisualInfo *visualInfo  = NULL ;
+ static Window       currHandle  ;
++static Window       wmWindow    ;
++static Window       fsWindow    = None ;
+ static GLXContext   currContext ;
+ static Window       rootWindow  ;
+ static Atom         delWinAtom  ;
++static XTextProperty *titlePropertyPtr = NULL;
+ 
+ static bool autoRepeat = false ;
+ 
++static void getEvents ();
++
+ void pwSetAutoRepeatKey ( bool enable )
+ {
+   autoRepeat = enable ;
+@@ -181,6 +204,41 @@
+ }
+ 
+ 
++static void pwRealSetResizable ( bool enable, int width, int height )
++{
++  XSizeHints         sizeHints ;
++  XWMHints             wmHints ;
++
++  resizable = enable;
++
++  if (resizable)
++    sizeHints.flags     = USSize;
++  else
++    sizeHints.flags     = PSize | PMinSize | PMaxSize;;
++
++  if ( origin[0] &gt;= 0 &amp;&amp; origin[1] &gt;= 0 )
++    sizeHints.flags |= USPosition ;
++
++  sizeHints.x           = origin[0] ;
++  sizeHints.y           = origin[1] ;
++  sizeHints.width       = width ;
++  sizeHints.height      = height ;
++  sizeHints.min_width   = width ;
++  sizeHints.min_height  = height ;
++  sizeHints.base_width  = width ;
++  sizeHints.base_height = height ;
++  sizeHints.max_width   = width ;
++  sizeHints.max_height  = height ;
++
++  wmHints.flags         = StateHint;
++  wmHints.initial_state = NormalState ;
++
++  XSetWMProperties ( currDisplay, wmWindow,
++	                  titlePropertyPtr, titlePropertyPtr, 0, 0,
++                          &amp;sizeHints, &amp;wmHints, NULL ) ;
++}
++
++
+ void pwInit ( int multisample, int num_samples )
+ {
+   pwInit ( 0, 0, -1, -1, multisample, &quot;NoName&quot;, FALSE, num_samples ) ;
+@@ -191,7 +249,7 @@
+                       pwMousePosFunc *mp, pwResizeCB *rcb,
+                       pwExitCB *ecb )
+ {
+-  if ( ! initialised )
++  if ( ! currDisplay )
+   {
+     fprintf ( stderr, &quot;PW: You must not call pwSetCallbacks before pwInit.\n&quot;);
+     exit ( 1 ) ;
+@@ -228,6 +286,7 @@
+   {
+     fprintf ( stderr, &quot;PW: GLX extension not available on display '%s'?!?&quot;,
+                                              XDisplayName ( displayName ) ) ;
++    XCloseDisplay ( currDisplay ) ;
+     exit ( 1 ) ;
+   }
+ 
+@@ -235,6 +294,11 @@
+   rootWindow   = RootWindow       ( currDisplay, currScreen ) ;
+   currConnect  = ConnectionNumber ( currDisplay ) ;
+   delWinAtom   = XInternAtom      ( currDisplay, &quot;WM_DELETE_WINDOW&quot;, 0 ) ;
++  fsWindow     = None;
++  
++#ifdef XF86VIDMODE
++  xf86_vidmode_init () ;
++#endif
+ 
+   if ( w == -1 ) w = DisplayWidth  ( currDisplay, currScreen ) ;
+   if ( h == -1 ) h = DisplayHeight ( currDisplay, currScreen ) ;
+@@ -244,10 +308,8 @@
+   size   [ 0 ] = w ;
+   size   [ 1 ] = h ;
+ 
++  static XTextProperty titleProperty ;
+   XSetWindowAttributes attribs ;
+-  XTextProperty   textProperty ;
+-  XSizeHints         sizeHints ;
+-  XWMHints             wmHints ;
+   unsigned int            mask ;
+   PixelFormat               pf ;
+ 
+@@ -280,6 +342,7 @@
+     if ( visualInfo == NULL )
+     {
+       fprintf ( stderr, &quot;PW: Unable to open a suitable graphics window,\n&quot; ) ;
++      XCloseDisplay ( currDisplay ) ;
+       exit ( 1 ) ;
+     }
+   }
+@@ -300,7 +363,12 @@
+ 
+   mask = CWBackPixmap | CWBorderPixel | CWColormap | CWEventMask;
+ 
+-  currHandle = XCreateWindow ( currDisplay, rootWindow,
++  wmWindow = XCreateWindow ( currDisplay, rootWindow,
++                           x, y, w, h, 0, visualInfo-&gt;depth,
++                           InputOutput, visualInfo-&gt;visual,
++                           mask, &amp;attribs ) ;
++
++  currHandle = XCreateWindow ( currDisplay, wmWindow,
+                            x, y, w, h, 0, visualInfo-&gt;depth,
+                            InputOutput, visualInfo-&gt;visual,
+                            mask, &amp;attribs ) ;
+@@ -315,19 +383,6 @@
+     fprintf ( stderr,&quot;PW: That may be bad for performance.&quot; ) ;
+   }
+ 
+-  sizeHints.flags = 0 ;
+-
+-  if ( x &gt;= 0 &amp;&amp; y &gt;= 0 )
+-    sizeHints.flags |= USPosition ;
+-
+-  sizeHints.flags |= USSize ;
+-
+-  sizeHints.x      = x ; sizeHints.y      = y ;
+-  sizeHints.width  = w ; sizeHints.height = h ;
+-
+-  wmHints.flags = StateHint;
+-  wmHints.initial_state = NormalState ;
+-
+   PropMotifWmHints hints  ;
+   Atom prop_t ;
+   Atom prop   ;
+@@ -338,17 +393,17 @@
+   prop_t = prop = XInternAtom ( currDisplay, &quot;_MOTIF_WM_HINTS&quot;, True ) ;
+ 
+   if ( prop != 0 )
+-    XChangeProperty ( currDisplay, currHandle, prop, prop_t, 32,
++    XChangeProperty ( currDisplay, wmWindow, prop, prop_t, 32,
+                       PropModeReplace, (unsigned char *) &amp;hints,
+                       PROP_MOTIF_WM_HINTS_ELEMENTS) ;
+ 
+-  XStringListToTextProperty ( (char **) &amp;title, 1, &amp;textProperty ) ;
++  if (XStringListToTextProperty ( (char **) &amp;title, 1, &amp;titleProperty ) )
++    titlePropertyPtr = &amp;titleProperty;
+ 
+-  XSetWMProperties ( currDisplay, currHandle,
+-	                  &amp;textProperty, &amp;textProperty, 0, 0,
+-                          &amp;sizeHints, &amp;wmHints, NULL ) ;
+-  XSetWMProtocols  ( currDisplay, currHandle, &amp;delWinAtom  , 1 );
++  pwRealSetResizable   ( true, w, h );
++  XSetWMProtocols  ( currDisplay, wmWindow, &amp;delWinAtom  , 1 );
+   XMapWindow       ( currDisplay, currHandle ) ;
++  XMapWindow       ( currDisplay, wmWindow ) ;
+   glXMakeCurrent   ( currDisplay, currHandle, currContext ) ;
+ 
+   pwSetCursor ( PW_CURSOR_LEFT ) ;
+@@ -357,13 +412,14 @@
+   glHint ( GL_MULTISAMPLE_FILTER_HINT_NV, multisample ) ;
+ #endif
+ 
++  atexit( pwCleanup ) ;
++
+   kbCB     = NULL ;
+   msCB     = NULL ;
+   mpCB     = NULL ;
+   resizeCB = NULL ;
+   exitCB   = defaultExitFunc ;
+ 
+-  initialised = true ;
+   insideCallback = false ;
+ 
+   glClear ( GL_COLOR_BUFFER_BIT ) ;
+@@ -373,6 +429,14 @@
+ }
+ 
+ 
++void pwSetResizable ( bool enable )
++{
++  /* Make sure we get any last resize events before doing this */
++  getEvents();
++  pwRealSetResizable ( enable, size[0], size[1] ) ;
++}
++
++
+ void pwGetSize ( int *w, int *h )
+ {
+   if ( w ) *w = size[0] ;
+@@ -380,17 +444,19 @@
+ }
+ 
+ 
+-void pwSetCursor ( int c )
++void pwRealSetCursor ( int c )
+ {
++  int newCursor;
++
+   switch ( c )
+   {
+-    case PW_CURSOR_RIGHT  : currCursor = XC_right_ptr      ; break ;
+-    case PW_CURSOR_LEFT   : currCursor = XC_left_ptr       ; break ;
+-    case PW_CURSOR_QUERY  : currCursor = XC_question_arrow ; break ;
+-    case PW_CURSOR_AIM    : currCursor = XC_target         ; break ;
+-    case PW_CURSOR_CIRCLE : currCursor = XC_circle         ; break ;
+-    case PW_CURSOR_WAIT   : currCursor = XC_watch          ; break ;
+-    case PW_CURSOR_CROSS  : currCursor = XC_crosshair      ; break ;
++    case PW_CURSOR_RIGHT  : newCursor = XC_right_ptr      ; break ;
++    case PW_CURSOR_LEFT   : newCursor = XC_left_ptr       ; break ;
++    case PW_CURSOR_QUERY  : newCursor = XC_question_arrow ; break ;
++    case PW_CURSOR_AIM    : newCursor = XC_target         ; break ;
++    case PW_CURSOR_CIRCLE : newCursor = XC_circle         ; break ;
++    case PW_CURSOR_WAIT   : newCursor = XC_watch          ; break ;
++    case PW_CURSOR_CROSS  : newCursor = XC_crosshair      ; break ;
+ 
+     case PW_CURSOR_NONE  :
+     default:
+@@ -406,36 +472,231 @@
+                         XCreatePixmapCursor ( currDisplay,
+                             pix, pix, &amp;bcol, &amp;bcol, 0, 0 ) ) ;
+         XFreePixmap   ( currDisplay, pix ) ;
+-
+-        currCursor = 0 ;
+       }
+       return ;
+   }
+  
+   XDefineCursor( currDisplay, currHandle,
+-                 XCreateFontCursor ( currDisplay, currCursor ) ) ;
++                 XCreateFontCursor ( currDisplay, newCursor ) ) ;
+ }
+ 
+ 
+-void pwSetSize ( int w, int h )
++void pwSetCursor ( int c )
++{
++  pwRealSetCursor (c);
++  wmCursor = c;
++  fsCursor = c;
++}
++
++
++void pwSetCursorEx ( int wm, int fs )
+ {
++  if (fsWindow == None)
++    pwRealSetCursor (wm);
++  else
++    pwRealSetCursor (fs);
++  wmCursor = wm;
++  fsCursor = fs;
++}
++
++
++#ifdef XF86VIDMODE      
++static void
++xf86_vidmode_init ( void )
++{
++  int i,j;
++  XF86VidModeModeLine *l = (XF86VidModeModeLine *)((char *)
++    &amp;XF86VidModeData.orig_mode + sizeof XF86VidModeData.orig_mode.dotclock);
++  
++  if (!XF86VidModeQueryVersion(currDisplay, &amp;i, &amp;j))
++    XF86VidModeData.vidmode_available = 0;
++  else if (!XF86VidModeQueryExtension(currDisplay, &amp;i, &amp;j))
++    XF86VidModeData.vidmode_available = 0;
++  else if (!XF86VidModeGetModeLine(currDisplay, currScreen,
++            (int *)&amp;XF86VidModeData.orig_mode.dotclock, l))
++    XF86VidModeData.vidmode_available = 0;
++  else if (!XF86VidModeGetViewPort(currDisplay, currScreen,
++            &amp;XF86VidModeData.orig_viewport_x,
++            &amp;XF86VidModeData.orig_viewport_y))
++    XF86VidModeData.vidmode_available = 0;
++  
++  if (!XF86VidModeData.vidmode_available)
++    fprintf(stderr, &quot;Warning: XF86VidMode not available\n&quot;);
++}
++
++
++/* qsort comparison function for sorting the modes */
++static int cmpmodes(const void *va, const void *vb)
++{
++    const XF86VidModeModeInfo *a = *(const XF86VidModeModeInfo **)va;
++    const XF86VidModeModeInfo *b = *(const XF86VidModeModeInfo **)vb;
++    if ( a-&gt;hdisplay == b-&gt;hdisplay )
++        return b-&gt;vdisplay - a-&gt;vdisplay;  
++    else
++        return b-&gt;hdisplay - a-&gt;hdisplay;
++}
++
++
++static void pwXf86VmSetFullScreenResolution (int desired_width,
++  int desired_height, int &amp;result_width, int &amp;result_height)
++{
++  int i;
++  XF86VidModeModeLine mode ; /* = { .hdisplay = 0, .privsize = 0 } ; */
++  XF86VidModeModeInfo **modes;
++  int mode_count;
++  
++  /* C++ can't do struct initialization by struct member name? */
++  mode.hdisplay = 0;
++  mode.privsize = 0;
++
++  if ( ! XF86VidModeData.vidmode_available )
++    return;
++  
++  /* Try to switch video mode. This must be done after the pointer is
++     grabbed, because otherwise it can be outside the window negating the
++     XF86VidModeSetViewPort. */
++  if (XF86VidModeGetModeLine(currDisplay, currScreen, &amp;i, &amp;mode))
++  {
++    result_width  = mode.hdisplay;
++    result_height = mode.vdisplay;
++  }
++    
++  /* Get list of modelines.  */
++  if (!XF86VidModeGetAllModeLines(currDisplay, currScreen, &amp;mode_count, &amp;modes))
++          mode_count = 0;
++     
++  /* Search for an exact matching video mode.  */
++  for (i = 0; i &lt; mode_count; i++) {
++     if ((modes[i]-&gt;hdisplay == desired_width) &amp;&amp; 
++         (modes[i]-&gt;vdisplay == desired_height))
++       break;
++  }
++
++  /* Search for a non exact match (smallest bigger res). */
++  if (i == mode_count) {
++    int best_width = 0, best_height = 0;
++    qsort(modes, mode_count, sizeof(void *), cmpmodes);
++    for (i = mode_count-1; i &gt; 0; i--) {
++       if ( ! best_width ) {
++          if ( (modes[i]-&gt;hdisplay &gt;= desired_width) &amp;&amp;
++               (modes[i]-&gt;vdisplay &gt;= desired_height) ) {
++             best_width = modes[i]-&gt;hdisplay;
++             best_height = modes[i]-&gt;vdisplay;
++          }
++       } else {
++          if ( (modes[i]-&gt;hdisplay != best_width) ||
++               (modes[i]-&gt;vdisplay != best_height) ) {
++             i++;
++             break;
++          }
++       }
++    }
++  }
++      
++  /* Switch video mode.  */
++  if ((i &gt;= 0) &amp;&amp;
++      ((modes[i]-&gt;hdisplay != mode.hdisplay) ||
++       (modes[i]-&gt;vdisplay != mode.vdisplay)) &amp;&amp;
++      XF86VidModeSwitchToMode(currDisplay, currScreen, modes[i]))
++  {
++    result_width  = modes[i]-&gt;hdisplay;
++    result_height = modes[i]-&gt;vdisplay;
++  }
++  
++  /* Lock mode switching.  */
++  XF86VidModeLockModeSwitch(currDisplay, currScreen, True);
++         
++  /* Set viewport. */
++  XF86VidModeSetViewPort(currDisplay, currScreen, 0, 0);
++
++  /* clean up */
++  if (mode.privsize)
++    XFree(mode.c_private);
++
++  if (mode_count)
++  {
++    for (i = 0; i &lt; mode_count; i++)
++      if (modes[i]-&gt;privsize)
++        XFree(modes[i]-&gt;c_private);
++    XFree(modes);
++  }
++}
++
++
++static void pwXf86VmRestoreOriginalResolution ( )
++{
++  int i;
++  XF86VidModeModeLine mode;
++
++  if ( ! XF86VidModeData.vidmode_available )
++    return;
++  
++  /* Unlock mode switching.  */
++  XF86VidModeLockModeSwitch(currDisplay, currScreen, False);
++
++  if (!XF86VidModeGetModeLine(currDisplay, currScreen, &amp;i, &amp;mode) ||
++      (mode.hdisplay != XF86VidModeData.orig_mode.hdisplay) ||
++      (mode.vdisplay != XF86VidModeData.orig_mode.vdisplay))
++  {
++    if (!XF86VidModeSwitchToMode(currDisplay, currScreen,
++          &amp;XF86VidModeData.orig_mode))
++      fprintf(stderr, &quot;XF86VidMode couldnot restore original resolution\n&quot;);
++  }
++  if (XF86VidModeData.orig_viewport_x || XF86VidModeData.orig_viewport_y)
++  {
++    if (!XF86VidModeSetViewPort(currDisplay, currScreen,
++          XF86VidModeData.orig_viewport_x,
++          XF86VidModeData.orig_viewport_y))
++      fprintf(stderr, &quot;XF86VidMode couldnot restore original viewport\n&quot;);
++  }
++}
++#endif
++
++
++void 
++pwSetSize ( int w, int h )
++{
++  bool notResizable = !resizable;
++  
++  if (notResizable)
++    pwRealSetResizable ( true, w, h );
++
+   XResizeWindow ( currDisplay, currHandle, w, h ) ;
+-  XFlush        ( currDisplay ) ;
++  XResizeWindow ( currDisplay, wmWindow, w, h ) ;
++
++  if (notResizable)
++    pwRealSetResizable ( false, w, h );
++
++#ifdef XF86VIDMODE      
++  if (fsWindow != None)
++  {
++    int screen_w = 0, screen_h ;
++    pwXf86VmSetFullScreenResolution ( w, h, screen_w, screen_h ) ;
++    /* check pwXf86VmSetFullScreenResolution didn't fail completly. */
++    if (screen_w)
++    {
++      /* Center the window */
++      XMoveWindow ( currDisplay, currHandle, ( screen_w - w ) / 2,
++                   ( screen_h - h ) / 2 ) ;
++    }
++  }
++#endif
++
++  XFlush ( currDisplay );
+ }
+ 
+ 
+ void pwSetOrigin ( int x, int y )
+ {
+-  XMoveWindow ( currDisplay, currHandle, x, y ) ;
++  XMoveWindow ( currDisplay, wmWindow, x, y ) ;
+   XFlush      ( currDisplay ) ;
+ }
+ 
+ 
+ void pwSetSizeOrigin ( int x, int y, int w, int h )
+ {
+-  XMoveWindow   ( currDisplay, currHandle, x, y ) ;
+-  XResizeWindow ( currDisplay, currHandle, w, h ) ;
+-  XFlush        ( currDisplay ) ;
++  XMoveWindow   ( currDisplay, wmWindow, x, y ) ;
++  pwSetSize     ( w, h );
+ }
+ 
+ 
+@@ -474,7 +735,11 @@
+     switch ( event.type )
+     {
+       case ClientMessage   : (*exitCB)() ; break ;
+-      case DestroyNotify   : (*exitCB)() ; break ;
++
++      case DestroyNotify   : 
++        if ( event.xdestroywindow.window == wmWindow )
++          (*exitCB)() ;
++        break ;
+ 
+       case ConfigureNotify :
+         if ( currHandle == event.xconfigure.window &amp;&amp;
+@@ -605,7 +870,7 @@
+ 
+ void pwSwapBuffers ()
+ {
+-  if ( ! initialised )
++  if ( ! currDisplay )
+   {
+     fprintf ( stderr, &quot;PLIB/PW: FATAL - Application called pwSwapBuffers&quot;
+                       &quot; before pwInit.\n&quot; ) ;
+@@ -635,15 +900,133 @@
+ #endif
+ 
+ 
++void pwSetFullscreen ()
++{
++  XEvent event;
++  XSetWindowAttributes setattr;
++  /* local width and height vars used for fullscreen window size and for
++     storing the video_mode size which is then used to center the window */
++  int fs_width  = DisplayWidth(currDisplay, currScreen);
++  int fs_height = DisplayHeight(currDisplay, currScreen);
++
++  /* Grab the keyboard */
++  if (XGrabKeyboard(currDisplay, rootWindow, False, GrabModeAsync,
++        GrabModeAsync, CurrentTime) != GrabSuccess)
++  {
++    fprintf(stderr, &quot;Error can not grab keyboard, not going fullscreen\n&quot;);
++    return;
++  }
++  keyb_grabbed = true;
++  
++  /* Create the fullscreen window */
++  setattr.override_redirect = True;
++  setattr.background_pixel = XBlackPixel(currDisplay, currScreen);
++  setattr.border_pixel = XBlackPixel(currDisplay, currScreen);
++  setattr.event_mask = StructureNotifyMask;
++  setattr.colormap = XCreateColormap ( currDisplay, rootWindow,
++                                       visualInfo-&gt;visual, AllocNone ) ;
++  fsWindow = XCreateWindow(currDisplay, rootWindow,
++                               0, 0, fs_width, fs_height, 0,
++                               visualInfo-&gt;depth, InputOutput,
++                               visualInfo-&gt;visual, CWOverrideRedirect |
++                               CWBackPixel | CWColormap | CWBorderPixel |
++                               CWEventMask, &amp;setattr);
++
++  /* Map the fullscreen window */
++  XMapRaised(currDisplay, fsWindow);
++  /* wait until we are mapped. (shamelessly borrowed from SDL) */
++  do {
++    XMaskEvent(currDisplay, StructureNotifyMask, &amp;event); 
++  } while ( (event.type != MapNotify) || 
++            (event.xmap.event != fsWindow) );
++  /* Make sure we got to the top of the window stack */
++  XRaiseWindow(currDisplay, fsWindow);
++  
++  /* Reparent the real window */
++  XReparentWindow(currDisplay, currHandle, fsWindow, 0, 0);
++
++  /* Grab the mouse.  */
++  if (XGrabPointer(currDisplay, currHandle, False,
++        PointerMotionMask | ButtonPressMask | ButtonReleaseMask,
++        GrabModeAsync, GrabModeAsync, currHandle, None,
++        CurrentTime) == GrabSuccess)
++    mouse_grabbed = true;
++  else
++    fprintf(stderr, &quot;Warning can not grab mouse\n&quot;);
++
++  /* Make sure we get any last resize events before using size[] */
++  getEvents();
++
++#ifdef XF86VIDMODE
++  /* Switch resolution */
++  pwXf86VmSetFullScreenResolution (size[0], size[1], fs_width, fs_height);
++#endif
++  
++  /* Center the window (if nescesarry) */
++  if ((fs_width != size[0]) || (fs_height != size[1]))
++    XMoveWindow(currDisplay, currHandle, (fs_width - size[0]) / 2,
++                 (fs_height - size[1]) / 2);
++                 
++  /* And last set the cursor */
++  pwRealSetCursor (fsCursor);
++}
++
++
++void pwSetWindowed ()
++{
++  if (mouse_grabbed) {
++    XUngrabPointer(currDisplay, CurrentTime);
++    mouse_grabbed = false;
++  }
++  if (keyb_grabbed) {
++    XUngrabKeyboard(currDisplay, CurrentTime);
++    keyb_grabbed = false;
++  }
++
++#ifdef XF86VIDMODE
++  /* Switch resolution */
++  pwXf86VmRestoreOriginalResolution ( ) ;
++#endif
++
++  /* Reparent the real window! */
++  XReparentWindow(currDisplay, currHandle, wmWindow, 0, 0);
++  XUnmapWindow(currDisplay, fsWindow);
++  XDestroyWindow(currDisplay, fsWindow);
++  fsWindow = None;
++
++  /* And last set the cursor */
++  pwRealSetCursor (wmCursor);
++}
++
++
++void pwToggleFullscreen ()
++{
++  if (fsWindow == None)
++    pwSetFullscreen () ;
++  else
++    pwSetWindowed () ;
++}
++
++
+ void pwCleanup ()
+ {
+-  if ( ! initialised )
+-    fprintf ( stderr, &quot;PLIB/PW: WARNING - Application called pwCleanup&quot;
+-                      &quot; before pwInit.\n&quot; ) ;
++  if ( ! currDisplay )
++    return;
++
++  if ( titlePropertyPtr )
++  {
++    XFree ( titlePropertyPtr-&gt;value ) ;
++    titlePropertyPtr = NULL;
++  }
++
++  if ( fsWindow != None )
++    pwSetWindowed ( ) ;
+ 
+   glXDestroyContext ( currDisplay, currContext ) ;
+   XDestroyWindow    ( currDisplay, currHandle  ) ;
+-  XFlush            ( currDisplay ) ;
++  XDestroyWindow    ( currDisplay, wmWindow    ) ;
++  XCloseDisplay     ( currDisplay ) ;
++  currDisplay = NULL;
+ }
+ 
+ 

Added: trunk/rpms/plib/plib-1.8.4-js.patch
===================================================================
--- trunk/rpms/plib/plib-1.8.4-js.patch	                        (rev 0)
+++ trunk/rpms/plib/plib-1.8.4-js.patch	2007-09-20 13:53:50 UTC (rev 5856)
@@ -0,0 +1,11 @@
+--- plib-1.8.4/src/js/jsLinuxOld.cxx~	2006-06-03 20:00:00.000000000 +0200
++++ plib-1.8.4/src/js/jsLinuxOld.cxx	2006-06-03 20:00:00.000000000 +0200
+@@ -27,7 +27,7 @@
+ 
+ #include &lt;linux/joystick.h&gt;
+ 
+-#if !defined(JS_VERSION) || JS_VERSION &gt;= 0x010000
++#if !defined(JS_VERSION) || JS_VERSION &lt; 0x010000
+ 
+ #include &lt;fcntl.h&gt;
+ #include &lt;sys/ioctl.h&gt;

Added: trunk/rpms/powertop/powertop-1.8-usb.patch
===================================================================
--- trunk/rpms/powertop/powertop-1.8-usb.patch	                        (rev 0)
+++ trunk/rpms/powertop/powertop-1.8-usb.patch	2007-09-20 13:53:50 UTC (rev 5856)
@@ -0,0 +1,11 @@
+--- usb.c.orig	2007-08-24 19:22:14.882108416 +0200
++++ usb.c	2007-08-24 19:22:26.326368624 +0200
+@@ -89,7 +89,7 @@
+ 			fclose(file);
+ 			continue;
+ 		}
+-		if (!strtoull(line, NULL,10)&lt;1)
++		if (strtoull(line, NULL,10)&lt;1)
+ 			need_hint = 1;
+ 
+ 		fclose(file);

Added: trunk/rpms/python-adns/python-adns-1.1.0-srv.patch
===================================================================
--- trunk/rpms/python-adns/python-adns-1.1.0-srv.patch	                        (rev 0)
+++ trunk/rpms/python-adns/python-adns-1.1.0-srv.patch	2007-09-20 13:53:50 UTC (rev 5856)
@@ -0,0 +1,60 @@
+--- adns-python-1.1.0/adnsmodule.c.orig	2006-05-08 16:23:21.000000000 -0400
++++ adns-python-1.1.0/adnsmodule.c	2006-05-09 11:35:15.000000000 -0400
+@@ -88,9 +88,10 @@
+ };
+ 
+ static _constant_class adns_rr[] = {
+-	{ &quot;typemask&quot;, adns__rrt_typemask },
++	{ &quot;typemask&quot;, adns_rrt_typemask },
+ 	{ &quot;deref&quot;, adns__qtf_deref },
+ 	{ &quot;mail822&quot;, adns__qtf_mail822 },
++	{ &quot;unknown&quot;, adns_r_unknown },
+ 	{ &quot;none&quot;, adns_r_none },
+ 	{ &quot;A&quot;, adns_r_a },
+ 	{ &quot;NSraw&quot;, adns_r_ns_raw },
+@@ -106,6 +107,8 @@
+ 	{ &quot;TXT&quot;, adns_r_txt },
+ 	{ &quot;RPraw&quot;, adns_r_rp_raw },
+ 	{ &quot;RP&quot;, adns_r_rp },
++	{ &quot;SRVraw&quot;, adns_r_srv_raw },
++	{ &quot;SRV&quot;, adns_r_srv },
+ 	{ &quot;ADDR&quot;, adns_r_addr },
+ 	{ NULL, 0 }
+ };
+@@ -176,6 +179,17 @@
+ 			  addrs);
+ 	return o;
+ }
++
++static PyObject *
++interpret_srv(
++	adns_rr_srvraw *srvrr
++	)
++{
++	PyObject *o;
++	o = Py_BuildValue(&quot;iiis&quot;, srvrr-&gt;priority, srvrr-&gt;weight, srvrr-&gt;port,
++		srvrr-&gt;host);
++	return o;
++}
+ 	
+ static PyObject *
+ interpret_answer(
+@@ -184,7 +198,7 @@
+ {
+ 	PyObject *o, *rrs;
+ 	int i;
+-	adns_rrtype t = answer-&gt;type &amp; adns__rrt_typemask;
++	adns_rrtype t = answer-&gt;type &amp; adns_rrt_typemask;
+ 	adns_rrtype td = answer-&gt;type &amp; adns__qtf_deref;
+ 
+ 	rrs = PyTuple_New(answer-&gt;nrrs);
+@@ -273,6 +287,9 @@
+ 				a = Py_BuildValue(&quot;ss&quot;, v-&gt;array[0], v-&gt;array[1]);
+ 			}
+ 			break;
++		case adns_r_srv_raw:
++			a = interpret_srv((answer-&gt;rrs.srvraw+i));
++			break;
+ 		default:
+ 			a = Py_None;
+ 			Py_INCREF(a);

Added: trunk/rpms/rfb/rfb-0.6.1-11-debian.patch
===================================================================
--- trunk/rpms/rfb/rfb-0.6.1-11-debian.patch	                        (rev 0)
+++ trunk/rpms/rfb/rfb-0.6.1-11-debian.patch	2007-09-20 13:53:50 UTC (rev 5856)
@@ -0,0 +1,1180 @@
+--- rfb-0.6.1.orig/lib/.depend
++++ rfb-0.6.1/lib/.depend
+@@ -1,29 +1,33 @@
+-computeSubrectDimensions.o: computeSubrectDimensions.cc
+ Connection.o: Connection.cc ../include/Connection.h
++Framebuffer.o: Framebuffer.cc ../include/Framebuffer.h \
++ ../include/rfb.h
++PixelFormatFramebuffer.o: PixelFormatFramebuffer.cc \
++ ../include/PixelFormatFramebuffer.h ../include/Framebuffer.h \
++ ../include/rfb.h
++ScaleEasyFramebuffer.o: ScaleEasyFramebuffer.cc \
++ ../include/ScaleFramebuffer.h ../include/Framebuffer.h \
++ ../include/rfb.h
++ScaleFramebuffer.o: ScaleFramebuffer.cc ../include/ScaleFramebuffer.h \
++ ../include/Framebuffer.h ../include/rfb.h
++ScaleFramebufferAA.o: ScaleFramebufferAA.cc \
++ ../include/ScaleFramebuffer.h ../include/Framebuffer.h \
++ ../include/rfb.h
++ScaleFramebuffer_save.o: ScaleFramebuffer_save.cc \
++ ../include/ScaleFramebuffer.h ../include/Framebuffer.h \
++ ../include/rfb.h
++ZlibConnection.o: ZlibConnection.cc ../include/ZlibConnection.h \
++ ../include/Connection.h
++computeSubrectDimensions.o: computeSubrectDimensions.cc
+ d3des.o: d3des.cc ../include/d3des.h
+ encodeRectangleCoRRE.o: encodeRectangleCoRRE.cc ../include/rfbServer.h \
+-  ../include/rfb.h ../include/Connection.h ../include/Framebuffer.h
++ ../include/rfb.h ../include/Connection.h ../include/Framebuffer.h
+ encodeRectangleHextile.o: encodeRectangleHextile.cc \
+-  ../include/rfbServer.h ../include/rfb.h ../include/Connection.h \
+-  ../include/Framebuffer.h
++ ../include/rfbServer.h ../include/rfb.h ../include/Connection.h \
++ ../include/Framebuffer.h
+ encodeRectangleRRE.o: encodeRectangleRRE.cc ../include/rfbServer.h \
+-  ../include/rfb.h ../include/Connection.h ../include/Framebuffer.h
+-Framebuffer.o: Framebuffer.cc ../include/Framebuffer.h ../include/rfb.h
+-PixelFormatFramebuffer.o: PixelFormatFramebuffer.cc \
+-  ../include/PixelFormatFramebuffer.h ../include/Framebuffer.h \
+-  ../include/rfb.h
++ ../include/rfb.h ../include/Connection.h ../include/Framebuffer.h
+ rfb.o: rfb.cc ../include/rfb.h
+ rfbClient.o: rfbClient.cc ../include/rfbClient.h ../include/rfb.h \
+-  ../include/Framebuffer.h ../include/Connection.h
++ ../include/Framebuffer.h ../include/Connection.h
+ rfbServer.o: rfbServer.cc ../include/rfbServer.h ../include/rfb.h \
+-  ../include/Connection.h ../include/Framebuffer.h ../include/d3des.h
+-ScaleEasyFramebuffer.o: ScaleEasyFramebuffer.cc \
+-  ../include/ScaleFramebuffer.h ../include/Framebuffer.h ../include/rfb.h
+-ScaleFramebufferAA.o: ScaleFramebufferAA.cc ../include/ScaleFramebuffer.h \
+-  ../include/Framebuffer.h ../include/rfb.h
+-ScaleFramebuffer.o: ScaleFramebuffer.cc ../include/ScaleFramebuffer.h \
+-  ../include/Framebuffer.h ../include/rfb.h
+-ScaleFramebuffer_save.o: ScaleFramebuffer_save.cc \
+-  ../include/ScaleFramebuffer.h ../include/Framebuffer.h ../include/rfb.h
+-ZlibConnection.o: ZlibConnection.cc ../include/ZlibConnection.h \
+-  ../include/Connection.h
++ ../include/Connection.h ../include/Framebuffer.h ../include/d3des.h
+--- rfb-0.6.1.orig/lib/Framebuffer.cc
++++ rfb-0.6.1/lib/Framebuffer.cc
+@@ -161,27 +161,54 @@
+                             unsigned int r,
+                             unsigned int g,
+                             unsigned int b,
+-                            unsigned int m = 255 )
++                            unsigned int m )
+ {
+     FramebufferPixel(this,x,y).setColor(r,g,b,m);
+ }
+ 
+ 
++void Framebuffer::putPixel( unsigned int x,
++                            unsigned int y,
++                            unsigned int r,
++                            unsigned int g,
++                            unsigned int b )
++{
++    FramebufferPixel(this,x,y).setColor(r,g,b,255);
++}
++
++
+ void Framebuffer::getPixel( unsigned int x,
+                             unsigned int y,
+                             unsigned int &amp;r,
+                             unsigned int &amp;g,
+                             unsigned int &amp;b,
+-                            unsigned int m = 255 )
++                            unsigned int m )
+ {
+     FramebufferPixel(this,x,y).getColor(r,g,b,m);
+ }
+ 
++void Framebuffer::getPixel( unsigned int x,
++                            unsigned int y,
++                            unsigned int &amp;r,
++                            unsigned int &amp;g,
++                            unsigned int &amp;b )
++{
++    FramebufferPixel(this,x,y).getColor(r,g,b,255);
++}
++
++
++void FramebufferPixel::setColor( unsigned int r,
++                                 unsigned int g,
++                                 unsigned int b )
++{
++    FramebufferPixel::setColor(r,g,b,255);
++}
++
+ 
+ void FramebufferPixel::setColor( unsigned int r,
+                                  unsigned int g,
+                                  unsigned int b,
+-                                 unsigned int m = 255 )
++                                 unsigned int m )
+ {
+     unsigned int r_max =   fb-&gt;pixelFormat.red_max;
+     unsigned int g_max =   fb-&gt;pixelFormat.green_max;
+@@ -245,8 +272,15 @@
+ 
+ void FramebufferPixel::getColor( unsigned int &amp;r,
+                                  unsigned int &amp;g,
++                                 unsigned int &amp;b )
++{
++  FramebufferPixel::getColor(r,g,b,255);
++}
++
++void FramebufferPixel::getColor( unsigned int &amp;r,
++                                 unsigned int &amp;g,
+                                  unsigned int &amp;b,
+-                                 unsigned int m = 255 )
++                                 unsigned int m )
+ {
+     unsigned int r_max =   fb-&gt;pixelFormat.red_max;
+     unsigned int g_max =   fb-&gt;pixelFormat.green_max;
+@@ -285,13 +319,16 @@
+ }
+ 
+ 
+-
++int saveFramebufferAsPPM( int file, Framebuffer *fb ) {
++  return saveFramebufferAsPPM(file, fb,
++					 0,0,-1,-1);
++}
+ 
+ int saveFramebufferAsPPM( int file, Framebuffer *fb,
+-                          int x0 = 0,
+-                          int y0 = 0,
+-                          int width = -1,
+-                          int height = -1 ) {
++                          int x0,
++                          int y0,
++                          int width,
++                          int height ) {
+     if ( width &lt; 0 ) width = fb-&gt;width;
+     if ( height &lt; 0 ) height = fb-&gt;height;
+     char tmp[255] = &quot;&quot;;
+--- rfb-0.6.1.orig/lib/ScaleFramebuffer.cc
++++ rfb-0.6.1/lib/ScaleFramebuffer.cc
+@@ -207,7 +207,7 @@
+             if ( (_y &lt;= row) &amp;&amp; (row &lt;= _y + _h) ) {
+ 	        for ( col = __x; col &lt; __x + __w; ++col ) {
+ //	        for ( col = 0; col &lt; cols; ++col ) {
+-                    getPixel( col, _cy, _r, _g, _b );
++                    getPixel( col, _cy, _r, _g, _b);
+ 		    rs[col] += fracrowleft * _r;
+ 		    gs[col] += fracrowleft * _g;
+ 		    bs[col] += fracrowleft * _b;
+--- rfb-0.6.1.orig/lib/rfb.cc
++++ rfb-0.6.1/lib/rfb.cc
+@@ -28,7 +28,12 @@
+ /* CARD16                                         */
+ /**************************************************/
+ 
+-CARD16::CARD16( unsigned int _value = 0 )
++CARD16::CARD16()
++{
++  CARD16::CARD16(0);
++}
++
++CARD16::CARD16( unsigned int _value )
+ {
+   value[1] = _value;
+   _value &gt;&gt;= 8;
+@@ -55,6 +60,11 @@
+ /* CARD32                                         */
+ /**************************************************/
+ 
++CARD32::CARD32()
++{
++  CARD32::CARD32(0);
++}
++
+ CARD32::CARD32( unsigned int _value = 0 )
+ {
+   value[3] = _value;
+--- rfb-0.6.1.orig/include/Framebuffer.h
++++ rfb-0.6.1/include/Framebuffer.h
+@@ -60,14 +60,26 @@
+                    unsigned int &amp;r,
+                    unsigned int &amp;g,
+                    unsigned int &amp;b,
+-                   unsigned int m = 255 );
++                   unsigned int m );
++
++    void getPixel( unsigned int x,
++                   unsigned int y,
++                   unsigned int &amp;r,
++                   unsigned int &amp;g,
++                   unsigned int &amp;b );
+                          
+     void putPixel( unsigned int x,
+                    unsigned int y,
+                    unsigned int r,
+                    unsigned int g,
+                    unsigned int b,
+-                   unsigned int m = 255 );
++                   unsigned int m );
++
++    void putPixel( unsigned int x,
++                   unsigned int y,
++                   unsigned int r,
++                   unsigned int g,
++                   unsigned int b );
+ 
+     PixelFormat pixelFormat;
+     unsigned int width;
+@@ -94,12 +106,20 @@
+         void setColor( unsigned int r,
+                        unsigned int g,
+                        unsigned int b,
+-                       unsigned int m = 255 );
++                       unsigned int m );
++
++        void setColor( unsigned int r,
++                       unsigned int g,
++                       unsigned int b );
+ 
+         void getColor( unsigned int &amp;r,
+                        unsigned int &amp;g,
+                        unsigned int &amp;b,
+-                       unsigned int m = 255 );
++                       unsigned int m );
++
++        void getColor( unsigned int &amp;r,
++                       unsigned int &amp;g,
++                       unsigned int &amp;b );
+        
+         void moveUp() { p -= rs; y--; }
+         void moveDown() { p += rs; y++; }
+@@ -120,10 +140,12 @@
+ };
+ 
+ int saveFramebufferAsPPM( int file, Framebuffer *fb,
+-                          int x0 = 0,
+-                          int y0 = 0,
+-                          int width = -1,
+-                          int height = -1 );
++                          int x0,
++                          int y0,
++                          int width,
++                          int height );
++
++int saveFramebufferAsPPM( int file, Framebuffer *fb );
+ 
+ }
+ 
+--- rfb-0.6.1.orig/include/rfb.h
++++ rfb-0.6.1/include/rfb.h
+@@ -29,7 +29,8 @@
+ class CARD16
+ {
+  public:
+-  CARD16( unsigned int _value = 0 );
++  CARD16();
++  CARD16( unsigned int _value);
+   operator unsigned int() const {
+     return (value[0] &lt;&lt; 8) | value[1];
+   }
+@@ -42,7 +43,8 @@
+ class CARD32
+ {
+  public:
+-  CARD32( unsigned int _value = 0 );
++  CARD32();
++  CARD32( unsigned int _value);
+   operator unsigned int() const {
+     return (value[0] &lt;&lt; 24) | (value[1] &lt;&lt; 16) | (value[2] &lt;&lt; 8) | value[3];
+   }
+--- rfb-0.6.1.orig/include/rfbClient.h
++++ rfb-0.6.1/include/rfbClient.h
+@@ -257,7 +257,7 @@
+ 
+  protected:
+   Rectangle rectangle;
+-  friend ClientStateDecodingRaw;
++  friend class ClientStateDecodingRaw;
+ };
+ 
+ 
+--- rfb-0.6.1.orig/include/rfbServer.h
++++ rfb-0.6.1/include/rfbServer.h
+@@ -25,7 +25,7 @@
+ #include &quot;Connection.h&quot;
+ #include &quot;Framebuffer.h&quot;
+ 
+-#include &lt;list&gt;
++#include &lt;list.h&gt;
+ 
+ namespace rfb {
+ 
+--- rfb-0.6.1.orig/x0rfbserver/.depend
++++ rfb-0.6.1/x0rfbserver/.depend
+@@ -1,24 +1,24 @@
+ OXAbout.o: OXAbout.cc OXAbout.h xclass++.h ../include/version.h
+ OXButtonBox.o: OXButtonBox.cc OXButtonBox.h ../icons/top2.xpm \
+-  ../icons/top2_hexonet.xpm ../icons/right2.xpm
++ ../icons/top2_hexonet.xpm ../icons/right2.xpm
+ OXNewClient.o: OXNewClient.cc OXNewClient.h
+ OXProperties.o: OXProperties.cc OXProperties.h xclass++.h \
+-  ../include/d3des.h OXButtonBox.h
++ ../include/d3des.h OXButtonBox.h
+ OXServiceApplet.o: OXServiceApplet.cc OXServiceApplet.h xclass++.h \
+-  ../icons/serviceInactive16x16.xpm ../icons/serviceActive16x16.xpm \
+-  ../icons/serviceInactive32x32.xpm ../icons/serviceActive32x32.xpm \
+-  ../icons/serviceInactive40x40.xpm ../icons/serviceActive40x40.xpm \
+-  ../icons/rfb_service_large.xpm ../icons/digit.0.xpm \
+-  ../icons/digit.1.xpm ../icons/digit.2.xpm ../icons/digit.3.xpm \
+-  ../icons/digit.4.xpm ../icons/digit.5.xpm ../icons/digit.6.xpm \
+-  ../icons/digit.7.xpm ../icons/digit.8.xpm ../icons/digit.9.xpm \
+-  ../icons/digit.colon.xpm ../icons/digit.minus.xpm OXAbout.h \
+-  ../include/version.h OXProperties.h
+-x0rfbserver.o: x0rfbserver.cc ../include/rfbServer.h ../include/rfb.h \
+-  ../include/Connection.h ../include/Framebuffer.h ../include/version.h \
+-  OXAbout.h xclass++.h ../icons/rfb_service_large.xpm \
+-  OSocketFileHandler.h OXServiceApplet.h OXProperties.h OXNewClient.h \
+-  XUpdateScanner.h ../include/ZlibConnection.h
++ ../icons/serviceInactive16x16.xpm ../icons/serviceActive16x16.xpm \
++ ../icons/serviceInactive32x32.xpm ../icons/serviceActive32x32.xpm \
++ ../icons/serviceInactive40x40.xpm ../icons/serviceActive40x40.xpm \
++ ../icons/rfb_service_large.xpm ../icons/digit.0.xpm \
++ ../icons/digit.1.xpm ../icons/digit.2.xpm ../icons/digit.3.xpm \
++ ../icons/digit.4.xpm ../icons/digit.5.xpm ../icons/digit.6.xpm \
++ ../icons/digit.7.xpm ../icons/digit.8.xpm ../icons/digit.9.xpm \
++ ../icons/digit.colon.xpm ../icons/digit.minus.xpm OXAbout.h \
++ ../include/version.h OXProperties.h
+ XUpdateScanner.o: XUpdateScanner.cc XUpdateScanner.h \
+-  ../include/rfbServer.h ../include/rfb.h ../include/Connection.h \
+-  ../include/Framebuffer.h OXProperties.h xclass++.h
++ ../include/rfbServer.h ../include/rfb.h ../include/Connection.h \
++ ../include/Framebuffer.h OXProperties.h xclass++.h
++x0rfbserver.o: x0rfbserver.cc ../include/rfbServer.h ../include/rfb.h \
++ ../include/Connection.h ../include/Framebuffer.h ../include/version.h \
++ OXAbout.h xclass++.h ../icons/rfb_service_large.xpm \
++ OSocketFileHandler.h OXServiceApplet.h OXProperties.h OXNewClient.h \
++ XUpdateScanner.h ../include/ZlibConnection.h
+--- rfb-0.6.1.orig/x0rfbserver/OXServiceApplet.cc
++++ rfb-0.6.1/x0rfbserver/OXServiceApplet.cc
+@@ -20,7 +20,7 @@
+ 
+ #include &quot;OXServiceApplet.h&quot;
+ 
+-#include &lt;iostream&gt;
++#include &lt;iostream.h&gt;
+ 
+ #include &quot;../icons/serviceInactive16x16.xpm&quot;
+ #include &quot;../icons/serviceActive16x16.xpm&quot;
+--- rfb-0.6.1.orig/x0rfbserver/x0rfbserver.cc
++++ rfb-0.6.1/x0rfbserver/x0rfbserver.cc
+@@ -484,7 +484,7 @@
+   if ( _fh == fhSocket ) {
+     if ( _mask &amp; XCM_READABLE ) {
+       struct sockaddr addr;
+-      size_t laddr = sizeof(addr);
++      socklen_t laddr = sizeof(addr);
+       int fdClient = accept(fd, &amp;addr, &amp;laddr);
+       int one = 1;
+       setsockopt(fdClient, IPPROTO_TCP, TCP_NODELAY, (char *)&amp;one, sizeof(one));
+--- rfb-0.6.1.orig/x0rfbserver/xclass++.h
++++ rfb-0.6.1/x0rfbserver/xclass++.h
+@@ -1,7 +1,7 @@
+ #ifndef _hexonet_xclass_plusplus_
+ #define _hexonet_xclass_plusplus_
+ 
+-#include &lt;map&gt;
++#include &lt;map.h&gt;
+ 
+ 
+ #define LAYOUT_HINTS map&lt; OXFrame*, OLayoutHints* &gt; layoutHints
+--- rfb-0.6.1.orig/xrfbviewer/.depend
++++ rfb-0.6.1/xrfbviewer/.depend
+@@ -1,33 +1,34 @@
+ ConnectionInfo.o: ConnectionInfo.cc ConnectionInfo.h
+ FBStreamRecorder.o: FBStreamRecorder.cc FBStreamRecorder.h \
+-  ../include/rfb.h
++ ../include/rfb.h
+ OXAbout.o: OXAbout.cc OXAbout.h xclass++.h ../include/version.h
+ OXConnectionDetails.o: OXConnectionDetails.cc OXConnectionDetails.h \
+-  ConnectionInfo.h OXConnectionOptions.h ../include/version.h \
+-  ../icons/top.xpm ../icons/top_hexonet.xpm ../icons/right.xpm
++ ConnectionInfo.h OXConnectionOptions.h ../include/version.h \
++ ../icons/top.xpm ../icons/top_hexonet.xpm ../icons/right.xpm
+ OXConnectionOptions.o: OXConnectionOptions.cc OXConnectionOptions.h \
+-  ConnectionInfo.h
++ ConnectionInfo.h
+ OXPassword.o: OXPassword.cc OXPassword.h ConnectionInfo.h
+ OXViewerApplet.o: OXViewerApplet.cc OXViewerApplet.h ConnectionInfo.h \
+-  OXAbout.h xclass++.h OXConnectionOptions.h OXConnectionDetails.h \
+-  ../icons/rfb_viewer_large.xpm ../icons/viewerInactive16x16.xpm \
+-  ../icons/viewerInactive32x32.xpm ../icons/viewerInactive40x40.xpm \
+-  ../icons/digit.0.xpm ../icons/digit.1.xpm ../icons/digit.2.xpm \
+-  ../icons/digit.3.xpm ../icons/digit.4.xpm ../icons/digit.5.xpm \
+-  ../icons/digit.6.xpm ../icons/digit.7.xpm ../icons/digit.8.xpm \
+-  ../icons/digit.9.xpm ../icons/digit.colon.xpm ../icons/digit.minus.xpm \
+-  ../include/version.h
+-RFMacroRecorder.o: RFMacroRecorder.cc RFMacroRecorder.h ../include/rfb.h
+-XFramebuffer.o: XFramebuffer.cc XFramebuffer.h ../include/Framebuffer.h \
+-  ../include/rfb.h
++ OXAbout.h xclass++.h OXConnectionOptions.h OXConnectionDetails.h \
++ ../icons/rfb_viewer_large.xpm ../icons/viewerInactive16x16.xpm \
++ ../icons/viewerInactive32x32.xpm ../icons/viewerInactive40x40.xpm \
++ ../icons/digit.0.xpm ../icons/digit.1.xpm ../icons/digit.2.xpm \
++ ../icons/digit.3.xpm ../icons/digit.4.xpm ../icons/digit.5.xpm \
++ ../icons/digit.6.xpm ../icons/digit.7.xpm ../icons/digit.8.xpm \
++ ../icons/digit.9.xpm ../icons/digit.colon.xpm \
++ ../icons/digit.minus.xpm ../include/version.h
++RFMacroRecorder.o: RFMacroRecorder.cc RFMacroRecorder.h \
++ ../include/rfb.h
++XFramebuffer.o: XFramebuffer.cc XFramebuffer.h \
++ ../include/Framebuffer.h ../include/rfb.h
+ xplayfbs.o: xplayfbs.cc ../icons/begin.xpm ../icons/rewind.xpm \
+-  ../icons/play.xpm ../icons/eject.xpm ../icons/forward.xpm \
+-  ../icons/end.xpm ../icons/fbs_player.xpm ../include/rfb.h OXAbout.h \
+-  xclass++.h ../include/version.h
++ ../icons/play.xpm ../icons/eject.xpm ../icons/forward.xpm \
++ ../icons/end.xpm ../icons/fbs_player.xpm ../include/rfb.h OXAbout.h \
++ xclass++.h ../include/version.h
+ xrfbviewer.o: xrfbviewer.cc ../include/rfbClient.h ../include/rfb.h \
+-  ../include/Framebuffer.h ../include/Connection.h OXAbout.h xclass++.h \
+-  OXViewerApplet.h ConnectionInfo.h OXConnectionOptions.h \
+-  OXConnectionDetails.h OXPassword.h XFramebuffer.h \
+-  ../include/ScaleFramebuffer.h ../include/PixelFormatFramebuffer.h \
+-  ../include/d3des.h ../include/ZlibConnection.h FBStreamRecorder.h \
+-  RFMacroRecorder.h ../icons/rfb_viewer_large.xpm ../include/version.h
++ ../include/Framebuffer.h ../include/Connection.h OXAbout.h xclass++.h \
++ OXViewerApplet.h ConnectionInfo.h OXConnectionOptions.h \
++ OXConnectionDetails.h OXPassword.h XFramebuffer.h \
++ ../include/ScaleFramebuffer.h ../include/PixelFormatFramebuffer.h \
++ ../include/d3des.h ../include/ZlibConnection.h FBStreamRecorder.h \
++ RFMacroRecorder.h ../icons/rfb_viewer_large.xpm ../include/version.h
+--- rfb-0.6.1.orig/xrfbviewer/OXViewerApplet.cc
++++ rfb-0.6.1/xrfbviewer/OXViewerApplet.cc
+@@ -24,7 +24,7 @@
+ #include &quot;OXConnectionOptions.h&quot;
+ #include &quot;OXConnectionDetails.h&quot;
+ 
+-#include &lt;iostream&gt;
++#include &lt;iostream.h&gt;
+ 
+ #include &lt;sys/types.h&gt;
+ #include &lt;fcntl.h&gt;
+@@ -197,7 +197,7 @@
+   if ( _fh == fhSocket ) {
+     cout &lt;&lt; &quot;Connection request&quot; &lt;&lt; endl;
+     struct sockaddr addr;
+-    size_t laddr = sizeof(addr);
++    socklen_t laddr = sizeof(addr);
+     int fdClient = accept(_fh-&gt;GetFd(), &amp;addr, &amp;laddr);
+     int one = 1;
+     setsockopt(fdClient, IPPROTO_TCP, TCP_NODELAY, (char *)&amp;one, sizeof(one));
+--- rfb-0.6.1.orig/xrfbviewer/OXViewerApplet.h
++++ rfb-0.6.1/xrfbviewer/OXViewerApplet.h
+@@ -30,7 +30,7 @@
+ 
+ #include &quot;ConnectionInfo.h&quot;
+ 
+-#include &lt;map&gt;
++#include &lt;map.h&gt;
+ 
+ class OXCompositeFrame;
+ 
+--- rfb-0.6.1.orig/xrfbviewer/xclass++.h
++++ rfb-0.6.1/xrfbviewer/xclass++.h
+@@ -1,7 +1,7 @@
+ #ifndef _hexonet_xclass_plusplus_
+ #define _hexonet_xclass_plusplus_
+ 
+-#include &lt;map&gt;
++#include &lt;map.h&gt;
+ 
+ 
+ #define LAYOUT_HINTS map&lt; OXFrame*, OLayoutHints* &gt; layoutHints
+--- rfb-0.6.1.orig/xrfbviewer/xplayfbs.cc
++++ rfb-0.6.1/xrfbviewer/xplayfbs.cc
+@@ -37,6 +37,7 @@
+ #include &lt;xclass/OXClient.h&gt;
+ #include &lt;xclass/OXWindow.h&gt;
+ #include &lt;xclass/OXMainFrame.h&gt;
++#undef max
+ #include &lt;xclass/OXFileDialog.h&gt;
+ #include &lt;xclass/OFileHandler.h&gt;
+ #include &lt;xclass/OTimer.h&gt;
+@@ -312,24 +313,24 @@
+ 
+ void printVersion_xplayfbs()
+ {
+-  cerr &lt;&lt; endl &lt;&lt; &quot;heXoNet FBS player&quot;
+-       &lt;&lt; endl &lt;&lt; &quot;Version &quot; &lt;&lt; VERSION_xplayfbs
+-       &lt;&lt; endl;
++  std::cerr &lt;&lt; std::endl &lt;&lt; &quot;heXoNet FBS player&quot;
++       &lt;&lt; std::endl &lt;&lt; &quot;Version &quot; &lt;&lt; VERSION_xplayfbs
++       &lt;&lt; std::endl;
+ }
+ 
+ 
+ void printHelp_xplayfbs()
+ {
+   printVersion_xplayfbs();
+-  cerr 
+-    &lt;&lt; endl 
+-    &lt;&lt; &quot;usage: xplayfbs [&lt;options&gt;] [file]&quot; &lt;&lt; endl
+-    &lt;&lt; &quot;       xplayfbs [&lt;options&gt;] -stdout [file]&quot; &lt;&lt; endl
+-    &lt;&lt; &quot;       xplayfbs [&lt;options&gt;] -connect [&lt;host&gt;][:&lt;display&gt;] [file]&quot; &lt;&lt; endl
+-    &lt;&lt; &quot;       xplayfbs -about&quot; &lt;&lt; endl
+-    &lt;&lt; endl
+-    &lt;&lt; &quot;&lt;options&gt;&quot; &lt;&lt; endl
+-    &lt;&lt; &quot;       &quot; &lt;&lt; endl
++  std::cerr 
++    &lt;&lt; std::endl 
++    &lt;&lt; &quot;usage: xplayfbs [&lt;options&gt;] [file]&quot; &lt;&lt; std::endl
++    &lt;&lt; &quot;       xplayfbs [&lt;options&gt;] -stdout [file]&quot; &lt;&lt; std::endl
++    &lt;&lt; &quot;       xplayfbs [&lt;options&gt;] -connect [&lt;host&gt;][:&lt;display&gt;] [file]&quot; &lt;&lt; std::endl
++    &lt;&lt; &quot;       xplayfbs -about&quot; &lt;&lt; std::endl
++    &lt;&lt; std::endl
++    &lt;&lt; &quot;&lt;options&gt;&quot; &lt;&lt; std::endl
++    &lt;&lt; &quot;       &quot; &lt;&lt; std::endl
+   ;
+   exit( 1 );
+ }
+--- rfb-0.6.1.orig/xrfbviewer/xrfbviewer.cc
++++ rfb-0.6.1/xrfbviewer/xrfbviewer.cc
+@@ -52,6 +52,7 @@
+ #include &lt;xclass/OFileHandler.h&gt;
+ #include &lt;xclass/OXCanvas.h&gt;
+ #include &lt;xclass/OTimer.h&gt;
++#undef max
+ #include &lt;xclass/OXFileDialog.h&gt;
+ 
+ #include &lt;X11/cursorfont.h&gt;
+@@ -84,7 +85,7 @@
+ 
+ #ifdef DEBUG
+ #include &lt;iostream&gt;
+-#define debug(msg) (cerr &lt;&lt; msg &lt;&lt; endl)
++#define debug(msg) (std::cerr &lt;&lt; msg &lt;&lt; endl)
+ #else // DEBUG
+ #define debug(msg)
+ #endif // DEBUG
+@@ -284,7 +285,7 @@
+ 
+   virtual int send( unsigned char* _data, unsigned int _size )
+     {
+-//      cerr &lt;&lt; &quot;send() &quot; &lt;&lt; _size &lt;&lt; endl;
++//      std::cerr &lt;&lt; &quot;send() &quot; &lt;&lt; _size &lt;&lt; endl;
+       if ( !client-&gt;fh1 )
+         if ( client-&gt;fd0 == client-&gt;fd1 ) {
+ 	  delete client-&gt;fh0;
+@@ -300,7 +301,7 @@
+           client-&gt;fh1 = new OFileHandler( client-&gt;mainFrame,
+ 	                                  client-&gt;fd1,
+ 		                          XCM_WRITABLE | XCM_EXCEPTION );
+-//      cerr &lt;&lt; &quot;return send()&quot; &lt;&lt; endl;
++//      std::cerr &lt;&lt; &quot;return send()&quot; &lt;&lt; endl;
+       return connection-&gt;send( _data, _size );
+     }
+ 
+@@ -526,18 +527,18 @@
+   BufferedConnection *connection = client-&gt;connectionLayer.buffered;
+   int fd = _fh-&gt;GetFd();
+   
+-//  cerr &lt;&lt; &quot;HandleFileEvent() &quot; &lt;&lt; fd &lt;&lt; endl;
++//  std::cerr &lt;&lt; &quot;HandleFileEvent() &quot; &lt;&lt; fd &lt;&lt; endl;
+ 
+   if ( (mask &amp; XCM_EXCEPTION) ) {
+-//    cerr &lt;&lt; &quot;XCM_EXCEPTION&quot; &lt;&lt; endl;
++//    std::cerr &lt;&lt; &quot;XCM_EXCEPTION&quot; &lt;&lt; endl;
+ 
+-//    cerr &lt;&lt; &quot;return HandleFileEvent() XCM_EXCEPTION &quot; &lt;&lt; endl;
++//    std::cerr &lt;&lt; &quot;return HandleFileEvent() XCM_EXCEPTION &quot; &lt;&lt; endl;
+     delete this;
+     return true;
+   }
+ 
+   if ( (mask &amp; XCM_READABLE) &amp;&amp; (fd == client-&gt;fd0) ) {
+-//    cerr &lt;&lt; &quot;XCM_READABLE&quot; &lt;&lt; endl;
++//    std::cerr &lt;&lt; &quot;XCM_READABLE&quot; &lt;&lt; endl;
+ 
+     int readSize = connection-&gt;receiverBuffer.size - connection-&gt;receiverBuffer.end;
+     int bytesRead;
+@@ -546,7 +547,7 @@
+                       readSize );
+     
+     if (bytesRead &lt;= 0) {
+-//      cerr &lt;&lt; &quot;return HandleFileEvent() XCM_READABLE&quot; &lt;&lt; endl;
++//      std::cerr &lt;&lt; &quot;return HandleFileEvent() XCM_READABLE&quot; &lt;&lt; endl;
+       delete this;
+       return true;
+     }
+@@ -560,7 +561,7 @@
+ 
+ 
+   if ( (mask &amp; XCM_WRITABLE) &amp;&amp; (fd == client-&gt;fd1) ) {
+-//    cerr &lt;&lt; &quot;XCM_WRITEABLE&quot; &lt;&lt; endl;
++//    std::cerr &lt;&lt; &quot;XCM_WRITEABLE&quot; &lt;&lt; endl;
+ 
+     int writeSize = connection-&gt;senderBuffer.end - connection-&gt;senderBuffer.pos;
+     if ( writeSize &gt; 0 ) {
+@@ -569,7 +570,7 @@
+                connection-&gt;senderBuffer.data + connection-&gt;senderBuffer.pos,
+                writeSize );
+       if (bytesWritten &lt; 0) {
+-//        cerr &lt;&lt; &quot;return HandleFileEvent() XCM_WRITABLE&quot; &lt;&lt; endl;
++//        std::cerr &lt;&lt; &quot;return HandleFileEvent() XCM_WRITABLE&quot; &lt;&lt; endl;
+         delete this;
+         return true;
+       }
+@@ -583,7 +584,7 @@
+     }
+   }
+ 
+-//  cerr &lt;&lt; &quot;return HandleFileEvent() &quot; &lt;&lt; endl;
++//  std::cerr &lt;&lt; &quot;return HandleFileEvent() &quot; &lt;&lt; endl;
+   return True;
+ }
+ 
+@@ -593,7 +594,7 @@
+ {
+   Client::handleProtocolVersion( protocolVersion );
+   protocolVersion[12] = 0;
+-//  cerr &lt;&lt; &quot;RFB protocol version: &quot; &lt;&lt; protocolVersion;
++//  std::cerr &lt;&lt; &quot;RFB protocol version: &quot; &lt;&lt; protocolVersion;
+ }
+ 
+ 
+@@ -607,7 +608,7 @@
+ #ifdef USE_ZLIB_WARREN
+ void Client95::handleZlibEnabled()
+ {
+-//  cerr &lt;&lt; &quot;Zlib (WARREN) enabled&quot; &lt;&lt; endl;
++//  std::cerr &lt;&lt; &quot;Zlib (WARREN) enabled&quot; &lt;&lt; endl;
+   connectionLayer.buffered-&gt;enableReceiverInflation();
+ }
+ #endif
+@@ -660,7 +661,7 @@
+     connectionInfo-&gt;recordFBS = (finfo.filename)? 1 : 0;
+     if ( connectionInfo-&gt;recordFBS ) {
+       sprintf( connectionInfo-&gt;filenameFBS, &quot;%s/%s&quot;, finfo.ini_dir, finfo.filename );
+-//      cerr &lt;&lt; &quot;FBS - filename: &quot; &lt;&lt; connectionInfo-&gt;filenameFBS &lt;&lt; endl;
++//      std::cerr &lt;&lt; &quot;FBS - filename: &quot; &lt;&lt; connectionInfo-&gt;filenameFBS &lt;&lt; endl;
+       
+       fbsRecorder = new FBStreamRecorder( connectionInfo-&gt;filenameFBS );
+       fbsRecorder-&gt;record( (unsigned char*) &quot;RFB 003.003\n&quot;, 12 );
+@@ -682,7 +683,7 @@
+     connectionInfo-&gt;recordRFM = (finfo.filename)? 1 : 0;
+     if ( connectionInfo-&gt;recordRFM ) {
+       sprintf( connectionInfo-&gt;filenameRFM, &quot;%s/%s&quot;, finfo.ini_dir, finfo.filename );
+-//      cerr &lt;&lt; &quot;RFM - filename: &quot; &lt;&lt; connectionInfo-&gt;filenameRFM &lt;&lt; endl;
++//      std::cerr &lt;&lt; &quot;RFM - filename: &quot; &lt;&lt; connectionInfo-&gt;filenameRFM &lt;&lt; endl;
+       
+       rfmRecorder = new RFMacroRecorder( connectionInfo-&gt;filenameRFM );
+     }
+@@ -702,9 +703,9 @@
+ {
+   Client::handleServerInitialisation( serverInitialisation );
+ 
+-//  cerr &lt;&lt; &quot;Desktop: &quot; &lt;&lt; serverInitialisation.name_string &lt;&lt; endl;
+-//  cerr &lt;&lt; &quot;FB-Width: &quot; &lt;&lt; serverInitialisation.framebuffer_width &lt;&lt; endl;
+-//  cerr &lt;&lt; &quot;FB-Height: &quot; &lt;&lt; serverInitialisation.framebuffer_height &lt;&lt; endl;
++//  std::cerr &lt;&lt; &quot;Desktop: &quot; &lt;&lt; serverInitialisation.name_string &lt;&lt; endl;
++//  std::cerr &lt;&lt; &quot;FB-Width: &quot; &lt;&lt; serverInitialisation.framebuffer_width &lt;&lt; endl;
++//  std::cerr &lt;&lt; &quot;FB-Height: &quot; &lt;&lt; serverInitialisation.framebuffer_height &lt;&lt; endl;
+ 
+   
+   mainFrame-&gt;canvas = new OXCanvas( mainFrame,
+@@ -912,26 +913,26 @@
+ 
+ void printVersion_xrfbviewer()
+ {
+-  cerr &lt;&lt; endl &lt;&lt; &quot;heXoNet RFB viewer for the X Window System&quot;
+-       &lt;&lt; endl &lt;&lt; &quot;Version &quot; &lt;&lt; VERSION_xrfbviewer
+-       &lt;&lt; endl;
++  std::cerr &lt;&lt; std::endl &lt;&lt; &quot;heXoNet RFB viewer for the X Window System&quot;
++       &lt;&lt; std::endl &lt;&lt; &quot;Version &quot; &lt;&lt; VERSION_xrfbviewer
++       &lt;&lt; std::endl;
+ }
+ 
+ void printHelp_xrfbviewer()
+ {
+   printVersion_xrfbviewer();
+-  cerr 
+-    &lt;&lt; endl 
+-    &lt;&lt; &quot;usage: xrfbviewer [&lt;options&gt;] [&lt;host&gt;][:&lt;display&gt;]&quot; &lt;&lt; endl
+-    &lt;&lt; &quot;       xrfbviewer [&lt;options&gt;] -listen [&lt;display&gt;]&quot; &lt;&lt; endl
+-    &lt;&lt; &quot;       xrfbviewer [&lt;options&gt;] -stdio&quot; &lt;&lt; endl
+-    &lt;&lt; &quot;       xrfbviewer -about&quot; &lt;&lt; endl
+-    &lt;&lt; endl
+-    &lt;&lt; &quot;&lt;options&gt;&quot; &lt;&lt; endl
+-    &lt;&lt; &quot;       -shared&quot; &lt;&lt; endl
+-    &lt;&lt; &quot;       -viewonly&quot; &lt;&lt; endl
+-    &lt;&lt; &quot;       -bgr233 | -spf&quot; &lt;&lt; endl
+-    &lt;&lt; &quot;       -scale &lt;num&gt;/&lt;denum&gt;&quot; &lt;&lt; endl;
++  std::cerr 
++    &lt;&lt; std::endl 
++    &lt;&lt; &quot;usage: xrfbviewer [&lt;options&gt;] [&lt;host&gt;][:&lt;display&gt;]&quot; &lt;&lt; std::endl
++    &lt;&lt; &quot;       xrfbviewer [&lt;options&gt;] -listen [&lt;display&gt;]&quot; &lt;&lt; std::endl
++    &lt;&lt; &quot;       xrfbviewer [&lt;options&gt;] -stdio&quot; &lt;&lt; std::endl
++    &lt;&lt; &quot;       xrfbviewer -about&quot; &lt;&lt; std::endl
++    &lt;&lt; std::endl
++    &lt;&lt; &quot;&lt;options&gt;&quot; &lt;&lt; std::endl
++    &lt;&lt; &quot;       -shared&quot; &lt;&lt; std::endl
++    &lt;&lt; &quot;       -viewonly&quot; &lt;&lt; std::endl
++    &lt;&lt; &quot;       -bgr233 | -spf&quot; &lt;&lt; std::endl
++    &lt;&lt; &quot;       -scale &lt;num&gt;/&lt;denum&gt;&quot; &lt;&lt; std::endl;
+   ;
+   exit( 1 );
+ }
+--- rfb-0.6.1.orig/rfbcat/.depend
++++ rfb-0.6.1/rfbcat/.depend
+@@ -1,5 +1,5 @@
+ FBStreamRecorder.o: FBStreamRecorder.cc FBStreamRecorder.h \
+-  ../include/rfb.h
++ ../include/rfb.h
+ rfbcat.o: rfbcat.cc ../include/rfbClient.h ../include/rfb.h \
+-  ../include/Framebuffer.h ../include/Connection.h ../include/d3des.h \
+-  ../include/version.h FBStreamRecorder.h
++ ../include/Framebuffer.h ../include/Connection.h ../include/d3des.h \
++ ../include/version.h FBStreamRecorder.h
+--- rfb-0.6.1.orig/rfbcat/rfbcat.cc
++++ rfb-0.6.1/rfbcat/rfbcat.cc
+@@ -20,8 +20,8 @@
+ 
+ #include &quot;rfbClient.h&quot;
+ 
+-#include &lt;iostream&gt;
+-#include &lt;fstream&gt;
++#include &lt;iostream.h&gt;
++#include &lt;fstream.h&gt;
+ 
+ #include &lt;stdio.h&gt;
+ #include &lt;stdlib.h&gt;
+--- rfb-0.6.1.orig/debian/patches/remove-rfbcat.patch
++++ rfb-0.6.1/debian/patches/remove-rfbcat.patch
+@@ -0,0 +1,58 @@
++From: Wesley J Landaker &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">wjl at icecavern.net</A>&gt;
++To: <A HREF="http://lists.repoforge.org/mailman/listinfo/commits">207479 at bugs.debian.org</A>
++Subject: patch for removing rfbcat
++Date: Tue, 9 Mar 2004 22:28:09 -0700
++
++package rfb
++tags 207479 +patch
++thanks
++
++Just for convenience, here is a patch to not compile or install rfbcat (see
++my previous e-mail for justification).
++
++--- rfb-0.6.1/debian/rfb.install.orig   2004-03-09 22:21:13.000000000 -0700
+++++ rfb-0.6.1/debian/rfb.install        2004-03-09 22:21:48.000000000 -0700
++@@ -1,5 +1,4 @@
++ ./x0rfbserver/x0rfbserver usr/bin
++ ./xrfbviewer/xrfbviewer usr/bin
++ ./xrfbviewer/xplayfbs usr/bin
++-./rfbcat/rfbcat usr/bin
++ ./man/man1 usr/share/man
++
++--- rfb-0.6.1/Makefile.orig     2004-03-09 22:20:29.000000000 -0700
+++++ rfb-0.6.1/Makefile  2004-03-09 22:24:15.000000000 -0700
++@@ -20,7 +20,7 @@
++
++ USE_ZLIB = USE_ZLIB_WARREN
++
++-PROGRAMS = xrfbviewer x0rfbserver xplayfbs rfbcat xvncconnect
+++PROGRAMS = xrfbviewer x0rfbserver xplayfbs xvncconnect
++
++ ENVIRONMENT = USE_ZLIB=$(USE_ZLIB)
++
++@@ -31,7 +31,6 @@
++        -cd lib         &amp;&amp;  $(MAKE) -e $(ENVIRONMENT) $@
++        -cd xrfbviewer  &amp;&amp;  $(MAKE) -e $(ENVIRONMENT) $@
++        -cd x0rfbserver &amp;&amp;  $(MAKE) -e $(ENVIRONMENT) $@
++-       -cd rfbcat      &amp;&amp;  $(MAKE) -e $(ENVIRONMENT) $@
++
++
++ librfb.a:
++@@ -46,9 +45,6 @@
++ xplayfbs: librfb.a
++        cd xrfbviewer   &amp;&amp;  $(MAKE) -e $(ENVIRONMENT) $@
++
++-rfbcat: librfb.a
++-       cd rfbcat       &amp;&amp;  $(MAKE) -e $(ENVIRONMENT) $@
++-
++ xvncconnect:
++        cd xvncconnect  &amp;&amp;  $(MAKE) -e $(ENVIRONMENT) $@
++
++@@ -57,5 +53,4 @@
++        cd x0rfbserver  &amp;&amp;  $(MAKE) $@
++        cd xrfbviewer   &amp;&amp;  $(MAKE) $@
++        cd xvncconnect  &amp;&amp;  $(MAKE) $@
++-       cd rfbcat       &amp;&amp;  $(MAKE) $@
++
++
++
+--- rfb-0.6.1.orig/debian/patches/size_t-to-socklen_t.diff
++++ rfb-0.6.1/debian/patches/size_t-to-socklen_t.diff
+@@ -0,0 +1,24 @@
++Wesley J Landaker &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">wjl at icecavern.net</A>&gt;
++
++--- rfb-0.6.1/x0rfbserver/x0rfbserver.cc.orig	2004-03-15 21:45:26.000000000 -0700
+++++ rfb-0.6.1/x0rfbserver/x0rfbserver.cc	2004-03-15 21:44:48.000000000 -0700
++@@ -484,7 +484,7 @@
++   if ( _fh == fhSocket ) {
++     if ( _mask &amp; XCM_READABLE ) {
++       struct sockaddr addr;
++-      size_t laddr = sizeof(addr);
+++      socklen_t laddr = sizeof(addr);
++       int fdClient = accept(fd, &amp;addr, &amp;laddr);
++       int one = 1;
++       setsockopt(fdClient, IPPROTO_TCP, TCP_NODELAY, (char *)&amp;one, sizeof(one));
++--- rfb-0.6.1/xrfbviewer/OXViewerApplet.cc.orig	2004-03-15 21:43:09.000000000 -0700
+++++ rfb-0.6.1/xrfbviewer/OXViewerApplet.cc	2004-03-15 21:43:56.000000000 -0700
++@@ -197,7 +197,7 @@
++   if ( _fh == fhSocket ) {
++     cout &lt;&lt; &quot;Connection request&quot; &lt;&lt; endl;
++     struct sockaddr addr;
++-    size_t laddr = sizeof(addr);
+++    socklen_t laddr = sizeof(addr);
++     int fdClient = accept(_fh-&gt;GetFd(), &amp;addr, &amp;laddr);
++     int one = 1;
++     setsockopt(fdClient, IPPROTO_TCP, TCP_NODELAY, (char *)&amp;one, sizeof(one));
+--- rfb-0.6.1.orig/debian/patches/gcc3.4.patch
++++ rfb-0.6.1/debian/patches/gcc3.4.patch
+@@ -0,0 +1,51 @@
++From: Andreas Jochens &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">aj at andaco.de</A>&gt;
++
++When building 'rfb' with gcc-3.4 I get the following error:
++
++In file included from /usr/include/c++/3.4/vector:75,
++                 from /usr/include/xclass/OXItemView.h:25,
++                 from /usr/include/xclass/OXListView.h:32,
++                 from /usr/include/xclass/OXFileDialog.h:26,
++                 from xrfbviewer.cc:55:
++/usr/include/c++/3.4/bits/vector.tcc: In member function `void std::vector&lt;_Tp, _Alloc&gt;::_M_fill_insert(__gnu_cxx::__normal_iterator&lt;typename _Alloc::pointer, std::vector&lt;_Tp, _Alloc&gt; &gt;, size_t, const _Tp&amp;)':
++/usr/include/c++/3.4/bits/vector.tcc:307: error: expected unqualified-id before '(' token
++/usr/include/c++/3.4/bits/vector.tcc: In member function `void std::vector&lt;_Tp, _Alloc&gt;::_M_range_insert(__gnu_cxx::__normal_iterator&lt;typename _Alloc::pointer, std::vector&lt;_Tp, _Alloc&gt; &gt;, _ForwardIterator, _ForwardIterator, std::forward_iterator_tag)':
++/usr/include/c++/3.4/bits/vector.tcc:384: error: expected unqualified-id before '(' token
++In file included from /usr/include/c++/3.4/backward/map.h:59,
++                 from xclass++.h:4,
++                 from OXAbout.h:36,
++                 from xrfbviewer.cc:60:
++/usr/include/c++/3.4/backward/backward_warning.h:32:2: warning: #warning This file includes at least one deprecated or antiquated header. Please consider using one of the 32 headers found in section 17.4.1.2 of the C++ standard. Examples include substituting the &lt;X&gt; header for the &lt;X.h&gt; header for C++ includes, or &lt;iostream&gt; instead of the deprecated header &lt;iostream.h&gt;. To disable this warning use -Wno-deprecated.
++xrfbviewer.cc:783:10: warning: extra tokens at end of #endif directive
++make[2]: *** [xrfbviewer.o] Error 1
++make[2]: Leaving directory `/rfb-0.6.1/xrfbviewer'
++
++With the attached patch 'rfb' can be compiled using gcc-3.4.
++
++Regards
++Andreas Jochens
++
++diff -urN ../tmp-orig/rfb-0.6.1/xrfbviewer/xplayfbs.cc ./xrfbviewer/xplayfbs.cc
++--- ../tmp-orig/rfb-0.6.1/xrfbviewer/xplayfbs.cc	2004-11-12 10:00:49.617032880 +0000
+++++ ./xrfbviewer/xplayfbs.cc	2004-11-12 10:00:31.499787120 +0000
++@@ -37,6 +37,7 @@
++ #include &lt;xclass/OXClient.h&gt;
++ #include &lt;xclass/OXWindow.h&gt;
++ #include &lt;xclass/OXMainFrame.h&gt;
+++#undef max
++ #include &lt;xclass/OXFileDialog.h&gt;
++ #include &lt;xclass/OFileHandler.h&gt;
++ #include &lt;xclass/OTimer.h&gt;
++diff -urN ../tmp-orig/rfb-0.6.1/xrfbviewer/xrfbviewer.cc ./xrfbviewer/xrfbviewer.cc
++--- ../tmp-orig/rfb-0.6.1/xrfbviewer/xrfbviewer.cc	2004-11-12 10:00:49.617032880 +0000
+++++ ./xrfbviewer/xrfbviewer.cc	2004-11-12 10:00:46.513504688 +0000
++@@ -52,6 +52,7 @@
++ #include &lt;xclass/OFileHandler.h&gt;
++ #include &lt;xclass/OXCanvas.h&gt;
++ #include &lt;xclass/OTimer.h&gt;
+++#undef max
++ #include &lt;xclass/OXFileDialog.h&gt;
++ 
++ #include &lt;X11/cursorfont.h&gt;
++
++
+--- rfb-0.6.1.orig/debian/copyright
++++ rfb-0.6.1/debian/copyright
+@@ -0,0 +1,28 @@
++This package was debianized by Paul Hedderly &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">prh at debian.org</A>&gt; on
++Wed, 16 Oct 2002 12:03:02 +0100.
++
++It was downloaded from:
++	<A HREF="http://www.hexonet.de/software/rfb/">http://www.hexonet.de/software/rfb/</A>
++	<A HREF="http://forum.hexonet.com/">http://forum.hexonet.com/</A>
++
++Upstream Author:
++	Jens Wagner &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">jwagner at hexonet.de</A>&gt;
++
++Copyright:
++ Copyright (c) 2000 heXoNet Support GmbH, D-66424 Homburg
++
++ This is free software; you can redistribute it and/or modify it under
++ the terms of the GNU General Public License as published by the Free
++ Software Foundation; either version 2, or (at your option) any later
++ version.
++
++ This is distributed in the hope that it will be useful, but WITHOUT
++ ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
++ FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
++ for more details.
++
++ You should have received a copy of the GNU General Public License with
++ your Debian GNU/Linux system, in /usr/share/common-licenses/GPL, or with
++ the debarchiver source package as the file COPYING.  If not, write to the Free
++ Software Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA
++ 02111-1307, USA.
+--- rfb-0.6.1.orig/debian/dirs
++++ rfb-0.6.1/debian/dirs
+@@ -0,0 +1,3 @@
++usr/bin
++usr/sbin
++usr/share/man/man1
+--- rfb-0.6.1.orig/debian/docs
++++ rfb-0.6.1/debian/docs
+@@ -0,0 +1 @@
++README
+--- rfb-0.6.1.orig/debian/menu
++++ rfb-0.6.1/debian/menu
+@@ -0,0 +1,5 @@
++?package(rfb):needs=&quot;X11&quot; section=&quot;Apps/Net&quot;\
++  title=&quot;x0rfbserver&quot; command=&quot;/usr/bin/x0rfbserver&quot;
++
++?package(rfb):needs=&quot;X11&quot; section=&quot;Apps/Net&quot;\
++  title=&quot;/usr/bin/x0rfbviewer&quot; command=&quot;/usr/bin/xrfbviewer&quot;
+--- rfb-0.6.1.orig/debian/rfb.install
++++ rfb-0.6.1/debian/rfb.install
+@@ -0,0 +1,4 @@
++./x0rfbserver/x0rfbserver usr/bin
++./xrfbviewer/xrfbviewer usr/bin
++./xrfbviewer/xplayfbs usr/bin
++./man/man1 usr/share/man
+--- rfb-0.6.1.orig/debian/rules
++++ rfb-0.6.1/debian/rules
+@@ -0,0 +1,95 @@
++#!/usr/bin/make -f
++# Sample debian/rules that uses debhelper.
++# GNU copyright 1997 to 1999 by Joey Hess.
++
++# Uncomment this to turn on verbose mode.
++#export DH_VERBOSE=1
++
++# This is the debhelper compatibility version to use.
++export DH_COMPAT=3
++
++
++
++ifneq (,$(findstring debug,$(DEB_BUILD_OPTIONS)))
++	CFLAGS += -g
++endif
++ifeq (,$(findstring nostrip,$(DEB_BUILD_OPTIONS)))
++	INSTALL_PROGRAM += -s
++endif
++
++configure: configure-stamp
++configure-stamp:
++	dh_testdir
++	# Add here commands to configure the package.
++
++	touch configure-stamp
++
++
++build: build-stamp
++
++build-stamp: configure-stamp 
++	dh_testdir
++
++	# Add here commands to compile the package.
++	$(MAKE)
++	#/usr/bin/docbook-to-man debian/rfb.sgml &gt; rfb.1
++
++	touch build-stamp
++
++clean:
++	dh_testdir
++	dh_testroot
++	rm -f build-stamp configure-stamp
++
++	# Add here commands to clean up after the build process.
++	-$(MAKE) clean
++
++	dh_clean
++
++install: build
++	dh_testdir
++	dh_testroot
++	dh_clean -k
++	dh_installdirs
++
++	# Add here commands to install the package into debian/rfb.
++	#$(MAKE) install DESTDIR=$(CURDIR)/debian/rfb
++	dh_install
++
++
++# Build architecture-independent files here.
++binary-indep: build install
++# We have nothing to do by default.
++
++# Build architecture-dependent files here.
++binary-arch: build install
++	dh_testdir
++	dh_testroot
++#	dh_installdebconf	
++	dh_installdocs
++	dh_installexamples
++	dh_installmenu
++#	dh_installlogrotate
++#	dh_installemacsen
++#	dh_installpam
++#	dh_installmime
++#	dh_installinit
++	dh_installcron
++	dh_installman
++	dh_installinfo
++	dh_undocumented rfbcat.1
++	dh_installchangelogs 
++	dh_link
++	dh_strip
++	dh_compress
++	dh_fixperms
++#	dh_makeshlibs
++	dh_installdeb
++#	dh_perl
++	dh_shlibdeps
++	dh_gencontrol
++	dh_md5sums
++	dh_builddeb
++
++binary: binary-indep binary-arch
++.PHONY: build clean binary-indep binary-arch binary install configure
+--- rfb-0.6.1.orig/debian/watch
++++ rfb-0.6.1/debian/watch
+@@ -0,0 +1,6 @@
++# Example watch control file for uscan
++# Rename this file to &quot;watch&quot; and then you can run the &quot;uscan&quot; command
++# to check for upstream updates and more.
++# Site		Directory		Pattern			Version	Script
++version=2
++sunsite.unc.edu	/pub/Linux/Incoming	rfb-(.*)\.tar\.gz	debian	uupdate
+--- rfb-0.6.1.orig/debian/changelog
++++ rfb-0.6.1/debian/changelog
+@@ -0,0 +1,90 @@
++rfb (0.6.1-11) unstable; urgency=low
++
++  * Fixed dependency, closes: #278148.
++
++ -- Ola Lundqvist &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">opal at debian.org</A>&gt;  Sun, 17 Apr 2005 21:11:33 +0200
++
++rfb (0.6.1-10) unstable; urgency=low
++
++  * Need xclass 0.8.3 to build correctly for sarge, closes: #293112.
++
++ -- Ola Lundqvist &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">opal at debian.org</A>&gt;  Sat,  5 Feb 2005 21:17:31 +0100
++
++rfb (0.6.1-9) unstable; urgency=low
++
++  * Applied patch from Andreas Jochens &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">aj at andaco.de</A>&gt; so it can compile
++    on gcc3.4, closes: #280875.
++
++ -- Ola Lundqvist &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">opal at debian.org</A>&gt;  Fri, 28 Jan 2005 21:49:23 +0100
++
++rfb (0.6.1-8) unstable; urgency=low
++
++  * Applied the patch mentioned in last upload about the build issue,
++    closes: #205316. I apparently forgot to apply it.
++
++ -- Ola Lundqvist &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">opal at debian.org</A>&gt;  Sat, 14 Aug 2004 18:17:54 +0200
++
++rfb (0.6.1-7) unstable; urgency=low
++
++  * Applied patch that fix a build issue, closes: #205316. Thanks to
++    Wesley J Landaker &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">wjl at icecavern.net</A>&gt; for the patch.
++  * Updated standards version 3.6.1.
++  * Removed rfbcat, closes: #207479.
++    Thanks to Wesley J Landaker &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">wjl at icecavern.net</A>&gt; for the patch.
++    Got some rejects but thy were not necessary to fix (in Makefile).
++  * Fixed menu entry as suggested by &quot;Christoffer Sawicki&quot; &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">qerub at home.se</A>&gt;.
++    Quoted them too, closes: #203293.
++  * Changed cerr and endl to std::cerr and std::endl in
++    xrfbviewer/xrfbviewer.cc and xrfbviewer/xplayfbs.cc in order to make it
++    compile.
++  * Changed build depends on libxclass0-dev (&lt;&lt; 0.9.0), was (&lt;&lt; 0.7.0).
++    No problem with that as far as I can see.
++
++ -- Ola Lundqvist &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">opal at debian.org</A>&gt;  Thu, 12 Aug 2004 09:01:39 +0200
++
++rfb (0.6.1-6) unstable; urgency=low
++
++  * Updated licensing information, closes: #207584.
++  * Updated debian policy from 3.5.8 to 3.5.10.
++
++ -- Ola Lundqvist &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">opal at debian.org</A>&gt;  Fri, 29 Aug 2003 20:53:04 +0200
++
++rfb (0.6.1-5) unstable; urgency=low
++
++  * Rebuild to make dependencies correct, closes: #195180.
++
++ -- Ola Lundqvist &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">opal at debian.org</A>&gt;  Fri, 13 Jun 2003 18:49:03 +0200
++
++rfb (0.6.1-4) unstable; urgency=low
++
++  * Added missing build dependency, closes: #189671.
++  * Fixing dependency on xclass0, closes: #192879.
++  * Updated copyright a bit.
++
++ -- Ola Lundqvist &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">opal at debian.org</A>&gt;  Sat, 19 Apr 2003 23:15:02 +0200
++
++rfb (0.6.1-3) unstable; urgency=low
++
++  * Now compiles using gcc3.2, closes: #166465.
++  * Seems not to crash with all the gcc fixes, closes: #168512.
++  * Removed libc6 from build dep, closes: #167989.
++  * Added missing build dependency, closes: #166363.
++  * Updated standards version to 3.5.8.
++  * Fixed spelling error in description,
++    closes: #181773, #165773, #167681, #172884.
++  * New maintainer.
++
++ -- Ola Lundqvist &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">opal at debian.org</A>&gt;  Thu, 17 Apr 2003 20:36:34 +0200
++
++rfb (0.6.1-2) unstable; urgency=low
++
++  * Closes ITA (Closes: Bug#78896)
++
++ -- Paul Hedderly &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">prh at debian.org</A>&gt;  Wed, 16 Oct 2002 13:09:18 +0100
++
++rfb (0.6.1-1) unstable; urgency=low
++
++  * Initial Release.
++
++ -- Paul Hedderly &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">prh at debian.org</A>&gt;  Wed, 16 Oct 2002 12:03:02 +0100
++
+--- rfb-0.6.1.orig/debian/control
++++ rfb-0.6.1/debian/control
+@@ -0,0 +1,19 @@
++Source: rfb
++Section: x11
++Priority: optional
++Maintainer: Ola Lundqvist &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">opal at debian.org</A>&gt;
++Build-Depends: debhelper (&gt;&gt; 3.0.0), libxclass0-dev (&gt;&gt; 0.8.3), libxclass0-dev (&lt;&lt; 0.9.0), zlib1g-dev, xlibs-dev
++Standards-Version: 3.6.1
++
++Package: rfb
++Architecture: any
++Depends: ${shlibs:Depends}, libxclass0 (&gt;&gt; 0.8.3)
++Description: VNC Server for X11 - exports current display
++ Like the xvncserver package, x0rfbserver exports an X display using the
++ RFB protocol.
++ .
++ Unlike xvncserver which creates a virtual X11 display to export, x0rfbserver
++ actually exports the display it is run in... just like the windows VNC server.
++ .
++ Also included are rfb utilities to capture and replay RFB data streams, and
++ a vnc viewer.
+--- rfb-0.6.1.orig/Makefile
++++ rfb-0.6.1/Makefile
+@@ -20,7 +20,7 @@
+ 
+ USE_ZLIB = USE_ZLIB_WARREN
+ 
+-PROGRAMS = xrfbviewer x0rfbserver xplayfbs rfbcat xvncconnect
++PROGRAMS = xrfbviewer x0rfbserver xplayfbs xvncconnect
+ 
+ ENVIRONMENT = USE_ZLIB=$(USE_ZLIB)
+ 

Added: trunk/rpms/rrdtool/rrdtool-1.2.19-python.patch
===================================================================
--- trunk/rpms/rrdtool/rrdtool-1.2.19-python.patch	                        (rev 0)
+++ trunk/rpms/rrdtool/rrdtool-1.2.19-python.patch	2007-09-20 13:53:50 UTC (rev 5856)
@@ -0,0 +1,22 @@
+diff -uNr bindings/python-orig/Makefile.am bindings/python/Makefile.am
+--- bindings/python-orig/Makefile.am	2007-03-31 11:21:43.000000000 +0100
++++ bindings/python/Makefile.am	2007-03-31 11:24:47.000000000 +0100
+@@ -2,6 +2,7 @@
+ 
+ pyexec_PROGRAMS = rrdtoolmodule.so
+ 
++rrdtoolmodule_so_LDFLAGS = -module -shared
+ rrdtoolmodule_so_LDADD = $(top_builddir)/src/librrd.la
+ rrdtoolmodule_so_SOURCES = rrdtoolmodule.c
+ 
+diff -uNr bindings/python-orig/Makefile.in bindings/python/Makefile.in
+--- bindings/python-orig/Makefile.in	2007-03-31 11:21:43.000000000 +0100
++++ bindings/python/Makefile.in	2007-03-31 11:22:14.000000000 +0100
+@@ -233,6 +233,7 @@
+ target_os = @target_os@
+ target_vendor = @target_vendor@
+ AM_CPPFLAGS = @CFLAGS@ -I$(top_srcdir)/src @PYTHON_INCLUDES@
++rrdtoolmodule_so_LDFLAGS = -module -shared
+ rrdtoolmodule_so_LDADD = $(top_builddir)/src/librrd.la
+ rrdtoolmodule_so_SOURCES = rrdtoolmodule.c
+ noinst_HEADERS = rrd_extra.h

Added: trunk/rpms/tightvnc/tightvnc-1.2.6-config-x86_64.patch
===================================================================
--- trunk/rpms/tightvnc/tightvnc-1.2.6-config-x86_64.patch	                        (rev 0)
+++ trunk/rpms/tightvnc/tightvnc-1.2.6-config-x86_64.patch	2007-09-20 13:53:50 UTC (rev 5856)
@@ -0,0 +1,126 @@
+--- vnc_unixsrc/Xvnc/config/cf/Imake.cf.config-x86_64	2002-04-30 09:07:30.000000000 -0400
++++ vnc_unixsrc/Xvnc/config/cf/Imake.cf	2002-12-04 11:25:39.000000000 -0500
+@@ -604,6 +604,16 @@ XCOMM Keep cpp from replacing path eleme
+ #  define PowerPCArchitecture
+ #  undef powerpc
+ # endif
++# if defined(__x86_64__)
++#  undef __x86_64__
++#  define x86_64Architecture
++# endif
++# if defined(x86_64__)
++#  undef x86_64__
++#  ifndef(x86_64Architecture)
++#   define x86_64Architecture
++#  endif
++# endif
+ #endif /* linux */
+ 
+ #if (defined(__Lynx__) || defined(Lynx)) &amp;&amp; (defined(i386) || defined(__i386__) || defined(__x86__) || defined(__powerpc__) || defined(__sparc__) || defined(sparc))
+--- vnc_unixsrc/Xvnc/config/cf/linux.cf.config-x86_64	2002-03-20 05:49:23.000000000 -0500
++++ vnc_unixsrc/Xvnc/config/cf/linux.cf	2002-12-04 11:30:13.000000000 -0500
+@@ -43,7 +43,7 @@ XCOMM platform:  $XFree86: xc/config/cf/
+ #if defined(AlphaArchitecture) || defined(PowerPCArchitecture) || \
+     defined(SparcArchitecture) || defined(ArmArchitecure) || \
+     defined(i386Architecture) || defined(s390Architecture) || \
+-    defined(s390xArchitecture)
++    defined(s390xArchitecture) || defined(x86_64Architecture)
+ #define DefaultLinuxCLibMajorVersion	6
+ #else
+ #define DefaultLinuxCLibMajorVersion	5
+@@ -157,6 +157,14 @@ XCOMM binutils:	(LinuxBinUtilsMajorVersi
+ #define UseStaticTermcapLib	NO
+ #endif
+ 
++#ifndef HaveLib64
++# if defined (x86_64Architecture) || defined (s390xArchitecture)
++#  define HaveLib64 YES
++# else
++#  define HaveLib64 NO
++# endif
++#endif
++
+ #define MkdirHierCmd		mkdir -p
+ #if LinuxElfDefault
+ #if UseElfFormat
+@@ -179,6 +187,13 @@ XCOMM binutils:	(LinuxBinUtilsMajorVersi
+ #ifdef SparcArchitecture
+ #define AsmDefines		-D__ELF__
+ #endif /* SparcArchitecture */
++#  ifdef x86_64Architecture
++#   define CcCmd                 gcc
++#   define CplusplusCmd          g++
++#   define AsCmd                 CcCmd -c -x assembler-with-cpp
++#   define LdCmd                 CcCmd -nostdlib
++#   define AsmDefines            -DUSE_GAS -U__ELF__
++#  endif /* x86_64Architecture */
+ #ifdef i386Architecture
+ #define CcCmd			gcc -b i486-linuxaout
+ #define CplusplusCmd		g++ -b i486-linuxaout
+@@ -206,6 +221,13 @@ XCOMM binutils:	(LinuxBinUtilsMajorVersi
+ #ifdef SparcArchitecture
+ #define AsmDefines		-D__ELF__
+ #endif /* SparcArchitecture */
++#  ifdef x86_64Architecture
++#   define CcCmd                 gcc
++#   define CplusplusCmd          g++
++#   define AsCmd                 CcCmd -c -x assembler-with-cpp
++#   define LdCmd                 CcCmd -nostdlib
++#   define AsmDefines            -D__ELF__
++#  endif /* x86_64Architecture */
+ #ifdef i386Architecture
+ #define CcCmd			gcc -b i486-linux
+ #define AsCmd			/usr/i486-linux/bin/as
+@@ -261,6 +283,15 @@ XCOMM binutils:	(LinuxBinUtilsMajorVersi
+ #define ServerExtraDefines	-DGCCUSESGAS XFree86ServerDefines -D_XSERVER64
+ #endif /* AlphaArchitecture */
+ 
++#ifdef x86_64Architecture
++# ifndef OptimizedCDebugFlags
++#  define OptimizedCDebugFlags	DefaultGcc2x86_64Opt
++# endif
++# define LinuxMachineDefines   -D__x86_64__
++# define ServerOSDefines	XFree86ServerOSDefines -DDDXTIME -DPART_NET
++# define ServerExtraDefines	-DGCCUSESGAS XFree86ServerDefines -D_XSERVER64
++#endif /* x86_64Architecture */
++
+ #ifdef Mc68020Architecture
+ #define OptimizedCDebugFlags	-O2
+ #define LinuxMachineDefines 	-D__mc68000__
+--- vnc_unixsrc/Xvnc/config/cf/xfree86.cf.config-x86_64	2000-06-11 08:00:51.000000000 -0400
++++ vnc_unixsrc/Xvnc/config/cf/xfree86.cf	2002-12-04 11:32:41.000000000 -0500
+@@ -1013,6 +1013,12 @@ XFREE86JAPANESEDOCDIR = $(XFREE86DOCDIR)
+ #endif
+ #endif
+ 
++#if HasGcc2 &amp;&amp; defined(x86_64Architecture)
++# ifndef DefaultGcc2x86_64Opt
++#  define DefaultGcc2x86_64Opt -O2 -fno-strength-reduce
++# endif
++#endif
++
+ #ifndef DontDefineXF86Contrib
+ #define XF86Contrib
+ #endif
+--- vnc_unixsrc/Xvnc/config/imake/imakemdep.h.config-x86_64	2002-03-20 00:36:47.000000000 -0500
++++ vnc_unixsrc/Xvnc/config/imake/imakemdep.h	2002-12-04 11:34:22.000000000 -0500
+@@ -304,6 +304,9 @@ char *cpp_argv[ARGUMENTS] = {
+ # ifdef __alpha__
+        &quot;-D__alpha__&quot;,
+ # endif
++# ifdef __x86_64__
++	&quot;-D__x86_64__&quot;,
++# endif
+ # ifdef __GNUC__
+ 	&quot;-traditional&quot;,
+ # endif
+@@ -468,6 +471,9 @@ char *cpp_argv[ARGUMENTS] = {
+ # ifdef __alpha__
+ 	&quot;-D__alpha__&quot;,
+ # endif
++# ifdef __x86_64__
++	&quot;-D__x86_64__&quot;,
++# endif
+ # ifdef __i386__
+ 	&quot;-D__i386__&quot;,
+ # endif

Added: trunk/rpms/tightvnc/tightvnc-1.2.9-fix-build-when-fds_bits-not-defined.patch
===================================================================
--- trunk/rpms/tightvnc/tightvnc-1.2.9-fix-build-when-fds_bits-not-defined.patch	                        (rev 0)
+++ trunk/rpms/tightvnc/tightvnc-1.2.9-fix-build-when-fds_bits-not-defined.patch	2007-09-20 13:53:50 UTC (rev 5856)
@@ -0,0 +1,12 @@
+--- vnc_unixsrc/Xvnc/include/Xpoll.h.deush	2004-09-03 12:58:28.221930897 +0200
++++ vnc_unixsrc/Xvnc/include/Xpoll.h	2004-09-03 12:58:39.260152096 +0200
+@@ -89,6 +89,9 @@
+ #define Select(n,r,w,e,t) select(n,(fd_set*)r,(fd_set*)w,(fd_set*)e,(struct timeval*)t)
+ #endif
+ 
++#ifndef fds_bits 
++#define fds_bits __fds_bits
++#endif
+ #ifndef FD_SET
+ #define FD_SET(n, p)    ((p)-&gt;fds_bits[(n)/NFDBITS] |= (1 &lt;&lt; ((n) % NFDBITS)))
+ #endif

Added: trunk/rpms/tightvnc/tightvnc-1.2.9-includes.patch
===================================================================
--- trunk/rpms/tightvnc/tightvnc-1.2.9-includes.patch	                        (rev 0)
+++ trunk/rpms/tightvnc/tightvnc-1.2.9-includes.patch	2007-09-20 13:53:50 UTC (rev 5856)
@@ -0,0 +1,141 @@
+--- vnc_unixsrc/Xvnc/include/Xfuncs.h.includes	2000-06-11 14:00:52.000000000 +0200
++++ vnc_unixsrc/Xvnc/include/Xfuncs.h	2006-01-20 17:58:28.000000000 +0100
+@@ -43,9 +43,11 @@ int bcmp();
+ #if (__STDC__ &amp;&amp; !defined(X_NOT_STDC_ENV) &amp;&amp; !defined(sun) &amp;&amp; !defined(macII) &amp;&amp; !defined(apollo)) || defined(SVR4) || defined(hpux) || defined(_IBMR2) || defined(_SEQUENT_)
+ #include &lt;string.h&gt;
+ #define _XFUNCS_H_INCLUDED_STRING_H
++#if defined(sun)
+ #define bcopy(b1,b2,len) memmove(b2, b1, (size_t)(len))
+ #define bzero(b,len) memset(b, 0, (size_t)(len))
+ #define bcmp(b1,b2,len) memcmp(b1, b2, (size_t)(len))
++#endif
+ #else
+ #ifdef sgi
+ #include &lt;bstring.h&gt;
+--- vnc_unixsrc/Xvnc/lib/Xdmcp/Alloc.c.includes	2000-06-11 14:00:52.000000000 +0200
++++ vnc_unixsrc/Xvnc/lib/Xdmcp/Alloc.c	2006-01-20 17:58:28.000000000 +0100
+@@ -30,8 +30,7 @@ in this Software without prior written a
+  */
+ 
+ /* stubs for use when Xalloc, Xrealloc and Xfree are not defined */
+-
+-extern char	*malloc (), *realloc ();
++#include &lt;stdlib.h&gt;
+ 
+ unsigned long *
+ Xalloc (amount)
+--- vnc_unixsrc/Xvnc/lib/Xdmcp/GenKey.c.includes	2000-06-11 14:00:52.000000000 +0200
++++ vnc_unixsrc/Xvnc/lib/Xdmcp/GenKey.c	2006-01-20 17:58:28.000000000 +0100
+@@ -29,6 +29,7 @@ in this Software without prior written a
+  * Author:  Keith Packard, MIT X Consortium
+  */
+ 
++#include &lt;time.h&gt;
+ #include &lt;X11/Xos.h&gt;
+ #include &lt;X11/X.h&gt;
+ #include &lt;X11/Xmd.h&gt;
+--- vnc_unixsrc/Xvnc/programs/Xserver/hw/vnc/init.c.includes	2002-10-27 13:36:02.000000000 +0100
++++ vnc_unixsrc/Xvnc/programs/Xserver/hw/vnc/init.c	2006-01-20 17:58:28.000000000 +0100
+@@ -55,6 +55,8 @@ from the X Consortium.
+ 
+ #include &lt;stdio.h&gt;
+ #include &lt;stdarg.h&gt;
++#include &lt;stdlib.h&gt;
++#include &lt;time.h&gt;
+ #include &lt;sys/types.h&gt;
+ #include &lt;sys/socket.h&gt;
+ #include &lt;netinet/in.h&gt;
+--- vnc_unixsrc/Xvnc/programs/Xserver/hw/vnc/sockets.c.includes	2002-10-27 13:36:02.000000000 +0100
++++ vnc_unixsrc/Xvnc/programs/Xserver/hw/vnc/sockets.c	2006-01-20 17:58:28.000000000 +0100
+@@ -38,11 +38,13 @@
+  */
+ 
+ #include &lt;stdio.h&gt;
++#include &lt;stdlib.h&gt;
+ #include &lt;sys/types.h&gt;
+ #include &lt;sys/time.h&gt;
+ #include &lt;sys/socket.h&gt;
+ #include &lt;netinet/in.h&gt;
+ #include &lt;netinet/tcp.h&gt;
++#include &lt;arpa/inet.h&gt;
+ #include &lt;netdb.h&gt;
+ #include &lt;fcntl.h&gt;
+ #include &lt;errno.h&gt;
+@@ -156,7 +158,7 @@ rfbCheckFds()
+     fd_set fds;
+     struct timeval tv;
+     struct sockaddr_in addr;
+-    int addrlen = sizeof(addr);
++    socklen_t addrlen = sizeof(addr);
+     char buf[6];
+     const int one = 1;
+     int sock;
+--- vnc_unixsrc/Xvnc/programs/Xserver/hw/vnc/httpd.c.includes	2003-04-09 00:20:13.000000000 +0200
++++ vnc_unixsrc/Xvnc/programs/Xserver/hw/vnc/httpd.c	2006-01-20 17:58:28.000000000 +0100
+@@ -28,6 +28,7 @@
+ #include &lt;sys/socket.h&gt;
+ #include &lt;netinet/in.h&gt;
+ #include &lt;netinet/tcp.h&gt;
++#include &lt;arpa/inet.h&gt;
+ #include &lt;netdb.h&gt;
+ #include &lt;fcntl.h&gt;
+ #include &lt;errno.h&gt;
+@@ -112,7 +113,7 @@ httpCheckFds()
+     fd_set fds;
+     struct timeval tv;
+     struct sockaddr_in addr;
+-    int addrlen = sizeof(addr);
++    socklen_t addrlen = sizeof(addr);
+ 
+     if (!httpDir)
+ 	return;
+@@ -192,7 +193,7 @@ static void
+ httpProcessInput()
+ {
+     struct sockaddr_in addr;
+-    int addrlen = sizeof(addr);
++    socklen_t addrlen = sizeof(addr);
+     char fullFname[512];
+     char params[1024];
+     char *ptr;
+--- vnc_unixsrc/libvncauth/vncauth.c.includes	2003-03-01 17:48:06.000000000 +0100
++++ vnc_unixsrc/libvncauth/vncauth.c	2006-01-20 17:58:28.000000000 +0100
+@@ -24,6 +24,7 @@
+ #include &lt;stdio.h&gt;
+ #include &lt;stdlib.h&gt;
+ #include &lt;string.h&gt;
++#include &lt;time.h&gt;
+ #include &lt;sys/types.h&gt;
+ #include &lt;sys/stat.h&gt;
+ #include &lt;unistd.h&gt;
+--- vnc_unixsrc/vncconnect/vncconnect.c.includes	2000-11-10 11:20:07.000000000 +0100
++++ vnc_unixsrc/vncconnect/vncconnect.c	2006-01-20 17:58:28.000000000 +0100
+@@ -3,6 +3,8 @@
+  */
+ 
+ #include &lt;stdio.h&gt;
++#include &lt;stdlib.h&gt;
++#include &lt;string.h&gt;
+ #include &lt;X11/Xlib.h&gt;
+ #include &lt;X11/Xatom.h&gt;
+ 
+--- vnc_unixsrc/vncviewer/sockets.c.includes	2001-01-15 04:54:18.000000000 +0100
++++ vnc_unixsrc/vncviewer/sockets.c	2006-01-20 18:00:55.000000000 +0100
+@@ -325,7 +325,7 @@ AcceptTcpConnection(int listenSock)
+ {
+   int sock;
+   struct sockaddr_in addr;
+-  int addrlen = sizeof(addr);
++  socklen_t addrlen = sizeof(addr);
+   int one = 1;
+ 
+   sock = accept(listenSock, (struct sockaddr *) &amp;addr, &amp;addrlen);
+@@ -401,7 +401,7 @@ Bool
+ SameMachine(int sock)
+ {
+   struct sockaddr_in peeraddr, myaddr;
+-  int addrlen = sizeof(struct sockaddr_in);
++  socklen_t addrlen = sizeof(struct sockaddr_in);
+ 
+   getpeername(sock, (struct sockaddr *)&amp;peeraddr, &amp;addrlen);
+   getsockname(sock, (struct sockaddr *)&amp;myaddr, &amp;addrlen);

Added: trunk/rpms/tightvnc/tightvnc-1.2.9-use-stdlib-malloc.patch
===================================================================
--- trunk/rpms/tightvnc/tightvnc-1.2.9-use-stdlib-malloc.patch	                        (rev 0)
+++ trunk/rpms/tightvnc/tightvnc-1.2.9-use-stdlib-malloc.patch	2007-09-20 13:53:50 UTC (rev 5856)
@@ -0,0 +1,46 @@
+--- vnc_unixsrc/Xvnc/lib/Xau/AuRead.c.deush	2004-09-03 14:21:45.927081876 +0200
++++ vnc_unixsrc/Xvnc/lib/Xau/AuRead.c	2004-09-03 14:23:47.945527051 +0200
+@@ -28,6 +28,7 @@
+ */
+ 
+ #include &lt;X11/Xauth.h&gt;
++#include &lt;stdlib.h&gt;
+ 
+ static
+ read_short (shortp, file)
+@@ -49,7 +50,7 @@
+ FILE	*file;
+ {
+     unsigned short  len;
+-    char	    *data, *malloc ();
++    char	    *data;
+ 
+     if (read_short (&amp;len, file) == 0)
+ 	return 0;
+@@ -76,7 +77,6 @@
+ {
+     Xauth   local;
+     Xauth   *ret;
+-    char    *malloc ();
+ 
+     if (read_short (&amp;local.family, auth_file) == 0)
+ 	return 0;
+--- vnc_unixsrc/Xvnc/lib/Xau/AuWrite.c.deush	2004-09-03 14:22:03.700438043 +0200
++++ vnc_unixsrc/Xvnc/lib/Xau/AuWrite.c	2004-09-03 14:25:11.554202519 +0200
+@@ -28,6 +28,7 @@
+ */
+ 
+ #include &lt;X11/Xauth.h&gt;
++#include &lt;stdlib.h&gt;
+ 
+ static
+ write_short (s, file)
+@@ -61,8 +62,6 @@
+ FILE	*auth_file;
+ Xauth	*auth;
+ {
+-    char    *malloc ();
+-
+     if (write_short (auth-&gt;family, auth_file) == 0)
+ 	return 0;
+     if (write_counted_string (auth-&gt;address_length, auth-&gt;address, auth_file) == 0)

Added: trunk/rpms/tightvnc/vncserver-halfbaked.patch
===================================================================
--- trunk/rpms/tightvnc/vncserver-halfbaked.patch	                        (rev 0)
+++ trunk/rpms/tightvnc/vncserver-halfbaked.patch	2007-09-20 13:53:50 UTC (rev 5856)
@@ -0,0 +1,20 @@
+--- vncserver.halfbaked	2003-02-19 21:00:35.000000000 -0700
++++ vncserver	2003-02-19 21:00:35.000000000 -0700
+@@ -153,15 +153,8 @@
+ $desktopLog = &quot;$vncUserDir/$host:$displayNumber.log&quot;;
+ unlink($desktopLog);
+ 
+-# Make an X server cookie - use as the seed the sum of the current time, our
+-# PID and part of the encrypted form of the password.  Ideally we'd use
+-# /dev/urandom, but that's only available on Linux.
+-
+-srand(time+$$+unpack(&quot;L&quot;,`cat $vncUserDir/passwd`));
+-$cookie = &quot;&quot;;
+-for (1..16) {
+-    $cookie .= sprintf(&quot;%02x&quot;, int(rand(256)));
+-}
++# Use mcookie to make an X server cookie
++$cookie = `/usr/bin/mcookie`;
+ 
+ system(&quot;xauth -f $xauthorityFile add $host:$displayNumber . $cookie&quot;);
+ system(&quot;xauth -f $xauthorityFile add $host/unix:$displayNumber . $cookie&quot;); 

Added: trunk/rpms/tightvnc/vncserver-vncpasswd-1.2.6.patch
===================================================================
--- trunk/rpms/tightvnc/vncserver-vncpasswd-1.2.6.patch	                        (rev 0)
+++ trunk/rpms/tightvnc/vncserver-vncpasswd-1.2.6.patch	2007-09-20 13:53:50 UTC (rev 5856)
@@ -0,0 +1,10 @@
+--- vnc_unixsrc/vncserver.deush	2003-01-02 17:50:08.000000000 +0100
++++ vnc_unixsrc/vncserver	2003-01-02 17:52:50.000000000 +0100
+@@ -127,6 +127,7 @@
+ if (!-e _ || ($mode &amp; 077) != 0) {
+     warn &quot;\nYou will require a password to access your desktops.\n\n&quot;;
+     system(&quot;vncpasswd $vncUserDir/passwd&quot;);
++    chmod 0600, &quot;$vncUserDir/passwd&quot;;
+     if (($? &amp; 0xFF00) != 0) {
+         exit 1;
+     }

Added: trunk/rpms/tightvnc/vncviewer-fix-crash-when-lose-focus.patch
===================================================================
--- trunk/rpms/tightvnc/vncviewer-fix-crash-when-lose-focus.patch	                        (rev 0)
+++ trunk/rpms/tightvnc/vncviewer-fix-crash-when-lose-focus.patch	2007-09-20 13:53:50 UTC (rev 5856)
@@ -0,0 +1,19 @@
+--- vnc_unixsrc/vncviewer/misc.c--	2004-03-16 11:04:41.947493167 +0100
++++ vnc_unixsrc/vncviewer/misc.c	2004-03-16 11:05:47.634753826 +0100
+@@ -24,6 +24,7 @@
+ #include &lt;vncviewer.h&gt;
+ #include &lt;signal.h&gt;
+ #include &lt;fcntl.h&gt;
++#include &lt;X11/Xproto.h&gt;
+ 
+ static void CleanupSignalHandler(int sig);
+ static int CleanupXErrorHandler(Display *dpy, XErrorEvent *error);
+@@ -293,6 +294,8 @@ static int
+ CleanupXErrorHandler(Display *dpy, XErrorEvent *error)
+ {
+   fprintf(stderr,&quot;CleanupXErrorHandler called\n&quot;);
++  if( error-&gt;request_code == X_SetInputFocus )
++      return 0;
+   Cleanup();
+   return (*defaultXErrorHandler)(dpy, error);
+ }


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004654.html">[svn] r5855 - in trunk/rpms: openrm perl-Mail-ClamAV xawtv
</A></li>
	<LI>Next message: <A HREF="004656.html">[svn] r5857 - trunk/rpms/figlet
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4655">[ date ]</a>
              <a href="thread.html#4655">[ thread ]</a>
              <a href="subject.html#4655">[ subject ]</a>
              <a href="author.html#4655">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.repoforge.org/mailman/listinfo/commits">More information about the commits
mailing list</a><br>
</body></html>
