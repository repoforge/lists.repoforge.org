<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [SVN] r2965 - in trunk/tools/dar: . dists/el2i dists/el3a	dists/el3i dists/el4a dists/el4i dists/fc1i dists/fc2a	dists/fc2i dists/fc3a dists/fc3i dists/nodist dists/rh6i	dists/rh7i dists/rh8i dists/rh9i scripts
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:commits%40lists.repoforge.org?Subject=Re:%20Re%3A%20%5BSVN%5D%20r2965%20-%20in%20trunk/tools/dar%3A%20.%20dists/el2i%20dists/el3a%0A%09dists/el3i%20dists/el4a%20dists/el4i%20dists/fc1i%20dists/fc2a%0A%09dists/fc2i%20dists/fc3a%20dists/fc3i%20dists/nodist%20dists/rh6i%0A%09dists/rh7i%20dists/rh8i%20dists/rh9i%20scripts&In-Reply-To=%3C200503082013.j28KDeKs012461%40lists.rpmforge.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001765.html">
   <LINK REL="Next"  HREF="001767.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[SVN] r2965 - in trunk/tools/dar: . dists/el2i dists/el3a	dists/el3i dists/el4a dists/el4i dists/fc1i dists/fc2a	dists/fc2i dists/fc3a dists/fc3i dists/nodist dists/rh6i	dists/rh7i dists/rh8i dists/rh9i scripts</H1>
    <B>svn-commits at rpmforge.net</B> 
    <A HREF="mailto:commits%40lists.repoforge.org?Subject=Re:%20Re%3A%20%5BSVN%5D%20r2965%20-%20in%20trunk/tools/dar%3A%20.%20dists/el2i%20dists/el3a%0A%09dists/el3i%20dists/el4a%20dists/el4i%20dists/fc1i%20dists/fc2a%0A%09dists/fc2i%20dists/fc3a%20dists/fc3i%20dists/nodist%20dists/rh6i%0A%09dists/rh7i%20dists/rh8i%20dists/rh9i%20scripts&In-Reply-To=%3C200503082013.j28KDeKs012461%40lists.rpmforge.net%3E"
       TITLE="[SVN] r2965 - in trunk/tools/dar: . dists/el2i dists/el3a	dists/el3i dists/el4a dists/el4i dists/fc1i dists/fc2a	dists/fc2i dists/fc3a dists/fc3i dists/nodist dists/rh6i	dists/rh7i dists/rh8i dists/rh9i scripts">svn-commits at rpmforge.net
       </A><BR>
    <I>Tue Mar  8 21:13:40 CET 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="001765.html">[SVN] r2964 - in trunk/rpms: PyKDE perl-Business-ISBN perl-Business-ISBN-Data perl-CGI-Untaint perl-CPAN-DistnameInfo perl-CPANPLUS perl-CSS-Tiny perl-Carp-Assert perl-Carp-Clan perl-Chart perl-Chart-Strip perl-Chemistry-File-MDLMol perl-Chemistry-Mol perl-Class-Autouse perl-Class-Hook perl-Class-Inspector perl-Class-MethodMaker perl-Class-Singleton perl-Class-XPath perl-Clone perl-Compress-Zlib perl-Config-General perl-Config-IniFiles perl-Config-Record perl-Config-Tiny perl-Convert-ASN1 perl-Convert-BER perl-Convert-BinHex perl-Convert-IBM390 perl-Convert-TNEF perl-Convert-UUlib perl-Crypt-CAST5 perl-Crypt-CapnMidNite perl-Crypt-DES perl-Crypt-Enigma perl-Crypt-License perl-Crypt-OpenSSL-Bignum perl-Crypt-OpenSSL-DSA perl-Crypt-OpenSSL-RSA perl-Crypt-RC6 perl-Crypt-Rijndael perl-Crypt-Serpent perl-Crypt-SmbHash perl-Crypt-Tea perl-Crypt-Twofish2 perl-Crypt-Vigenere perl-Curses perl-Cwd perl-DBD-CSV perl-DBD-File perl-DNS-BL perl-Data-Dump perl-Data-DumpXML perl-Da! ta-ShowTable perl-Data-UUID perl-Date-Pcalc perl-DateTime perl-DateTime-Calendar-Christian perl-DateTime-Calendar-Julian perl-DateTime-Event-Chinese perl-DateTime-Event-Cron perl-DateTime-Event-Easter perl-DateTime-Event-ICal perl-DateTime-Event-Lunar perl-DateTime-Event-NameDay perl-DateTime-Event-Random perl-DateTime-Event-Recurrence perl-DateTime-Event-SolarTerm perl-DateTime-Event-Sunrise perl-DateTime-Locale perl-DateTime-Set perl-DateTime-TimeZone perl-DateTime-Util-Astro perl-DateTime-Util-Calc perl-Devel-Trace perl-Device-SerialPorts perl-Digest-BubbleBabble perl-Digest-HMAC perl-Digest-MD2 perl-Digest-MD5-M4p perl-Digest-Nilsimsa perl-Digest-SHA1 perl-Email-Address perl-Email-MIME perl-Email-MIME-Attachment-Stripper perl-Email-MIME-ContentType perl-Email-MIME-Encodings perl-Email-MIME-Modifier perl-Email-MessageID perl-Email-Valid perl-Env-Bash perl-Expect perl-ExtUtils-AutoInstall perl-ExtUtils-CBuilder perl-ExtUtils-Depends perl-ExtUtils-ParseXS perl-ExtUtils-Per! lPP perl-ExtUtils-PkgConfig perl-FCGI perl-File-Find-Rule perl! -File-Fi
</A></li>
        <LI>Next message: <A HREF="001767.html">[SVN] r2966 - in trunk/tools/dar: . scripts
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1766">[ date ]</a>
              <a href="thread.html#1766">[ thread ]</a>
              <a href="subject.html#1766">[ subject ]</a>
              <a href="author.html#1766">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: dag
Date: 2005-03-08 21:13:38 +0100 (Tue, 08 Mar 2005)
New Revision: 2965

Added:
   trunk/tools/dar/scripts/
   trunk/tools/dar/scripts/pre-brand.sh
   trunk/tools/dar/scripts/pre-disttag.sh
   trunk/tools/dar/scripts/pre-stub.sh
Modified:
   trunk/tools/dar/ChangeLog
   trunk/tools/dar/Makefile
   trunk/tools/dar/dar-build
   trunk/tools/dar/dar-exec
   trunk/tools/dar/dar-prepare
   trunk/tools/dar/dar-shell
   trunk/tools/dar/dar-sync
   trunk/tools/dar/dar-update
   trunk/tools/dar/dar.conf
   trunk/tools/dar/dists/el2i/config
   trunk/tools/dar/dists/el3a/config
   trunk/tools/dar/dists/el3i/config
   trunk/tools/dar/dists/el4a/config
   trunk/tools/dar/dists/el4i/config
   trunk/tools/dar/dists/fc1i/config
   trunk/tools/dar/dists/fc2a/config
   trunk/tools/dar/dists/fc2i/config
   trunk/tools/dar/dists/fc3a/config
   trunk/tools/dar/dists/fc3i/config
   trunk/tools/dar/dists/nodist/config
   trunk/tools/dar/dists/rh6i/config
   trunk/tools/dar/dists/rh7i/config
   trunk/tools/dar/dists/rh8i/config
   trunk/tools/dar/dists/rh9i/config
Log:
Updates

Modified: trunk/tools/dar/ChangeLog
===================================================================
--- trunk/tools/dar/ChangeLog	2005-03-08 19:22:25 UTC (rev 2964)
+++ trunk/tools/dar/ChangeLog	2005-03-08 20:13:38 UTC (rev 2965)
@@ -31,6 +31,9 @@
 - dar-sync: Recompress createrepo metadata for rsyncability
 - dar-build: Added disttag as a macro
 - dar-*: Moved the LD_ASSUME_KERNEL bits to per distribution files
+- dar-build: Added preprocessing scripts
+- dar-update: Improved the handling of updates to update tools
+- dar-build: Experimental usage of /dev/shm for building
 
 Version 0.6.0
 - dar.conf: Removed DISTSMAP, added it to dists specific section

Modified: trunk/tools/dar/Makefile
===================================================================
--- trunk/tools/dar/Makefile	2005-03-08 19:22:25 UTC (rev 2964)
+++ trunk/tools/dar/Makefile	2005-03-08 20:13:38 UTC (rev 2965)
@@ -24,19 +24,20 @@
 	for i in dar.conf $(DIST_SCRIPTS) $(DIST_LIBS); do bash -n $$i || exit 1; done
 
 install:
-	install -m0755 -d $(DESTDIR)$(sysconfdir)/dar/{config,dists} \
+	install -m0755 -d $(DESTDIR)$(sysconfdir)/dar/{dists,scripts} \
 		$(DESTDIR)$(sysconfdir)/logrotate.d \
 		$(DESTDIR)$(datadir)/dar/skel \
 		$(DESTDIR)$(libdir)/dar \
 		$(DESTDIR)$(sbindir)
 	install -m0700 -d $(DESTDIR)$(localstatedir)/log/dar
 
-	install -m0644 dar.conf $(DESTDIR)$(sysconfdir)/dar
+	install -D -m0644 dar.conf $(DESTDIR)$(sysconfdir)/dar/dar.conf
 
 	install -m0755 $(DIST_SCRIPTS) $(DESTDIR)$(sbindir)
 	install -m0755 $(DIST_LIBS) $(DESTDIR)$(libdir)/dar/
 #	install -m0644 dists/*/* $(DESTDIR)$(sysconfdir)/dar/dists/
 	cp -af dists/* $(DESTDIR)$(sysconfdir)/dar/dists/
+	cp -af scripts/* $(DESTDIR)$(sysconfdir)/dar/scripts/
 
 #	install -m0644 skel/* $(DESTDIR)$(datadir)/dar/skel/
 	cp -af skel/* $(DESTDIR)$(datadir)/dar/skel/

Modified: trunk/tools/dar/dar-build
===================================================================
--- trunk/tools/dar/dar-build	2005-03-08 19:22:25 UTC (rev 2964)
+++ trunk/tools/dar/dar-build	2005-03-08 20:13:38 UTC (rev 2965)
@@ -168,8 +168,14 @@
 			done
 
 			rm -f &quot;$NEWSPECFILE&quot;
-			cat &quot;$SPECFILE&quot; | sed -e &quot;s|\(Release: *.\+\)|\1.${DISTTAG// *}.$TAG|&quot; &gt;&quot;$NEWSPECFILE&quot;
+			cp -af &quot;$SPECFILE&quot; &quot;$NEWSPECFILE&quot;
+			export NEWSPECFILE DISTTAG TAG
 
+			for script in $CONFIGDIR/scripts/pre-*.sh; do
+#				echo &quot;Processing $script.&quot;
+				source &quot;$script&quot;
+			done
+
 			### Start logging
 			rm -f &quot;$PACKAGEDIR/$app/$LOGFILE&quot;
 			(	echo &quot;----- Build information -----&quot;
@@ -285,7 +291,7 @@
 				export LD_PRELOAD=&quot;/lib/libsoapbox.so&quot;
 			fi
 
-			BUILDCMD=&quot;/usr/bin/rpmbuild -bb $RPMOPTS \
+			BUILDCMD=&quot;/usr/bin/rpmbuild -bb --clean $RPMOPTS \
 					--define \&quot;_smp_mflags $MAKEFLAGS\&quot; \
 					--define \&quot;_rpmfilename %%{NAME}-%%{VERSION}-%%{RELEASE}.%%{ARCH}.rpm\&quot; \
 					--define \&quot;_initrddir %{_sysconfdir}/rc.d/init.d\&quot; \
@@ -305,7 +311,7 @@
 
 				### Check for building as user
 				if [ $AS_ROOT -eq 1 ]; then
-					$SETARCH chroot &quot;$CHROOTDIR/$dist&quot; /usr/bin/rpmbuild -bb $RPMOPTS \
+					$SETARCH chroot &quot;$CHROOTDIR/$dist&quot; /usr/bin/rpmbuild -bb --clean $RPMOPTS \
 						--define &quot;_smp_mflags $MAKEFLAGS&quot; \
 						--define &quot;_rpmfilename %%{NAME}-%%{VERSION}-%%{RELEASE}.%%{ARCH}.rpm&quot; \
 						--define &quot;_initrddir %{_sysconfdir}/rc.d/init.d&quot; \
@@ -319,7 +325,7 @@
 						--define &quot;$DISTNICK 1&quot; \
 						&quot;$NEWSPECFILE&quot;
 				else
-					$SETARCH chroot &quot;$CHROOTDIR/$dist&quot; /bin/su - -m $BUILD_USER -c &quot;/usr/bin/rpmbuild -bb $RPMOPTS \
+					$SETARCH chroot &quot;$CHROOTDIR/$dist&quot; /bin/su - -m $BUILD_USER -c &quot;/usr/bin/rpmbuild -bb --clean $RPMOPTS \
 						--define '_smp_mflags $MAKEFLAGS' \
 						--define '_rpmfilename %%{NAME}-%%{VERSION}-%%{RELEASE}.%%{ARCH}.rpm' \
 						--define '_initrddir %{_sysconfdir}/rc.d/init.d' \

Modified: trunk/tools/dar/dar-exec
===================================================================
--- trunk/tools/dar/dar-exec	2005-03-08 19:22:25 UTC (rev 2964)
+++ trunk/tools/dar/dar-exec	2005-03-08 20:13:38 UTC (rev 2965)
@@ -21,6 +21,7 @@
 
 	if [ -r &quot;$CONFIGDIR/dists/$distname/config&quot; ]; then
 		source &quot;$CONFIGDIR/dists/$distname/config&quot;
+		export distname DISTNAME DISTNICK DISTTAG DISTPATH DISTARCH
 	fi
 
 	### Check for building as user

Modified: trunk/tools/dar/dar-prepare
===================================================================
--- trunk/tools/dar/dar-prepare	2005-03-08 19:22:25 UTC (rev 2964)
+++ trunk/tools/dar/dar-prepare	2005-03-08 20:13:38 UTC (rev 2965)
@@ -12,11 +12,19 @@
 	if [ &quot;${DEFAULT_DISTS// */}&quot; != $distname ]; then
 		ln -f $CHROOTDIR/${DEFAULT_DISTS// */}/root/.bash_history $CHROOTDIR/$distname/root/.bash_history
 	fi
-	umount $CHROOTDIR/$distname{/dev/pts,/proc,/tmp,$ROOT}/
+
+	umount $CHROOTDIR/$distname{/dev/pts,/proc,/tmp,$ROOT/build,$ROOT}/ 2&gt;/dev/null
+
 	mkdir -p $CHROOTDIR/$distname{/dev/pts,/proc,/tmp,$ROOT}/
 #	rm -rf $CHROOTDIR/$distname{$RPMTMPPATH}/*
-	mount -o bind /tmp/ $CHROOTDIR/$distname/tmp/
 	mount -o bind $ROOT $CHROOTDIR/$distname$ROOT
 	mount -t proc proc $CHROOTDIR/$distname/proc/
 	mount -t devpts devpts $CHROOTDIR/$distname/dev/pts
+
+###	Use this when you want to speed up building :)
+	mount -o bind /dev/shm $CHROOTDIR/$distname$ROOT/build
+
+###	Use thise when using X processes inside chroots
+#	mount -o bind /tmp/ $CHROOTDIR/$distname/tmp/
+
 done

Modified: trunk/tools/dar/dar-shell
===================================================================
--- trunk/tools/dar/dar-shell	2005-03-08 19:22:25 UTC (rev 2964)
+++ trunk/tools/dar/dar-shell	2005-03-08 20:13:38 UTC (rev 2965)
@@ -16,10 +16,6 @@
 set_as_root
 AS_ROOT=1
 
-if [ -z &quot;$DISTS&quot; ]; then
-	DISTS=&quot;$DEFAULT_DISTS&quot;
-fi
-
 echo &quot;Entering shells.&quot;
 for distname in $DISTS; do
 	if [ -r &quot;$CONFIGDIR/dists/$distname/config&quot; ]; then

Modified: trunk/tools/dar/dar-sync
===================================================================
--- trunk/tools/dar/dar-sync	2005-03-08 19:22:25 UTC (rev 2964)
+++ trunk/tools/dar/dar-sync	2005-03-08 20:13:38 UTC (rev 2965)
@@ -30,16 +30,16 @@
 	build_repo_srpms &quot;source&quot;
 fi
 
-for dist in $DISTS; do
-	if [ -r &quot;$CONFIGDIR/dists/$dist/config&quot; ]; then
-		source &quot;$CONFIGDIR/dists/$dist/config&quot;
+for distname in $DISTS; do
+	if [ -r &quot;$CONFIGDIR/dists/$distname/config&quot; ]; then
+		source &quot;$CONFIGDIR/dists/$distname/config&quot;
 	else
-		warning &quot;Configfile $CONFIGDIR/dists/$dist/config missing. Aborting.&quot;
+		warning &quot;Configfile $CONFIGDIR/dists/$distname/config missing. Aborting.&quot;
 		continue
 	fi
 	
 	if [ &quot;$CREATE_REPO&quot; == &quot;true&quot; ]; then
-		echo &quot;Building $dist repository in $DISTPATH.&quot;
+		echo &quot;Building $distname repository in $DISTPATH.&quot;
 		ln -sf ../../../../source $FTPDIR/$DISTPATH/SRPMS.dag
 		if [ &quot;$REPO_APT&quot; == &quot;yes&quot; ]; then
 			build_repo_apt &quot;$DISTTAG&quot; &quot;$DISTPATH&quot;

Modified: trunk/tools/dar/dar-update
===================================================================
--- trunk/tools/dar/dar-update	2005-03-08 19:22:25 UTC (rev 2964)
+++ trunk/tools/dar/dar-update	2005-03-08 20:13:38 UTC (rev 2965)
@@ -12,6 +12,7 @@
 
 ### Update build environment
 for distname in $DISTS; do
+	echo &quot;Updating $distname.&quot;
         if [ -r &quot;$CONFIGDIR/dists/$distname/config&quot; ]; then
                 source &quot;$CONFIGDIR/dists/$distname/config&quot;
         else
@@ -25,23 +26,24 @@
 #		build_repo_yum &quot;$DISTTAG&quot; &quot;$DISTPATH&quot;
 	fi
 
-	echo &quot;Updating $distname.&quot;
 	if [ &quot;$UPDATECMD&quot; ]; then
 		chroot $CHROOTDIR/$distname $UPDATECMD
 	fi
 
-	echo &quot;Upgrading $distname.&quot;
 	if [ &quot;$UPGRADECMD&quot; ]; then
 		chroot $CHROOTDIR/$distname $UPGRADECMD
 	fi
 
-	if [ &quot;$INSTALLCMD&quot; ]; then
-		for pkg in $PKGS; do
-			instcmd=&quot;$(echo $INSTALLCMD | sed -e &quot;s|%p|$pkg|g&quot;)&quot;
-	
-			echo &quot;Installing $pkg in $distname.&quot;
-			chroot $CHROOTDIR/$distname $instcmd
-		done
+	if [ &quot;$INSTALLCMD&quot; -a &quot;$PKGS&quot; ]; then
+		if echo &quot;$INSTALLCMD&quot; | grep -q '%p'; then
+			for pkg in $PKGS; do
+				instcmd=&quot;$(echo $INSTALLCMD | sed -e &quot;s|%p|$pkg|g&quot;)&quot;
+				echo &quot;Installing $pkg in $distname.&quot;
+				chroot $CHROOTDIR/$distname $instcmd
+			done
+		else
+			echo $PKGS | xargs chroot $CHROOTDIR/$distname $INSTALLCMD
+		fi
 	fi
 	echo
 done

Modified: trunk/tools/dar/dar.conf
===================================================================
--- trunk/tools/dar/dar.conf	2005-03-08 19:22:25 UTC (rev 2964)
+++ trunk/tools/dar/dar.conf	2005-03-08 20:13:38 UTC (rev 2965)
@@ -30,6 +30,6 @@
 RSYNC_OPTIONS=&quot;--exclude bert/ --exclude dries/ --exclude redhat/6.2 --exclude redhat/8.0 --delay-renames&quot;
 RSYNC_TARGET=&quot;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at rsync.sw.be</A>:dag.wieers.com/pub/&quot;
 ### Use wondershaper
-RSYNC_LIMIT=&quot;12&quot;
+RSYNC_LIMIT=&quot;18&quot;
 GPG_PATH=&quot;/home/dag/.gnupg&quot;
 GPG_NAME=&quot;Dag Wieers (Dag Apt Repository v1.0)&quot;

Modified: trunk/tools/dar/dists/el2i/config
===================================================================
--- trunk/tools/dar/dists/el2i/config	2005-03-08 19:22:25 UTC (rev 2964)
+++ trunk/tools/dar/dists/el2i/config	2005-03-08 20:13:38 UTC (rev 2965)
@@ -4,11 +4,13 @@
 DISTCC_CC=&quot;i386-redhat-linux-gcc-2.96&quot;
 DISTCC_CXX=&quot;i386-redhat-linux-g++-2.96&quot;
 
-UPDATECMD=&quot;up2date -u&quot;
 #UPDATECMD=&quot;apt-get -qq update&quot;
 #UPGRADECMD=&quot;apt-get -qq -f -y upgrade&quot;
-INSTALLCMD=&quot;up2date -i %p&quot;
 #INSTALLCMD=&quot;apt-get -qq -y -m install %p&quot;
+UPDATECMD=&quot;up2date -u&quot;
+INSTALLCMD=&quot;up2date -if&quot;
+#UPDATECMD=&quot;yum update&quot;
+#INSTALLCMD=&quot;yum install %p&quot;
 
 DISTNAME=&quot;el2&quot;
 DISTNICK=&quot;el2i&quot;

Modified: trunk/tools/dar/dists/el3a/config
===================================================================
--- trunk/tools/dar/dists/el3a/config	2005-03-08 19:22:25 UTC (rev 2964)
+++ trunk/tools/dar/dists/el3a/config	2005-03-08 20:13:38 UTC (rev 2965)
@@ -4,11 +4,13 @@
 DISTCC_CC=&quot;x86_64-redhat-linux-gcc-3.2.3&quot;
 DISTCC_CXX=&quot;x86_64-redhat-linux-g++-3.2.3&quot;
 
-UPDATECMD=&quot;up2date -u&quot;
 #UPDATECMD=&quot;apt-get -qq update&quot;
 #UPGRADECMD=&quot;apt-get -qq -f -y upgrade&quot;
-INSTALLCMD=&quot;up2date -i %p&quot;
 #INSTALLCMD=&quot;apt-get -qq -y -m install %p&quot;
+UPDATECMD=&quot;up2date -u&quot;
+INSTALLCMD=&quot;up2date -if&quot;
+#UPDATECMD=&quot;yum update&quot;
+#INSTALLCMD=&quot;yum install %p&quot;
 
 DISTNAME=&quot;el3&quot;
 DISTNICK=&quot;el3a&quot;

Modified: trunk/tools/dar/dists/el3i/config
===================================================================
--- trunk/tools/dar/dists/el3i/config	2005-03-08 19:22:25 UTC (rev 2964)
+++ trunk/tools/dar/dists/el3i/config	2005-03-08 20:13:38 UTC (rev 2965)
@@ -4,11 +4,13 @@
 DISTCC_CC=&quot;i386-redhat-linux-gcc-3.2.3&quot;
 DISTCC_CXX=&quot;i386-redhat-linux-g++-3.2.3&quot;
 
-UPDATECMD=&quot;up2date -u&quot;
 #UPDATECMD=&quot;apt-get -qq update&quot;
 #UPGRADECMD=&quot;apt-get -qq -f -y upgrade&quot;
-INSTALLCMD=&quot;up2date -i %p&quot;
 #INSTALLCMD=&quot;apt-get -qq -y -m install %p&quot;
+UPDATECMD=&quot;up2date -u&quot;
+INSTALLCMD=&quot;up2date -if&quot;
+#UPDATECMD=&quot;yum update&quot;
+#INSTALLCMD=&quot;yum install %p&quot;
 
 DISTNAME=&quot;el3&quot;
 DISTNICK=&quot;el3i&quot;

Modified: trunk/tools/dar/dists/el4a/config
===================================================================
--- trunk/tools/dar/dists/el4a/config	2005-03-08 19:22:25 UTC (rev 2964)
+++ trunk/tools/dar/dists/el4a/config	2005-03-08 20:13:38 UTC (rev 2965)
@@ -4,11 +4,13 @@
 DISTCC_CC=&quot;x86_64-redhat-linux-gcc-3.4.3&quot;
 DISTCC_CXX=&quot;x86_64-redhat-linux-g++-3.4.3&quot;
 
-UPDATECMD=&quot;up2date -u&quot;
 #UPDATECMD=&quot;apt-get -qq update&quot;
 #UPGRADECMD=&quot;apt-get -qq -f -y upgrade&quot;
-INSTALLCMD=&quot;up2date -i %p&quot;
 #INSTALLCMD=&quot;apt-get -qq -y -m install %p&quot;
+UPDATECMD=&quot;up2date -u&quot;
+INSTALLCMD=&quot;up2date -if&quot;
+#UPDATECMD=&quot;yum update&quot;
+#INSTALLCMD=&quot;yum install %p&quot;
 
 DISTNAME=&quot;el4&quot;
 DISTNICK=&quot;el4a&quot;

Modified: trunk/tools/dar/dists/el4i/config
===================================================================
--- trunk/tools/dar/dists/el4i/config	2005-03-08 19:22:25 UTC (rev 2964)
+++ trunk/tools/dar/dists/el4i/config	2005-03-08 20:13:38 UTC (rev 2965)
@@ -4,11 +4,13 @@
 DISTCC_CC=&quot;i386-redhat-linux-gcc-3.4.3&quot;
 DISTCC_CXX=&quot;i386-redhat-linux-g++-3.4.3&quot;
 
-UPDATECMD=&quot;up2date -u&quot;
 #UPDATECMD=&quot;apt-get -qq update&quot;
 #UPGRADECMD=&quot;apt-get -qq -f -y upgrade&quot;
-INSTALLCMD=&quot;up2date -i %p&quot;
 #INSTALLCMD=&quot;apt-get -qq -y -m install %p&quot;
+UPDATECMD=&quot;up2date -u&quot;
+INSTALLCMD=&quot;up2date -if&quot;
+#UPDATECMD=&quot;yum update&quot;
+#INSTALLCMD=&quot;yum install %p&quot;
 
 DISTNAME=&quot;el4&quot;
 DISTNICK=&quot;el4i&quot;

Modified: trunk/tools/dar/dists/fc1i/config
===================================================================
--- trunk/tools/dar/dists/fc1i/config	2005-03-08 19:22:25 UTC (rev 2964)
+++ trunk/tools/dar/dists/fc1i/config	2005-03-08 20:13:38 UTC (rev 2965)
@@ -7,6 +7,10 @@
 UPDATECMD=&quot;apt-get -qq update&quot;
 UPGRADECMD=&quot;apt-get -qq -f -y upgrade&quot;
 INSTALLCMD=&quot;apt-get -qq -y -m install %p&quot;
+#UPDATECMD=&quot;up2date -u&quot;
+#INSTALLCMD=&quot;up2date -if&quot;
+#UPDATECMD=&quot;yum update&quot;
+#INSTALLCMD=&quot;yum install %p&quot;
 
 DISTNAME=&quot;fc1&quot;
 DISTNICK=&quot;fc1i&quot;

Modified: trunk/tools/dar/dists/fc2a/config
===================================================================
--- trunk/tools/dar/dists/fc2a/config	2005-03-08 19:22:25 UTC (rev 2964)
+++ trunk/tools/dar/dists/fc2a/config	2005-03-08 20:13:38 UTC (rev 2965)
@@ -1,14 +1,16 @@
 ### RED HAT FEDORA CORE 2
 
 ### Distcc compilers
-#DISTCC_CC=&quot;i386-redhat-linux-gcc-3.3.3&quot;
-#DISTCC_CXX=&quot;i386-redhat-linux-g++-3.3.3&quot;
+DISTCC_CC=&quot;x86_64-redhat-linux-gcc-3.3.3&quot;
+DISTCC_CXX=&quot;x86_64-redhat-linux-g++-3.3.3&quot;
 
-#UPDATECMD=&quot;yum update&quot;
 UPDATECMD=&quot;apt-get -qq update&quot;
 UPGRADECMD=&quot;apt-get -qq -f -y upgrade&quot;
+INSTALLCMD=&quot;apt-get -qq -y -m install %p&quot;
+#UPDATECMD=&quot;up2date -u&quot;
+#INSTALLCMD=&quot;up2date -if&quot;
+#UPDATECMD=&quot;yum update&quot;
 #INSTALLCMD=&quot;yum install %p&quot;
-INSTALLCMD=&quot;apt-get -qq -y -m install %p&quot;
 
 DISTNAME=&quot;fc2&quot;
 DISTNICK=&quot;fc2a&quot;

Modified: trunk/tools/dar/dists/fc2i/config
===================================================================
--- trunk/tools/dar/dists/fc2i/config	2005-03-08 19:22:25 UTC (rev 2964)
+++ trunk/tools/dar/dists/fc2i/config	2005-03-08 20:13:38 UTC (rev 2965)
@@ -7,6 +7,10 @@
 UPDATECMD=&quot;apt-get -qq update&quot;
 UPGRADECMD=&quot;apt-get -qq -f -y upgrade&quot;
 INSTALLCMD=&quot;apt-get -qq -y -m install %p&quot;
+#UPDATECMD=&quot;up2date -u&quot;
+#INSTALLCMD=&quot;up2date -if&quot;
+#UPDATECMD=&quot;yum update&quot;
+#INSTALLCMD=&quot;yum install %p&quot;
 
 DISTNAME=&quot;fc2&quot;
 DISTNICK=&quot;fc2i&quot;

Modified: trunk/tools/dar/dists/fc3a/config
===================================================================
--- trunk/tools/dar/dists/fc3a/config	2005-03-08 19:22:25 UTC (rev 2964)
+++ trunk/tools/dar/dists/fc3a/config	2005-03-08 20:13:38 UTC (rev 2965)
@@ -1,14 +1,16 @@
 ### RED HAT FEDORA CORE 3
 
 ### Distcc compilers
-#DISTCC_CC=&quot;i386-redhat-linux-gcc-3.3.3&quot;
-#DISTCC_CXX=&quot;i386-redhat-linux-g++-3.3.3&quot;
+DISTCC_CC=&quot;x86_64-redhat-linux-gcc-3.3.3&quot;
+DISTCC_CXX=&quot;x86_64-redhat-linux-g++-3.3.3&quot;
 
-#UPDATECMD=&quot;yum -y update&quot;
 UPDATECMD=&quot;apt-get -qq update&quot;
 UPGRADECMD=&quot;apt-get -qq -f -y upgrade&quot;
-#INSTALLCMD=&quot;yum -y install %p.x86_64&quot;
 INSTALLCMD=&quot;apt-get -qq -y -m install %p&quot;
+#UPDATECMD=&quot;up2date -u&quot;
+#INSTALLCMD=&quot;up2date -if&quot;
+#UPDATECMD=&quot;yum update&quot;
+#INSTALLCMD=&quot;yum install %p&quot;
 
 DISTNAME=&quot;fc3&quot;
 DISTNICK=&quot;fc3a&quot;

Modified: trunk/tools/dar/dists/fc3i/config
===================================================================
--- trunk/tools/dar/dists/fc3i/config	2005-03-08 19:22:25 UTC (rev 2964)
+++ trunk/tools/dar/dists/fc3i/config	2005-03-08 20:13:38 UTC (rev 2965)
@@ -7,6 +7,10 @@
 UPDATECMD=&quot;apt-get -qq update&quot;
 UPGRADECMD=&quot;apt-get -qq -f -y upgrade&quot;
 INSTALLCMD=&quot;apt-get -qq -y -m install %p&quot;
+#UPDATECMD=&quot;up2date -u&quot;
+#INSTALLCMD=&quot;up2date -if&quot;
+#UPDATECMD=&quot;yum update&quot;
+#INSTALLCMD=&quot;yum install %p&quot;
 
 DISTNAME=&quot;fc3&quot;
 DISTNICK=&quot;fc3i&quot;

Modified: trunk/tools/dar/dists/nodist/config
===================================================================
--- trunk/tools/dar/dists/nodist/config	2005-03-08 19:22:25 UTC (rev 2964)
+++ trunk/tools/dar/dists/nodist/config	2005-03-08 20:13:38 UTC (rev 2965)
@@ -7,6 +7,10 @@
 #UPDATECMD=&quot;apt-get -qq update&quot;
 #UPGRADECMD=&quot;apt-get -qq -f -y upgrade&quot;
 #INSTALLCMD=&quot;apt-get -qq -y -m install %p&quot;
+#UPDATECMD=&quot;up2date -u&quot;
+#INSTALLCMD=&quot;up2date -if&quot;
+#UPDATECMD=&quot;yum update&quot;
+#INSTALLCMD=&quot;yum install %p&quot;
 
 DISTNAME=&quot;nodist&quot;
 DISTNICK=&quot;nodist&quot;

Modified: trunk/tools/dar/dists/rh6i/config
===================================================================
--- trunk/tools/dar/dists/rh6i/config	2005-03-08 19:22:25 UTC (rev 2964)
+++ trunk/tools/dar/dists/rh6i/config	2005-03-08 20:13:38 UTC (rev 2965)
@@ -7,6 +7,10 @@
 UPDATECMD=&quot;apt-get -qq update&quot;
 UPGRADECMD=&quot;apt-get -qq -f -y upgrade&quot;
 INSTALLCMD=&quot;apt-get -qq -y -m install %p&quot;
+#UPDATECMD=&quot;up2date -u&quot;
+#INSTALLCMD=&quot;up2date -if&quot;
+#UPDATECMD=&quot;yum update&quot;
+#INSTALLCMD=&quot;yum install %p&quot;
 
 DISTNAME=&quot;rh6&quot;
 DISTNICK=&quot;rh6i&quot;

Modified: trunk/tools/dar/dists/rh7i/config
===================================================================
--- trunk/tools/dar/dists/rh7i/config	2005-03-08 19:22:25 UTC (rev 2964)
+++ trunk/tools/dar/dists/rh7i/config	2005-03-08 20:13:38 UTC (rev 2965)
@@ -7,6 +7,10 @@
 UPDATECMD=&quot;apt-get -qq update&quot;
 UPGRADECMD=&quot;apt-get -qq -f -y upgrade&quot;
 INSTALLCMD=&quot;apt-get -qq -y -m install %p&quot;
+#UPDATECMD=&quot;up2date -u&quot;
+#INSTALLCMD=&quot;up2date -if&quot;
+#UPDATECMD=&quot;yum update&quot;
+#INSTALLCMD=&quot;yum install %p&quot;
 
 DISTNAME=&quot;rh7&quot;
 DISTNICK=&quot;rh7i&quot;

Modified: trunk/tools/dar/dists/rh8i/config
===================================================================
--- trunk/tools/dar/dists/rh8i/config	2005-03-08 19:22:25 UTC (rev 2964)
+++ trunk/tools/dar/dists/rh8i/config	2005-03-08 20:13:38 UTC (rev 2965)
@@ -7,6 +7,10 @@
 UPDATECMD=&quot;apt-get -qq update&quot;
 UPGRADECMD=&quot;apt-get -qq -f -y upgrade&quot;
 INSTALLCMD=&quot;apt-get -qq -y -m install %p&quot;
+#UPDATECMD=&quot;up2date -u&quot;
+#INSTALLCMD=&quot;up2date -if&quot;
+#UPDATECMD=&quot;yum update&quot;
+#INSTALLCMD=&quot;yum install %p&quot;
 
 DISTNAME=&quot;rh8&quot;
 DISTNICK=&quot;rh8i&quot;

Modified: trunk/tools/dar/dists/rh9i/config
===================================================================
--- trunk/tools/dar/dists/rh9i/config	2005-03-08 19:22:25 UTC (rev 2964)
+++ trunk/tools/dar/dists/rh9i/config	2005-03-08 20:13:38 UTC (rev 2965)
@@ -7,6 +7,10 @@
 UPDATECMD=&quot;apt-get -qq update&quot;
 UPGRADECMD=&quot;apt-get -qq -f -y upgrade&quot;
 INSTALLCMD=&quot;apt-get -qq -y -m install %p&quot;
+#UPDATECMD=&quot;up2date -u&quot;
+#INSTALLCMD=&quot;up2date -if&quot;
+#UPDATECMD=&quot;yum update&quot;
+#INSTALLCMD=&quot;yum install %p&quot;
 
 DISTNAME=&quot;rh9&quot;
 DISTNICK=&quot;rh9i&quot;

Added: trunk/tools/dar/scripts/pre-brand.sh
===================================================================
--- trunk/tools/dar/scripts/pre-brand.sh	2005-03-08 19:22:25 UTC (rev 2964)
+++ trunk/tools/dar/scripts/pre-brand.sh	2005-03-08 20:13:38 UTC (rev 2965)
@@ -0,0 +1,25 @@
+#!/bin/bash
+
+#echo &quot;Specfile: $NEWSPECFILE&quot;
+#set -x
+
+AUTHOR=&quot;$(grep '^# Authority: ' $NEWSPECFILE | sed -e 's|^# Authority: ||')&quot;
+
+case &quot;$AUTHOR&quot; in
+	(dries)
+		PACKAGER=&quot;Dries Verachtert &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dries at ulyssis.org</A>&gt;&quot;
+		;;
+	(bert)
+		PACKAGER=&quot;Bert de Bruijn &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">bert at debruijn.be</A>&gt;&quot;;;
+		
+	(dag|thias|*)
+		PACKAGER=&quot;Dag Wieers &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>&gt;&quot;
+		;;
+esac
+
+VENDOR=&quot;Dag Apt Repository, <A HREF="http://dag.wieers.com/apt/">http://dag.wieers.com/apt/</A>&quot;
+
+perl -pi.orig -e 's|^(Source:.+)$|Packager: '&quot;$PACKAGER&quot;'\nVendor: '&quot;$VENDOR&quot;'\n\n$1|' &quot;$NEWSPECFILE&quot;
+
+#set +x
+#diff -u &quot;$NEWSPECFILE&quot;.orig &quot;$NEWSPECFILE&quot;

Added: trunk/tools/dar/scripts/pre-disttag.sh
===================================================================
--- trunk/tools/dar/scripts/pre-disttag.sh	2005-03-08 19:22:25 UTC (rev 2964)
+++ trunk/tools/dar/scripts/pre-disttag.sh	2005-03-08 20:13:38 UTC (rev 2965)
@@ -0,0 +1,18 @@
+#!/bin/bash
+
+#set -x
+
+### Processing disttag variable
+DISTTAG=&quot;${DISTTAG// *}&quot;
+
+#echo &quot;Specfile: $NEWSPECFILE&quot;
+#echo &quot;Disttag: $DISTTAG&quot;
+#echo &quot;Tag: $TAG&quot;
+
+### Originally in dar-build
+#cat &quot;$SPECFILE&quot; | sed -e &quot;s|\(Release: *.\+\)|\1.${DISTTAG// *}.$TAG|&quot; &gt;&quot;$NEWSPECFILE&quot;
+
+perl -pi.orig -e 's|^(Release)\s*:\s+(.+)\s*$|$1: '$DISTTAG'.'$TAG'\n|' &quot;$NEWSPECFILE&quot;
+
+#diff -u &quot;$NEWSPECFILE&quot;.orig &quot;$NEWSPECFILE&quot;
+#set +x

Added: trunk/tools/dar/scripts/pre-stub.sh
===================================================================
--- trunk/tools/dar/scripts/pre-stub.sh	2005-03-08 19:22:25 UTC (rev 2964)
+++ trunk/tools/dar/scripts/pre-stub.sh	2005-03-08 20:13:38 UTC (rev 2965)
@@ -0,0 +1,3 @@
+#!/bin/bash
+
+#set -x


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001765.html">[SVN] r2964 - in trunk/rpms: PyKDE perl-Business-ISBN perl-Business-ISBN-Data perl-CGI-Untaint perl-CPAN-DistnameInfo perl-CPANPLUS perl-CSS-Tiny perl-Carp-Assert perl-Carp-Clan perl-Chart perl-Chart-Strip perl-Chemistry-File-MDLMol perl-Chemistry-Mol perl-Class-Autouse perl-Class-Hook perl-Class-Inspector perl-Class-MethodMaker perl-Class-Singleton perl-Class-XPath perl-Clone perl-Compress-Zlib perl-Config-General perl-Config-IniFiles perl-Config-Record perl-Config-Tiny perl-Convert-ASN1 perl-Convert-BER perl-Convert-BinHex perl-Convert-IBM390 perl-Convert-TNEF perl-Convert-UUlib perl-Crypt-CAST5 perl-Crypt-CapnMidNite perl-Crypt-DES perl-Crypt-Enigma perl-Crypt-License perl-Crypt-OpenSSL-Bignum perl-Crypt-OpenSSL-DSA perl-Crypt-OpenSSL-RSA perl-Crypt-RC6 perl-Crypt-Rijndael perl-Crypt-Serpent perl-Crypt-SmbHash perl-Crypt-Tea perl-Crypt-Twofish2 perl-Crypt-Vigenere perl-Curses perl-Cwd perl-DBD-CSV perl-DBD-File perl-DNS-BL perl-Data-Dump perl-Data-DumpXML perl-Da! ta-ShowTable perl-Data-UUID perl-Date-Pcalc perl-DateTime perl-DateTime-Calendar-Christian perl-DateTime-Calendar-Julian perl-DateTime-Event-Chinese perl-DateTime-Event-Cron perl-DateTime-Event-Easter perl-DateTime-Event-ICal perl-DateTime-Event-Lunar perl-DateTime-Event-NameDay perl-DateTime-Event-Random perl-DateTime-Event-Recurrence perl-DateTime-Event-SolarTerm perl-DateTime-Event-Sunrise perl-DateTime-Locale perl-DateTime-Set perl-DateTime-TimeZone perl-DateTime-Util-Astro perl-DateTime-Util-Calc perl-Devel-Trace perl-Device-SerialPorts perl-Digest-BubbleBabble perl-Digest-HMAC perl-Digest-MD2 perl-Digest-MD5-M4p perl-Digest-Nilsimsa perl-Digest-SHA1 perl-Email-Address perl-Email-MIME perl-Email-MIME-Attachment-Stripper perl-Email-MIME-ContentType perl-Email-MIME-Encodings perl-Email-MIME-Modifier perl-Email-MessageID perl-Email-Valid perl-Env-Bash perl-Expect perl-ExtUtils-AutoInstall perl-ExtUtils-CBuilder perl-ExtUtils-Depends perl-ExtUtils-ParseXS perl-ExtUtils-Per! lPP perl-ExtUtils-PkgConfig perl-FCGI perl-File-Find-Rule perl! -File-Fi
</A></li>
	<LI>Next message: <A HREF="001767.html">[SVN] r2966 - in trunk/tools/dar: . scripts
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1766">[ date ]</a>
              <a href="thread.html#1766">[ thread ]</a>
              <a href="subject.html#1766">[ subject ]</a>
              <a href="author.html#1766">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.repoforge.org/mailman/listinfo/commits">More information about the commits
mailing list</a><br>
</body></html>
