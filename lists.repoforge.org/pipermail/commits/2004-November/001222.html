<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [SVN] r2416 - in trunk/rpms: . aide amavisd-new clamav dconf dstat	gdesklets-goodweather kdissert lftp libgda memtest86+	perl-Kwiki php-adodb rootsh s4g snackamp tnftp vpnc whowatch xosview
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:commits%40lists.repoforge.org?Subject=Re:%20Re%3A%20%5BSVN%5D%20r2416%20-%20in%20trunk/rpms%3A%20.%20aide%20amavisd-new%20clamav%20dconf%20dstat%0A%09gdesklets-goodweather%20kdissert%20lftp%20libgda%20memtest86%2B%0A%09perl-Kwiki%20php-adodb%20rootsh%20s4g%20snackamp%20tnftp%20vpnc%20whowatch%20xosview&In-Reply-To=%3C20041105000755.D011B17F74%40web22.us.megagiga.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001221.html">
   <LINK REL="Next"  HREF="001223.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[SVN] r2416 - in trunk/rpms: . aide amavisd-new clamav dconf dstat	gdesklets-goodweather kdissert lftp libgda memtest86+	perl-Kwiki php-adodb rootsh s4g snackamp tnftp vpnc whowatch xosview</H1>
    <B>svn-commits at rpmforge.net</B> 
    <A HREF="mailto:commits%40lists.repoforge.org?Subject=Re:%20Re%3A%20%5BSVN%5D%20r2416%20-%20in%20trunk/rpms%3A%20.%20aide%20amavisd-new%20clamav%20dconf%20dstat%0A%09gdesklets-goodweather%20kdissert%20lftp%20libgda%20memtest86%2B%0A%09perl-Kwiki%20php-adodb%20rootsh%20s4g%20snackamp%20tnftp%20vpnc%20whowatch%20xosview&In-Reply-To=%3C20041105000755.D011B17F74%40web22.us.megagiga.com%3E"
       TITLE="[SVN] r2416 - in trunk/rpms: . aide amavisd-new clamav dconf dstat	gdesklets-goodweather kdissert lftp libgda memtest86+	perl-Kwiki php-adodb rootsh s4g snackamp tnftp vpnc whowatch xosview">svn-commits at rpmforge.net
       </A><BR>
    <I>Fri Nov  5 01:07:55 CET 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="001221.html">[SVN] r2415 - in trunk/rpms: . Gtk-Perl armagetron-moviepack faad2	gkrellm-plugins libebml libfame libmatroska libmpeg3 ogle	ogle_gui perl-Cache-Cache perl-Video-DVDRip perl-libintl	transcode videolan-client
</A></li>
        <LI>Next message: <A HREF="001223.html">[SVN] r2417 - in trunk/rpms: . dnotify
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1222">[ date ]</a>
              <a href="thread.html#1222">[ thread ]</a>
              <a href="subject.html#1222">[ subject ]</a>
              <a href="author.html#1222">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: dag
Date: 2004-11-05 01:07:53 +0100 (Fri, 05 Nov 2004)
New Revision: 2416

Added:
   trunk/rpms/aide/
   trunk/rpms/aide/README.quickstart
   trunk/rpms/aide/aide-useless-includes.patch
   trunk/rpms/aide/aide.conf
   trunk/rpms/aide/aide.spec
   trunk/rpms/dconf/
   trunk/rpms/dconf/dconf.spec
   trunk/rpms/dstat/
   trunk/rpms/dstat/dstat.spec
   trunk/rpms/perl-Kwiki/
   trunk/rpms/perl-Kwiki/mp2-fix.patch
   trunk/rpms/perl-Kwiki/perl-Kwiki.spec
   trunk/rpms/perl-Kwiki/relative-link.patch
   trunk/rpms/rootsh/
   trunk/rpms/rootsh/rootsh.spec
   trunk/rpms/s4g/
   trunk/rpms/s4g/s4g.spec
   trunk/rpms/tnftp/
   trunk/rpms/tnftp/tnftp.spec
   trunk/rpms/vpnc/
   trunk/rpms/vpnc/vpnc.conf
   trunk/rpms/vpnc/vpnc.spec
   trunk/rpms/whowatch/
   trunk/rpms/whowatch/whowatch.spec
   trunk/rpms/xosview/
   trunk/rpms/xosview/xosview-1.8.0-gcc33.patch
   trunk/rpms/xosview/xosview-1.8.0-kernel26.patch
   trunk/rpms/xosview/xosview-1.8.0-nfs.patch
   trunk/rpms/xosview/xosview-1.8.0-proc.patch
   trunk/rpms/xosview/xosview-1.8.0-procstat.patch
   trunk/rpms/xosview/xosview-1.8.0-rpath.patch
   trunk/rpms/xosview/xosview-1.8.0-s390.patch
   trunk/rpms/xosview/xosview-1.8.0-strip.patch
   trunk/rpms/xosview/xosview-non-i386.patch
   trunk/rpms/xosview/xosview-ppc.patch
   trunk/rpms/xosview/xosview.png
   trunk/rpms/xosview/xosview.spec
Modified:
   trunk/rpms/amavisd-new/amavisd-new.spec
   trunk/rpms/clamav/clamav.spec
   trunk/rpms/gdesklets-goodweather/gdesklets-goodweather.spec
   trunk/rpms/kdissert/kdissert.spec
   trunk/rpms/lftp/lftp.spec
   trunk/rpms/libgda/libgda.spec
   trunk/rpms/memtest86+/memtest86+.spec
   trunk/rpms/php-adodb/php-adodb.spec
   trunk/rpms/snackamp/snackamp-fdw.spec
Log:
Initial packages.
Updated to new release.


Added: trunk/rpms/aide/README.quickstart
===================================================================
--- trunk/rpms/aide/README.quickstart	2004-11-04 19:58:52 UTC (rev 2415)
+++ trunk/rpms/aide/README.quickstart	2004-11-05 00:07:53 UTC (rev 2416)
@@ -0,0 +1,40 @@
+1) Customize /etc/aide.conf to your liking. In particular, add
+   important directories and files which you would like to be
+   covered by integrity checks. Avoid files which are expected
+   to change frequently or which don't affect the safety of your
+   system.
+
+2) Run &quot;/usr/sbin/aide --init&quot; to build the initial database.
+   With the default setup, that creates /var/lib/aide/aide.db.new.gz
+
+3) Store /etc/aide.conf, /usr/sbin/aide and /var/lib/aide/aide.db.new.gz
+   in a secure location, e.g. on separate read-only media (such as
+   CD-ROM). Alternatively, keep MD5 fingerprints or GPG signatures
+   of those files in a secure location, so you have means to verify
+   that nobody modified those files.
+
+4) Copy /var/lib/aide/aide.db.new.gz to /var/lib/aide/aide.db.gz
+   which is the location of the input database.
+
+5) Run &quot;/usr/sbin/aide --check&quot; to check your system for inconsistencies
+   compared with the AIDE database. Prior to running a check manually,
+   ensure that the AIDE binary and database have not been modified
+   without your knowledge.
+   
+   Caution! 
+   
+   With the default setup, an AIDE check is not run periodically as a
+   cron job. It cannot be guaranteed that the AIDE binaries, config
+   file and database are intact. It is not recommended that you run
+   automated AIDE checks without verifying AIDE yourself frequently.
+   In addition to that, AIDE does not implement any password or
+   encryption protection for its own files.
+   
+   It is up to you how to put a file integrity checker to good effect
+   and how to set up automated checks if you think it adds a level of
+   safety (e.g. detecting failed/incomplete compromises or unauthorized
+   modification of special files). On a compromised system, the
+   intruder could disable the automated check. Or he could replace the
+   AIDE binary, config file and database easily when they are not
+   located on read-only media. 
+

Added: trunk/rpms/aide/aide-useless-includes.patch
===================================================================
--- trunk/rpms/aide/aide-useless-includes.patch	2004-11-04 19:58:52 UTC (rev 2415)
+++ trunk/rpms/aide/aide-useless-includes.patch	2004-11-05 00:07:53 UTC (rev 2416)
@@ -0,0 +1,11 @@
+--- aide-0.9/src/Makefile.in.orig	2002-06-06 11:08:32.000000000 +0200
++++ aide-0.9/src/Makefile.in	2002-06-06 11:08:48.000000000 +0200
+@@ -98,7 +98,7 @@
+ aide_SOURCES =  		conf_yacc.y			conf_lex.l			getopt.c			getopt1.c			gnu_regex.c			error.c				md.c				db.c				commandconf.c			db_file.c			db_disk.c			db_lex.l			db_sql.c			gen_list.c			list.c				do_md.c				base64.c			symboltable.c			compare_db.c			be.c				util.c				aide.c
+ 
+ 
+-INCLUDES = -I$(prefix)/include -I$(top_srcdir)/include
++INCLUDES = -I$(top_srcdir)/include
+ 
+ LDADD = @CRYPTLIB@ @ACLLIB@
+ 

Added: trunk/rpms/aide/aide.conf
===================================================================
--- trunk/rpms/aide/aide.conf	2004-11-04 19:58:52 UTC (rev 2415)
+++ trunk/rpms/aide/aide.conf	2004-11-05 00:07:53 UTC (rev 2416)
@@ -0,0 +1,84 @@
+# Example configuration file for AIDE.
+
+@@define DBDIR /var/lib/aide
+
+# The location of the database to be read.
+database=file:@@{DBDIR}/aide.db.gz
+
+# The location of the database to be written.
+#database_out=sql:host:port:database:login_name:passwd:table
+#database_out=file:aide.db.new
+database_out=file:@@{DBDIR}/aide.db.new.gz
+
+# Whether to gzip the output to database
+gzip_dbout=yes
+
+# Default.
+verbose=5
+
+report_url=file:/var/log/aide.log
+report_url=stdout
+#report_url=stderr
+#NOT IMPLEMENTED report_url=mailto:<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">root at foo.com</A>
+#NOT IMPLEMENTED report_url=syslog:LOG_AUTH
+
+# These are the default rules.
+#
+#p:      permissions
+#i:      inode:
+#n:      number of links
+#u:      user
+#g:      group
+#s:      size
+#b:      block count
+#m:      mtime
+#a:      atime
+#c:      ctime
+#S:      check for growing size
+#md5:    md5 checksum
+#sha1:   sha1 checksum
+#rmd160: rmd160 checksum
+#tiger:  tiger checksum
+#haval:  haval checksum
+#gost:   gost checksum
+#crc32:  crc32 checksum
+#R:      p+i+n+u+g+s+m+c+md5
+#L:      p+i+n+u+g
+#E:      Empty group
+#&gt;:      Growing logfile p+u+g+i+n+S
+
+# You can create custom rules like this.
+
+NORMAL = R+b+sha1
+
+DIR = p+i+n+u+g
+
+# Next decide what directories/files you want in the database.
+
+/boot   NORMAL
+/bin    NORMAL
+/sbin   NORMAL
+/lib    NORMAL
+/opt    NORMAL
+/usr    NORMAL
+/root   NORMAL
+
+# Check only permissions, inode, user and group for /etc, but
+# cover some important files closely.
+/etc    p+i+u+g
+!/etc/mtab
+/etc/exports  NORMAL
+/etc/fstab    NORMAL
+/etc/passwd   NORMAL
+/etc/group    NORMAL
+/etc/gshadow  NORMAL
+/etc/shadow   NORMAL
+
+/var/log   p+n+u+g
+
+# With AIDE's default verbosity level of 5, these would give lots of
+# warnings upon tree traversal. It might change with future version.
+#
+#=/lost\+found    DIR
+#=/home           DIR
+

Added: trunk/rpms/aide/aide.spec
===================================================================
--- trunk/rpms/aide/aide.spec	2004-11-04 19:58:52 UTC (rev 2415)
+++ trunk/rpms/aide/aide.spec	2004-11-05 00:07:53 UTC (rev 2416)
@@ -0,0 +1,78 @@
+# $Id$
+# Authority: dag
+
+Summary: Advanced intrusion detection environment
+Name: aide
+Version: 0.10
+Release: 1
+License: GPL
+Group: Applications/System
+URL: <A HREF="http://www.cs.tut.fi/~rammer/aide.html">http://www.cs.tut.fi/~rammer/aide.html</A>
+
+Packager: Dag Wieers &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>&gt;
+Vendor: Dag Apt Repository, <A HREF="http://dag.wieers.com/apt/">http://dag.wieers.com/apt/</A>
+
+Source: <A HREF="http://dl.sf.net/aide/aide-%{version">http://dl.sf.net/aide/aide-%{version</A>}.tar.gz
+Source1: aide.conf
+Source2: README.quickstart
+Patch1: aide-useless-includes.patch
+Buildroot: %{_tmppath}/%{name}-%{version}-%{release}-root
+Buildrequires: flex, bison, m4
+Buildrequires: mhash-devel, zlib-devel
+
+### Postgresql support doesn't build.
+#Buildconflicts: postgresql-devel
+
+%description 
+AIDE (Advanced Intrusion Detection Environment) is a file integrity
+checker and intrusion detection program.
+
+%prep
+%setup
+%patch1 -p1
+
+%{__perl} -pi.orig -e 's|^C(PP)?FLAGS=.+$||' configure
+%{__perl} -pi.orig -e 's|%{_sysconfdir}/aide.db|%{_localstatedir}/lib/aide.db|' config.h
+%{__perl} -pi.orig -e 's|&lt;prefix&gt;/etc/aide.db|%{_localstatedir}/lib/aide.db|' doc/aide.1
+%{__perl} -pi.orig -e 's|&lt;prefix&gt;/etc/aide.conf|%{_sysconfdir}/aide.conf|' doc/aide.1
+
+%build
+%configure \
+	--with-config_file=&quot;%{_sysconfdir}/aide.conf&quot; \
+	--with-zlib \
+	--with-mhash \
+	--enable-mhash 
+%{__make} %{?_smp_mflags}
+
+%install
+%{__rm} -rf %{buildroot}
+%makeinstall \
+	bindir=&quot;%{buildroot}%{_sbindir}&quot;
+%{__install} -D -m0600 %{SOURCE1} %{buildroot}%{_sysconfdir}/aide.conf
+%{__install} -d -m0755 %{buildroot}%{_localstatedir}/lib/aide/
+
+%{__install} -m0644 %{SOURCE2} README.quickstart
+%{__install} -D -m0644 doc/aide.1.ru %{buildroot}%{_mandir}/ru/man1/aide.1
+%{__install} -D -m0644 doc/aide.conf.5.ru %{buildroot}%{_mandir}/ru/man5/aide.conf.5
+
+%clean
+%{__rm} -rf %{buildroot}
+
+%files
+%defattr(-, root, root, 0755)
+%doc AUTHORS ChangeLog COPYING NEWS README* ./doc/manual.html
+%doc %{_mandir}/man?/aide.*
+%doc %lang(ru) %{_mandir}/ru/man?/aide.*
+
+%defattr(0600, root, root, 0755)
+%config(noreplace) %{_sysconfdir}/aide.conf
+
+%defattr(0700, root, root, 0755)
+%{_sbindir}/aide
+
+%defattr(0700, root, root, 0700)
+%{_localstatedir}/lib/aide/
+
+%changelog
+* Thu Oct 07 2004 Dag Wieers &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>&gt; - 0.10-1
+- Initial package. (using DAR)


Property changes on: trunk/rpms/aide/aide.spec
___________________________________________________________________
Name: svn:keywords
   + Id
Name: svn:eol-style
   + native

Modified: trunk/rpms/amavisd-new/amavisd-new.spec
===================================================================
--- trunk/rpms/amavisd-new/amavisd-new.spec	2004-11-04 19:58:52 UTC (rev 2415)
+++ trunk/rpms/amavisd-new/amavisd-new.spec	2004-11-05 00:07:53 UTC (rev 2416)
@@ -2,14 +2,12 @@
 # Authority: dag
 # Upstream: &lt;amavis-user$lists,sourceforge,net&gt;
 
-%define real_release p10
-
 %define logmsg logger -t %{name}/rpm
 
 Summary: Mail virus-scanner
 Name: amavisd-new
-Version: 20030616
-Release: 9.%{real_release}
+Version: 2.2.0
+Release: 1
 License: GPL
 Group: System Environment/Daemons
 URL: <A HREF="http://www.ijs.si/software/amavisd/">http://www.ijs.si/software/amavisd/</A>
@@ -17,7 +15,7 @@
 Packager: Dag Wieers &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>&gt;
 Vendor: Dag Apt Repository, <A HREF="http://dag.wieers.com/apt/">http://dag.wieers.com/apt/</A>
 
-Source: <A HREF="http://www.ijs.si/software/amavisd/amavisd-new-%{version">http://www.ijs.si/software/amavisd/amavisd-new-%{version</A>}-%{real_release}.tar.gz
+Source: <A HREF="http://www.ijs.si/software/amavisd/amavisd-new-%{version">http://www.ijs.si/software/amavisd/amavisd-new-%{version</A>}.tar.gz
 BuildRoot: %{_tmppath}/%{name}-%{version}-%{release}-root
 
 BuildRequires: sendmail-devel &gt;= 8.12, sendmail
@@ -56,11 +54,24 @@
 ### FIXME: Some versions of install fail to change permissions when failing to change ownership. (Please fix upstream)
 %{__perl} -pi.orig -e 's| -o root | |g' helper-progs/Makefile.in
 
+%{__cat} &lt;&lt;EOF &gt;amavisd.logrotate
+%{_localstatedir}/log/amavis.log {
+        create 600 vscan vscan
+	missingok
+	copytruncate
+	notifempty
+}
+EOF
+
+%{__cat} &lt;&lt;EOF &gt;amavisd.cron
+/usr/sbin/tmpwatch 720 %{_localstatedir}/virusmails/
+EOF
+
 %{__cat} &lt;&lt;'EOF' &gt;amavisd.sysconfig
 ### Uncomment this if you want to use amavis with sendmail milter interface.
 ### See README.milter for details.
 #
-#MILTER_SOCKET=&quot;local:/var/spool/amavis/amavis-milter.sock&quot;
+#MILTER_SOCKET=&quot;local:/var/amavis/amavis-milter.sock&quot;
 #MILTER_SOCKET=&quot;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">10024 at 127.0.0.1</A>&quot;
 
 ### These are other defaults.
@@ -79,7 +90,7 @@
 # description: AMaViS virus scanner.
 #
 # processname: amavisd
-# config: %{_sysconfdir}/amavis.conf
+# config: %{_sysconfdir}/amavisd.conf
 # pidfile: %{_localstatedir}/run/amavisd.pid
 
 source %{_initrddir}/functions
@@ -88,7 +99,7 @@
 [ -r %{_sysconfdir}/amavisd.conf ] || exit 1
 
 ### Default variables
-AMAVIS_ACCOUNT=&quot;amavis&quot;
+AMAVIS_USER=&quot;vscan&quot;
 MILTER_SOCKET=&quot;&quot;
 MILTER_FLAGS=&quot;&quot;
 SYSCONFIG=&quot;%{_sysconfdir}/sysconfig/amavisd&quot;
@@ -96,6 +107,9 @@
 ### Read configuration
 [ -r &quot;$SYSCONFIG&quot; ] &amp;&amp; source &quot;$SYSCONFIG&quot;
 
+### Backward compatibility
+[ &quot;$AMAVIS_ACCOUNT&quot; ] &amp;&amp; AMAVIS_USER=&quot;$AMAVIS_ACCOUNT&quot;
+
 RETVAL=0
 prog=&quot;amavisd&quot;
 prog2=&quot;amavis-milter&quot;
@@ -104,13 +118,13 @@
 start() {
 	if [ &quot;$MILTER_SOCKET&quot; -a -x &quot;%{_sbindir}/$prog2&quot; ]; then
 		echo -n $&quot;Starting $desc ($prog2): &quot;
-		daemon --user &quot;$AMAVIS_ACCOUNT&quot; %{_sbindir}/$prog2 -p &quot;$MILTER_SOCKET&quot; $MILTER_FLAGS
+		daemon --user &quot;$AMAVIS_USER&quot; %{_sbindir}/$prog2 -p &quot;$MILTER_SOCKET&quot; $MILTER_FLAGS
 		RETVAL=$?
 		echo
 		[ $RETVAL -eq 0 ] &amp;&amp; touch %{_localstatedir}/lock/subsys/$prog2
 	fi
 	echo -n $&quot;Starting $desc ($prog): &quot;
-	daemon --user &quot;$AMAVIS_ACCOUNT&quot; %{_sbindir}/$prog
+	daemon --user &quot;$AMAVIS_USER&quot; %{_sbindir}/$prog
 	RETVAL=$?
 	echo
 	[ $RETVAL -eq 0 ] &amp;&amp; touch %{_localstatedir}/lock/subsys/$prog
@@ -180,9 +194,9 @@
 cd helper-progs
 %configure \
 	--with-milterlib=&quot;%{_libdir}&quot; \
-	--with-user=&quot;amavis&quot; \
-	--with-sockname=&quot;%{_localstatedir}/spool/amavis/amavisd.sock&quot; \
-	--with-runtime-dir=&quot;%{_localstatedir}/spool/amavis&quot; \
+	--with-user=&quot;vscan&quot; \
+	--with-sockname=&quot;%{_localstatedir}/amavis/amavisd.sock&quot; \
+	--with-runtime-dir=&quot;%{_localstatedir}/amavis&quot; \
 	--enable-postfix \
 	--enable-all
 %{__make} %{?_smp_mflags}
@@ -192,32 +206,38 @@
 %{__install} -d -m0755 %{buildroot}%{_sbindir}
 %makeinstall -C helper-progs
 
+#%{__perl} -pi.orig -e '
+#		s|=\s+'\''vscan'\''|= &quot;amavis&quot;|;
+#		s|=\s+'\''sweep'\''|= &quot;amavis&quot;|; 
+#		s|^#*(\$MYHOME)\s+=.*$|$1 = &quot;%{_localstatedir}/amavis&quot;;|;
+#		s|^#*(\$QUARANTINEDIR)\s+=.*$|$1 = &quot;%{_localstatedir}/virusmails&quot;;|;
+#	' amavisd.conf
 %{__perl} -pi.orig -e '
-		s|= '\''vscan'\''|= &quot;amavis&quot;|;
-		s|= '\''sweep'\''|= &quot;amavis&quot;|; 
-		s|^#*(\$MYHOME) =.*$|$1 = &quot;%{_localstatedir}/spool/amavis&quot;;|;
-		s|^#*(\$QUARANTINEDIR) =.*$|$1 = &quot;%{_localstatedir}/spool/amavis/virusmails&quot;;|;
+		s|^(#*\$SYSLOG.+)$|$1\n\$LOGFILE = &quot;%{_localstatedir}/log/amavis.log&quot;;|;
 	' amavisd.conf
 
-%{__install} -d -m0700 %{buildroot}%{_localstatedir}/spool/amavis/virusmails/
+%{__install} -d -m0700 %{buildroot}%{_localstatedir}/virusmails/
+%{__install} -d -m0755 %{buildroot}%{_localstatedir}/amavis/{db,tmp,var}/
 
 %{__install} -D -m0755 amavisd %{buildroot}%{_sbindir}/amavisd
 %{__install} -D -m0755 amavisd.sysv %{buildroot}%{_initrddir}/amavisd
 %{__install} -D -m0700 amavisd.conf %{buildroot}%{_sysconfdir}/amavisd.conf
 %{__install} -D -m0644 LDAP.schema %{buildroot}%{_sysconfdir}/openldap/schema/amavisd-new.schema
 %{__install} -D -m0644 amavisd.sysconfig %{buildroot}%{_sysconfdir}/sysconfig/amavisd
+%{__install} -D -m0644 amavisd.logrotate %{buildroot}%{_sysconfdir}/logrotate.d/amavisd
+%{__install} -D -m0755 amavisd.cron %{buildroot}%{_sysconfdir}/cron.daily/amavisd
 
 %clean
 %{__rm} -rf %{buildroot}
 
 %pre
-/usr/sbin/useradd -c &quot;AMaViS email scanner user&quot; -M -s /bin/sh -r amavis \
-		-d &quot;/var/spool/amavis&quot; &amp;&gt;/dev/null || :
+/usr/sbin/useradd -c &quot;Virus scan user&quot; -M -s /bin/sh -r vscan \
+		-d &quot;/var/tmp&quot; &amp;&gt;/dev/null || :
 
 %post
 /sbin/chkconfig --add amavisd
 
-if [ -r /etc/postfixes/aliases ]; then
+if [ -r /etc/postfix/aliases ]; then
 	if ! grep -q &quot;^virusalert:&quot; /etc/postfix/aliases; then
 		echo -e &quot;virusalert:\troot&quot; &gt;&gt; /etc/postfix/aliases
 		if [ -x /usr/bin/newaliases ]; then
@@ -242,7 +262,7 @@
 %post milter
 if [ -f /etc/mail/sendmail.mc ]; then
 	if ! grep -q &quot;milter-amavis&quot; /etc/mail/sendmail.mc; then
-		echo -e &quot;\ndnl define(\`MILTER', 1)\ndnl INPUT_MAIL_FILTER(\`milter-amavis', \`S=local:/var/spool/amavis/amavis-milter.sock, F=T, T=S:10m;R:10m;E:10m')&quot; &gt;&gt;/etc/mail/sendmail.mc
+		echo -e &quot;\ndnl define(\`MILTER', 1)\ndnl INPUT_MAIL_FILTER(\`milter-amavis', \`S=local:/var/amavis/amavis-milter.sock, F=T, T=S:10m;R:10m;E:10m')&quot; &gt;&gt;/etc/mail/sendmail.mc
 	fi
 fi
 
@@ -257,27 +277,43 @@
     /sbin/service amavisd condrestart &amp;&gt;/dev/null || :
 fi
 
+### Remove obsolete amavis user
+/usr/sbin/userdel amavis &amp;&gt;/dev/null || :
+
 %files
 %defattr(-, root, root, 0755)
 %doc AAAREADME.first LDAP.schema LICENSE MANIFEST RELEASE_NOTES README_FILES/* test-messages/
 %config %{_initrddir}/amavisd
 %config %{_sysconfdir}/openldap/schema/*.schema
+%config(noreplace) %{_sysconfdir}/logrotate.d/amavisd
+%config(noreplace) %{_sysconfdir}/cron.daily/amavisd
 %{_sbindir}/amavis
 %{_sbindir}/amavisd
 
-%defattr(0640, amavis, amavis, 0755)
+%defattr(0640, vscan, vscan, 0755)
 %config(noreplace) %{_sysconfdir}/amavisd.conf
 %config(noreplace) %{_sysconfdir}/sysconfig/amavisd
 
-%defattr(0700, amavis, amavis, 0700)
-%dir %{_localstatedir}/spool/amavis/
-%dir %{_localstatedir}/spool/amavis/virusmails/
+%defattr(0750, vscan, vscan, 0750)
+%dir %{_localstatedir}/amavis/
+%dir %{_localstatedir}/amavis/db/
+%dir %{_localstatedir}/amavis/tmp/
+%dir %{_localstatedir}/amavis/var/
+%dir %{_localstatedir}/virusmails/
 
 %files milter
 %defattr(-, root, root, 0755)
 %{_sbindir}/amavis-milter
 
 %changelog
+* Thu Nov 04 2004 Dag Wieers &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>&gt; - 2.2.0-1
+- Change of version format, requires manual intervention.
+- Directory changes to conform to amavisd standard.
+- Now using user vscan instead of amavis.
+- Added logrotate config for amavisd. (Anders Nielsen)
+- Added a clean-up cron script for /var/virusmails. (Anders Nielsen)
+- Updated to release 2.2.0.
+
 * Thu Jul 01 2004 Dag Wieers &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>&gt; - 20030616-9.p10
 - Updated to release 20030616-p10.
 

Modified: trunk/rpms/clamav/clamav.spec
===================================================================
--- trunk/rpms/clamav/clamav.spec	2004-11-04 19:58:52 UTC (rev 2415)
+++ trunk/rpms/clamav/clamav.spec	2004-11-05 00:07:53 UTC (rev 2416)
@@ -3,6 +3,7 @@
 # Upstream: &lt;clamav-devel$lists,sf,net&gt;
 
 ### FIXME: Sysv script does not have condrestart option (redo sysv script)
+### FIXME: amavisd-new requires clamd to run as user vscan, solution needed
 
 %{?el2:%define _without_milter 1}
 

Added: trunk/rpms/dconf/dconf.spec
===================================================================
--- trunk/rpms/dconf/dconf.spec	2004-11-04 19:58:52 UTC (rev 2415)
+++ trunk/rpms/dconf/dconf.spec	2004-11-05 00:07:53 UTC (rev 2416)
@@ -0,0 +1,57 @@
+# $Id$
+# Authority: dag
+# Upstream: Dag Wieers &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>&gt;
+
+Summary: Collect a system's hardware and software configuration
+Name: dconf
+Version: 0.3
+Release: 1
+License: GPL
+Group: System Environment/Base
+URL: <A HREF="http://dag.wieers.com/home-made/dconf/">http://dag.wieers.com/home-made/dconf/</A>
+
+Packager: Dag Wieers &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>&gt;
+Vendor: Dag Apt Repository, <A HREF="http://dag.wieers.com/apt/">http://dag.wieers.com/apt/</A>
+
+Source: <A HREF="http://dag.wieers.com/home-made/dconf/dconf-%{version">http://dag.wieers.com/home-made/dconf/dconf-%{version</A>}.tar.bz2
+BuildRoot: %{_tmppath}/%{name}-%{version}-%{release}-root
+
+BuildArch: noarch
+Requires: python
+
+%description
+Dconf is a tool to collect a system's hardware and software configuration.
+It allows to take your system configuration with you on the road, compare
+identical systems (like nodes in a cluster) to troubleshoot HW or SW
+problems.
+
+Dconf is also useful in projects where you have to manage changes as a
+team. Dconf can send out system changes to a list of email addresses so
+that they can be revised and discussed in group.
+
+You can customize your dconf configuration for specific needs, like making
+a profile of your laptop's hardware or copy specific software configuration
+files to send out or compare with other systems.
+
+%prep
+%setup
+
+%build
+
+%install
+%{__rm} -rf %{buildroot}
+%makeinstall
+
+%clean
+%{__rm} -rf %{buildroot}
+
+%files
+%defattr(-, root, root, 0755)
+%doc AUTHORS ChangeLog COPYING README TODO *.conf
+%config(noreplace) %{_sysconfdir}/dconf.conf
+%config(noreplace) %{_sysconfdir}/dconf-custom.conf
+%{_bindir}/dconf
+
+%changelog
+* Sun Oct 24 2004 Dag Wieers &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>&gt; - 0.3-1
+- Updated to release 0.3.


Property changes on: trunk/rpms/dconf/dconf.spec
___________________________________________________________________
Name: svn:keywords
   + Id
Name: svn:eol-style
   + native

Added: trunk/rpms/dstat/dstat.spec
===================================================================
--- trunk/rpms/dstat/dstat.spec	2004-11-04 19:58:52 UTC (rev 2415)
+++ trunk/rpms/dstat/dstat.spec	2004-11-05 00:07:53 UTC (rev 2416)
@@ -0,0 +1,68 @@
+# $Id$
+# Authority: dag
+# Upstream: Dag Wieers &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>&gt;
+
+Summary: Versatile vmstat, iostat and ifstat replacement
+Name: dstat
+Version: 0.4
+Release: 1
+License: GPL
+Group: System Environment/Base
+URL: <A HREF="http://dag.wieers.com/home-made/dstat/">http://dag.wieers.com/home-made/dstat/</A>
+
+Packager: Dag Wieers &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>&gt;
+Vendor: Dag Apt Repository, <A HREF="http://dag.wieers.com/apt/">http://dag.wieers.com/apt/</A>
+
+Source: <A HREF="http://dag.wieers.com/home-made/dstat/dstat-%{version">http://dag.wieers.com/home-made/dstat/dstat-%{version</A>}.tar.bz2
+BuildRoot: %{_tmppath}/%{name}-%{version}-%{release}-root
+
+BuildArch: noarch
+Requires: python
+
+%description
+Dstat is a versatile replacement for vmstat, iostat and ifstat. Dstat
+overcomes some of the limitations and adds some extra features.
+
+Dstat allows you to view all of your system resources instantly,
+you can eg. compare disk usage in combination with interrupts from
+your IDE controller, or compare the network bandwidth numbers
+directly with the disk throughput (in the same interval).
+
+Dstat also cleverly gives you the most detailed information in
+columns and clearly indicates in what magnitude and unit the output
+is displayed. Less confusion, less mistakes.
+
+Dstat is also unique in letting you aggregate block device throughput
+for a certain diskset or network bandwidth for a group of interfaces,
+ie. you can see the throughput for all the block devices that make up
+a single filesystem or storage system.
+
+You can customize your dstat output from /etc/dstat.conf and you can
+write your own dstat modules to plug into the dstat output.
+
+Dstat's output, in its current form, is not very useful to be post-
+processed by other tools. It's mostly meant for allowing humans to
+interprete real-time data as easy as possible.
+
+%prep
+%setup
+
+%build
+
+%install
+%{__rm} -rf %{buildroot}
+%makeinstall
+
+%clean
+%{__rm} -rf %{buildroot}
+
+%files
+%defattr(-, root, root, 0755)
+%doc AUTHORS ChangeLog COPYING README TODO 
+#%doc *.conf
+#%config(noreplace) %{_sysconfdir}/dstat.conf
+%{_bindir}/dstat
+
+%changelog
+* Tue Oct 26 2004 Dag Wieers &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>&gt; - 0.4-1
+- Updated to release 0.4.


Property changes on: trunk/rpms/dstat/dstat.spec
___________________________________________________________________
Name: svn:keywords
   + Id
Name: svn:eol-style
   + native

Modified: trunk/rpms/gdesklets-goodweather/gdesklets-goodweather.spec
===================================================================
--- trunk/rpms/gdesklets-goodweather/gdesklets-goodweather.spec	2004-11-04 19:58:52 UTC (rev 2415)
+++ trunk/rpms/gdesklets-goodweather/gdesklets-goodweather.spec	2004-11-05 00:07:53 UTC (rev 2416)
@@ -1,13 +1,12 @@
 # $Id$
-
 # Authority: dag
 
 %define real_name GoodWeather
 
 Summary: GoodWeather sensor and display for gdesklets
 Name: gdesklets-goodweather
-Version: 0.3
-Release: 0
+Version: 0.4
+Release: 1
 License: GPL
 Group: User Interface/Desktops
 URL: <A HREF="http://gdesklets.gnomedesktop.org/">http://gdesklets.gnomedesktop.org/</A>
@@ -15,7 +14,7 @@
 Packager: Dag Wieers &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>&gt;
 Vendor: Dag Apt Repository, <A HREF="http://dag.wieers.com/apt/">http://dag.wieers.com/apt/</A>
 
-Source: <A HREF="http://www.pycage.de/download/gdesklets/%{real_name">http://www.pycage.de/download/gdesklets/%{real_name</A>}-%{version}.tar.bz2
+Source: <A HREF="http://gdesklets.gnomedesktop.org/files/GoodWeather-%{version">http://gdesklets.gnomedesktop.org/files/GoodWeather-%{version</A>}.tar.bz2
 Source1: Makefile_install_scripts.tar.bz2
 BuildRoot: %{_tmppath}/%{name}-%{version}-%{release}-root
 
@@ -52,10 +51,13 @@
 %files
 %defattr(-, root, root, 0755)
 %doc README
-%{_bindir}/*
-%{_datadir}/gdesklets/Displays/*
-%{_datadir}/gdesklets/Sensors/*
+%{_bindir}/gdesklets-add-GoodWeather-display
+%{_datadir}/gdesklets/Displays/GoodWeather/
+%{_datadir}/gdesklets/Sensors/GoodWeather/
 
 %changelog
+* Thu Aug 19 2004 Dag Wieers &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>&gt; - 0.4-1
+- Updated to release 0.4.
+
 * Wed Dec 03 2003 Dag Wieers &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>&gt; - 0.3-0
 - Initial package. (using DAR)

Modified: trunk/rpms/kdissert/kdissert.spec
===================================================================
--- trunk/rpms/kdissert/kdissert.spec	2004-11-04 19:58:52 UTC (rev 2415)
+++ trunk/rpms/kdissert/kdissert.spec	2004-11-05 00:07:53 UTC (rev 2416)
@@ -8,9 +8,11 @@
 %{?el2:%define _without_freedesktop 1}
 %{?rh6:%define _without_freedesktop 1}
 
+%define desktop_vendor freshrpms
+
 Summary: Mindmapping tool for creating texts
 Name: kdissert
-Version: 0.2.5
+Version: 0.2.7
 Release: 1
 License: GPL
 Group: Applications/Productivity
@@ -46,6 +48,11 @@
 
 %build
 source &quot;/etc/profile.d/qt.sh&quot;
+%{__libtoolize} --force --copy
+#%{__aclocal} --force
+%{__automake} --add-missing
+%{__autoconf}
+%{__autoheader}
 %configure
 %{__make} %{?_smp_mflags}
 
@@ -59,11 +66,9 @@
 
 %if %{?_without_freedesktop:1}0
 	%{__install} -D -m0644 kdissert.desktop %{buildroot}%{_datadir}/applications/kdissert.desktop
-%{?_without_freedesktop:%{_datadir}/gnome/apps/Multimedia/gxine.desktop}
-
 %else
 	%{__install} -d -m0755 %{buildroot}%{_datadir}/applications/
-	desktop-file-install --vendor kde                  \
+	desktop-file-install --vendor %{desktop_vendor}    \
 		--dir %{buildroot}%{_datadir}/applications \
 		--add-category X-Red-Hat-Base              \
 		kdissert.desktop
@@ -93,9 +98,12 @@
 %{_datadir}/mimelnk/application/x-kdissert.desktop
 %{_datadir}/pixmaps/kdissert.png
 %{_libdir}/libkdiss*.so
-%{!?_without_freedesktop:%{_datadir}/applications/kde-kdissert.desktop}
+%{!?_without_freedesktop:%{_datadir}/applications/%{desktop_vendor}-kdissert.desktop}
 %{?_without_freedesktop:%{_datadir}/gnome/apps/Applications/kdissert.desktop}
 
 %changelog
+* Tue Nov 02 2004 Dag Wieers &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>&gt; - 0.2.7-1
+- Updated to release 0.2.7.
+
 * Thu Jul 22 2004 Dag Wieers &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>&gt; - 0.2.5-1
 - Initial package. (using DAR)

Modified: trunk/rpms/lftp/lftp.spec
===================================================================
--- trunk/rpms/lftp/lftp.spec	2004-11-04 19:58:52 UTC (rev 2415)
+++ trunk/rpms/lftp/lftp.spec	2004-11-05 00:07:53 UTC (rev 2416)
@@ -7,7 +7,7 @@
 
 Summary: Sophisticated file transfer program
 Name: lftp
-Version: 3.0.10
+Version: 3.0.11
 Release: 1
 License: GPL
 Group: Applications/Internet
@@ -61,6 +61,9 @@
 %{_libdir}/lftp/
 
 %changelog
+* Thu Nov 04 2004 Dag Wieers &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>&gt; - 3.0.11-1
+- Updated to release 3.0.11.
+
 * Sun Oct 31 2004 Dag Wieers &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>&gt; - 3.0.10-1
 - Updated to release 3.0.10.
 

Modified: trunk/rpms/libgda/libgda.spec
===================================================================
--- trunk/rpms/libgda/libgda.spec	2004-11-04 19:58:52 UTC (rev 2415)
+++ trunk/rpms/libgda/libgda.spec	2004-11-05 00:07:53 UTC (rev 2416)
@@ -4,9 +4,13 @@
 
 %{?dist: %{expand: %%define %dist 1}}
 
+%{?rh7:%define _without_mdbtools 1}
+%{?el2:%define _without_mdbtools 1}
+%{?rh6:%define _without_mdbtools 1}
+
 Summary: Library for writing gnome database programs
 Name: libgda
-Version: 1.1.4
+Version: 1.1.6
 Release: 1
 License: LGPL
 Group: System Environment/Libraries
@@ -22,11 +26,7 @@
 BuildRequires: libxml2-devel, libxslt-devel &gt;= 1.0.9
 BuildRequires: mysql-devel, postgresql-devel, unixODBC-devel, sqlite-devel
 BuildRequires: freetds-devel, xbase-devel
-%{?fc2:BuildRequires: mdbtools-devel}
-%{?fc1:BuildRequires: mdbtools-devel}
-%{?el3:BuildRequires: mdbtools-devel}
-%{?rh9:BuildRequires: mdbtools-devel}
-%{?rh8:BuildRequires: mdbtools-devel}
+%{!?_without_mdbtools:BuildRequires: mdbtools-devel}
 BuildRequires: scrollkeeper
 
 Requires(post): scrollkeeper
@@ -111,6 +111,9 @@
 %{_libdir}/pkgconfig/*.pc
 
 %changelog
+* Wed Aug 18 2004 Dag Wieers &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>&gt; - 1.1.6-1
+- Updated to release 1.1.6.
+
 * Fri Jun 11 2004 Dag Wieers &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>&gt; - 1.1.4-1
 - Updated to release 1.1.4.
 

Modified: trunk/rpms/memtest86+/memtest86+.spec
===================================================================
--- trunk/rpms/memtest86+/memtest86+.spec	2004-11-04 19:58:52 UTC (rev 2415)
+++ trunk/rpms/memtest86+/memtest86+.spec	2004-11-05 00:07:53 UTC (rev 2416)
@@ -10,7 +10,7 @@
 
 Summary: Thorough, stand-alone memory tester
 Name: memtest86+
-Version: 1.20
+Version: 1.27
 Release: 1
 License: GPL
 Group: System Environment/Kernel
@@ -62,6 +62,9 @@
 %{_prefix}/%{name}-%{version}
 
 %changelog
+* Thu Nov 04 2004 Dag Wieers &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>&gt; - 1.27-1
+- Updated to release 1.27.
+
 * Sun Jul 18 2004 Dag Wieers &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>&gt; - 1.20-1
 - Updated to release 1.20.
 

Added: trunk/rpms/perl-Kwiki/mp2-fix.patch
===================================================================
--- trunk/rpms/perl-Kwiki/mp2-fix.patch	2004-11-04 19:58:52 UTC (rev 2415)
+++ trunk/rpms/perl-Kwiki/mp2-fix.patch	2004-11-05 00:07:53 UTC (rev 2416)
@@ -0,0 +1,12 @@
+--- CGI-Kwiki-0.18/lib/CGI/Kwiki/Privacy.pm.orig	2003-08-25 15:45:08.000000000 -0500
++++ CGI-Kwiki-0.18/lib/CGI/Kwiki/Privacy.pm	2004-04-04 14:41:30.000000000 -0500
+@@ -96,6 +96,9 @@
+ # Name of the current script
+ sub script {
+     my $script = $0;
++    if ($script eq '/dev/null' or $script eq '-e') { # probably mod_perl
++        $script = Apache-&gt;request-&gt;filename;
++    }
+     $script =~ s/.*[\\\/]//;
+     return $script;
+ }

Added: trunk/rpms/perl-Kwiki/perl-Kwiki.spec
===================================================================
--- trunk/rpms/perl-Kwiki/perl-Kwiki.spec	2004-11-04 19:58:52 UTC (rev 2415)
+++ trunk/rpms/perl-Kwiki/perl-Kwiki.spec	2004-11-05 00:07:53 UTC (rev 2416)
@@ -0,0 +1,57 @@
+# $Id$
+# Authority: dag
+
+%define perl_vendorlib %(eval &quot;`perl -V:installvendorlib`&quot;; echo $installvendorlib)
+%define perl_vendorarch %(eval &quot;`perl -V:installvendorarch`&quot;; echo $installvendorarch)
+
+%define real_name Kwiki
+
+Summary: Kwiki module for perl
+Name: perl-Kwiki
+Version: 0.33
+Release: 1
+License: GPL or Artistic
+Group: Applications/CPAN
+#URL: <A HREF="http://search.cpan.org/dist/Kwiki/">http://search.cpan.org/dist/Kwiki/</A>
+URL: <A HREF="http://www.kwiki.org/">http://www.kwiki.org/</A>
+
+Packager: Dag Wieers &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>&gt;
+Vendor: Dag Apt Repository, <A HREF="http://dag.wieers.com/apt/">http://dag.wieers.com/apt/</A>
+
+Source: <A HREF="http://www.cpan.org/modules/by-module/Kwiki/Kwiki-%{version">http://www.cpan.org/modules/by-module/Kwiki/Kwiki-%{version</A>}.tar.gz
+BuildRoot: %{_tmppath}/%{name}-%{version}-%{release}-root
+BuildArch: noarch
+
+%description
+Kwiki is a modular implementation of a Wiki in Perl.
+
+%prep
+%setup -n %{real_name}-%{version}
+
+%build
+CFLAGS=&quot;%{optflags}&quot; %{__perl} Makefile.PL \
+        PREFIX=&quot;%{buildroot}%{_prefix}&quot; \
+        INSTALLDIRS=&quot;vendor&quot; \
+%{__make} %{?_smp_mflags}
+
+%install
+%{__rm} -rf %{buildroot}
+%makeinstall
+
+### Clean up buildroot
+%{__rm} -rf %{buildroot}%{perl_archlib} \
+                %{buildroot}%{perl_vendorarch}
+
+%clean
+%{__rm} -rf %{buildroot}
+
+%files
+%defattr(-, root, root, 0755)
+%doc Changes README
+%doc %{_mandir}/man?/*
+%{perl_vendorlib}/*
+%{_bindir}/*
+
+%changelog
+* Thu Sep 30 2004 Dag Wieers &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>&gt; - 0.33-1
+- Initial package. (using DAR)


Property changes on: trunk/rpms/perl-Kwiki/perl-Kwiki.spec
___________________________________________________________________
Name: svn:keywords
   + Id
Name: svn:eol-style
   + native

Added: trunk/rpms/perl-Kwiki/relative-link.patch
===================================================================
--- trunk/rpms/perl-Kwiki/relative-link.patch	2004-11-04 19:58:52 UTC (rev 2415)
+++ trunk/rpms/perl-Kwiki/relative-link.patch	2004-11-05 00:07:53 UTC (rev 2416)
@@ -0,0 +1,11 @@
+--- CGI-Kwiki-0.18/lib/CGI/Kwiki/Formatter.pm.orig	2003-09-11 00:18:12.000000000 -0500
++++ CGI-Kwiki-0.18/lib/CGI/Kwiki/Formatter.pm	2004-04-04 13:34:07.000000000 -0500
+@@ -319,7 +319,7 @@
+     $text =~ s/(^\s*|\s+(?=\s)|\s$)//g;
+     my $url = $text;
+     $url = $1 if $text =~ s/(.*?) +//;
+-    $url =~ s/^http:(?!=\/\/)//; # relative links
++    $url =~ s/^https?:(?!\/\/)//; # relative links
+     return qq{&lt;a href=&quot;$url&quot;&gt;$text&lt;/a&gt;};
+ }
+ 

Modified: trunk/rpms/php-adodb/php-adodb.spec
===================================================================
--- trunk/rpms/php-adodb/php-adodb.spec	2004-11-04 19:58:52 UTC (rev 2415)
+++ trunk/rpms/php-adodb/php-adodb.spec	2004-11-05 00:07:53 UTC (rev 2416)
@@ -2,11 +2,11 @@
 # Authority: dag
 
 %define real_name adodb
-%define real_version 422
+%define real_version 452
 
 Summary: Portable Database Library for PHP
 Name: php-adodb
-Version: 4.22
+Version: 4.52
 Release: 1
 License: BSD or LGPL
 Group: Development/Languages
@@ -55,6 +55,9 @@
 %{_localstatedir}/www/adodb/
 
 %changelog
+* Fri Nov 05 2004 Dag Wieers &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>&gt; - 4.52-1
+- Updated to release 4.52.
+
 * Mon May 03 2004 Dag Wieers &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>&gt; - 4.22-1
 - Updated to release 4.22.
 

Added: trunk/rpms/rootsh/rootsh.spec
===================================================================
--- trunk/rpms/rootsh/rootsh.spec	2004-11-04 19:58:52 UTC (rev 2415)
+++ trunk/rpms/rootsh/rootsh.spec	2004-11-05 00:07:53 UTC (rev 2416)
@@ -0,0 +1,52 @@
+# $Id$
+# Authority: dag
+# Upstream: Gerhard Lausser &lt;gerhard.lausser$consol,de&gt;
+
+Summary: Shell wrapper to log activity
+Name: rootsh
+Version: 0.2
+Release: 1
+License: GPL
+Group: System Environment/Base
+URL: <A HREF="http://sourceforge.net/projects/rootsh/">http://sourceforge.net/projects/rootsh/</A>
+
+Packager: Dag Wieers &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>&gt;
+Vendor: Dag Apt Repository, <A HREF="http://dag.wieers.com/apt/">http://dag.wieers.com/apt/</A>
+
+Source: <A HREF="http://prdownloads.sourceforge.net/rootsh/rootsh-%{version">http://prdownloads.sourceforge.net/rootsh/rootsh-%{version</A>}.tar.gz
+BuildRoot: %{_tmppath}/%{name}-%{version}-%{release}-root
+
+%description
+Rootsh is a wrapper for shells which logs all echoed keystrokes and terminal
+output to a file and/or to syslog. It's main purpose is the auditing of users
+who need a shell with root privileges. They start rootsh through the sudo
+mechanism.
+
+%prep
+%setup
+
+%build
+%configure \
+%{!?_without_syslog:--enable-syslog=&quot;local5.notice&quot;} \
+%{?_without_syslog:--disable-syslog} \
+	--with-logdir=&quot;%{_localstatedir}/log/rootsh&quot;
+%{__make} %{?_smp_mflags}
+
+%install
+%{__rm} -rf %{buildroot}
+%makeinstall
+%{__install} -d -m0700 %{buildroot}%{_localstatedir}/log/rootsh/
+
+%clean
+%{__rm} -rf %{buildroot}
+
+%files
+%defattr(-, root, root, 0755)
+%doc AUTHORS ChangeLog COPYING INSTALL NEWS README THANKS TODO
+%{_bindir}/rootsh
+%defattr(0700, root, root)
+%{_localstatedir}/log/rootsh
+
+%changelog
+* Fri Sep 14 2004 Dag Wieers &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>&gt; - 0.2-1
+- Initial package. (using DAR)


Property changes on: trunk/rpms/rootsh/rootsh.spec
___________________________________________________________________
Name: svn:keywords
   + Id
Name: svn:eol-style
   + native

Added: trunk/rpms/s4g/s4g.spec
===================================================================
--- trunk/rpms/s4g/s4g.spec	2004-11-04 19:58:52 UTC (rev 2415)
+++ trunk/rpms/s4g/s4g.spec	2004-11-05 00:07:53 UTC (rev 2416)
@@ -0,0 +1,49 @@
+# $Id$
+# Authority: dag
+# Upstream: Tangui Morlier &lt;tmorlier$lri,fr&gt;
+
+%{!?kernel:%define kernel %(rpm -q kernel-source --qf '%{RPMTAG_VERSION}-%{RPMTAG_RELEASE}' | tail -1)}
+
+Summary: User level sandbox designed for grid technologies
+Name: s4g
+Version: 0.8.1
+Release: 1
+License: GPL
+Group: System Environment/Base
+URL: <A HREF="http://www.lri.fr/~tmorlier/S4G/">http://www.lri.fr/~tmorlier/S4G/</A>
+
+Packager: Dag Wieers &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>&gt;
+Vendor: Dag Apt Repository, <A HREF="http://dag.wieers.com/apt/">http://dag.wieers.com/apt/</A>
+
+Source: <A HREF="http://www.lri.fr/~tmorlier/S4G/s4g-%{version">http://www.lri.fr/~tmorlier/S4G/s4g-%{version</A>}.tgz
+BuildRoot: %{_tmppath}/%{name}-%{version}-%{release}-root
+
+%description
+S4G is an open source user level sandbox designed for grid technologies.
+It offers a secure execution environment for untrusted applications.
+Efficient and lightweight, it does not require to modify your linux kernel,
+to insert a specific module nor to have special administrator rights.
+
+%prep
+%setup
+
+%build
+%{__make} %{?_smp_mflags} \
+	FLAGS=&quot;%{optflags} -I%{_includedir}&quot;
+#	FLAGS=&quot;%{optflags} -I%{_includedir} -I/%{_lib}/modules/%{kernel}/build/include&quot;
+
+%install
+%{__rm} -rf %{buildroot}
+%{__install} -D -m0755 sandbox %{buildroot}%{_bindir}/sandbox
+
+%clean
+%{__rm} -rf %{buildroot}
+
+%files
+%defattr(-, root, root, 0755)
+%doc AUTHORS COPYING README
+%{_bindir}/sandbox
+
+%changelog
+* Fri Sep 24 2004 Dag Wieers &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>&gt; - 0.8.1-1
+- Initial package. (using DAR)


Property changes on: trunk/rpms/s4g/s4g.spec
___________________________________________________________________
Name: svn:keywords
   + Id
Name: svn:eol-style
   + native

Modified: trunk/rpms/snackamp/snackamp-fdw.spec
===================================================================
--- trunk/rpms/snackamp/snackamp-fdw.spec	2004-11-04 19:58:52 UTC (rev 2415)
+++ trunk/rpms/snackamp/snackamp-fdw.spec	2004-11-05 00:07:53 UTC (rev 2416)
@@ -72,7 +72,7 @@
 	%{__install} -m0644 %{name}.desktop %{buildroot}%{_datadir}/gnome/apps/Multimedia/
 %else
         %{__install} -d -m0755 %{buildroot}%{_datadir}/applications
-        desktop-file-install --vendor gnome                \
+        desktop-file-install --vendor %{desktop_vendor}    \
                 --add-category X-Red-Hat-Base              \
                 --add-category Application                 \
                 --add-category AudioVideo                  \

Added: trunk/rpms/tnftp/tnftp.spec
===================================================================
--- trunk/rpms/tnftp/tnftp.spec	2004-11-04 19:58:52 UTC (rev 2415)
+++ trunk/rpms/tnftp/tnftp.spec	2004-11-05 00:07:53 UTC (rev 2416)
@@ -0,0 +1,50 @@
+# $Id$
+# Authority: dag
+
+%define real_version 20030825
+
+Summary: Enhanced NetBSD ftp client
+Name: tnftp
+Version: 0.0.20030825
+Release: 1
+License: BSD
+Group: Applications/Internet
+URL: <A HREF="ftp://ftp.netbsd.org/pub/NetBSD/misc/lukemftp/">ftp://ftp.netbsd.org/pub/NetBSD/misc/lukemftp/</A>
+
+Packager: Dag Wieers &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>&gt;
+Vendor: Dag Apt Repository, <A HREF="http://dag.wieers.com/apt/">http://dag.wieers.com/apt/</A>
+
+Source: <A HREF="ftp://ftp.netbsd.org/pub/NetBSD/misc/lukemftp/tnftp-%{real_version">ftp://ftp.netbsd.org/pub/NetBSD/misc/lukemftp/tnftp-%{real_version</A>}.tar.gz
+Buildroot: %{_tmppath}/%{name}-%{version}-%{release}-root
+
+Requires: libtermcap
+
+%description 
+tnftp is a port of the NetBSD FTP client to other systems.
+tnftp was formerly known as `lukemftp' and was renamed by Luke Mewburn
+in February 2003.
+
+%prep 
+%setup -n %{name}-%{real_version}
+
+%build 
+%configure 
+%{__make} %{?_smp_mflags}
+
+%install 
+%{__rm} -rf %{buildroot}
+%{__install} -D -m0755 src/ftp %{buildroot}%{_bindir}/tnftp
+%{__install} -D -m0644 src/ftp.1 %{buildroot}%{_mandir}/man1/tnftp.1
+
+%clean 
+%{__rm} -rf %{buildroot}
+
+%files 
+%defattr(-, root, root, 0755) 
+%doc ChangeLog COPYING README THANKS todo
+%doc %{_mandir}/man1/tnftp.1*
+%{_bindir}/tnftp
+
+%changelog 
+* Sat Oct 09 2004 Dag Wieers &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>&gt; - 0.0.20030825-1
+- Contributed package by Florin Andrei.


Property changes on: trunk/rpms/tnftp/tnftp.spec
___________________________________________________________________
Name: svn:keywords
   + Id
Name: svn:eol-style
   + native

Added: trunk/rpms/vpnc/vpnc.conf
===================================================================
--- trunk/rpms/vpnc/vpnc.conf	2004-11-04 19:58:52 UTC (rev 2415)
+++ trunk/rpms/vpnc/vpnc.conf	2004-11-05 00:07:53 UTC (rev 2416)
@@ -0,0 +1,6 @@
+# this is the rdu gateway, change as appropriate
+#IPSec gateway my.vpn.gateway
+#IPSec ID my.ipsec.id
+#IPSec secret mysecret
+# your username goes here
+#Xauth username 

Added: trunk/rpms/vpnc/vpnc.spec
===================================================================
--- trunk/rpms/vpnc/vpnc.spec	2004-11-04 19:58:52 UTC (rev 2415)
+++ trunk/rpms/vpnc/vpnc.spec	2004-11-05 00:07:53 UTC (rev 2416)
@@ -0,0 +1,64 @@
+# $Id$
+# Authority: dag
+
+%define _sbindir /sbin
+
+Summary: IPSec VPN client compatible with Cisco equipment
+Name: vpnc
+Version: 0.2
+Release: 1
+License: GPL
+Group: Applications/Internet
+URL: <A HREF="http://www.unix-ag.uni-kl.de/~massar/vpnc/">http://www.unix-ag.uni-kl.de/~massar/vpnc/</A>
+
+Packager: Dag Wieers &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>&gt;
+Vendor: Dag Apt Repository, <A HREF="http://dag.wieers.com/apt/">http://dag.wieers.com/apt/</A>
+
+Source: <A HREF="http://www.unix-ag.uni-kl.de/~massar/vpnc/vpnc-%{version">http://www.unix-ag.uni-kl.de/~massar/vpnc/vpnc-%{version</A>}-rm+zomb.1.tar.gz
+BuildRoot: %{_tmppath}/%{name}-%{version}-%{release}-root
+
+BuildRequires: libgcrypt-devel &gt; 1.1.90
+Requires: kernel &gt;= 2.4
+
+%description
+A VPN client compatible with Cisco's EasyVPN equipment.
+
+Supports IPSec (ESP) with Mode Configuration and Xauth.  Supports only
+shared-secret IPSec authentication, 3DES, MD5, and IP tunneling.
+
+%prep
+%setup -n vpnc-%{version}-rm+zomb.1
+
+%{__cat} &lt;&lt;EOF &gt;vpnc.conf
+### This is the gateway configuration
+#IPSec gateway my.vpn.gateway
+#IPSec ID my.ipsec.id
+#IPSec secret mysecret
+
+### Put your username here
+#Xauth username 
+EOF
+
+%build
+%{__make} %{?_smp_mflags}
+
+%install
+%{__rm} -rf %{buildroot}
+%{__install} -D -m0755 vpnc %{buildroot}%{_sbindir}/vpnc
+%{__install} -D -m0600 vpnc.conf %{buildroot}%{_sysconfdir}/vpnc.conf
+%{__install} -D -m0644 vpnc.8 %{buildroot}%{_mandir}/man8/vpnc.8
+
+%clean
+%{__rm} -rf %{buildroot}
+
+%files
+%defattr(-, root, root, 0755)
+%doc ChangeLog COPYING README TODO vpnc-*
+%doc %{_mandir}/man8/vpnc.8*
+%config(noreplace) %{_sysconfdir}/vpnc.conf
+%{_sbindir}/vpnc
+%dev(c, 10, 200) /dev/tun
+
+%changelog
+* Sun Oct 10 2004 Dag Wieers &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>&gt; - 0.2-1
+- Initial package. (using DAR)


Property changes on: trunk/rpms/vpnc/vpnc.spec
___________________________________________________________________
Name: svn:keywords
   + Id
Name: svn:eol-style
   + native

Added: trunk/rpms/whowatch/whowatch.spec
===================================================================
--- trunk/rpms/whowatch/whowatch.spec	2004-11-04 19:58:52 UTC (rev 2415)
+++ trunk/rpms/whowatch/whowatch.spec	2004-11-05 00:07:53 UTC (rev 2416)
@@ -0,0 +1,53 @@
+# $Id$
+# Authority: dag
+# Upstream: Michal Suszycki &lt;mike$wizard,ae,krakow,pl&gt;
+
+Summary: Display information about users currently logged on users
+Name: whowatch
+Version: 1.4
+Release: 1
+License: GPL
+Group: Applications/System
+URL: <A HREF="http://wizard.ae.krakow.pl/~mike/">http://wizard.ae.krakow.pl/~mike/</A>
+
+Packager: Dag Wieers &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>&gt;
+Vendor: Dag Apt Repository, <A HREF="http://dag.wieers.com/apt/">http://dag.wieers.com/apt/</A>
+
+Source: <A HREF="http://wizard.ae.krakow.pl/~mike/download/whowatch-%{version">http://wizard.ae.krakow.pl/~mike/download/whowatch-%{version</A>}.tar.gz
+BuildRoot: %{_tmppath}/%{name}-%{version}-%{release}-root
+
+BuildRequires: ncurses-devel 
+
+%description
+Whowatch is an interactive console utility that displays informations about
+the users currently logged on to the machine, in real time. Besides standard
+information (login, tty, host, user's process) you can see type of login
+(ie. ssh, telnet). You can also see selected user's processes tree or all
+system processes tree.  In the process tree mode there is ability to send
+INT or KILL signal to selected process.
+
+%prep
+%setup
+
+%build
+%configure
+%{__make} %{?_smp_mflags}
+
+%install
+%{__rm} -rf %{buildroot}
+%{__install} -d -m0755 %{buildroot}%{_mandir}/man1/ \
+			%{buildroot}%{_bindir}
+%makeinstall
+
+%clean
+%{__rm} -rf %{buildroot}
+
+%files 
+%defattr(-,root,root,-)
+%doc AUTHORS ChangeLog COPYING KEYS README TODO
+%doc %{_mandir}/man1/whowatch.1*
+%{_bindir}/whowatch
+
+%changelog
+* Fri Nov 05 2004 Dag Wieers &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>&gt; - 1.4-1
+- Initial package. (using DAR)


Property changes on: trunk/rpms/whowatch/whowatch.spec
___________________________________________________________________
Name: svn:keywords
   + Id
Name: svn:eol-style
   + native

Added: trunk/rpms/xosview/xosview-1.8.0-gcc33.patch
===================================================================
--- trunk/rpms/xosview/xosview-1.8.0-gcc33.patch	2004-11-04 19:58:52 UTC (rev 2415)
+++ trunk/rpms/xosview/xosview-1.8.0-gcc33.patch	2004-11-05 00:07:53 UTC (rev 2416)
@@ -0,0 +1,90 @@
+--- xosview-1.8.0/linux/cpumeter.cc.gcc	2003-05-22 22:42:40.000000000 +0200
++++ xosview-1.8.0/linux/cpumeter.cc	2003-05-22 23:07:10.000000000 +0200
+@@ -11,9 +11,11 @@
+ #include &lt;fstream.h&gt;
+ #include &lt;stdlib.h&gt;
+ #include &lt;string.h&gt;
+-#include &lt;strstream.h&gt;
++#include &lt;strstream&gt;
+ #include &lt;ctype.h&gt;
+ 
++using namespace std;
++
+ static const char STATFILENAME[] = &quot;/proc/stat&quot;;
+ #define MAX_PROCSTAT_LENGTH 4096
+ 
+--- xosview-1.8.0/linux/memmeter.cc.gcc	2003-05-22 23:00:40.000000000 +0200
++++ xosview-1.8.0/linux/memmeter.cc	2003-05-22 23:01:22.000000000 +0200
+@@ -8,9 +8,11 @@
+ #include &quot;memmeter.h&quot;
+ #include &quot;xosview.h&quot;
+ #include &lt;fstream.h&gt;
+-#include &lt;strstream.h&gt;
++#include &lt;strstream&gt;
+ #include &lt;stdlib.h&gt;
+ 
++using namespace std;
++
+ static const char MEMFILENAME[] = &quot;/proc/meminfo&quot;;
+ static const char MEMSTATFNAME[] = &quot;/proc/memstat&quot;;
+ 
+--- xosview-1.8.0/linux/swapmeter.cc.gcc	2003-05-22 23:01:38.000000000 +0200
++++ xosview-1.8.0/linux/swapmeter.cc	2003-05-22 23:01:45.000000000 +0200
+@@ -10,7 +10,7 @@
+ #include &quot;swapmeter.h&quot;
+ #include &quot;xosview.h&quot;
+ #include &lt;fstream.h&gt;
+-#include &lt;strstream.h&gt;
++#include &lt;strstream&gt;
+ #include &lt;stdlib.h&gt;
+ 
+ #ifdef USESYSCALLS
+--- xosview-1.8.0/linux/intmeter.cc.gcc	2003-05-22 23:02:00.000000000 +0200
++++ xosview-1.8.0/linux/intmeter.cc	2003-05-22 23:02:31.000000000 +0200
+@@ -10,12 +10,13 @@
+ #include &quot;xosview.h&quot;
+ #include &quot;cpumeter.h&quot;
+ #include &lt;fstream.h&gt;
+-#include &lt;strstream.h&gt;
++#include &lt;strstream&gt;
+ #include &lt;stdlib.h&gt;
+ #ifdef __alpha__
+ #include &lt;asm/irq.h&gt;
+ #endif 
+ 
++using namespace std;
+ 
+ static const char *INTFILE     = &quot;/proc/interrupts&quot;;
+ static const char *VERSIONFILE = &quot;/proc/version&quot;;
+--- xosview-1.8.0/linux/raidmeter.cc.gcc	2003-05-22 23:02:47.000000000 +0200
++++ xosview-1.8.0/linux/raidmeter.cc	2003-05-22 23:03:05.000000000 +0200
+@@ -8,11 +8,13 @@
+ #include &quot;raidmeter.h&quot;
+ #include &quot;xosview.h&quot;
+ #include &lt;fstream.h&gt;
+-#include &lt;strstream.h&gt;
++#include &lt;strstream&gt;
+ #include &lt;stdio.h&gt;
+ #include &lt;stdlib.h&gt;
+ #include &lt;string.h&gt;
+ 
++using namespace std;
++
+ RAIDMeter::RAIDMeter( XOSView *parent, int raiddev)
+   : BitFieldMeter( parent, 1, 2, &quot;RAID&quot;) {
+   _raiddev = raiddev;
+--- xosview-1.8.0/linux/serialmeter.cc.gcc	2003-05-22 23:03:21.000000000 +0200
++++ xosview-1.8.0/linux/serialmeter.cc	2003-05-22 23:03:46.000000000 +0200
+@@ -16,9 +16,11 @@
+ #include &lt;sys/ioctl.h&gt;
+ #include &lt;errno.h&gt;
+ #include &lt;stdlib.h&gt;
+-#include &lt;strstream.h&gt;
++#include &lt;strstream&gt;
+ #include &lt;iomanip.h&gt;
+ 
++using namespace std;
++
+ // This should go away after types.h gets fixed in the kernel.
+ #ifdef __alpha__
+ typedef unsigned char u8;

Added: trunk/rpms/xosview/xosview-1.8.0-kernel26.patch
===================================================================
--- trunk/rpms/xosview/xosview-1.8.0-kernel26.patch	2004-11-04 19:58:52 UTC (rev 2415)
+++ trunk/rpms/xosview/xosview-1.8.0-kernel26.patch	2004-11-05 00:07:53 UTC (rev 2416)
@@ -0,0 +1,37 @@
+--- xosview-1.8.0/linux/diskmeter.cc.kernel26	2004-01-20 11:21:01.176672751 +0100
++++ xosview-1.8.0/linux/diskmeter.cc	2004-01-20 11:21:48.949830071 +0100
+@@ -64,6 +64,8 @@
+         {
+         stats.ignore(1024, '\n');
+         stats &gt;&gt; buf;
++        if (stats.eof())
++           break;
+         }
+ 
+ 	// read values
+--- xosview-1.8.0/linux/cpumeter.cc.kernel26	2004-01-20 11:23:36.035973182 +0100
++++ xosview-1.8.0/linux/cpumeter.cc	2004-01-20 11:25:10.643379468 +0100
+@@ -61,8 +61,11 @@
+   }
+ 
+   // read until we are at the right line.
+-  for (int i = 0 ; i &lt; _lineNum ; i++)
++  for (int i = 0 ; i &lt; _lineNum ; i++) {
++    if (stats.eof())
++       break;
+     stats.getline(tmp, MAX_PROCSTAT_LENGTH);
++  }
+ 
+   stats &gt;&gt;tmp &gt;&gt;cputime_[cpuindex_][0]
+ 	      &gt;&gt;cputime_[cpuindex_][1]
+--- xosview-1.8.0/linux/pagemeter.cc.kernel26	2004-01-20 11:25:27.043716194 +0100
++++ xosview-1.8.0/linux/pagemeter.cc	2004-01-20 11:26:12.630092678 +0100
+@@ -58,7 +58,7 @@
+ 
+   do {
+     stats &gt;&gt;buf;
+-  } while (strncasecmp(buf, &quot;swap&quot;, 5));
++  } while (!stats.eof() &amp;&amp; strncasecmp(buf, &quot;swap&quot;, 5));
+ 	  
+   stats &gt;&gt;pageinfo_[pageindex_][0] &gt;&gt;pageinfo_[pageindex_][1];
+ 

Added: trunk/rpms/xosview/xosview-1.8.0-nfs.patch
===================================================================
--- trunk/rpms/xosview/xosview-1.8.0-nfs.patch	2004-11-04 19:58:52 UTC (rev 2415)
+++ trunk/rpms/xosview/xosview-1.8.0-nfs.patch	2004-11-05 00:07:53 UTC (rev 2416)
@@ -0,0 +1,380 @@
+--- xosview-1.8.0/config/Makefile.linux.in.org	2002-02-24 17:00:47.000000000 -0500
++++ xosview-1.8.0/config/Makefile.linux.in	2003-07-02 13:45:12.000000000 -0400
+@@ -15,6 +15,7 @@
+ swapmeter.o \
+ pagemeter.o \
+ netmeter.o \
++nfsmeter.o \
+ intmeter.o \
+ loadmeter.o \
+ btrymeter.o \
+--- xosview-1.8.0/linux/MeterMaker.cc.org	2002-02-24 17:00:47.000000000 -0500
++++ xosview-1.8.0/linux/MeterMaker.cc	2003-01-30 15:43:38.000000000 -0500
+@@ -21,6 +21,7 @@
+ #include &quot;diskmeter.h&quot;
+ #include &quot;raidmeter.h&quot;
+ #include &quot;lmstemp.h&quot;
++#include &quot;nfsmeter.h&quot;
+ 
+ #include &lt;stdlib.h&gt;
+ 
+@@ -99,4 +100,11 @@
+       push(new LmsTemp(_xos, res, lab, caption));
+     }
+   }
++  // check for the NFS mesters
++  if (_xos-&gt;isResourceTrue(&quot;NFSDStats&quot;)){
++      push(new NFSDStats(_xos));
++  }
++  if (_xos-&gt;isResourceTrue(&quot;NFSStats&quot;)){
++      push(new NFSStats(_xos));
++  }
+ }
+--- xosview-1.8.0/linux/nfsmeter.cc.org	2003-07-02 13:44:31.000000000 -0400
++++ xosview-1.8.0/linux/nfsmeter.cc	2003-01-31 12:18:36.000000000 -0500
+@@ -0,0 +1,248 @@
++//
++//  Copyright (c) 1994, 1995, 2002 by Mike Romberg ( <A HREF="http://lists.repoforge.org/mailman/listinfo/commits">romberg at fsl.noaa.gov</A> )
++//
++//  Modifications to support dynamic addresses by:
++//    Michael N. Lipp (<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">mnl at dtro.e-technik.th-darmstadt.de</A>)
++//
++//  This file may be distributed under terms of the GPL
++//
++//
++// $Id$
++//
++
++#include &quot;nfsmeter.h&quot;
++#include &quot;xosview.h&quot;
++
++#include &lt;unistd.h&gt;
++#include &lt;fstream.h&gt;
++#include &lt;stdlib.h&gt;
++#include &lt;sys/socket.h&gt;
++#include &lt;sys/ioctl.h&gt;
++#if defined(GNULIBC) || defined(__GLIBC__)
++#include &lt;net/if.h&gt;
++#else
++#include &lt;linux/if.h&gt;
++#endif
++#include &lt;netinet/in.h&gt;
++#include &lt;errno.h&gt;
++#include &lt;iostream.h&gt;
++#include &lt;iomanip.h&gt;
++
++#ifndef MAX
++#define MAX(_a, _b) ((_a) &gt; (_b) ? (_a) : (_b))
++#endif
++
++#define NFSSVCSTAT  &quot;/proc/net/rpc/nfsd&quot;
++#define NFSCLTSTAT  &quot;/proc/net/rpc/nfs&quot;
++
++NFSMeter::NFSMeter(XOSView *parent, const char *name, int nfields, 
++		char *fields, const char *statfile)
++  : FieldMeterGraph( parent, nfields, name, fields ){
++	_statfile = statfile; 
++	_statname = name;
++}
++
++NFSMeter::~NFSMeter( void ){
++}
++
++void NFSMeter::checkResources( void ){
++  FieldMeterGraph::checkResources();
++}
++
++NFSDStats::NFSDStats(XOSView *parent)
++  : NFSMeter(parent, &quot;NFSD&quot;, 4, &quot;BAD/UDP/TCP/IDLE&quot;, NFSSVCSTAT ){
++	starttimer();
++}
++
++NFSDStats::~NFSDStats( void ) {
++}
++
++void NFSDStats::checkResources( void ){
++  NFSMeter::checkResources();
++
++  setfieldcolor( 0, parent_-&gt;getResource( &quot;NFSDStatBadCallsColor&quot; ) );
++  setfieldcolor( 1, parent_-&gt;getResource( &quot;NFSDStatUDPColor&quot; ) );
++  setfieldcolor( 2, parent_-&gt;getResource( &quot;NFSDStatTCPColor&quot; ) );
++  setfieldcolor( 3, parent_-&gt;getResource( &quot;NFSDStatIdleColor&quot; ) );
++
++  useGraph_ = 1;
++  dodecay_ = 1;
++  SetUsedFormat (&quot;autoscale&quot;);
++  //SetUsedFormat (&quot;percent&quot;);
++}
++void NFSDStats::checkevent(void)
++{
++	char buf[4096], name[64];
++	unsigned long netcnt, netudpcnt, nettcpcnt, nettcpconn;
++	unsigned long calls, badcalls;
++	int found;
++
++    ifstream ifs(_statfile);
++
++    if (!ifs) {
++        // cerr &lt;&lt;&quot;Can not open file : &quot; &lt;&lt;_statfile &lt;&lt;endl;
++        // parent_-&gt;done(1);
++        return;
++	}
++
++	fields_[0] = fields_[1] = fields_[2] = 0;  // network activity
++    stoptimer();
++
++	name[0] = '\0';
++	found = 0;
++	while (!ifs.eof() &amp;&amp; found != 2) {
++		ifs.getline(buf, 4096, '\n');
++		if (strncmp(&quot;net&quot;, buf, strlen(&quot;net&quot;)) == 0) {
++			sscanf(buf, &quot;%s %lu %lu %lu %lu\n&quot;, name, 
++				&amp;netcnt, &amp;netudpcnt, &amp;nettcpcnt, &amp;nettcpconn);
++			found++;
++		}
++		if (strncmp(&quot;rpc&quot;, buf, strlen(&quot;rpc&quot;)) == 0) {
++			sscanf(buf, &quot;%s %lu %lu\n&quot;, name, &amp;calls, &amp;badcalls);
++			found++;
++		}
++	}
++
++    float t = 1000000.0 / usecs();
++
++    if (t &lt; 0)
++        t = 0.1;
++
++	maxpackets_ = MAX(netcnt, calls) - _lastNetCnt;
++	if (maxpackets_ == 0) {
++		maxpackets_ = netcnt;
++	} else {
++		fields_[0] = (badcalls - _lastBad) * t;
++		fields_[1] = (netudpcnt - _lastUdp) * t;
++		fields_[2] = (nettcpcnt - _lastTcp) * t;
++	}
++
++    total_ = fields_[0] + fields_[1] + fields_[2];
++    if (total_ &gt; maxpackets_)
++        fields_[3] = 0;
++    else {
++        total_ = maxpackets_;
++        fields_[3] = total_ - fields_[0] - fields_[1] - fields_[2];
++	}
++
++    if (total_)
++        setUsed(fields_[0] + fields_[1] + fields_[2], total_);
++
++    starttimer();
++    drawfields();
++
++	_lastNetCnt = MAX(netcnt, calls);
++    _lastTcp = nettcpcnt;
++    _lastUdp = netudpcnt;
++    _lastBad = badcalls;
++}
++
++NFSStats::NFSStats(XOSView *parent)
++  : NFSMeter(parent, &quot;NFS&quot;, 4, &quot;RETRY/AUTH/CALL/IDLE&quot;, NFSCLTSTAT ){
++	starttimer();
++}
++
++NFSStats::~NFSStats( void ) {
++}
++
++void NFSStats::checkResources( void ){
++  NFSMeter::checkResources();
++
++  setfieldcolor( 0, parent_-&gt;getResource( &quot;NFSStatReTransColor&quot; ) );
++  setfieldcolor( 1, parent_-&gt;getResource( &quot;NFSStatAuthRefrshColor&quot; ) );
++  setfieldcolor( 2, parent_-&gt;getResource( &quot;NFSStatCallsColor&quot; ) );
++  setfieldcolor( 3, parent_-&gt;getResource( &quot;NFSStatIdleColor&quot; ) );
++
++  useGraph_ = 1;
++  dodecay_ = 1;
++  SetUsedFormat (&quot;autoscale&quot;);
++  // SetUsedFormat (&quot;percent&quot;);
++}
++
++void NFSStats::checkevent(void)
++{
++	char buf[4096], name[64];
++	unsigned long calls, retrns, authrefresh, maxpackets_;
++	
++    ifstream ifs(_statfile);
++
++    if (!ifs) {
++        // cerr &lt;&lt;&quot;Can not open file : &quot; &lt;&lt;_statfile &lt;&lt;endl;
++        // parent_-&gt;done(1);
++        return;
++	}
++
++	fields_[0] = fields_[1] = fields_[2] = 0;
++    stoptimer();
++
++	name[0] = '\0';
++	while (!ifs.eof()) {
++		ifs.getline(buf, 4096, '\n');
++		if (strncmp(&quot;rpc&quot;, buf, strlen(&quot;rpc&quot;)))
++			continue;
++		sscanf(buf, &quot;%s %lu %lu %lu\n&quot;, name, &amp;calls, &amp;retrns, &amp;authrefresh);
++		break;
++	}
++
++    float t = 1000000.0 / usecs();
++
++    if (t &lt; 0)
++        t = 0.1;
++
++	maxpackets_ = calls - _lastcalls;
++	if (maxpackets_ == 0) {
++		maxpackets_ = calls;
++	} else {
++		fields_[2] = (calls - _lastcalls) * t;
++		fields_[1] = (authrefresh - _lastauthrefresh) * t;
++		fields_[0] = (retrns - _lastretrns) * t;
++	}
++
++    total_ = fields_[0] + fields_[1] + fields_[2];
++    if (total_ &gt; maxpackets_)
++        fields_[3] = 0;
++    else {
++        total_ = maxpackets_;
++        fields_[3] = total_ - fields_[2] - fields_[1] - fields_[0];
++	}
++
++    if (total_)
++        setUsed(fields_[0] + fields_[1] + fields_[2], total_);
++
++    starttimer();
++    drawfields();
++
++	_lastcalls = calls;
++	_lastretrns = retrns;
++	_lastauthrefresh = authrefresh;
++}
++#if 0
++NFSV3::NFSV3( XOSView *parent)
++	: BitMeter( parent, &quot;NFSv3&quot;, &quot;&quot;, 1, 0, 0 ) {
++
++	setNumBits(23);
++	legend(&quot;Version 3&quot;);
++
++	for ( int i = 0 ; i &lt; numBits() ; i++ )
++		procs[i] = lastprocs[i] = 0;
++}
++NFSV3::~NFSV3( void ) {
++}
++
++void NFSV3::checkResources( void ){
++  BitMeter::checkResources();
++  onColor_  = parent_-&gt;allocColor( parent_-&gt;getResource( &quot;NFSv3OnColor&quot; ) );
++  offColor_ = parent_-&gt;allocColor( parent_-&gt;getResource( &quot;NFSv3OffColor&quot; ) );
++}
++
++void NFSV3::checkevent( void ){
++  getirqs();
++
++  for ( int i = 0 ; i &lt; numBits() ; i++ ){
++    bits_[i] = ((irqs_[i] - lastirqs_[i]) != 0);
++    lastirqs_[i] = irqs_[i];
++  }
++
++  BitMeter::checkevent();
++}
++#endif
+--- xosview-1.8.0/linux/nfsmeter.h.org	2003-07-02 13:48:53.000000000 -0400
++++ xosview-1.8.0/linux/nfsmeter.h	2003-07-02 13:44:42.000000000 -0400
+@@ -0,0 +1,69 @@
++//  
++//
++//  This file may be distributed under terms of the GPL
++//
++//
++// $Id$
++//
++#ifndef _NFSMETER_H_
++#define _NFSMETER_H_
++
++#include &quot;fieldmetergraph.h&quot;
++#include &quot;timer.h&quot;
++
++class Host;
++
++class NFSMeter : public FieldMeterGraph {
++public:
++	NFSMeter(
++		XOSView *parent, 
++		const char *name, 
++		int   nfields, 
++		char *files, 
++		const char *statfile);
++  ~NFSMeter( void );
++
++  const char *name( void ) const { return _statname; }  
++  void checkResources( void );
++  void starttimer(void) { return _timer.start(); };
++  void stoptimer(void) { return _timer.stop(); };
++  double usecs(void) { return _timer.report_usecs(); };
++
++protected:
++  const char *_statname;
++  const char *_statfile;
++
++private:
++  Timer _timer;
++
++};
++
++class NFSStats : public NFSMeter {
++public:
++  NFSStats(XOSView *parent);
++  ~NFSStats(void);
++
++  void checkevent( void );
++
++  void checkResources( void );
++private:
++	unsigned long _lastcalls, _lastretrns, _lastauthrefresh;
++};
++
++class NFSDStats : public NFSMeter {
++public:
++  NFSDStats(XOSView *parent);
++  ~NFSDStats(void);
++
++  void checkevent( void );
++
++  void checkResources( void );
++
++protected:
++  float maxpackets_;
++
++private:
++  unsigned long _lastTcp, _lastUdp, _lastNetCnt, _lastBad;
++};
++
++#endif
+--- xosview-1.8.0/Xdefaults.in.orig	2004-03-11 12:10:01.625819389 +0100
++++ xosview-1.8.0/Xdefaults.in	2004-03-11 12:09:49.398061490 +0100
+@@ -247,3 +247,22 @@
+ xosview*lmstempLabel2:	RTMP
+ xosview*lmstempPriority: 20
+ xosview*lmstempUsedFormat: autoscale
++
++xosview*NFSDStats:       True
++xosview*NFSDStatCallsColor:     green
++xosview*NFSDStatBadCallsColor: red
++xosview*NFSDStatUDPColor:       yellow
++xosview*NFSDStatTCPColor:       orange
++xosview*NFSDStatIdleColor:      aquamarine
++xosview*NFSDNetStats: True
++xosview*NFSDNetUDPColor: yellow
++xosview*NFSDNetTCPColor: orange
++xosview*NFSDNetIdleColor: aquamarine
++! xosview*NFSDNetBandwidth:   10000000  ! for 100Mbit/s Ethernet (could be 12500000)
++xosview*NFSDNetBandwidth:   2000  ! for 100Mbit/s Ethernet (could be 12500000)
++
++xosview*NFSStats:	True
++xosview*NFSStatReTransColor:	aquamarine
++xosview*NFSStatAuthRefrshColor:	seagreen
++xosview*NFSStatCallsColor:	green
++xosview*NFSStatIdleColor:	aquamarine

Added: trunk/rpms/xosview/xosview-1.8.0-proc.patch
===================================================================
--- trunk/rpms/xosview/xosview-1.8.0-proc.patch	2004-11-04 19:58:52 UTC (rev 2415)
+++ trunk/rpms/xosview/xosview-1.8.0-proc.patch	2004-11-05 00:07:53 UTC (rev 2416)
@@ -0,0 +1,88 @@
+--- xosview-1.8.0/linux/netmeter.cc.proc	Sun Feb 24 23:55:19 2002
++++ xosview-1.8.0/linux/netmeter.cc	Sun Jun  2 20:30:04 2002
+@@ -31,6 +31,7 @@
+ 
+ #include &lt;unistd.h&gt;
+ #include &lt;fstream.h&gt;
++#include &lt;string.h&gt;
+ #include &lt;stdlib.h&gt;
+ #include &lt;sys/socket.h&gt;
+ #include &lt;sys/ioctl.h&gt;
+@@ -43,6 +44,7 @@
+ #include &lt;errno.h&gt;
+ #include &lt;iostream.h&gt;
+ #include &lt;iomanip.h&gt;
++#include &lt;string&gt;
+ 
+ NetMeter::NetMeter( XOSView *parent, float max )
+   : FieldMeterGraph( parent, 3, &quot;NET&quot;, &quot;IN/OUT/IDLE&quot; ){
+@@ -60,7 +62,7 @@
+ 
+ void NetMeter::checkOSVersion(void)
+     {
+-    ifstream ifs(&quot;/proc/sys/kernel/osrelease&quot;);
++    std::ifstream ifs(&quot;/proc/sys/kernel/osrelease&quot;);
+     if (!ifs)
+         {
+         cerr &lt;&lt;&quot;Can not open file : &quot; &lt;&lt; &quot;/proc/sys/kernel/osrelease&quot; &lt;&lt;endl;
+@@ -77,7 +79,7 @@
+     if (major &gt; 2 || (major == 2 &amp;&amp; minor &gt;= 1))
+         {
+ 	// check presence of iacct and oacct chains
+-        ifstream chains(&quot;/proc/net/ip_fwchains&quot;);
++        std::ifstream chains(&quot;/proc/net/ip_fwchains&quot;);
+ 	int n = 0;
+ 	char buf[1024];
+ 
+@@ -135,7 +137,7 @@
+ 
+ void NetMeter::checkeventNew(void)
+     {
+-    ifstream ifs(_netfilename);
++    std::ifstream ifs(_netfilename);
+ 
+     if (!ifs)
+         {
+@@ -144,6 +146,7 @@
+         return;
+         }
+ 
++		std::string str_in;
+     unsigned long in, out, ig;
+     unsigned long totin = 0, totout = 0;
+     char buf[1024];
+@@ -173,8 +176,14 @@
+ 	  while (ifs)
+ 	      {
+ 	      ifs.ignore(1024, ':');
+-	      ifs &gt;&gt; in &gt;&gt; ig &gt;&gt; ig &gt;&gt; ig &gt;&gt; ig &gt;&gt; ig &gt;&gt; ig &gt;&gt; ig &gt;&gt; out;
+-
++              ifs &gt;&gt; str_in;
++              if (str_in == &quot;No&quot;)
++                continue;
++              else
++                {
++                  in = strtoul(str_in.c_str(), NULL, 10);
++                  ifs &gt;&gt; ig &gt;&gt; ig &gt;&gt; ig &gt;&gt; ig &gt;&gt; ig &gt;&gt; ig &gt;&gt; ig &gt;&gt; out;
++                }
+ 	      if (!ifs.eof())
+ 		  {
+ 		  totin += in;
+@@ -210,7 +219,7 @@
+     fields_[2] = maxpackets_;     // assume no
+     fields_[0] = fields_[1] = 0;  // network activity
+ 
+-    ifstream ifs(_netfilename);
++    std::ifstream ifs(_netfilename);
+     if (!ifs)
+         {
+         cerr &lt;&lt;&quot;Can not open file : &quot; &lt;&lt; _netfilename &lt;&lt;endl;
+@@ -230,7 +239,7 @@
+         }
+ 
+     char c;
+-    unsigned long sa, da, sm, dm, bytes;
++    unsigned long dec, hex, sa, da, sm, dm, bytes;
+     unsigned long tot_in = 0, tot_out = 0;
+ 
+     ifs.ignore(1024, '\n');

Added: trunk/rpms/xosview/xosview-1.8.0-procstat.patch
===================================================================
--- trunk/rpms/xosview/xosview-1.8.0-procstat.patch	2004-11-04 19:58:52 UTC (rev 2415)
+++ trunk/rpms/xosview/xosview-1.8.0-procstat.patch	2004-11-05 00:07:53 UTC (rev 2416)
@@ -0,0 +1,91 @@
+--- xosview-1.8.0/linux/cpumeter.cc.orig	Wed Feb 24 23:16:20 1999
++++ xosview-1.8.0/linux/cpumeter.cc	Sun Jun  2 22:43:46 2002
+@@ -15,6 +15,7 @@
+ #include &lt;ctype.h&gt;
+ 
+ static const char STATFILENAME[] = &quot;/proc/stat&quot;;
++#define MAX_PROCSTAT_LENGTH 4096
+ 
+ CPUMeter::CPUMeter(XOSView *parent, const char *cpuID)
+ : FieldMeterGraph( parent, 4, toUpper(cpuID), &quot;USR/NICE/SYS/FREE&quot; ) {
+@@ -49,7 +50,7 @@
+ 
+ void CPUMeter::getcputime( void ){
+   total_ = 0;
+-  char tmp[1024];
++  char tmp[MAX_PROCSTAT_LENGTH];
+   ifstream stats( STATFILENAME );
+ 
+   if ( !stats ){
+@@ -59,11 +60,11 @@
+ 
+   // read until we are at the right line.
+   for (int i = 0 ; i &lt; _lineNum ; i++)
+-    stats.getline(tmp, 1024);
++    stats.getline(tmp, MAX_PROCSTAT_LENGTH);
+ 
+-  stats &gt;&gt;tmp &gt;&gt;cputime_[cpuindex_][0]  
+-	      &gt;&gt;cputime_[cpuindex_][1]  
+-	      &gt;&gt;cputime_[cpuindex_][2]  
++  stats &gt;&gt;tmp &gt;&gt;cputime_[cpuindex_][0]
++	      &gt;&gt;cputime_[cpuindex_][1]
++	      &gt;&gt;cputime_[cpuindex_][2]
+ 	      &gt;&gt;cputime_[cpuindex_][3];
+ 
+   int oldindex = (cpuindex_+1)%2;
+@@ -87,9 +88,9 @@
+   }
+ 
+   int line = -1;
+-  char buf[1024];
++  char buf[MAX_PROCSTAT_LENGTH];
+   while (!stats.eof()){
+-    stats.getline(buf, 1024);
++    stats.getline(buf, MAX_PROCSTAT_LENGTH);
+     if (!stats.eof()){
+       line++;
+       if (!strncmp(cpuID, buf, strlen(cpuID)) &amp;&amp; buf[strlen(cpuID)] == ' ')
+@@ -99,9 +100,9 @@
+   return -1;
+ }
+ 
+-// Checks for the SMP kernel patch by <A HREF="http://lists.repoforge.org/mailman/listinfo/commits">forissier at isia.cma.fr.</A>  
++// Checks for the SMP kernel patch by <A HREF="http://lists.repoforge.org/mailman/listinfo/commits">forissier at isia.cma.fr.</A>
+ // <A HREF="http://www-isia.cma.fr/~forissie/smp_kernel_patch/">http://www-isia.cma.fr/~forissie/smp_kernel_patch/</A>
+-// If it finds that this patch has been applied to the current kernel 
++// If it finds that this patch has been applied to the current kernel
+ // then returns the number of cpus that are on this machine.
+ int CPUMeter::countCPUs(void){
+   ifstream stats( STATFILENAME );
+@@ -112,9 +113,9 @@
+   }
+ 
+   int cpuCount = 0;
+-  char buf[1024];
++  char buf[MAX_PROCSTAT_LENGTH];
+   while (!stats.eof()){
+-    stats.getline(buf, 1024);
++    stats.getline(buf, MAX_PROCSTAT_LENGTH);
+     if (!stats.eof()){
+       if (!strncmp(buf, &quot;cpu&quot;, 3) &amp;&amp; buf[3] != ' ')
+           cpuCount++;
+@@ -127,7 +128,7 @@
+ const char *CPUMeter::cpuStr(int num){
+   static char buffer[32];
+   ostrstream str(buffer, 32);
+-  
++
+   str &lt;&lt; &quot;cpu&quot;;
+   if (num != 0)
+     str &lt;&lt; (num - 1);
+@@ -137,8 +138,8 @@
+ }
+ 
+ const char *CPUMeter::toUpper(const char *str){
+-  static char buffer[1024];
+-  strncpy(buffer, str, 1024);
++  static char buffer[MAX_PROCSTAT_LENGTH];
++  strncpy(buffer, str, MAX_PROCSTAT_LENGTH);
+   for (char *tmp = buffer ; *tmp != '\0' ; tmp++)
+     *tmp = toupper(*tmp);
+ 

Added: trunk/rpms/xosview/xosview-1.8.0-rpath.patch
===================================================================
--- trunk/rpms/xosview/xosview-1.8.0-rpath.patch	2004-11-04 19:58:52 UTC (rev 2415)
+++ trunk/rpms/xosview/xosview-1.8.0-rpath.patch	2004-11-05 00:07:53 UTC (rev 2416)
@@ -0,0 +1,25 @@
+--- xosview-1.8.0/config/configure.in.orig	2002-02-18 03:11:13.000000000 +0100
++++ xosview-1.8.0/config/configure.in	2004-02-24 18:44:31.392502243 +0100
+@@ -10,8 +10,8 @@
+ ICE_CXX_LONG_LONG
+ AC_PATH_X
+ CXXFLAGS=&quot;$CXXFLAGS -I$x_includes&quot;
+-LIBS=&quot;-L$x_libraries -R$x_libraries $LIBS&quot;
+-ELF_LINK_FLAGS=&quot;-Wl,-R$x_libraries&quot;
++LIBS=&quot;-L$x_libraries&quot;
++#ELF_LINK_FLAGS=&quot;-Wl,-R$x_libraries&quot;
+ dnl AC_PREFIX_DEFAULT(/usr/X11)	dnl No longer needed with our
+ dnl 				x_includes magic in Makefile.top.in.
+ dnl  Check for /usr/X11R6.  If it exists, make that the default prefix.
+--- xosview-1.8.0/configure.rpath	2004-02-24 18:50:32.900789381 +0100
++++ xosview-1.8.0/configure	2004-02-24 18:50:49.020152232 +0100
+@@ -1197,8 +1197,7 @@
+ fi
+ 
+ CXXFLAGS=&quot;$CXXFLAGS -I$x_includes&quot;
+-LIBS=&quot;-L$x_libraries -R$x_libraries $LIBS&quot;
+-ELF_LINK_FLAGS=&quot;-Wl,-R$x_libraries&quot;
++LIBS=&quot;-L$x_libraries&quot;
+ 
+ if test -r /usr/X11R6 ; then
+     ac_default_prefix=/usr/X11R6

Added: trunk/rpms/xosview/xosview-1.8.0-s390.patch
===================================================================
--- trunk/rpms/xosview/xosview-1.8.0-s390.patch	2004-11-04 19:58:52 UTC (rev 2415)
+++ trunk/rpms/xosview/xosview-1.8.0-s390.patch	2004-11-05 00:07:53 UTC (rev 2416)
@@ -0,0 +1,25 @@
+--- xosview-1.8.0/config/Makefile.linux.in.s390	2002-02-24 17:00:47.000000000 -0500
++++ xosview-1.8.0/config/Makefile.linux.in	2003-01-06 13:27:20.000000000 -0500
+@@ -23,9 +23,9 @@
+ lmstemp.o \
+ MeterMaker.o
+ 
+-FAIL_ARCHS =3D m68k sparc
++FAIL_ARCHS =3D m68k sparc s390 s390x powerpc powerpc64
+ ifneq (,$(findstring @host_cpu@, $(FAIL_ARCHS)))
+-# nothing else for m68k
++# nothing else for FAIL_ARCHS
+ else
+ OBJS += serialmeter.o
+ endif
+--- xosview-1.8.0/linux/MeterMaker.cc.s390	2003-01-06 13:24:14.000000000 -0500
++++ xosview-1.8.0/linux/MeterMaker.cc	2003-01-06 13:24:49.000000000 -0500
+@@ -57,7 +57,7 @@
+       push(new DiskMeter(_xos, atof(_xos-&gt;getResource(&quot;diskBandwidth&quot;))));
+ 
+   // check for the serial meters.
+-#if !defined(__mc68000__) &amp;&amp; !defined(__powerpc__)
++#if !defined(__mc68000__) &amp;&amp; !defined(__powerpc__) &amp;&amp; !defined(__s390__) &amp;&amp; !defined(__s390x__)
+   for (int i = 0 ; i &lt; SerialMeter::numDevices() ; i++)
+     if (_xos-&gt;isResourceTrue(SerialMeter::getResourceName(
+       (SerialMeter::Device)i)))

Added: trunk/rpms/xosview/xosview-1.8.0-strip.patch
===================================================================
--- trunk/rpms/xosview/xosview-1.8.0-strip.patch	2004-11-04 19:58:52 UTC (rev 2415)
+++ trunk/rpms/xosview/xosview-1.8.0-strip.patch	2004-11-05 00:07:53 UTC (rev 2416)
@@ -0,0 +1,20 @@
+--- xosview-1.8.0/config/aclocal.m4.orig	2002-06-20 14:15:27.000000000 +0200
++++ xosview-1.8.0/config/aclocal.m4	2002-06-20 14:16:05.000000000 +0200
+@@ -139,7 +139,7 @@
+ #endif
+ ], [USE_MOD_VERSIONS=-DMODVERSIONS] AC_MSG_RESULT(yes), AC_MSG_RESULT(no))
+ SMP_LINUX
+-INSTALL_ARGS='-s -m 4755'
++INSTALL_ARGS='-m 755'
+ fi
+ ,
+ AC_SYS_LINUX_VERS
+@@ -165,7 +165,7 @@
+         echo &quot;disabled the Linux $LVERSION memstat module by default&quot;
+ fi
+ )
+-INSTALL_ARGS='-s -m 4755'
++INSTALL_ARGS='-m 755'
+ if test &quot;$smp&quot; = &quot;yes&quot;
+ then
+ LINUX_SMP=&quot;-D__SMP__&quot;

Added: trunk/rpms/xosview/xosview-non-i386.patch
===================================================================
--- trunk/rpms/xosview/xosview-non-i386.patch	2004-11-04 19:58:52 UTC (rev 2415)
+++ trunk/rpms/xosview/xosview-non-i386.patch	2004-11-05 00:07:53 UTC (rev 2416)
@@ -0,0 +1,28 @@
+--- ./linux/serialmeter.cc.fred	Tue Feb 16 15:09:26 1999
++++ ./linux/serialmeter.cc	Fri Jan 21 12:03:45 2000
+@@ -32,11 +32,11 @@
+ #include &lt;unistd.h&gt;
+ #if defined(GNULIBC) || defined(__GLIBC__)
+ #include &lt;sys/io.h&gt;
+-#ifndef __alpha__
++#if !defined(__alpha__) &amp;&amp; !defined(__sparc__) &amp;&amp; !defined(__powerpc__) &amp;&amp; !defined(__ia64__)
+ #include &lt;sys/perm.h&gt;
+ #endif
+ #else
+-#ifndef __alpha__
++#if !defined(__alpha__) &amp;&amp; !defined(__sparc__) &amp;&amp; !defined(__powerpc__) &amp;&amp; !defined(__ia64__)
+ #include &lt;asm/io.h&gt;
+ #endif
+ #endif
+@@ -72,7 +72,11 @@
+ }
+ 
+ bool SerialMeter::getport(unsigned short int port){
++#if !defined(__i386__) &amp;&amp; !defined(__ia64__)
++  return 1;
++#else
+   return ioperm(port, 1, 1) != -1;
++#endif
+ }
+ 
+ void SerialMeter::getserial( void ){

Added: trunk/rpms/xosview/xosview-ppc.patch
===================================================================
--- trunk/rpms/xosview/xosview-ppc.patch	2004-11-04 19:58:52 UTC (rev 2415)
+++ trunk/rpms/xosview/xosview-ppc.patch	2004-11-05 00:07:53 UTC (rev 2416)
@@ -0,0 +1,12 @@
+--- linux/MeterMaker.cc	Fri Nov 12 00:13:22 1999
++++ linux/MeterMaker.cc.ppc	Thu Jan 25 07:48:31 2001
+@@ -56,7 +56,7 @@
+       push(new DiskMeter(_xos, atof(_xos-&gt;getResource(&quot;diskBandwidth&quot;))));
+ 
+   // check for the serial meters.
+-#ifndef __mc68000__
++#if !defined(__mc68000__) &amp;&amp; !defined(__powerpc__)
+   for (int i = 0 ; i &lt; SerialMeter::numDevices() ; i++)
+     if (_xos-&gt;isResourceTrue(SerialMeter::getResourceName(
+       (SerialMeter::Device)i)))
+

Added: trunk/rpms/xosview/xosview.png
===================================================================
(Binary files differ)


Property changes on: trunk/rpms/xosview/xosview.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/rpms/xosview/xosview.spec
===================================================================
--- trunk/rpms/xosview/xosview.spec	2004-11-04 19:58:52 UTC (rev 2415)
+++ trunk/rpms/xosview/xosview.spec	2004-11-05 00:07:53 UTC (rev 2416)
@@ -0,0 +1,112 @@
+# $Id$
+# Authority: dag
+
+%{?dist: %{expand: %%define %dist 1}}
+
+%{?rh7:%define _without_freedesktop 1}
+%{?el2:%define _without_freedesktop 1} 
+%{?rh6:%define _without_freedesktop 1}
+
+%define desktop_vendor rpmforge
+
+Summary: X Window System utility for monitoring system resources
+Name: xosview
+Version: 1.8.0
+Release: 1
+License: GPL/BSD
+Group: Applications/System
+Url: <A HREF="http://xosview.sourceforge.net/">http://xosview.sourceforge.net/</A>
+
+Packager: Dag Wieers &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>&gt;
+Vendor: Dag Apt Repository, <A HREF="http://dag.wieers.com/apt/">http://dag.wieers.com/apt/</A>
+
+Source: <A HREF="http://dl.sf.net/xosview/xosview-%{version">http://dl.sf.net/xosview/xosview-%{version</A>}.tar.gz
+Source1: xosview.png
+Patch0: xosview-non-i386.patch
+Patch2: xosview-ppc.patch
+Patch3: xosview-1.8.0-rpath.patch
+Patch5: xosview-1.8.0-s390.patch
+Patch6: xosview-1.8.0-proc.patch
+Patch8: xosview-1.8.0-procstat.patch
+Patch9: xosview-1.8.0-strip.patch
+Patch10: xosview-1.8.0-gcc33.patch
+Patch11: xosview-1.8.0-kernel26.patch
+Patch12: xosview-1.8.0-nfs.patch
+Buildroot: %{_tmppath}/%{name}-%{version}-%{release}-root
+
+%{!?_without_freedesktop:BuildRequires: desktop-file-utils}
+
+%description
+The xosview utility displays a set of bar graphs which show the
+current system state, including memory usage, CPU usage, system load,
+etc. Xosview runs under the X Window System.
+
+%prep
+%setup
+%patch0 -p0
+%patch2 -p0 -b .ppc
+%patch3 -p1
+%patch5 -p1 -b .s390
+%patch6 -p1 -b .proc
+%patch8 -p1 -b .procstat
+%patch9 -p1 -b .strip
+%patch10 -p1 -b .gcc33
+%patch11 -p1 -b .kernel26
+%patch12 -p1
+
+%{__cat} &lt;&lt;EOF &gt;xosview.desktop
+[Desktop Entry]
+Name=Xosview OS Monitor
+Comment=Display resources in real-time
+Exec=xosview
+Terminal=false
+Type=Application
+Icon=xosview.png
+Categories=Application;System;
+Encoding=UTF-8
+EOF
+
+#%{__cp} -vf %{_datadir}/libtool/config.* config/
+
+%build
+%configure \
+	--disable-linux-memstat
+%{__make} %{?_smp_mflags} all
+
+%install
+%{__rm} -rf %{buildroot}
+%{__install} -d -m0755 %{buildroot}%{_prefix}/X11R6/bin/ \
+			%{buildroot}%{_prefix}/X11R6/man/man1/ \
+			%{buildroot}%{_prefix}/X11R6/lib/X11/app-defaults/
+%makeinstall \
+	PREFIX_TO_USE=&quot;%{buildroot}%{_prefix}/X11R6&quot;
+%{__install} -D -m0644 %{SOURCE1} %{buildroot}%{_datadir}/icons/xosview.png
+
+%{__chmod} 0755 %{buildroot}%{_usr}/X11R6/bin/xosview
+
+%if %{?_without_freedesktop:1}0
+	%{__install} -D -m0644 xosview.desktop %{buildroot}%{_datadir}/gnome/apps/Utilities/xosview.desktop
+%else
+	%{__install} -d -m0755 %{buildroot}%{_datadir}/applications/
+	desktop-file-install --vendor %{desktop_vendor}    \
+		--add-category X-Red-Hat-Base              \
+		--dir %{buildroot}%{_datadir}/applications \
+		xosview.desktop
+%endif
+
+%clean
+%{__rm} -rf %{buildroot}
+
+%files
+%defattr(-, root, root, 0755)
+%doc CHANGES COPYING* README README.linux TODO
+%doc %{_prefix}/X11R6/man/man1/xosview.1*
+%{_prefix}/X11R6/bin/xosview
+%{_prefix}/X11R6/lib/X11/app-defaults/XOsview
+%{_datadir}/icons/xosview.png
+%{?_without_freedesktop:%{_datadir}/gnome/apps/Utilities/xosview.desktop}
+%{!?_without_freedesktop:%{_datadir}/applications/%{desktop_vendor}-xosview.desktop}
+
+%changelog
+* Sun Oct 10 2004 Dag Wieers &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>&gt; - 1.8.0-1
+- Initial package. (using DAR)


Property changes on: trunk/rpms/xosview/xosview.spec
___________________________________________________________________
Name: svn:keywords
   + Id
Name: svn:eol-style
   + native


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001221.html">[SVN] r2415 - in trunk/rpms: . Gtk-Perl armagetron-moviepack faad2	gkrellm-plugins libebml libfame libmatroska libmpeg3 ogle	ogle_gui perl-Cache-Cache perl-Video-DVDRip perl-libintl	transcode videolan-client
</A></li>
	<LI>Next message: <A HREF="001223.html">[SVN] r2417 - in trunk/rpms: . dnotify
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1222">[ date ]</a>
              <a href="thread.html#1222">[ thread ]</a>
              <a href="subject.html#1222">[ subject ]</a>
              <a href="author.html#1222">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.repoforge.org/mailman/listinfo/commits">More information about the commits
mailing list</a><br>
</body></html>
