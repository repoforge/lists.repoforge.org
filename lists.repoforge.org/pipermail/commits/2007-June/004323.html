<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [svn] r5524 - trunk/tools/unoconv
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:commits%40lists.repoforge.org?Subject=Re:%20Re%3A%20%5Bsvn%5D%20r5524%20-%20trunk/tools/unoconv&In-Reply-To=%3C20070618100707.A16CE944A96%40pooch.vmhosting.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004322.html">
   <LINK REL="Next"  HREF="004324.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[svn] r5524 - trunk/tools/unoconv</H1>
    <B>packagers at lists.rpmforge.net</B> 
    <A HREF="mailto:commits%40lists.repoforge.org?Subject=Re:%20Re%3A%20%5Bsvn%5D%20r5524%20-%20trunk/tools/unoconv&In-Reply-To=%3C20070618100707.A16CE944A96%40pooch.vmhosting.org%3E"
       TITLE="[svn] r5524 - trunk/tools/unoconv">packagers at lists.rpmforge.net
       </A><BR>
    <I>Mon Jun 18 12:07:07 CEST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="004322.html">[svn] r5523 - in trunk/rpms: perl-AI-DecisionTree perl-AI-Fuzzy	perl-AI-Gene-Sequence perl-AI-Menu perl-AI-NeuralNet-BackProp	perl-AOL-TOC perl-Algorithm-Permute perl-Alias perl-AnyData	perl-Apache-Admin-Config perl-Apache-DBI perl-Apache-ParseLog	perl-Apache-Session-SharedMem perl-Apache-SessionManager	perl-Apache-SimpleTemplate perl-Array-Lookup	perl-Array-PrintCols perl-Array-Reform perl-Array-Unique	perl-Attribute-Handlers-Prospective perl-Attribute-Persistent	perl-Attribute-Protected perl-Audio perl-Audio-DSP	perl-Audio-ESD perl-Audio-Mixer perl-Audio-OSS	perl-Audio-Play-MPG123 perl-Audio-Wav	perl-Authen-Challenge-Basic perl-Authen-NTLM perl-Authen-PAM	perl-Authen-Smb perl-B-Graph perl-BSD-Resource	perl-Bit-ShiftReg perl-Bit-Vector-Minimal perl-Business-ISBN	perl-Business-ISSN perl-CDB_File perl-CDDB perl-CDDB_get	perl-CGI-Application perl-CGI-Application-Plugin-QueryHash	perl-CGI-Debug perl-CGI-FastTemplate perl-CGI-Lite	perl-CGI-Log perl-CGI-Out perl-CGI-Response perl-CGI-Screen	perl-CGI-SpeedyCGI perl-CGI-Untaint perl-CGI-Upload	perl-CGI-Validate perl-CGI-WeT perl-CGI-Widget perl-CGI-XML	perl-CGI-XMLForm perl-CORBA-IOP-IOR perl-CPANPLUS	perl-Cache-Cache perl-Cache-Mmap perl-Carp-Assert-More	perl-Catalyst-Model-NetBlogger perl-Catalyst-Model-SVN	perl-Catalyst-Plugin-LogWarnings perl-Catalyst-View-GraphViz	perl-Chart-Plot perl-Chatbot-Eliza perl-Chemistry-File-MDLMol	perl-Chemistry-Mol perl-Class-BlackHole perl-Class-Container	perl-Class-DBI-AbstractSearch perl-Class-Data-Inheritable	perl-Class-Date perl-Class-Eroot perl-Class-ErrorHandler	perl-Class-Fields perl-Class-Hook perl-Class-Inner	perl-Class-Loader perl-Class-MakeMethods	perl-Class-Multimethods perl-Class-Observable	perl-Class-ReturnValue perl-Class-Singleton	perl-Class-Virtual perl-Class-WhiteHole perl-Class-XPath	perl-ClearCase-CRDB perl-Compress-Bzip2 perl-Compress-LZV1	perl-Compress-SelfExtracting perl-Compress-Zlib	perl-Config-Crontab perl-Config-IniFiles perl-Config-Record	perl-Config-Simple perl-Convert-ASCII-Armour perl-Convert-BER	perl-Convert-BinHex perl-Convert-Context perl-Convert-EBCDIC	perl-Convert-GeekCode perl-Convert-IBM390 perl-Convert-SciEng	perl-Convert-TNEF perl-Convert-Translit perl-Convert-UU	perl-Convert-UUlib perl-Crypt-Blowfish perl-Crypt-Blowfish_PP	perl-Crypt-CAST5 perl-Crypt-CAST5_PP perl-Crypt-CBCeasy	perl-Crypt-CFB perl-Crypt-Caesar perl-Crypt-CapnMidNite	perl-Crypt-CipherSaber perl-Crypt-Ctr perl-Crypt-DES	perl-Crypt-DES_EDE3 perl-Crypt-DES_PP perl-Crypt-DH	perl-Crypt-ECB perl-Crypt-Enigma perl-Crypt-GOST	perl-Crypt-GOST_PP perl-Crypt-GeneratePassword	perl-Crypt-HCE_MD5 perl-Crypt-HCE_SHA perl-Crypt-IDEA	perl-Crypt-License perl-Crypt-Memfrob perl-Crypt-Mimetic	perl-Crypt-NULL perl-Crypt-OpenSSL-DSA perl-Crypt-Passwd	perl-Crypt-RC6 perl-Crypt-RandPasswd perl-Crypt-Rot13	perl-Crypt-SKey perl-Crypt-Simple perl-Crypt-Solitaire	perl-Crypt-Twofish perl-Crypt-Twofish2 perl-Crypt-UnixCrypt	perl-Crypt-Vigenere perl-Curses-UI perl-Cwd perl-DBD-AnyData	perl-DBD-CSV perl-DBD-File perl-DBD-XBase perl-DBIx-Abstract	perl-DBIx-AnyDBD perl-DBIx-Cursor perl-Data-Buffer	perl-Data-DRef perl-Data-DumpXML perl-Data-PropertyList	perl-Data-Rmap perl-Date-Easter perl-Date-Holidays-DK	perl-Date-Leapyear perl-Date-Tie perl-Date-Tolkien-Shire	perl-DateTime perl-DateTime-Calendar-Christian	perl-DateTime-Calendar-Discordian	perl-DateTime-Calendar-Julian perl-DateTime-Event-Cron	perl-DateTime-Event-Easter perl-DateTime-Event-ICal	perl-DateTime-Event-Random perl-DateTime-Event-Recurrence	perl-DateTime-Event-Sunrise perl-DateTime-Format-Strptime	perl-DateTime-Set perl-DelimMatch perl-Devel-Size	perl-Devel-StackTrace perl-Device-SerialPort	perl-Device-SerialPorts perl-Digest-BubbleBabble	perl-Digest-Elf perl-Digest-MD5-M4p perl-Digest-SHA1	perl-Digest-Tiger perl-GD-Convert perl-GD-SIRDS	perl-Getopt-ExPar perl-Getopt-Long perl-Getopt-Regex	perl-SNMP-Simple perl-SPOPS perl-SQL-Statement	perl-SVG-Metadata perl-Socket6 perl-Statistics-ChiSquare	perl-Statistics-Distributions perl-Statistics-Frequency	perl-Statistics-LTU perl-Statistics-MaxEntropy	perl-Statistics-ROC perl-Storable perl-String-Buffer	perl-String-Similarity perl-String-Strip perl-String-Trigram	perl-Sys-Load perl-Sys-OutPut perl-Sys-Pushd	perl-Template-Plugin-Number-Format perl-Template-Plugin-YAML	perl-Template-Toolkit perl-Term-ReadKey	perl-Test-Builder-Tester perl-Test-Extreme	perl-Text-BasicTemplate perl-Text-CSV_XS	perl-Text-EP3-Verilog perl-Text-ExtractWords perl-Text-FillIn	perl-Text-Filter perl-Text-FixedLength perl-Text-Format	perl-Text-German perl-Text-Glob perl-Text-Graphics	perl-Text-Iconv perl-Text-LineEditor perl-Text-MacroScript	perl-Text-Macros perl-Text-Merge perl-Text-MetaText	perl-Text-Metaphone perl-Text-Number perl-Text-PDF	perl-Text-Quoted perl-Text-Template perl-Text-Thesaurus-ISO	perl-Text-Vpp perl-Text-WikiFormat perl-Text-Wrapper	perl-TextStructured perl-Tie-Array-Sorted perl-Tie-Cache-LRU	perl-Tie-Config perl-Tie-Coupler perl-Tie-DB_Lock	perl-Tie-Dir perl-Tie-FTP perl-Tie-LLHash perl-Tie-Restore	perl-Tie-STDERR perl-Tie-TwoLevelHash perl-Time-Beat	perl-TimeDate perl-Tk-FileDialog perl-Tk-MListbox	perl-Tree-Simple-VisitorFactory perl-UML-Sequence	perl-UNIVERSAL-exports perl-Unicode-CheckUTF8	perl-Unicode-Lite perl-Unicode-Map8 perl-Unicode-MapUTF8	perl-VCS perl-WSDL-Generator perl-WWW-Automate	perl-WWW-Gazetteer-HeavensAbove perl-WWW-Google-Video	perl-WWW-Poll perl-WWW-Shorten-KUSO	perl-WebService-SyncSBS-D2H perl-X11-Keyboard	perl-X11-SendEvent perl-XML-DOM perl-XML-DOM-BagOfTricks	perl-XML-DOMHandler perl-XML-Filter-BufferText	perl-XML-Generator perl-XML-Handler-YAWriter	perl-XML-NamespaceSupport perl-XML-Parser-EasyTree	perl-XML-QL perl-XML-RAI-TrackBack perl-XML-RSS-Parser	perl-XML-RSS-SimpleGen perl-XML-RSS-TimingBot perl-XML-RegExp	perl-XML-Registry perl-XML-SAX-Writer perl-XML-XPath	perl-XML-XSLT perl-XMLNews-HTMLTemplate perl-YAML-ConfigFile
</A></li>
        <LI>Next message: <A HREF="004324.html">[svn] r5525 - in trunk/rpms: perl-Algorithm-Diff	perl-Apache-Session-Wrapper perl-Compress-LZF perl-Crypt-Lite	perl-DBD-SQLite perl-Data-Table perl-Module-Find	perl-Net-DNS-Codes perl-POE-Component-Client-NNTP	perl-POE-Component-Server-Echo perl-POE-Filter-LZF	perl-POE-Filter-LZO perl-Tie-RegexpHash perl-URI-Find
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4323">[ date ]</a>
              <a href="thread.html#4323">[ thread ]</a>
              <a href="subject.html#4323">[ subject ]</a>
              <a href="author.html#4323">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: dag
Date: 2007-06-18 12:07:06 +0200 (Mon, 18 Jun 2007)
New Revision: 5524

Modified:
   trunk/tools/unoconv/TODO
   trunk/tools/unoconv/unoconv
Log:
Improvements to error output.

Modified: trunk/tools/unoconv/TODO
===================================================================
--- trunk/tools/unoconv/TODO	2007-06-17 22:03:51 UTC (rev 5523)
+++ trunk/tools/unoconv/TODO	2007-06-18 10:07:06 UTC (rev 5524)
@@ -13,6 +13,7 @@
 ### Usability
 - Start OpenOffice automatically to assist conversion and then stop
 - Maybe change the commandline interface to reflect ImageMagick's convert
+- Add the list of input formats as well, and print that list too
 
 ### Documentation
 - Add manpage

Modified: trunk/tools/unoconv/unoconv
===================================================================
--- trunk/tools/unoconv/unoconv	2007-06-17 22:03:51 UTC (rev 5523)
+++ trunk/tools/unoconv/unoconv	2007-06-18 10:07:06 UTC (rev 5524)
@@ -40,7 +40,7 @@
 __version__ = &quot;$Revision$&quot;
 # $Source$
 
-VERSION = '0.2'
+VERSION = '0.2svn'
 
 doctypes = ('document', 'graphics', 'presentation', 'spreadsheet')
 
@@ -242,7 +242,7 @@
         self.doctype = None
         self.server = 'localhost'
         self.port = '2002'
-        self.connection = &quot;uno:socket,host=%s,port=%s;urp;StarOffice.ComponentContext&quot; % (self.server, self.port)
+        self.connection = &quot;socket,host=%s,port=%s;urp;StarOffice.ComponentContext&quot; % (self.server, self.port)
         self.filenames = []
 
         ### Get options from the commandline
@@ -343,7 +343,7 @@
     def __init__(self):
         context = uno.getComponentContext()
         resolver = context.ServiceManager.createInstanceWithContext(&quot;com.sun.star.bridge.UnoUrlResolver&quot;, context)
-        unocontext = resolver.resolve(op.connection)
+        unocontext = resolver.resolve(&quot;uno:%s&quot; % op.connection)
         unosvcmgr = unocontext.ServiceManager
     
         self.desktop = unosvcmgr.createInstanceWithContext(&quot;com.sun.star.frame.Desktop&quot;, unocontext)
@@ -463,7 +463,11 @@
      
     except NoConnectException, e:
         print &gt;&gt;sys.stderr, &quot;unoconv: could not find an existing connection to Open Office at %s:%s.&quot; % (op.server, op.port)
-        print &gt;&gt;sys.stderr, &quot;Please start an ooffice instance by doing:\n    ooffice -headless -accept=\&quot;socket,host=%s,port=%s;urp;\&quot;&quot; % (op.server, op.port)
+        print &gt;&gt;sys.stderr
+        if op.connection:
+            print &gt;&gt;sys.stderr, &quot;Please start an ooffice instance on server '%s' by doing:\n\n    ooffice -headless -accept=\&quot;%s\&quot;&quot; % (op.server, op.connection)
+        else:
+            print &gt;&gt;sys.stderr, &quot;Please start an ooffice instance on server '%s' by doing:\n\n    ooffice -headless -accept=\&quot;socket,host=localhost,port=%s;urp;\&quot;&quot; % (op.server, op.port)
         exitcode = 1
     
 ### Main entrance


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004322.html">[svn] r5523 - in trunk/rpms: perl-AI-DecisionTree perl-AI-Fuzzy	perl-AI-Gene-Sequence perl-AI-Menu perl-AI-NeuralNet-BackProp	perl-AOL-TOC perl-Algorithm-Permute perl-Alias perl-AnyData	perl-Apache-Admin-Config perl-Apache-DBI perl-Apache-ParseLog	perl-Apache-Session-SharedMem perl-Apache-SessionManager	perl-Apache-SimpleTemplate perl-Array-Lookup	perl-Array-PrintCols perl-Array-Reform perl-Array-Unique	perl-Attribute-Handlers-Prospective perl-Attribute-Persistent	perl-Attribute-Protected perl-Audio perl-Audio-DSP	perl-Audio-ESD perl-Audio-Mixer perl-Audio-OSS	perl-Audio-Play-MPG123 perl-Audio-Wav	perl-Authen-Challenge-Basic perl-Authen-NTLM perl-Authen-PAM	perl-Authen-Smb perl-B-Graph perl-BSD-Resource	perl-Bit-ShiftReg perl-Bit-Vector-Minimal perl-Business-ISBN	perl-Business-ISSN perl-CDB_File perl-CDDB perl-CDDB_get	perl-CGI-Application perl-CGI-Application-Plugin-QueryHash	perl-CGI-Debug perl-CGI-FastTemplate perl-CGI-Lite	perl-CGI-Log perl-CGI-Out perl-CGI-Response perl-CGI-Screen	perl-CGI-SpeedyCGI perl-CGI-Untaint perl-CGI-Upload	perl-CGI-Validate perl-CGI-WeT perl-CGI-Widget perl-CGI-XML	perl-CGI-XMLForm perl-CORBA-IOP-IOR perl-CPANPLUS	perl-Cache-Cache perl-Cache-Mmap perl-Carp-Assert-More	perl-Catalyst-Model-NetBlogger perl-Catalyst-Model-SVN	perl-Catalyst-Plugin-LogWarnings perl-Catalyst-View-GraphViz	perl-Chart-Plot perl-Chatbot-Eliza perl-Chemistry-File-MDLMol	perl-Chemistry-Mol perl-Class-BlackHole perl-Class-Container	perl-Class-DBI-AbstractSearch perl-Class-Data-Inheritable	perl-Class-Date perl-Class-Eroot perl-Class-ErrorHandler	perl-Class-Fields perl-Class-Hook perl-Class-Inner	perl-Class-Loader perl-Class-MakeMethods	perl-Class-Multimethods perl-Class-Observable	perl-Class-ReturnValue perl-Class-Singleton	perl-Class-Virtual perl-Class-WhiteHole perl-Class-XPath	perl-ClearCase-CRDB perl-Compress-Bzip2 perl-Compress-LZV1	perl-Compress-SelfExtracting perl-Compress-Zlib	perl-Config-Crontab perl-Config-IniFiles perl-Config-Record	perl-Config-Simple perl-Convert-ASCII-Armour perl-Convert-BER	perl-Convert-BinHex perl-Convert-Context perl-Convert-EBCDIC	perl-Convert-GeekCode perl-Convert-IBM390 perl-Convert-SciEng	perl-Convert-TNEF perl-Convert-Translit perl-Convert-UU	perl-Convert-UUlib perl-Crypt-Blowfish perl-Crypt-Blowfish_PP	perl-Crypt-CAST5 perl-Crypt-CAST5_PP perl-Crypt-CBCeasy	perl-Crypt-CFB perl-Crypt-Caesar perl-Crypt-CapnMidNite	perl-Crypt-CipherSaber perl-Crypt-Ctr perl-Crypt-DES	perl-Crypt-DES_EDE3 perl-Crypt-DES_PP perl-Crypt-DH	perl-Crypt-ECB perl-Crypt-Enigma perl-Crypt-GOST	perl-Crypt-GOST_PP perl-Crypt-GeneratePassword	perl-Crypt-HCE_MD5 perl-Crypt-HCE_SHA perl-Crypt-IDEA	perl-Crypt-License perl-Crypt-Memfrob perl-Crypt-Mimetic	perl-Crypt-NULL perl-Crypt-OpenSSL-DSA perl-Crypt-Passwd	perl-Crypt-RC6 perl-Crypt-RandPasswd perl-Crypt-Rot13	perl-Crypt-SKey perl-Crypt-Simple perl-Crypt-Solitaire	perl-Crypt-Twofish perl-Crypt-Twofish2 perl-Crypt-UnixCrypt	perl-Crypt-Vigenere perl-Curses-UI perl-Cwd perl-DBD-AnyData	perl-DBD-CSV perl-DBD-File perl-DBD-XBase perl-DBIx-Abstract	perl-DBIx-AnyDBD perl-DBIx-Cursor perl-Data-Buffer	perl-Data-DRef perl-Data-DumpXML perl-Data-PropertyList	perl-Data-Rmap perl-Date-Easter perl-Date-Holidays-DK	perl-Date-Leapyear perl-Date-Tie perl-Date-Tolkien-Shire	perl-DateTime perl-DateTime-Calendar-Christian	perl-DateTime-Calendar-Discordian	perl-DateTime-Calendar-Julian perl-DateTime-Event-Cron	perl-DateTime-Event-Easter perl-DateTime-Event-ICal	perl-DateTime-Event-Random perl-DateTime-Event-Recurrence	perl-DateTime-Event-Sunrise perl-DateTime-Format-Strptime	perl-DateTime-Set perl-DelimMatch perl-Devel-Size	perl-Devel-StackTrace perl-Device-SerialPort	perl-Device-SerialPorts perl-Digest-BubbleBabble	perl-Digest-Elf perl-Digest-MD5-M4p perl-Digest-SHA1	perl-Digest-Tiger perl-GD-Convert perl-GD-SIRDS	perl-Getopt-ExPar perl-Getopt-Long perl-Getopt-Regex	perl-SNMP-Simple perl-SPOPS perl-SQL-Statement	perl-SVG-Metadata perl-Socket6 perl-Statistics-ChiSquare	perl-Statistics-Distributions perl-Statistics-Frequency	perl-Statistics-LTU perl-Statistics-MaxEntropy	perl-Statistics-ROC perl-Storable perl-String-Buffer	perl-String-Similarity perl-String-Strip perl-String-Trigram	perl-Sys-Load perl-Sys-OutPut perl-Sys-Pushd	perl-Template-Plugin-Number-Format perl-Template-Plugin-YAML	perl-Template-Toolkit perl-Term-ReadKey	perl-Test-Builder-Tester perl-Test-Extreme	perl-Text-BasicTemplate perl-Text-CSV_XS	perl-Text-EP3-Verilog perl-Text-ExtractWords perl-Text-FillIn	perl-Text-Filter perl-Text-FixedLength perl-Text-Format	perl-Text-German perl-Text-Glob perl-Text-Graphics	perl-Text-Iconv perl-Text-LineEditor perl-Text-MacroScript	perl-Text-Macros perl-Text-Merge perl-Text-MetaText	perl-Text-Metaphone perl-Text-Number perl-Text-PDF	perl-Text-Quoted perl-Text-Template perl-Text-Thesaurus-ISO	perl-Text-Vpp perl-Text-WikiFormat perl-Text-Wrapper	perl-TextStructured perl-Tie-Array-Sorted perl-Tie-Cache-LRU	perl-Tie-Config perl-Tie-Coupler perl-Tie-DB_Lock	perl-Tie-Dir perl-Tie-FTP perl-Tie-LLHash perl-Tie-Restore	perl-Tie-STDERR perl-Tie-TwoLevelHash perl-Time-Beat	perl-TimeDate perl-Tk-FileDialog perl-Tk-MListbox	perl-Tree-Simple-VisitorFactory perl-UML-Sequence	perl-UNIVERSAL-exports perl-Unicode-CheckUTF8	perl-Unicode-Lite perl-Unicode-Map8 perl-Unicode-MapUTF8	perl-VCS perl-WSDL-Generator perl-WWW-Automate	perl-WWW-Gazetteer-HeavensAbove perl-WWW-Google-Video	perl-WWW-Poll perl-WWW-Shorten-KUSO	perl-WebService-SyncSBS-D2H perl-X11-Keyboard	perl-X11-SendEvent perl-XML-DOM perl-XML-DOM-BagOfTricks	perl-XML-DOMHandler perl-XML-Filter-BufferText	perl-XML-Generator perl-XML-Handler-YAWriter	perl-XML-NamespaceSupport perl-XML-Parser-EasyTree	perl-XML-QL perl-XML-RAI-TrackBack perl-XML-RSS-Parser	perl-XML-RSS-SimpleGen perl-XML-RSS-TimingBot perl-XML-RegExp	perl-XML-Registry perl-XML-SAX-Writer perl-XML-XPath	perl-XML-XSLT perl-XMLNews-HTMLTemplate perl-YAML-ConfigFile
</A></li>
	<LI>Next message: <A HREF="004324.html">[svn] r5525 - in trunk/rpms: perl-Algorithm-Diff	perl-Apache-Session-Wrapper perl-Compress-LZF perl-Crypt-Lite	perl-DBD-SQLite perl-Data-Table perl-Module-Find	perl-Net-DNS-Codes perl-POE-Component-Client-NNTP	perl-POE-Component-Server-Echo perl-POE-Filter-LZF	perl-POE-Filter-LZO perl-Tie-RegexpHash perl-URI-Find
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4323">[ date ]</a>
              <a href="thread.html#4323">[ thread ]</a>
              <a href="subject.html#4323">[ subject ]</a>
              <a href="author.html#4323">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.repoforge.org/mailman/listinfo/commits">More information about the commits
mailing list</a><br>
</body></html>
