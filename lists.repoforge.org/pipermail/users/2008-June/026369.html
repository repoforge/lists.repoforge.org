<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [users] nvidia-x11-drv, CentOS 5.1-&gt;5.2
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:users%40lists.repoforge.org?Subject=Re:%20Re%3A%20%5Busers%5D%20nvidia-x11-drv%2C%20CentOS%205.1-%3E5.2&In-Reply-To=%3C486615EE.3090209%40imag.fr%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="026366.html">
   <LINK REL="Next"  HREF="026375.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[users] nvidia-x11-drv, CentOS 5.1-&gt;5.2</H1>
    <B>Nicolas Thierry-Mieg</B> 
    <A HREF="mailto:users%40lists.repoforge.org?Subject=Re:%20Re%3A%20%5Busers%5D%20nvidia-x11-drv%2C%20CentOS%205.1-%3E5.2&In-Reply-To=%3C486615EE.3090209%40imag.fr%3E"
       TITLE="[users] nvidia-x11-drv, CentOS 5.1-&gt;5.2">Nicolas.Thierry-Mieg at imag.fr
       </A><BR>
    <I>Sat Jun 28 12:43:58 CEST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="026366.html">[users] nvidia-x11-drv, CentOS 5.1-&gt;5.2
</A></li>
        <LI>Next message: <A HREF="026375.html">[users] nvidia-x11-drv, CentOS 5.1-&gt;5.2
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26369">[ date ]</a>
              <a href="thread.html#26369">[ thread ]</a>
              <a href="subject.html#26369">[ subject ]</a>
              <a href="author.html#26369">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>

Dag Wieers wrote:
&gt;<i> On Wed, 25 Jun 2008, Se&#225;n O Sullivan wrote:
</I>&gt;<i> 
</I>&gt;&gt;<i> I noticed some odd issues with nvidia-x11-drv 173.08-1.beta.el5.rf
</I>&gt;&gt;<i> while upgrading from CentOS 5.1 -&gt; 5.2 (x86).
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> It occurred on three machines, all AMD (Athlon(tm) 64 X2 Dual Core
</I>&gt;&gt;<i> Processor 3800+,  Opteron(tm) Processor 246).
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> When the nvidia.ko module was being loaded the machine would stop
</I>&gt;&gt;<i> responding &amp; require a hard reboot.
</I>&gt;&gt;<i> Resolved by removing &amp; reinstalling nvidia-x11-drv.
</I>&gt;&gt;<i> Seemingly when the upgrade happened, an nvidia.ko symlink was placed
</I>&gt;&gt;<i> in /lib/modules/2.6.18-92.1.1.el5/weak-updates/ pointing to the .ko
</I>&gt;&gt;<i> in /lib/modules/2.6.18-53.1.21.el5/weak-updates/
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> When did reinstall &amp; ran /etc/init.d/dkms_autoinstaller nvidia.ko was
</I>&gt;&gt;<i> placed in /lib/modules/2.6.18-92.1.1.el5/extra
</I>&gt;<i> 
</I>&gt;<i> Hi Sean,
</I>&gt;<i> 
</I>&gt;<i> Do you mean that the weak-module was unstable, but a re-compiled module 
</I>&gt;<i> did not have a problem at all ?
</I>

Adding my 2c, I think that's correct (replace &quot;unstable&quot; by &quot;broken&quot;, 
this is the &quot;black screen &amp; lockup at rhgb&quot; many people have been 
talking about on the centos list).

I also hit this when I upgraded a workstation to 5.2 yesterday.
I solved it by rebooting under my older kernel and using dkms commands 
(status, remove, build, install, rinse and repeat...).
I guess uninstalling and reinstalling the rpm does the same to dkms.

I don't know dkms well, but the problem seems to be that when installing 
a newer kernel, a weak-updates/ link is automatically created to the 
previously built module. Then when you reboot, dkms_autoinstall is 
supposed to build the module for the new kernel. But it doesn't do 
anything because it sees the weak-updates version, and thinks this is 
good enough.
This doesn't usually pose problems in centos/rhel, because the kernels 
are so similar.
But from 5.1 to 5.2 there was enough difference in the kernel interface 
that the nvidia driver compiled for the 5.1 kernel didn't work with the 
5.2 kernel.



&gt;<i> If so, I think that needs to be reported to dkms. I do not influence the 
</I>&gt;<i> weak-linking behaviour, but if some assumption is wrong from the 
</I>&gt;<i> technical angle, it should probably be disabled.
</I>&gt;<i> 
</I>
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="026366.html">[users] nvidia-x11-drv, CentOS 5.1-&gt;5.2
</A></li>
	<LI>Next message: <A HREF="026375.html">[users] nvidia-x11-drv, CentOS 5.1-&gt;5.2
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26369">[ date ]</a>
              <a href="thread.html#26369">[ thread ]</a>
              <a href="subject.html#26369">[ subject ]</a>
              <a href="author.html#26369">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.repoforge.org/mailman/listinfo/users">More information about the users
mailing list</a><br>
</body></html>
