<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [suggest] colordiff added to repo
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:users%40lists.repoforge.org?Subject=Re:%20Re%3A%20%5Bsuggest%5D%20colordiff%20added%20to%20repo&In-Reply-To=%3C20071116234320.M23623%40npgx.com.au%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="023307.html">
   <LINK REL="Next"  HREF="025881.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[suggest] colordiff added to repo</H1>
    <B>Michael Mansour</B> 
    <A HREF="mailto:users%40lists.repoforge.org?Subject=Re:%20Re%3A%20%5Bsuggest%5D%20colordiff%20added%20to%20repo&In-Reply-To=%3C20071116234320.M23623%40npgx.com.au%3E"
       TITLE="[suggest] colordiff added to repo">mic at npgx.com.au
       </A><BR>
    <I>Sat Nov 17 00:55:30 CET 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="023307.html">[suggest] colordiff added to repo
</A></li>
        <LI>Next message: <A HREF="025881.html">[users] Perl package update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23308">[ date ]</a>
              <a href="thread.html#23308">[ thread ]</a>
              <a href="subject.html#23308">[ subject ]</a>
              <a href="author.html#23308">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Dag,

&gt;<i> On Sat, 17 Nov 2007, Michael Mansour wrote:
</I>&gt;<i> 
</I>&gt;<i> &gt; Could colordiff:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; <A HREF="http://colordiff.sourceforge.net/">http://colordiff.sourceforge.net/</A>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; please be added to the repo? as you have cdiff (which I can't get to work at
</I>&gt;<i> &gt; all) and colordiff pulled from Fedora (I use SL4.5 so need the FC5 RPM):
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; <A HREF="http://download.fedora.redhat.com/pub/fedora/linux/extras/5/i386/">http://download.fedora.redhat.com/pub/fedora/linux/extras/5/i386/</A>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; works fine and contains cdiff already:
</I>&gt;<i> 
</I>&gt;<i> cdiff colors the output from diff, so it is not a diff tool, it 
</I>&gt;<i> colors the output.
</I>&gt;<i> 
</I>&gt;<i> 	diff -u filea.txt fileb.txt | cdiff
</I>
I tried the above and it works fine (the output is actually easier to follow
than colordiff). 

All colordiff eseentially does is give exactly the same diff output but in
colour, while cdiff does some re-ordering with colours.

BTW, I read the man page several times to try and figure out how to use cdiff,
it can really use an &quot;EXAMPLES&quot; section in the man page.

&gt;<i> &gt; # rpm -ql colordiff
</I>&gt;<i> &gt; /etc/colordiffrc
</I>&gt;<i> &gt; /usr/bin/cdiff
</I>&gt;<i> &gt; /usr/bin/colordiff
</I>&gt;<i> &gt; /usr/share/doc/colordiff-1.0.5
</I>&gt;<i> &gt; /usr/share/doc/colordiff-1.0.5/BUGS
</I>&gt;<i> &gt; /usr/share/doc/colordiff-1.0.5/CHANGES
</I>&gt;<i> &gt; /usr/share/doc/colordiff-1.0.5/COPYING
</I>&gt;<i> &gt; /usr/share/doc/colordiff-1.0.5/README
</I>&gt;<i> &gt; /usr/share/doc/colordiff-1.0.5/colordiffrc-darkbg
</I>&gt;<i> &gt; /usr/share/doc/colordiff-1.0.5/colordiffrc-lightbg
</I>&gt;<i> &gt; /usr/share/man/man1/colordiff.1.gz
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Fedora 8 has colordiff as part of it's package collection now, but this is so
</I>&gt;<i> &gt; useful it would be ideal to have it for el3, el4, el5.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Much appreciated.
</I>&gt;<i> 
</I>&gt;<i> I think so too that it would be useful, but given the fact that cdiff
</I>&gt;<i> already is packaged in package 'cdiff' and I don't want to risk any future
</I>&gt;<i> conflicts on this one, I prefer not to package it.
</I>
You're right, since trying to install colordiff over cdiff gives:

# rpm -Uvh colordiff-1.0.5-1.noarch.rpm
warning: colordiff-1.0.5-1.noarch.rpm: V3 DSA signature: NOKEY, key ID 1ac70ce6
Preparing...                ########################################### [100%]
        file /usr/bin/cdiff from install of colordiff-1.0.5-1 conflicts with
file from package cdiff-1.5-1.el4.rf

But it would also make sense that if colordiff contains both cdiff and
colordiff (and since Fedora 8 has colordiff in place, which would cause
problems for people that try and grab cdiff from rpmforge), that you could
deprecate the cdiff package from your repo.

&gt;<i> Can you make a comparison of cdiff from the cdiff package and this 
</I>&gt;<i> new one ? It seems to be configurable (and probably has more options 
</I>&gt;<i> too.
</I>
The header of the cdiff contained in the colordiff RPM contains:

# Copyright (C) 2003-2004 Ville Skytt&#195;&#164; &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/users">ville.skytta at iki.fi</A>&gt;
# Based on cdiff version 1.4 by <A HREF="http://lists.repoforge.org/mailman/listinfo/users">eivind at FreeBSD.org</A>

So the colordiff author has taken cdiff and updated it

I have successfully used:

 	diff -u filea.txt fileb.txt | cdiff

on both the original cdiff and &quot;colordiff's cdiff&quot; and they both produce the
same output.

The content of each follows.

cdiff from the cdiff RPM in your repo:

# cat cdiff.first
#!/bin/sh
if [ &quot;$1&quot; = &quot;-m&quot; ]; then
        shift;
        CODES=&quot;4:7:1:1&quot;
else
        if [ &quot;$CDIFFCOLORS&quot; != &quot;&quot; ]; then
                CODES=$CDIFFCOLORS
        else
                CODES=&quot;1:34:31:35&quot;
        fi
fi
(if [ &quot;$1&quot; != &quot;&quot; ]; then
    while [ &quot;$1&quot; != &quot;&quot; ]; do
        case $1 in
        *.bz2)
            cat=&quot;bzcat&quot;
            ;;
        *)
            cat=&quot;zcat -f&quot;
            ;;
        esac
        case $1 in
        http:*|https:*|ftp:*|file:*)
            if [ -z &quot;$CDIFF_FETCH&quot; ]; then
                # Wget doesn't do <A HREF="file://">file://</A> URLs... :(
                if which curl &gt;/dev/null 2&gt;&amp;1; then
                    CDIFF_FETCH=&quot;curl -s&quot;
                elif which lwp-request &gt;/dev/null 2&gt;&amp;1; then
                    CDIFF_FETCH=&quot;lwp-request -m GET&quot;
                fi
                if [ -z &quot;$CDIFF_FETCH&quot; ]; then
                    echo &quot;Error: no program to fetch from URLs found.&quot;
                    exit 1
                fi
            fi
            $CDIFF_FETCH $1 | $cat
            ;;
        *)
            $cat $1
            ;;
        esac
        shift;
    done
else
        cat
fi) | perl -p -mconstant=CODES,${CODES} -e '
no warnings qw(utf8);
($at, $m, $p, $c) = split /:/, CODES;
while (s/\t/&quot; &quot; x (8 - ((length($`)-1) % 8))/e) {}
s/^(\+.*)$/\033[${p}m$1\033[0m/o;
s/^(-.*)$/\033[${m}m$1\033[0m/o
        if !s/^(--- \d+,\d+ ----.*)$/\033[1m$1\033[0m/o;
s/^(\*\*\* \d+,\d+ *\*\*\*.*)$/\033[1m$1\033[0m/o;
s/^(\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*)$/\033[1m$1\033[0m/o;
s/^(!.*)$/\033[${c}m$1\033[0m/o;
s/^(@@.*$)/\033[${at}m$1\033[0m/o;
if (/^1.(\d+)(\s+\(\w+\s+\d{2}-\w{3}-\d{2}\):\s)(.*)/) {
        $lastcol = $lastcol || 0;
        $lastcol++ if defined($lastrev) &amp;&amp; $lastrev != $1;
        $lastrev = $1;
        $lastcol %= 6;
        $_ = &quot;\033[3&quot; . ($lastcol + 1) . &quot;m1.$1$2\033[0m$3\n&quot;;
}
' | less -R

cdiff from the colordiff RPM (from FC5 - Fedora 8 may have a more updated one):

# cat cdiff
#!/bin/sh

# cdiff.sh - Convenience wrapper for colordiff
#
# Copyright (C) 2003-2004 Ville Skytt&#195;&#164; &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/users">ville.skytta at iki.fi</A>&gt;
# Based on cdiff version 1.4 by <A HREF="http://lists.repoforge.org/mailman/listinfo/users">eivind at FreeBSD.org</A>
#
# This program is free software; you can redistribute it and/or
# modify it under the terms of the GNU General Public License
# as published by the Free Software Foundation; either version 2
# of the License, or (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program; if not, write to the Free Software
# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.

(if [ &quot;$1&quot; != &quot;&quot; ]; then
    while [ &quot;$1&quot; != &quot;&quot; ]; do
        file=`echo &quot;$1&quot; | perl -pe 's|^file:/+|/|i'`
        case &quot;$file&quot; in
        *.bz2)
            cat=&quot;bzcat&quot;
            ;;
        *)
            cat=&quot;zcat -f&quot;
            ;;
        esac
        case `echo &quot;$file&quot; | perl -ne 'print lc $_'` in
        http:*|https:*|ftp:*)
            if [ -z &quot;$CDIFF_FETCH&quot; ]; then
                if which wget &gt;/dev/null 2&gt;&amp;1; then
                    CDIFF_FETCH=&quot;wget -qO -&quot;
                elif which curl &gt;/dev/null 2&gt;&amp;1; then
                    CDIFF_FETCH=&quot;curl -s&quot;
                elif which lwp-request &gt;/dev/null 2&gt;&amp;1; then
                    CDIFF_FETCH=&quot;lwp-request -m GET&quot;
                elif which lynx &gt;/dev/null 2&gt;&amp;1; then
                    CDIFF_FETCH=&quot;lynx -source&quot;
                elif which elinks &gt;/dev/null 2&gt;&amp;1; then
                    CDIFF_FETCH=&quot;elinks -source&quot;
                fi
                if [ -z &quot;$CDIFF_FETCH&quot; ]; then
                    echo &quot;Error: no program to fetch from URLs found.&quot;
                    exit 1
                fi
            fi
            $CDIFF_FETCH &quot;$file&quot; | $cat
            ;;
        *)
            $cat &quot;$file&quot;
            ;;
        esac
        shift;
    done
else
    cat
fi) | colordiff | less -R

I also like the fact that when using the colordiff RPM, I have a choice to use
either cdiff or colordiff.

Regards,

Michael.

&gt;<i> -- 
</I>&gt;<i> --   dag wieers,  <A HREF="http://lists.repoforge.org/mailman/listinfo/users">dag at wieers.com</A>,  <A HREF="http://dag.wieers.com/">http://dag.wieers.com/</A>   --
</I>&gt;<i> [Any errors in spelling, tact or fact are transmission errors]
</I>------- End of Original Message -------


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="023307.html">[suggest] colordiff added to repo
</A></li>
	<LI>Next message: <A HREF="025881.html">[users] Perl package update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23308">[ date ]</a>
              <a href="thread.html#23308">[ thread ]</a>
              <a href="subject.html#23308">[ subject ]</a>
              <a href="author.html#23308">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.repoforge.org/mailman/listinfo/users">More information about the users
mailing list</a><br>
</body></html>
