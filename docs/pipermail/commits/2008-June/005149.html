<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [svn] r6350 - in branches/rpms/brian: . i386-pc-minix-binutils	i386-pc-minix-gcc-static noarch-novendor-nosystem-binutils	noarch-novendor-nosystem-gcc noarch-novendor-nosystem-glibc	noarch-novendor-nosystem-linux-kernel-headers
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:commits%40lists.repoforge.org?Subject=Re:%20Re%3A%20%5Bsvn%5D%20r6350%20-%20in%20branches/rpms/brian%3A%20.%20i386-pc-minix-binutils%0A%09i386-pc-minix-gcc-static%20noarch-novendor-nosystem-binutils%0A%09noarch-novendor-nosystem-gcc%20noarch-novendor-nosystem-glibc%0A%09noarch-novendor-nosystem-linux-kernel-headers&In-Reply-To=%3C200806092318.m59NIRgi017115%40surya.karan.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005148.html">
   <LINK REL="Next"  HREF="005150.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[svn] r6350 - in branches/rpms/brian: . i386-pc-minix-binutils	i386-pc-minix-gcc-static noarch-novendor-nosystem-binutils	noarch-novendor-nosystem-gcc noarch-novendor-nosystem-glibc	noarch-novendor-nosystem-linux-kernel-headers</H1>
    <B>packagers at lists.rpmforge.net</B> 
    <A HREF="mailto:commits%40lists.repoforge.org?Subject=Re:%20Re%3A%20%5Bsvn%5D%20r6350%20-%20in%20branches/rpms/brian%3A%20.%20i386-pc-minix-binutils%0A%09i386-pc-minix-gcc-static%20noarch-novendor-nosystem-binutils%0A%09noarch-novendor-nosystem-gcc%20noarch-novendor-nosystem-glibc%0A%09noarch-novendor-nosystem-linux-kernel-headers&In-Reply-To=%3C200806092318.m59NIRgi017115%40surya.karan.org%3E"
       TITLE="[svn] r6350 - in branches/rpms/brian: . i386-pc-minix-binutils	i386-pc-minix-gcc-static noarch-novendor-nosystem-binutils	noarch-novendor-nosystem-gcc noarch-novendor-nosystem-glibc	noarch-novendor-nosystem-linux-kernel-headers">packagers at lists.rpmforge.net
       </A><BR>
    <I>Tue Jun 10 01:18:27 CEST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="005148.html">[svn] r6349 - in branches/rpms/brian: . LBRC dkms-golden	dkms-linuxdvb dkms-openafs-kernel dkms-qc-usb dkms-sundance	dkms-truecrypt dkms-wis-go7007-linux dvb-apps libdvb novi	nozomi opencv player pybluez python-json stage thinkfinger	tsrpm vdr vdr-analogtv vdr-burn vdr-clock vdr-dvd vdr-femon	vdr-ffnetdev vdr-freecell vdr-mp3 vdr-osdteletext	vdr-reelchannelscan vdr-remote vdr-screenshot vdr-skinelchi	vdr-skinreel vdr-skins vdr-skinsoppalusikka vdr-softdevice	vdr-streamdev vdr-subtitles vdr-sudoku vdr-text2skin	vdr-timeline vdr-vdrrip vdr-wapd vdr-weather vdr-xine	vdradmin-am vdrsync xine xine-lib xournal
</A></li>
        <LI>Next message: <A HREF="005150.html">[svn] r6351 - in trunk/rpms: dirac ffe libgc smb4k
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5149">[ date ]</a>
              <a href="thread.html#5149">[ thread ]</a>
              <a href="subject.html#5149">[ subject ]</a>
              <a href="author.html#5149">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: bschueler
Date: 2008-06-10 00:18:27 +0100 (Tue, 10 Jun 2008)
New Revision: 6350

Added:
   branches/rpms/brian/i386-pc-minix-binutils/
   branches/rpms/brian/i386-pc-minix-binutils/README-binutils.fedora
   branches/rpms/brian/i386-pc-minix-binutils/binutils-2.16-posix-1.patch
   branches/rpms/brian/i386-pc-minix-binutils/binutils-2.16.1-build-fixes.patch
   branches/rpms/brian/i386-pc-minix-binutils/binutils-2.16.1-elfvsb-test.patch
   branches/rpms/brian/i386-pc-minix-binutils/binutils-2.16.1-ltconfig-multilib.patch
   branches/rpms/brian/i386-pc-minix-binutils/binutils-2.16.1-place-orphan.patch
   branches/rpms/brian/i386-pc-minix-binutils/cross-binutils.spec
   branches/rpms/brian/i386-pc-minix-gcc-static/
   branches/rpms/brian/i386-pc-minix-gcc-static/README-gcc.fedora
   branches/rpms/brian/i386-pc-minix-gcc-static/arm-linux-soft-float.patch
   branches/rpms/brian/i386-pc-minix-gcc-static/cross-gcc.spec
   branches/rpms/brian/i386-pc-minix-gcc-static/gcc-4.1.1-cross_search_paths-1.patch
   branches/rpms/brian/i386-pc-minix-gcc-static/gcc-4.1.1-minix-install.patch
   branches/rpms/brian/i386-pc-minix-gcc-static/gcc-4.1.2-gcc_eh.patch
   branches/rpms/brian/i386-pc-minix-gcc-static/gcc-4.1.2-version.patch
   branches/rpms/brian/i386-pc-minix-gcc-static/gcc40-cross-build-fixes.patch
   branches/rpms/brian/noarch-novendor-nosystem-binutils/
   branches/rpms/brian/noarch-novendor-nosystem-binutils/README-binutils.fedora
   branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17-posix-1.patch
   branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-build-fixes.patch
   branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-bz4267.patch
   branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-elfvsb-test.patch
   branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-fixsyms.patch
   branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-gas-debug-ranges-revert.patch
   branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-ia64-lib64.patch
   branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-kept-section.patch
   branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-ltconfig-multilib.patch
   branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-place-orphan.patch
   branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-popcnt.patch
   branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-power6-insns.patch
   branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-ppc-relbrlt-test.patch
   branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-ppc64-pie.patch
   branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-ppc64-version-script.patch
   branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-rh223181.patch
   branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-rh235221.patch
   branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-rh241252.patch
   branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-sse4.patch
   branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-standards.patch
   branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-target-minix.patch
   branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-tekhex.patch
   branches/rpms/brian/noarch-novendor-nosystem-binutils/cross-binutils.spec
   branches/rpms/brian/noarch-novendor-nosystem-gcc/
   branches/rpms/brian/noarch-novendor-nosystem-gcc/README-gcc.fedora
   branches/rpms/brian/noarch-novendor-nosystem-gcc/arm-linux-soft-float.patch
   branches/rpms/brian/noarch-novendor-nosystem-gcc/cross-gcc.spec
   branches/rpms/brian/noarch-novendor-nosystem-gcc/gcc-4.1.1-cross_search_paths-1.patch
   branches/rpms/brian/noarch-novendor-nosystem-gcc/gcc-4.1.2-gcc_eh.patch
   branches/rpms/brian/noarch-novendor-nosystem-gcc/gcc-4.1.2-version.patch
   branches/rpms/brian/noarch-novendor-nosystem-gcc/gcc40-cross-build-fixes.patch
   branches/rpms/brian/noarch-novendor-nosystem-glibc/
   branches/rpms/brian/noarch-novendor-nosystem-glibc/README-glibc.fedora
   branches/rpms/brian/noarch-novendor-nosystem-glibc/cross-glibc.spec
   branches/rpms/brian/noarch-novendor-nosystem-glibc/glibc-2.5-libgcc_eh-1.patch
   branches/rpms/brian/noarch-novendor-nosystem-glibc/glibc-2.5-localedef_segfault-1.patch
   branches/rpms/brian/noarch-novendor-nosystem-glibc/glibc-2.5-mips_fixes-1.patch
   branches/rpms/brian/noarch-novendor-nosystem-linux-kernel-headers/
   branches/rpms/brian/noarch-novendor-nosystem-linux-kernel-headers/cross-kernel-headers.spec
Log:
Added configurable cross-toolchain generating pseudo specs

Added: branches/rpms/brian/i386-pc-minix-binutils/README-binutils.fedora
===================================================================
--- branches/rpms/brian/i386-pc-minix-binutils/README-binutils.fedora	                        (rev 0)
+++ branches/rpms/brian/i386-pc-minix-binutils/README-binutils.fedora	2008-06-09 23:18:27 UTC (rev 6350)
@@ -0,0 +1,4 @@
+This package does not include the gnu texinfo documentation because this would
+conflict with the native binutils. If you've installed the native binutils,
+you can find the info documentation there, notice that this might be for a
+different version though!

Added: branches/rpms/brian/i386-pc-minix-binutils/binutils-2.16-posix-1.patch
===================================================================
--- branches/rpms/brian/i386-pc-minix-binutils/binutils-2.16-posix-1.patch	                        (rev 0)
+++ branches/rpms/brian/i386-pc-minix-binutils/binutils-2.16-posix-1.patch	2008-06-09 23:18:27 UTC (rev 6350)
@@ -0,0 +1,98 @@
+Submitted By: Jim Gifford (patches at jg555 dot com)
+Date: 2005-05-06
+Initial Package Version: 2.16
+Origin: <A HREF="http://ttervo.vectorstar.net/nptl/posix-patches/binutils-2.14.90.0.7-posix-head-tail.patch">http://ttervo.vectorstar.net/nptl/posix-patches/binutils-2.14.90.0.7-posix-head-tail.patch</A>
+Upstream Status: Accepted/but Suspended
+Description: Makes Posix Compliant
+	     Rediffed against 2.16 by Jeremy Huntwork
+
+diff -Naur binutils-2.16-ORIG/gas/Makefile.am binutils-2.16/gas/Makefile.am
+--- binutils-2.16-ORIG/gas/Makefile.am	2005-03-22 10:31:44.000000000 -0500
++++ binutils-2.16/gas/Makefile.am	2005-05-06 17:08:11.859876859 -0400
+@@ -762,13 +762,13 @@
+ against=stage2
+ 
+ # This rule is derived from corresponding code in the Makefile.in for gcc.
+-# The &quot;tail +16c&quot; is to bypass headers which may include timestamps or
++# The &quot;tail -c +16&quot; is to bypass headers which may include timestamps or
+ # temporary assembly file names.
+ comparison:
+ 	x=0 ; \
+ 	for file in *.o ; do \
+-	  tail +16c ./$$file &gt; tmp-foo1; \
+-	  if tail +16c ${against}/$$file &gt; tmp-foo2 2&gt;/dev/null ; then \
++	  tail -c +16 ./$$file &gt; tmp-foo1; \
++	  if tail -c +16 ${against}/$$file &gt; tmp-foo2 2&gt;/dev/null ; then \
+ 	    if cmp tmp-foo1 tmp-foo2 ; then \
+ 	      true ; \
+ 	    else \
+diff -Naur binutils-2.16-ORIG/gas/Makefile.in binutils-2.16/gas/Makefile.in
+--- binutils-2.16-ORIG/gas/Makefile.in	2005-04-29 09:57:16.000000000 -0400
++++ binutils-2.16/gas/Makefile.in	2005-05-06 17:08:11.868875659 -0400
+@@ -3164,13 +3164,13 @@
+ 	if [ -f stage3/as-new$(EXEEXT) -a ! -f stage3/as$(EXEEXT) ] ; then (cd stage3 ; ln -s as-new as$(EXEEXT)) ; fi
+ 
+ # This rule is derived from corresponding code in the Makefile.in for gcc.
+-# The &quot;tail +16c&quot; is to bypass headers which may include timestamps or
++# The &quot;tail -c +16&quot; is to bypass headers which may include timestamps or
+ # temporary assembly file names.
+ comparison:
+ 	x=0 ; \
+ 	for file in *.o ; do \
+-	  tail +16c ./$$file &gt; tmp-foo1; \
+-	  if tail +16c ${against}/$$file &gt; tmp-foo2 2&gt;/dev/null ; then \
++	  tail -c +16 ./$$file &gt; tmp-foo1; \
++	  if tail -c +16 ${against}/$$file &gt; tmp-foo2 2&gt;/dev/null ; then \
+ 	    if cmp tmp-foo1 tmp-foo2 ; then \
+ 	      true ; \
+ 	    else \
+diff -Naur binutils-2.16-ORIG/ld/testsuite/ld-bootstrap/bootstrap.exp binutils-2.16/ld/testsuite/ld-bootstrap/bootstrap.exp
+--- binutils-2.16-ORIG/ld/testsuite/ld-bootstrap/bootstrap.exp	2005-03-03 06:52:06.000000000 -0500
++++ binutils-2.16/ld/testsuite/ld-bootstrap/bootstrap.exp	2005-05-06 17:08:11.870875393 -0400
+@@ -149,8 +149,8 @@
+         # Although this works, a way to set the date would be better.
+         # Removing or zeroing the date stamp in the binary produced by
+         # the linker is not possible as it is required by the target OS.
+-        exec tail +140 tmpdir/ld2 &gt;tmpdir/ld2tail
+-        exec tail +140 tmpdir/ld3 &gt;tmpdir/ld3tail
++        exec tail -n +140 tmpdir/ld2 &gt;tmpdir/ld2tail
++        exec tail -n +140 tmpdir/ld3 &gt;tmpdir/ld3tail
+         catch &quot;exec cmp tmpdir/ld2tail tmpdir/ld3tail&quot; exec_output
+         exec rm tmpdir/ld2tail tmpdir/ld3tail
+     } else {
+diff -Naur binutils-2.16-ORIG/ltcf-c.sh binutils-2.16/ltcf-c.sh
+--- binutils-2.16-ORIG/ltcf-c.sh	2004-10-05 09:34:42.000000000 -0400
++++ binutils-2.16/ltcf-c.sh	2005-05-06 17:08:11.873874993 -0400
+@@ -153,7 +153,7 @@
+     # If the export-symbols file already is a .def file (1st line
+     # is EXPORTS), use it as is.
+     # If DATA tags from a recent dlltool are present, honour them!
+-    archive_expsym_cmds='if test &quot;x`head -1 $export_symbols`&quot; = xEXPORTS; then
++    archive_expsym_cmds='if test &quot;x`head -n 1 $export_symbols`&quot; = xEXPORTS; then
+         cp $export_symbols $output_objdir/$soname-def;
+       else
+         echo EXPORTS &gt; $output_objdir/$soname-def;
+diff -Naur binutils-2.16-ORIG/ltcf-gcj.sh binutils-2.16/ltcf-gcj.sh
+--- binutils-2.16-ORIG/ltcf-gcj.sh	2004-07-21 15:21:41.000000000 -0400
++++ binutils-2.16/ltcf-gcj.sh	2005-05-06 17:08:11.876874593 -0400
+@@ -156,7 +156,7 @@
+     # If the export-symbols file already is a .def file (1st line
+     # is EXPORTS), use it as is.
+     # If DATA tags from a recent dlltool are present, honour them!
+-    archive_expsym_cmds='if test &quot;x`head -1 $export_symbols`&quot; = xEXPORTS; then
++    archive_expsym_cmds='if test &quot;x`head -n 1 $export_symbols`&quot; = xEXPORTS; then
+         cp $export_symbols $output_objdir/$soname-def;
+       else
+         echo EXPORTS &gt; $output_objdir/$soname-def;
+diff -Naur binutils-2.16-ORIG/src-release binutils-2.16/src-release
+--- binutils-2.16-ORIG/src-release	2004-12-03 05:30:06.000000000 -0500
++++ binutils-2.16/src-release	2005-05-06 17:08:11.878874327 -0400
+@@ -69,7 +69,7 @@
+ 	elif grep AM_INIT_AUTOMAKE $(TOOL)/configure.in &gt;/dev/null 2&gt;&amp;1; then \
+ 	  sed &lt; $(TOOL)/configure.in -n 's/AM_INIT_AUTOMAKE[^,]*, *\([^)]*\))/\1/p'; \
+ 	elif test -f $(TOOL)/version.in; then \
+-	  head -1 $(TOOL)/version.in; \
++	  head -n 1 $(TOOL)/version.in; \
+ 	elif grep VERSION $(TOOL)/Makefile.in &gt; /dev/null 2&gt;&amp;1; then \
+ 	  sed &lt; $(TOOL)/Makefile.in -n 's/^VERSION *= *//p'; \
+ 	else \


Property changes on: branches/rpms/brian/i386-pc-minix-binutils/binutils-2.16-posix-1.patch
___________________________________________________________________
Name: svn:executable
   + *

Added: branches/rpms/brian/i386-pc-minix-binutils/binutils-2.16.1-build-fixes.patch
===================================================================
--- branches/rpms/brian/i386-pc-minix-binutils/binutils-2.16.1-build-fixes.patch	                        (rev 0)
+++ branches/rpms/brian/i386-pc-minix-binutils/binutils-2.16.1-build-fixes.patch	2008-06-09 23:18:27 UTC (rev 6350)
@@ -0,0 +1,29 @@
+2006-02-14  Jakub Jelinek  &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">jakub at redhat.com</A>&gt;
+
+ld/testsuite/
+	* ld-shared/main.c (main): Prevent warnings about unused p.
+	* ld-elfcomm/common1b.c (dummy1): Add __attribute__((__used__)) for
+	GCC 3.3+.
+
+--- ld/testsuite/ld-shared/main.c.jj	2001-07-11 15:48:54.000000000 +0200
++++ ld/testsuite/ld-shared/main.c	2006-02-14 10:07:08.000000000 +0100
+@@ -40,6 +40,8 @@ main ()
+ {
+   int (*p) ();
+ 
++  p = (void *) 0;
++  (void) p;
+   printf (&quot;mainvar == %d\n&quot;, mainvar);
+   printf (&quot;overriddenvar == %d\n&quot;, overriddenvar);
+   printf (&quot;shlibvar1 == %d\n&quot;, shlibvar1);
+--- ld/testsuite/ld-elfcomm/common1b.c.jj	2003-04-15 11:38:10.000000000 +0200
++++ ld/testsuite/ld-elfcomm/common1b.c	2006-02-14 10:11:19.000000000 +0100
+@@ -1,3 +1,7 @@
+-static char dummy1 = 'X';
++static char dummy1
++#if defined __GNUC__ &amp;&amp; (__GNUC__ &gt;= 4 || (__GNUC__ == 3 &amp;&amp; __GNUC_MINOR__ &gt;= 3))
++  __attribute__((__used__))
++#endif
++  = 'X';
+ char foo1 [] = &quot;Aligned at odd byte.&quot;;
+ char foo2 [4];

Added: branches/rpms/brian/i386-pc-minix-binutils/binutils-2.16.1-elfvsb-test.patch
===================================================================
--- branches/rpms/brian/i386-pc-minix-binutils/binutils-2.16.1-elfvsb-test.patch	                        (rev 0)
+++ branches/rpms/brian/i386-pc-minix-binutils/binutils-2.16.1-elfvsb-test.patch	2008-06-09 23:18:27 UTC (rev 6350)
@@ -0,0 +1,85 @@
+2004-08-03  Jakub Jelinek  &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">jakub at redhat.com</A>&gt;
+
+	* ld-elfvsb/sh1.c (overriddenvar, shlib_overriddencall2): If
+	!SHARED, move to...
+	* ld-elfvsb/sh2.c: ... here.
+	* ld-elfvsb/elfvsb.exp: Add -DSHARED to compiler options when building
+	{sh[123],main}.c with $picflag.
+
+--- ld/testsuite/ld-elfvsb/sh1.c.jj	2003-05-05 17:46:50.000000000 -0400
++++ ld/testsuite/ld-elfvsb/sh1.c	2004-08-03 13:15:48.000000000 -0400
+@@ -13,7 +13,11 @@ extern int mainvar;
+ /* This variable is defined in the shared library, and overridden by
+    the main program.  */
+ #ifndef XCOFF_TEST
++#ifdef SHARED
+ int overriddenvar = -1;
++#else
++extern int overriddenvar;
++#endif
+ #endif
+ 
+ /* This variable is defined in the shared library.  */
+@@ -76,12 +80,14 @@ shlib_shlibcall2 ()
+   return shlib_overriddencall2 ();
+ }
+ 
++#ifdef SHARED
+ int
+ shlib_overriddencall2 ()
+ {
+   return 7;
+ }
+ #endif
++#endif
+ 
+ /* This function calls a function defined by the main program.  */
+ 
+--- ld/testsuite/ld-elfvsb/elfvsb.exp.jj	2004-05-27 14:26:05.000000000 -0400
++++ ld/testsuite/ld-elfvsb/elfvsb.exp	2004-08-03 13:13:40.000000000 -0400
+@@ -315,8 +315,8 @@ proc visibility_run {visibility} {
+ 
+ 	# Now compile the code using -fpic.
+ 
+-	if { ![ld_compile &quot;$CC -g $CFLAGS $SHCFLAG $VSBCFLAG $picflag&quot; $srcdir/$subdir/sh1.c $tmpdir/sh1p.o] 
+-	    || ![ld_compile &quot;$CC -g $CFLAGS $SHCFLAG $VSBCFLAG $picflag&quot; $srcdir/$subdir/sh2.c $tmpdir/sh2p.o] } {
++	if { ![ld_compile &quot;$CC -g $CFLAGS $SHCFLAG $VSBCFLAG -DSHARED $picflag&quot; $srcdir/$subdir/sh1.c $tmpdir/sh1p.o] 
++	    || ![ld_compile &quot;$CC -g $CFLAGS $SHCFLAG $VSBCFLAG -DSHARED $picflag&quot; $srcdir/$subdir/sh2.c $tmpdir/sh2p.o] } {
+ 	    unresolved &quot;visibility ($visibility)&quot;
+ 	} else {
+ 	    if { [ string match $visibility &quot;protected&quot; ]
+@@ -337,7 +337,7 @@ proc visibility_run {visibility} {
+     }
+ 
+     # Now do the same tests again, but this time compile main.c PIC.
+-    if ![ld_compile &quot;$CC -g $CFLAGS $SHCFLAG $VSBCFLAG $picflag&quot; $srcdir/$subdir/main.c $tmpdir/mainp.o] {
++    if ![ld_compile &quot;$CC -g $CFLAGS $SHCFLAG $VSBCFLAG -DSHARED $picflag&quot; $srcdir/$subdir/main.c $tmpdir/mainp.o] {
+ 	unresolved &quot;visibility ($visibility) (PIC main, non PIC so)&quot;
+ 	unresolved &quot;visibility ($visibility) (PIC main)&quot;
+     } else {
+@@ -446,7 +446,7 @@ if { ![ld_compile &quot;$CC -g $CFLAGS&quot; $srcd
+ if { ![ld_compile &quot;$CC -g $CFLAGS&quot; $srcdir/$subdir/test.c tmpdir/test.o] } {
+     unresolved &quot;weak hidden symbol&quot;
+ } else {
+-   if { ![ld_compile &quot;$CC -g $CFLAGS $picflag&quot; $srcdir/$subdir/sh3.c tmpdir/sh3.o] } {
++   if { ![ld_compile &quot;$CC -g $CFLAGS -DSHARED $picflag&quot; $srcdir/$subdir/sh3.c tmpdir/sh3.o] } {
+ 	unresolved &quot;weak hidden symbol&quot;
+     } else {
+ 	if ![ld_simple_link $ld tmpdir/sh3.so &quot;-shared tmpdir/sh3.o&quot;] {
+--- ld/testsuite/ld-elfvsb/sh2.c.jj	2003-05-05 17:46:50.000000000 -0400
++++ ld/testsuite/ld-elfvsb/sh2.c	2004-08-03 13:14:22.000000000 -0400
+@@ -44,3 +44,13 @@ visibility_func_weak ()
+   return 2;
+ }
+ #endif
++
++#if !defined (XCOFF_TEST) &amp;&amp; !defined (SHARED)
++int overriddenvar = -1;
++
++int
++shlib_overriddencall2 ()
++{
++  return 7;
++}
++#endif
+

Added: branches/rpms/brian/i386-pc-minix-binutils/binutils-2.16.1-ltconfig-multilib.patch
===================================================================
--- branches/rpms/brian/i386-pc-minix-binutils/binutils-2.16.1-ltconfig-multilib.patch	                        (rev 0)
+++ branches/rpms/brian/i386-pc-minix-binutils/binutils-2.16.1-ltconfig-multilib.patch	2008-06-09 23:18:27 UTC (rev 6350)
@@ -0,0 +1,26 @@
+--- ltconfig.jj	2003-02-03 16:56:49.000000000 +0900
++++ ltconfig	2003-02-03 16:56:49.000000000 +0900
+@@ -1237,6 +1237,23 @@
+   # people can always --disable-shared, the test was removed, and we
+   # assume the GNU/Linux dynamic linker is in use.
+   dynamic_linker='GNU/Linux ld.so'
++
++  # Find out which ABI we are using (multilib hack).
++  case &quot;$host_cpu&quot; in
++  x86_64*|s390*|sparc*|ppc*|powerpc*)
++    echo &quot;$progname:@lineno@: checking multilib ABI type&quot; 1&gt;&amp;5
++    touch conftest.$ac_ext
++    if { (eval echo $progname: \&quot;$ac_compile\&quot;) 1&gt;&amp;5; (eval $ac_compile) 2&gt;conftest.err; } &amp;&amp; test -s conftest.$objext; then
++      case `/usr/bin/file conftest.o` in
++      *64-bit*)
++	sys_lib_dlsearch_path_spec=&quot;/lib64 /usr/lib64&quot;
++	sys_lib_search_path_spec=&quot;/lib64 /usr/lib64 /usr/local/lib64&quot;
++        ;;
++      esac
++    fi
++    rm -rf conftest*
++    ;;
++  esac
+   ;;
+ 
+ netbsd*)

Added: branches/rpms/brian/i386-pc-minix-binutils/binutils-2.16.1-place-orphan.patch
===================================================================
--- branches/rpms/brian/i386-pc-minix-binutils/binutils-2.16.1-place-orphan.patch	                        (rev 0)
+++ branches/rpms/brian/i386-pc-minix-binutils/binutils-2.16.1-place-orphan.patch	2008-06-09 23:18:27 UTC (rev 6350)
@@ -0,0 +1,16 @@
+2003-08-05  Jakub Jelinek  &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">jakub at redhat.com</A>&gt;
+
+	* emulparams/elf64ppc.sh (OTHER_GOT_RELOC_SECTIONS): Add .rela.opd.
+
+--- ld/emulparams/elf64ppc.sh.jj	2003-07-28 10:24:45.000000000 -0400
++++ ld/emulparams/elf64ppc.sh	2003-08-05 08:35:58.000000000 -0400
+@@ -28,7 +28,8 @@ else
+   .toc		0 : { *(.toc) }&quot;
+ fi
+ OTHER_GOT_RELOC_SECTIONS=&quot;
+-  .rela.toc	${RELOCATING-0} : { *(.rela.toc) }&quot;
++  .rela.toc	${RELOCATING-0} : { *(.rela.toc) }
++  .rela.opd	${RELOCATING-0} : { *(.rela.opd) }&quot;
+ OTHER_READWRITE_SECTIONS=&quot;
+   .toc1		${RELOCATING-0}${RELOCATING+ALIGN(8)} : { *(.toc1) }
+   .opd		${RELOCATING-0}${RELOCATING+ALIGN(8)} : { KEEP (*(.opd)) }&quot;

Added: branches/rpms/brian/i386-pc-minix-binutils/cross-binutils.spec
===================================================================
--- branches/rpms/brian/i386-pc-minix-binutils/cross-binutils.spec	                        (rev 0)
+++ branches/rpms/brian/i386-pc-minix-binutils/cross-binutils.spec	2008-06-09 23:18:27 UTC (rev 6350)
@@ -0,0 +1,78 @@
+%{!?target_arch: %define target_arch noarch}
+%{!?target_vendor: %define target_vendor novendor}
+%{!?target_system: %define target_system nosystem}
+%define target %{target_arch}-%{target_vendor}-%{target_system}
+
+Name:           %{target}-binutils
+Version:        2.16.1
+Release:        1%{?dist}
+Summary:        Cross Compiling GNU binutils targeted at %{target}
+Group:          Development/Tools
+License:        GPL
+URL:            <A HREF="http://www.gnu.org/software/binutils/">http://www.gnu.org/software/binutils/</A>
+Source0:        <A HREF="ftp://ftp.gnu.org/pub/gnu/binutils/binutils-%{version">ftp://ftp.gnu.org/pub/gnu/binutils/binutils-%{version</A>}.tar.bz2
+Source1:        README-binutils.fedora
+Patch1: binutils-2.16.1-ltconfig-multilib.patch
+Patch3: binutils-2.16.1-place-orphan.patch
+Patch5: binutils-2.16.1-elfvsb-test.patch
+Patch7: binutils-2.16.1-build-fixes.patch
+Patch104:       binutils-2.16-posix-1.patch
+BuildRoot:      %{_tmppath}/%{name}-%{version}-%{release}-%(%{__id_u} -n)
+BuildRequires:  texinfo &gt;= 4.0, dejagnu, gettext, flex, bison, gcc
+
+%description
+This is a Cross Compiling version of GNU binutils, which can be used to
+assemble and link binaries for the %{target} platform, instead of for the
+native %{_arch} platform.
+
+
+%prep
+%setup # -q -c
+pushd binutils-%{version}
+%patch1 -p0 -b .ltconfig-multilib~
+%patch3 -p0 -b .place-orphan~
+%patch5 -p0 -b .elfvsb-test~
+%patch7 -p0 -b .build-fixes~
+%patch104 -p1
+popd
+cp %{SOURCE1} .
+
+
+%build
+mkdir -p build
+pushd build
+%define host %(echo ${MACHTYPE} | sed &quot;s/$(echo ${MACHTYPE} | cut -d- -f2)/cross/&quot;)
+../binutils-%{version}/configure --prefix=%{_prefix} --target=%{target} \
+  --mandir=%{_mandir} --infodir=%{_infodir} --host=%{host} \
+  --with-lib-path=%{_prefix}/%{target}/lib --disable-shared \
+  --disable-nls
+make configure-host
+make 
+popd build
+
+%install
+rm -rf $RPM_BUILD_ROOT
+pushd build
+make install DESTDIR=$RPM_BUILD_ROOT
+popd build
+# these are for win targets only
+rm -f $RPM_BUILD_ROOT%{_mandir}/man1/%{target}-{dlltool,nlmconv,windres}.1
+# we don't want these as we are a cross version
+rm -fr $RPM_BUILD_ROOT%{_infodir}
+rm -f   $RPM_BUILD_ROOT%{_libdir}/libiberty.a
+
+
+%clean
+rm -rf $RPM_BUILD_ROOT
+
+
+%files
+%defattr(-,root,root,-)
+%doc binutils-%{version}/COPYING binutils-%{version}/COPYING.LIB
+%doc binutils-%{version}/README README-binutils.fedora
+%{_prefix}/%{target}
+%{_bindir}/%{target}-*
+%{_mandir}/man1/%{target}-*.1.gz
+
+
+%changelog

Added: branches/rpms/brian/i386-pc-minix-gcc-static/README-gcc.fedora
===================================================================
--- branches/rpms/brian/i386-pc-minix-gcc-static/README-gcc.fedora	                        (rev 0)
+++ branches/rpms/brian/i386-pc-minix-gcc-static/README-gcc.fedora	2008-06-09 23:18:27 UTC (rev 6350)
@@ -0,0 +1,4 @@
+This package does not include the gnu texinfo documentation because this would
+conflict with the native gcc. If you've installed the native gcc,
+you can find the info documentation there, notice that this might be for a
+different version though!

Added: branches/rpms/brian/i386-pc-minix-gcc-static/arm-linux-soft-float.patch
===================================================================
--- branches/rpms/brian/i386-pc-minix-gcc-static/arm-linux-soft-float.patch	                        (rev 0)
+++ branches/rpms/brian/i386-pc-minix-gcc-static/arm-linux-soft-float.patch	2008-06-09 23:18:27 UTC (rev 6350)
@@ -0,0 +1,30 @@
+diff -u -r gcc-4.0.2/gcc/config/arm/t-linux gcc-4.0.2/gcc/config/arm.new/t-linux
+--- gcc-4.0.2/gcc/config/arm/t-linux	2005-10-18 22:04:44.000000000 +1000
++++ gcc-4.0.2/gcc/config/arm.new/t-linux	2005-10-18 22:05:03.000000000 +1000
+@@ -4,7 +4,12 @@ TARGET_LIBGCC2_CFLAGS = -fomit-frame-poi
+ LIBGCC2_DEBUG_CFLAGS = -g0
+ 
+ LIB1ASMSRC = arm/lib1funcs.asm
+-LIB1ASMFUNCS = _udivsi3 _divsi3 _umodsi3 _modsi3 _dvmd_lnx
++LIB1ASMFUNCS = _udivsi3 _divsi3 _umodsi3 _modsi3 _dvmd_lnx \
++	_negdf2 _addsubdf3 _muldivdf3 _cmpdf2 _unorddf2 _fixdfsi _fixunsdfsi \
++	_truncdfsf2 _negsf2 _addsubsf3 _muldivsf3 _cmpsf2 _unordsf2 \
++	_fixsfsi _fixunssfsi _floatdidf _floatdisf \
++	_bb_init_func _call_via_rX _interwork_call_via_rX \
++	_lshrdi3 _ashrdi3 _ashldi3
+ 
+ # MULTILIB_OPTIONS = mhard-float/msoft-float
+ # MULTILIB_DIRNAMES = hard-float soft-float
+
+
+--- gcc-4.1.1/gcc/config/arm/linux-elf.h	2007-01-06 11:17:51.000000000 +0000
++++ gcc-4.1.1/gcc/config/arm/linux-elf-soft.h	2007-01-06 11:22:01.000000000 +0000
+@@ -49,7 +49,7 @@
+    %{shared:-lc} \
+    %{!shared:%{profile:-lc_p}%{!profile:-lc}}&quot;
+ 
+-#define LIBGCC_SPEC &quot;%{msoft-float:-lfloat} %{mfloat-abi=soft*:-lfloat} -lgcc&quot;
++/* #define LIBGCC_SPEC &quot;%{msoft-float:-lfloat} %{mfloat-abi=soft*:-lfloat} -lgcc&quot; */
+ 
+ #define LINUX_TARGET_INTERPRETER &quot;/lib/ld-linux.so.2&quot;
+ 

Added: branches/rpms/brian/i386-pc-minix-gcc-static/cross-gcc.spec
===================================================================
--- branches/rpms/brian/i386-pc-minix-gcc-static/cross-gcc.spec	                        (rev 0)
+++ branches/rpms/brian/i386-pc-minix-gcc-static/cross-gcc.spec	2008-06-09 23:18:27 UTC (rev 6350)
@@ -0,0 +1,250 @@
+%define use_cpu_defs 0
+%{!?target_arch: %define target_arch noarch}
+%{!?target_vendor: %define target_vendor novendor}
+%{!?target_system: %define target_system nosystem}
+%{?target_cpu: %define cpu_defs --with-cpu=%{target_cpu} --enable-cxx-flags=-mcpu=%{target_cpu}
+               %define use_cpu_defs 1}
+%define target_base_arch %(echo &quot;%{target_arch}&quot; | \
+  sed -e &quot;s/armeb/arm/g&quot; -e &quot;s/arm64/arm/g&quot; -e &quot;s/s390x/s390/g&quot; -e &quot;s/i[4-6]86/i386/g&quot; -e &quot;s/mipsel/mips/g&quot; -e &quot;s/ppc32/ppc/g&quot; -e &quot;s/powerpc/ppc/g&quot; )
+%{!?vendor_name: %define vendor_name %{target_vendor}}
+%define target %{target_arch}-%{target_vendor}-%{target_system}
+%define glibcversion 2.5.0
+%{!?bootstrap: %define bootstrap 0}
+%{!?use_softfp: %define use_softfp 0}
+
+%if !%{bootstrap}
+Name:           %{target}-gcc
+%else
+Name:           %{target}-gcc-static
+%endif
+Version:        4.1.1
+Release:        1%{?dist}
+Summary:        Cross Compiling GNU GCC targeted at %{target}
+Group:          Development/Languages
+License:        GPLv2+
+URL:            <A HREF="http://gcc.gnu.org/">http://gcc.gnu.org/</A>
+Source0:        <A HREF="ftp://ftp.gnu.org/gnu/gcc/gcc-%{version">ftp://ftp.gnu.org/gnu/gcc/gcc-%{version</A>}/gcc-4.1.1.tar.bz2
+Source1:        README-gcc.fedora
+Patch0:         arm-linux-soft-float.patch
+Patch1:         gcc40-cross-build-fixes.patch
+Patch2:         gcc-4.1.2-gcc_eh.patch
+Patch3:         gcc-4.1.2-version.patch
+Patch4:         gcc-4.1.1-cross_search_paths-1.patch
+Patch5:         gcc-4.1.1-minix-install.patch
+BuildRoot:      %{_tmppath}/%{name}-%{version}-%{release}-%(%{__id_u} -n)
+BuildRequires:  %{target}-binutils zlib-devel
+Requires:       %{target}-binutils
+%if %{bootstrap}
+#BuildRequires:  %{target}-%{target_system}-kernel-headers
+%else
+BuildRequires:  %{target}-glibc
+Requires:       %{target}-glibc
+Obsoletes:      %{target}-gcc-static
+%endif
+
+%description
+This is a Cross Compiling version of GNU GCC, which can be used to
+compile programs for the %{target} platform, instead of for the
+native %{_arch} platform.
+
+
+%if !%{bootstrap}
+
+%package c++
+Summary:        Cross Compiling GNU G++ targeted at %{target}
+Group:          Development/Languages
+Requires:       %{name} = %{version}-%{release}
+
+%description c++
+This package contains the Cross Compiling version of g++, which can be used to
+compile c++ code for the %{target} platform, instead of for the
+native %{_arch} platform.
+
+%endif
+
+
+%prep
+%setup -q -c -a 1
+cp -a %{SOURCE1} .
+pushd gcc-%{version}*
+%if %(test &quot;%{target_base_arch}&quot; = &quot;arm&quot; &amp;&amp; echo 1 || echo 0)
+#%patch0 -p1
+%endif
+#%patch1 -p1
+%if !%{bootstrap}
+#%patch3 -p1
+#%patch4 -p1
+%else
+#%patch2 -p1
+%endif
+%patch5 -p1
+sed -i 's/VERSUFFIX &quot;.*&quot;/VERSUFFIX &quot; (%{vendor_name} %{version}-%{release})&quot;/' \
+  gcc/version.c
+contrib/gcc_update --touch
+# Set up the compiler to take the include files from our toolchain
+echo &quot;
+#undef STARTFILE_PREFIX_SPEC
+#define STARTFILE_PREFIX_SPEC \&quot;%{_prefix}/%{target}/lib/\&quot;&quot; &gt;&gt; gcc/config/linux.h
+cp gcc/Makefile.in{,.orig}
+sed -e &quot;s@\(^CROSS_SYSTEM_HEADER_DIR =\).*@\1 %{_prefix}/%{target}/<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">include at g</A>&quot;     gcc/Makefile.in.orig &gt; gcc/Makefile.in
+popd
+
+# Extract %%__os_install_post into os_install_post~
+cat &lt;&lt; \EOF &gt; os_install_post~
+%__os_install_post
+EOF
+
+# Generate customized brp-*scripts
+cat os_install_post~ | while read a x y; do
+case $a in
+# Prevent brp-strip* from trying to handle foreign binaries
+*/brp-strip*)
+  b=$(basename $a)
+  sed -e 's,find $RPM_BUILD_ROOT,find $RPM_BUILD_ROOT%_bindir $RPM_BUILD_ROOT%_libexecdir,' $a &gt; $b
+  chmod a+x $b
+  ;;
+esac
+done
+
+sed -e 's,^[ ]*/usr/lib/rpm.*/brp-strip,./brp-strip,' \
+&lt; os_install_post~ &gt; os_install_post 
+
+%build
+%if %{bootstrap}
+%define languages 'c'
+%else
+%define languages 'c,c++'
+%endif
+mkdir -p build-%{target}-gcc
+pushd build-%{target}-gcc
+CC=&quot;%{__cc} ${RPM_OPT_FLAGS}&quot; \
+../gcc-%{version}*/configure --prefix=%{_prefix} \
+  --mandir=%{_mandir} --infodir=%{_infodir} \
+%if %{bootstrap}
+  --with-build-sysroot=%{_builddir}/%{name}-%{version}/sysroot \
+  --disable-threads --disable-shared \
+%if %{use_softfp}
+  --with-float=soft \
+%endif
+%else
+  --enable-long-long --enable-threads=posix \
+  --disable-libstdcxx-pch \
+  --enable-__cxa_atexit \
+  --enable-symvers=gnu \
+  --enable-version-specific-runtime-libs \
+  --enable-c99 \
+  --with-system-zlib \
+  --enable-shared \
+%endif
+  --target=%{target} --enable-languages=%{languages} \
+  --disable-libmudflap --disable-libssp --disable-multilib \
+%if %{use_cpu_defs}
+  %{cpu_defs} \
+%endif
+  --disable-nls
+
+# In general, building GCC is not smp-safe
+%if %{bootstrap}
+make all-gcc
+%else
+make AS_FOR_TARGET=&quot;%{target}-as&quot; \
+     LD_FOR_TARGET=&quot;%{target}-ld&quot;
+%endif
+popd
+
+%install
+rm -rf $RPM_BUILD_ROOT
+pushd build-%{target}-gcc
+%if %{bootstrap}
+make install-gcc DESTDIR=$RPM_BUILD_ROOT
+%else
+make install DESTDIR=$RPM_BUILD_ROOT
+%endif
+popd
+# we don't want these as we are a cross version
+rm -r $RPM_BUILD_ROOT%{_infodir}
+rm -r $RPM_BUILD_ROOT%{_mandir}/man7
+rm -f  $RPM_BUILD_ROOT%{_libdir}/libiberty.a
+# and these aren't usefull for embedded targets
+rm -fr $RPM_BUILD_ROOT%{_bindir}/gcc/%{target}/%{version}/install-tools
+rm -fr $RPM_BUILD_ROOT%{_libexecdir}/gcc/%{target}/%{version}/install-tools
+%if !%{bootstrap}
+rm -f $RPM_BUILD_ROOT%{_prefix}/%{target}/lib/libiberty.a
+rm -f $RPM_BUILD_ROOT%{_prefix}/%{target}/lib64/libiberty.a
+rm -f $RPM_BUILD_ROOT%{_bindir}/gcc/%{target}/%{version}/*.la
+%endif
+
+# creating links (&lt;cpu&gt;-&lt;system&gt;) of cross-tools for use with tsrpm
+for FILE in $RPM_BUILD_ROOT%{_bindir}/%{target}-*; do
+    ln ${FILE} `echo ${FILE} | sed -e &quot;s/\(.*%{version}.*\)%{target}\(.*\)/\1%{target_arch}-%{target_system}\2/g&quot;`
+done
+
+%define __os_install_post . ./os_install_post
+
+
+%clean
+rm -rf $RPM_BUILD_ROOT
+
+
+%files
+%defattr(-,root,root,-)
+%doc gcc-%{version}*/COPYING gcc-%{version}*/COPYING.LIB
+%doc gcc-%{version}*/README README-gcc.fedora
+%{_bindir}/%{target}-*
+%{_bindir}/%{target_arch}-%{target_system}-*
+%{_prefix}/lib*/gcc/%{target}/
+%{_libexecdir}/gcc/%{target}/
+%{_mandir}/man1/%{target}-*.1.gz
+
+%if !%{bootstrap}
+
+%exclude %{_bindir}/%{target}-?++
+%exclude %{_bindir}/%{target_arch}-%{target_system}-?++
+%exclude /usr/lib/gcc/%{target}/%{version}/lib*c++.a
+%exclude /usr/lib/gcc/%{target}/%{version}/include/c++
+%exclude %{_libexecdir}/gcc/%{target}/%{version}/cc1plus
+%exclude %{_includedir}/omp.h
+%exclude %{_mandir}/man1/%{target}-g++.1.gz
+
+
+%files c++
+%defattr(-,root,root,-)
+%{_bindir}/%{target}-?++
+%{_bindir}/%{target_arch}-%{target_system}-?++
+/usr/lib/gcc/%{target}/%{version}/lib*c++.a
+/usr/lib/gcc/%{target}/%{version}/include/c++
+%{_libexecdir}/gcc/%{target}/%{version}/cc1plus
+%{_mandir}/man1/%{target}-g++.1.gz
+
+%endif
+
+
+%changelog
+* Tue Mar 25 2008 Brian Schueler &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">brian.schueler at gmx.de</A>&gt; 4.1.2-7
+- switched from Linux threads to POSIX threads
+
+* Fri Aug 3 2007 Kevin Kofler &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">Kevin at tigcc.ticalc.org</A>&gt; 4.1.2-6
+- Disable bootstrap
+- Add &quot;GP2X&quot; to VERSUFFIX
+- Link C++ against -lgcc_eh to fix undefined references
+- Specify GPL version in License tag
+
+* Thu May 31 2007 Hans de Goede &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">j.w.r.degoede at hhs.nl</A>&gt; 4.1.2-5
+- Merge in avr-gcc cross compile changes
+
+* Thu May 31 2007 Koos Termeulen <A HREF="http://lists.repoforge.org/mailman/listinfo/commits">koostermeulen at gmail.com</A> 4.1.2-4
+- Moved kernel-headers to separate package
+- Added bootstrap option to define whether we want a bootstrapped gcc or not
+
+* Thu May 10 2007 Koos Termeulen <A HREF="http://lists.repoforge.org/mailman/listinfo/commits">koostermeulen at gmail.com</A> 4.1.2-3
+- Added &quot;linux-2.6.21-headers&quot; and &quot;glibc-2.3.5-headers&quot; for bootstrapping gcc
+- Glibc-2.3.5 is used because the arm is not supported in version 2.5
+
+* Thu Apr 26 2007 Koos Termeulen <A HREF="http://lists.repoforge.org/mailman/listinfo/commits">koostermeulen at gmail.com</A> 4.1.2-2
+- Correction in description
+- Changes in ./configure
+- Don't remove the devel-files from package
+- Removed CFLAGS because it didn't work properly
+
+* Thu Apr 20 2007 Koos Termeulen <A HREF="http://lists.repoforge.org/mailman/listinfo/commits">koostermeulen at gmail.com</A> 4.1.2-1
+- Initial release

Added: branches/rpms/brian/i386-pc-minix-gcc-static/gcc-4.1.1-cross_search_paths-1.patch
===================================================================
--- branches/rpms/brian/i386-pc-minix-gcc-static/gcc-4.1.1-cross_search_paths-1.patch	                        (rev 0)
+++ branches/rpms/brian/i386-pc-minix-gcc-static/gcc-4.1.1-cross_search_paths-1.patch	2008-06-09 23:18:27 UTC (rev 6350)
@@ -0,0 +1,49 @@
+Submitted by: Ryan Oliver &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">ryan.oliver at pha.com.au</A>&gt;
+Date: 2005-05-02
+Initial Package Version: 4.0.1
+Origin: Ryan Oliver (issue reported by Erik-Jan Post)
+        Rediffed against 4.1.0 by Chris Staub
+Upstream Status: N/A
+Description:
+  Removes standard_exec_prefix_2 from library search path when cross-compiling.
+  Removes both standard_exec_prefix_1 and standard_exec_prefix_2 from the gcc
+  executable search path when cross-compiling.
+
+  ie: if cross_compile = 1 in the specs file, do not
+      - do not add /usr/lib/gcc/${TARGET}/${GCC_VER} to the library search path
+      - do not add /usr/lib/gcc/${TARGET}/${GCC_VER} or
+                   /usr/libexec/gcc/${TARGET}/${GCC_VER}
+        to the executable search path
+
+  This avoids the possibility of linking in libraries from the host if they
+  exist under those directories.
+ 
+diff -Naur gcc-4.1.0.orig/gcc/gcc.c gcc-4.1.0/gcc/gcc.c
+--- gcc-4.1.0.orig/gcc/gcc.c	2006-01-21 13:29:08.000000000 -0500
++++ gcc-4.1.0/gcc/gcc.c	2006-02-28 22:20:05.000000000 -0500
+@@ -3818,16 +3818,22 @@
+ 	      PREFIX_PRIORITY_LAST, 2, 0);
+   add_prefix (&amp;exec_prefixes, standard_exec_prefix, &quot;BINUTILS&quot;,
+ 	      PREFIX_PRIORITY_LAST, 2, 0);
+-  add_prefix (&amp;exec_prefixes, standard_exec_prefix_1, &quot;BINUTILS&quot;,
++  if (*cross_compile == '0')
++    {
++      add_prefix (&amp;exec_prefixes, standard_exec_prefix_1, &quot;BINUTILS&quot;,
+ 	      PREFIX_PRIORITY_LAST, 2, 0);
+-  add_prefix (&amp;exec_prefixes, standard_exec_prefix_2, &quot;BINUTILS&quot;,
++      add_prefix (&amp;exec_prefixes, standard_exec_prefix_2, &quot;BINUTILS&quot;,
+ 	      PREFIX_PRIORITY_LAST, 2, 0);
++    }
+ #endif
+ 
+   add_prefix (&amp;startfile_prefixes, standard_exec_prefix, &quot;BINUTILS&quot;,
+ 	      PREFIX_PRIORITY_LAST, 1, 0);
+-  add_prefix (&amp;startfile_prefixes, standard_exec_prefix_2, &quot;BINUTILS&quot;,
++  if (*cross_compile == '0')
++    {
++      add_prefix (&amp;startfile_prefixes, standard_exec_prefix_2, &quot;BINUTILS&quot;,
+ 	      PREFIX_PRIORITY_LAST, 1, 0);
++    }
+ 
+   tooldir_prefix = concat (tooldir_base_prefix, spec_machine,
+ 			   dir_separator_str, NULL);


Property changes on: branches/rpms/brian/i386-pc-minix-gcc-static/gcc-4.1.1-cross_search_paths-1.patch
___________________________________________________________________
Name: svn:executable
   + *

Added: branches/rpms/brian/i386-pc-minix-gcc-static/gcc-4.1.1-minix-install.patch
===================================================================
--- branches/rpms/brian/i386-pc-minix-gcc-static/gcc-4.1.1-minix-install.patch	                        (rev 0)
+++ branches/rpms/brian/i386-pc-minix-gcc-static/gcc-4.1.1-minix-install.patch	2008-06-09 23:18:27 UTC (rev 6350)
@@ -0,0 +1,27 @@
+diff -ruN gcc-4.1.1/gcc/Makefile.in gcc-4.1.1.bs/gcc/Makefile.in
+--- gcc-4.1.1/gcc/Makefile.in	2006-11-03 11:59:50.000000000 +0100
++++ gcc-4.1.1.bs/gcc/Makefile.in	2008-04-16 19:32:42.000000000 +0200
+@@ -1296,7 +1296,6 @@
+ cc1-dummy$(exeext): $(C_OBJS) dummy-checksum.o $(BACKEND) $(LIBDEPS)
+ 	$(CC) $(ALL_CFLAGS) $(LDFLAGS) -o $@ $(C_OBJS) dummy-checksum.o \
+ 	  $(BACKEND) $(LIBS)
+-	install -S 125Mb $@
+ 
+ cc1-checksum.c : cc1-dummy$(exeext) build/genchecksum$(build_exeext)
+ 	build/genchecksum$(build_exeext) cc1-dummy$(exeext) &gt; $@
+@@ -1306,7 +1305,6 @@
+ cc1$(exeext): $(C_OBJS) cc1-checksum.o $(BACKEND) $(LIBDEPS)
+ 	$(CC) $(ALL_CFLAGS) $(LDFLAGS) -o $@ $(C_OBJS) cc1-checksum.o \
+ 	  $(BACKEND) $(LIBS)
+-	install -S 125Mb $@
+ 
+ # Build the version of limits.h that we will install.
+ xlimits.h: glimits.h limitx.h limity.h
+@@ -2913,7 +2911,6 @@
+ 	 build/genattrtab.o build/genautomata.o \
+ 	 $(BUILD_RTL) $(BUILD_SUPPORT) $(BUILD_PRINT) $(BUILD_ERRORS) \
+ 	 $(BUILD_VARRAY) $(BUILD_LIBS) -lm
+-	install -S 70Mb $@
+ 
+ build/genattrtab.o : genattrtab.c $(RTL_BASE_H) $(OBSTACK_H) $(BCONFIG_H) \
+   $(SYSTEM_H) coretypes.h $(GTM_H) errors.h $(GGC_H) gensupport.h genattrtab.h

Added: branches/rpms/brian/i386-pc-minix-gcc-static/gcc-4.1.2-gcc_eh.patch
===================================================================
--- branches/rpms/brian/i386-pc-minix-gcc-static/gcc-4.1.2-gcc_eh.patch	                        (rev 0)
+++ branches/rpms/brian/i386-pc-minix-gcc-static/gcc-4.1.2-gcc_eh.patch	2008-06-09 23:18:27 UTC (rev 6350)
@@ -0,0 +1,24 @@
+diff -ur gcc-4.1.2/gcc/cp/g++spec.c gcc-4.1.2-gcc_eh/gcc/cp/g++spec.c
+--- gcc-4.1.2/gcc/cp/g++spec.c	2005-06-25 02:59:41.000000000 +0200
++++ gcc-4.1.2-gcc_eh/gcc/cp/g++spec.c	2007-08-03 14:46:03.000000000 +0200
+@@ -251,7 +251,7 @@
+ #endif
+ 
+   /* Make sure to have room for the trailing NULL argument.  */
+-  num_args = argc + added + need_math + shared_libgcc + (library &gt; 0) + 1;
++  num_args = argc + added + need_math + shared_libgcc + 2 * (library &gt; 0) + 1;
+   arglist = xmalloc (num_args * sizeof (char *));
+ 
+   i = 0;
+@@ -311,7 +311,10 @@
+     {
+       arglist[j] = saw_profile_flag ? LIBSTDCXX_PROFILE : LIBSTDCXX;
+       if (arglist[j][0] != '-' || arglist[j][1] == 'l')
+-	added_libraries++;
++      {
++	arglist[++j] = &quot;-lgcc_eh&quot;;
++	added_libraries += 2;
++      }
+       j++;
+     }
+   if (saw_math)

Added: branches/rpms/brian/i386-pc-minix-gcc-static/gcc-4.1.2-version.patch
===================================================================
--- branches/rpms/brian/i386-pc-minix-gcc-static/gcc-4.1.2-version.patch	                        (rev 0)
+++ branches/rpms/brian/i386-pc-minix-gcc-static/gcc-4.1.2-version.patch	2008-06-09 23:18:27 UTC (rev 6350)
@@ -0,0 +1,6 @@
+diff -ruN gcc-4.1.2-20070626/gcc/BASE-VER gcc-4.1.2-20070626.new/gcc/BASE-VER
+--- gcc-4.1.2-20070626/gcc/BASE-VER	2007-06-22 13:14:40.000000000 +0200
++++ gcc-4.1.2-20070626.new/gcc/BASE-VER	2008-03-30 17:02:26.000000000 +0200
+@@ -1 +1 @@
+-4.1.3
++4.1.2

Added: branches/rpms/brian/i386-pc-minix-gcc-static/gcc40-cross-build-fixes.patch
===================================================================
--- branches/rpms/brian/i386-pc-minix-gcc-static/gcc40-cross-build-fixes.patch	                        (rev 0)
+++ branches/rpms/brian/i386-pc-minix-gcc-static/gcc40-cross-build-fixes.patch	2008-06-09 23:18:27 UTC (rev 6350)
@@ -0,0 +1,52 @@
+--- gcc-4.1.2/configure.cross-build-fixes	2007-01-25 16:47:43.000000000 +0100
++++ gcc-4.1.2/configure	2007-01-25 16:47:43.000000000 +0100
+@@ -3260,7 +3260,13 @@ CFLAGS_FOR_BUILD=${CFLAGS_FOR_BUILD-${CF
+ # being built; programs in there won't even run.
+ if test &quot;${build}&quot; = &quot;${host}&quot; &amp;&amp; test -d ${srcdir}/gcc; then
+   # Search for pre-installed headers if nothing else fits.
+-  FLAGS_FOR_TARGET=$FLAGS_FOR_TARGET' -B$(build_tooldir)/bin/ -B$(build_tooldir)/lib/ -isystem $(build_tooldir)/include -isystem $(build_tooldir)/sys-include'
++  FLAGS_FOR_TARGET=$FLAGS_FOR_TARGET' -B$(build_tooldir)/bin/ -B$(build_tooldir)/lib/'
++  if test &quot;${with_build_sysroot+set}&quot; = set; then
++    sysroot_dir=&quot;$with_build_sysroot&quot;
++  else
++    sysroot_dir='$(build_tooldir)/'
++  fi
++  FLAGS_FOR_TARGET=$FLAGS_FOR_TARGET&quot; -isystem $sysroot_dir/usr/include&quot;
+ fi
+ 
+ if test &quot;x${use_gnu_ld}&quot; = x &amp;&amp;
+--- gcc-4.1.2/gcc/mklibgcc.in.cross-build-fixes	2006-09-21 13:30:29.000000000 +0200
++++ gcc-4.1.2/gcc/mklibgcc.in	2007-01-25 16:47:43.000000000 +0100
+@@ -196,7 +196,7 @@ for ml in $MULTILIBS; do
+   shlib_slibdir_qual=
+   libgcc_a=$dir/libgcc.a
+   libgcov_a=$dir/libgcov.a
+-  libgcc_eh_a=
++  libgcc_eh_a=$dir/libgcc_eh.a
+   libgcc_s_so=
+   libunwind_a=
+   libunwind_so=
+@@ -205,7 +205,6 @@ for ml in $MULTILIBS; do
+     libunwind_a=$dir/libunwind.a
+   fi
+   if [ &quot;$SHLIB_LINK&quot; ]; then
+-    libgcc_eh_a=$dir/libgcc_eh.a
+     libgcc_s_so=$dir/libgcc_s${SHLIB_EXT}
+     if [ &quot;$LIBUNWIND&quot; ]; then
+       libunwind_so=$dir/libunwind${SHLIB_EXT}
+@@ -868,12 +867,11 @@ for ml in $MULTILIBS; do
+   echo '	$(INSTALL_DATA)' ${dir}/libgcov.a ${ldir}/
+   echo '	chmod 644'  ${ldir}/libgcov.a
+   echo '	$(RANLIB_FOR_TARGET)' ${ldir}/libgcov.a
++  echo '	$(INSTALL_DATA)' ${dir}/libgcc_eh.a ${ldir}/
++  echo '	chmod 644'  ${ldir}/libgcc_eh.a
++  echo '	$(RANLIB_FOR_TARGET)' ${ldir}/libgcc_eh.a
+ 
+   if [ &quot;$SHLIB_LINK&quot; ]; then
+-    echo '	$(INSTALL_DATA)' ${dir}/libgcc_eh.a ${ldir}/
+-    echo '	chmod 644'  ${ldir}/libgcc_eh.a
+-    echo '	$(RANLIB_FOR_TARGET)' ${ldir}/libgcc_eh.a
+-
+     shlib_slibdir_qual=
+     os_multilib_dir=`$GCC_FOR_TARGET $flags --print-multi-os-directory`
+     if [ &quot;$os_multilib_dir&quot; != . ]; then

Added: branches/rpms/brian/noarch-novendor-nosystem-binutils/README-binutils.fedora
===================================================================
--- branches/rpms/brian/noarch-novendor-nosystem-binutils/README-binutils.fedora	                        (rev 0)
+++ branches/rpms/brian/noarch-novendor-nosystem-binutils/README-binutils.fedora	2008-06-09 23:18:27 UTC (rev 6350)
@@ -0,0 +1,4 @@
+This package does not include the gnu texinfo documentation because this would
+conflict with the native binutils. If you've installed the native binutils,
+you can find the info documentation there, notice that this might be for a
+different version though!

Added: branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17-posix-1.patch
===================================================================
--- branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17-posix-1.patch	                        (rev 0)
+++ branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17-posix-1.patch	2008-06-09 23:18:27 UTC (rev 6350)
@@ -0,0 +1,98 @@
+Submitted By: Jim Gifford (patches at jg555 dot com)
+Date: 2005-05-06
+Initial Package Version: 2.16
+Origin: <A HREF="http://ttervo.vectorstar.net/nptl/posix-patches/binutils-2.14.90.0.7-posix-head-tail.patch">http://ttervo.vectorstar.net/nptl/posix-patches/binutils-2.14.90.0.7-posix-head-tail.patch</A>
+Upstream Status: Accepted/but Suspended
+Description: Makes Posix Compliant
+	     Rediffed against 2.16 by Jeremy Huntwork
+
+diff -Naur binutils-2.16-ORIG/gas/Makefile.am binutils-2.16/gas/Makefile.am
+--- binutils-2.16-ORIG/gas/Makefile.am	2005-03-22 10:31:44.000000000 -0500
++++ binutils-2.16/gas/Makefile.am	2005-05-06 17:08:11.859876859 -0400
+@@ -762,13 +762,13 @@
+ against=stage2
+ 
+ # This rule is derived from corresponding code in the Makefile.in for gcc.
+-# The &quot;tail +16c&quot; is to bypass headers which may include timestamps or
++# The &quot;tail -c +16&quot; is to bypass headers which may include timestamps or
+ # temporary assembly file names.
+ comparison:
+ 	x=0 ; \
+ 	for file in *.o ; do \
+-	  tail +16c ./$$file &gt; tmp-foo1; \
+-	  if tail +16c ${against}/$$file &gt; tmp-foo2 2&gt;/dev/null ; then \
++	  tail -c +16 ./$$file &gt; tmp-foo1; \
++	  if tail -c +16 ${against}/$$file &gt; tmp-foo2 2&gt;/dev/null ; then \
+ 	    if cmp tmp-foo1 tmp-foo2 ; then \
+ 	      true ; \
+ 	    else \
+diff -Naur binutils-2.16-ORIG/gas/Makefile.in binutils-2.16/gas/Makefile.in
+--- binutils-2.16-ORIG/gas/Makefile.in	2005-04-29 09:57:16.000000000 -0400
++++ binutils-2.16/gas/Makefile.in	2005-05-06 17:08:11.868875659 -0400
+@@ -3164,13 +3164,13 @@
+ 	if [ -f stage3/as-new$(EXEEXT) -a ! -f stage3/as$(EXEEXT) ] ; then (cd stage3 ; ln -s as-new as$(EXEEXT)) ; fi
+ 
+ # This rule is derived from corresponding code in the Makefile.in for gcc.
+-# The &quot;tail +16c&quot; is to bypass headers which may include timestamps or
++# The &quot;tail -c +16&quot; is to bypass headers which may include timestamps or
+ # temporary assembly file names.
+ comparison:
+ 	x=0 ; \
+ 	for file in *.o ; do \
+-	  tail +16c ./$$file &gt; tmp-foo1; \
+-	  if tail +16c ${against}/$$file &gt; tmp-foo2 2&gt;/dev/null ; then \
++	  tail -c +16 ./$$file &gt; tmp-foo1; \
++	  if tail -c +16 ${against}/$$file &gt; tmp-foo2 2&gt;/dev/null ; then \
+ 	    if cmp tmp-foo1 tmp-foo2 ; then \
+ 	      true ; \
+ 	    else \
+diff -Naur binutils-2.16-ORIG/ld/testsuite/ld-bootstrap/bootstrap.exp binutils-2.16/ld/testsuite/ld-bootstrap/bootstrap.exp
+--- binutils-2.16-ORIG/ld/testsuite/ld-bootstrap/bootstrap.exp	2005-03-03 06:52:06.000000000 -0500
++++ binutils-2.16/ld/testsuite/ld-bootstrap/bootstrap.exp	2005-05-06 17:08:11.870875393 -0400
+@@ -149,8 +149,8 @@
+         # Although this works, a way to set the date would be better.
+         # Removing or zeroing the date stamp in the binary produced by
+         # the linker is not possible as it is required by the target OS.
+-        exec tail +140 tmpdir/ld2 &gt;tmpdir/ld2tail
+-        exec tail +140 tmpdir/ld3 &gt;tmpdir/ld3tail
++        exec tail -n +140 tmpdir/ld2 &gt;tmpdir/ld2tail
++        exec tail -n +140 tmpdir/ld3 &gt;tmpdir/ld3tail
+         catch &quot;exec cmp tmpdir/ld2tail tmpdir/ld3tail&quot; exec_output
+         exec rm tmpdir/ld2tail tmpdir/ld3tail
+     } else {
+diff -Naur binutils-2.16-ORIG/ltcf-c.sh binutils-2.16/ltcf-c.sh
+--- binutils-2.16-ORIG/ltcf-c.sh	2004-10-05 09:34:42.000000000 -0400
++++ binutils-2.16/ltcf-c.sh	2005-05-06 17:08:11.873874993 -0400
+@@ -153,7 +153,7 @@
+     # If the export-symbols file already is a .def file (1st line
+     # is EXPORTS), use it as is.
+     # If DATA tags from a recent dlltool are present, honour them!
+-    archive_expsym_cmds='if test &quot;x`head -1 $export_symbols`&quot; = xEXPORTS; then
++    archive_expsym_cmds='if test &quot;x`head -n 1 $export_symbols`&quot; = xEXPORTS; then
+         cp $export_symbols $output_objdir/$soname-def;
+       else
+         echo EXPORTS &gt; $output_objdir/$soname-def;
+diff -Naur binutils-2.16-ORIG/ltcf-gcj.sh binutils-2.16/ltcf-gcj.sh
+--- binutils-2.16-ORIG/ltcf-gcj.sh	2004-07-21 15:21:41.000000000 -0400
++++ binutils-2.16/ltcf-gcj.sh	2005-05-06 17:08:11.876874593 -0400
+@@ -156,7 +156,7 @@
+     # If the export-symbols file already is a .def file (1st line
+     # is EXPORTS), use it as is.
+     # If DATA tags from a recent dlltool are present, honour them!
+-    archive_expsym_cmds='if test &quot;x`head -1 $export_symbols`&quot; = xEXPORTS; then
++    archive_expsym_cmds='if test &quot;x`head -n 1 $export_symbols`&quot; = xEXPORTS; then
+         cp $export_symbols $output_objdir/$soname-def;
+       else
+         echo EXPORTS &gt; $output_objdir/$soname-def;
+diff -Naur binutils-2.16-ORIG/src-release binutils-2.16/src-release
+--- binutils-2.16-ORIG/src-release	2004-12-03 05:30:06.000000000 -0500
++++ binutils-2.16/src-release	2005-05-06 17:08:11.878874327 -0400
+@@ -69,7 +69,7 @@
+ 	elif grep AM_INIT_AUTOMAKE $(TOOL)/configure.in &gt;/dev/null 2&gt;&amp;1; then \
+ 	  sed &lt; $(TOOL)/configure.in -n 's/AM_INIT_AUTOMAKE[^,]*, *\([^)]*\))/\1/p'; \
+ 	elif test -f $(TOOL)/version.in; then \
+-	  head -1 $(TOOL)/version.in; \
++	  head -n 1 $(TOOL)/version.in; \
+ 	elif grep VERSION $(TOOL)/Makefile.in &gt; /dev/null 2&gt;&amp;1; then \
+ 	  sed &lt; $(TOOL)/Makefile.in -n 's/^VERSION *= *//p'; \
+ 	else \


Property changes on: branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17-posix-1.patch
___________________________________________________________________
Name: svn:executable
   + *

Added: branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-build-fixes.patch
===================================================================
--- branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-build-fixes.patch	                        (rev 0)
+++ branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-build-fixes.patch	2008-06-09 23:18:27 UTC (rev 6350)
@@ -0,0 +1,29 @@
+2006-02-14  Jakub Jelinek  &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">jakub at redhat.com</A>&gt;
+
+ld/testsuite/
+	* ld-shared/main.c (main): Prevent warnings about unused p.
+	* ld-elfcomm/common1b.c (dummy1): Add __attribute__((__used__)) for
+	GCC 3.3+.
+
+--- ld/testsuite/ld-shared/main.c.jj	2001-07-11 15:48:54.000000000 +0200
++++ ld/testsuite/ld-shared/main.c	2006-02-14 10:07:08.000000000 +0100
+@@ -40,6 +40,8 @@ main ()
+ {
+   int (*p) ();
+ 
++  p = (void *) 0;
++  (void) p;
+   printf (&quot;mainvar == %d\n&quot;, mainvar);
+   printf (&quot;overriddenvar == %d\n&quot;, overriddenvar);
+   printf (&quot;shlibvar1 == %d\n&quot;, shlibvar1);
+--- ld/testsuite/ld-elfcomm/common1b.c.jj	2003-04-15 11:38:10.000000000 +0200
++++ ld/testsuite/ld-elfcomm/common1b.c	2006-02-14 10:11:19.000000000 +0100
+@@ -1,3 +1,7 @@
+-static char dummy1 = 'X';
++static char dummy1
++#if defined __GNUC__ &amp;&amp; (__GNUC__ &gt;= 4 || (__GNUC__ == 3 &amp;&amp; __GNUC_MINOR__ &gt;= 3))
++  __attribute__((__used__))
++#endif
++  = 'X';
+ char foo1 [] = &quot;Aligned at odd byte.&quot;;
+ char foo2 [4];

Added: branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-bz4267.patch
===================================================================
--- branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-bz4267.patch	                        (rev 0)
+++ branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-bz4267.patch	2008-06-09 23:18:27 UTC (rev 6350)
@@ -0,0 +1,30 @@
+2007-03-29  Alan Modra  &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">amodra at bigpond.net.au</A>&gt;
+
+	PR ld/4267
+	* elf32-ppc.c (allocate_dynrelocs): Set plt.offset to -1 for
+	unused entries.  Don't clear plt.plist in loop.
+
+--- bfd/elf32-ppc.c	26 Mar 2007 12:23:00 -0000	1.211
++++ bfd/elf32-ppc.c	29 Mar 2007 01:11:30 -0000	1.212
+@@ -4500,13 +4500,15 @@ allocate_dynrelocs (struct elf_link_hash
+ 	      }
+ 	    else
+ 	      ent-&gt;plt.offset = (bfd_vma) -1;
+-
+-	    if (!doneone)
+-	      {
+-		h-&gt;plt.plist = NULL;
+-		h-&gt;needs_plt = 0;
+-	      }
+ 	  }
++	else
++	  ent-&gt;plt.offset = (bfd_vma) -1;
++
++      if (!doneone)
++	{
++	  h-&gt;plt.plist = NULL;
++	  h-&gt;needs_plt = 0;
++	}
+     }
+   else
+     {

Added: branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-elfvsb-test.patch
===================================================================
--- branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-elfvsb-test.patch	                        (rev 0)
+++ branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-elfvsb-test.patch	2008-06-09 23:18:27 UTC (rev 6350)
@@ -0,0 +1,85 @@
+2004-08-03  Jakub Jelinek  &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">jakub at redhat.com</A>&gt;
+
+	* ld-elfvsb/sh1.c (overriddenvar, shlib_overriddencall2): If
+	!SHARED, move to...
+	* ld-elfvsb/sh2.c: ... here.
+	* ld-elfvsb/elfvsb.exp: Add -DSHARED to compiler options when building
+	{sh[123],main}.c with $picflag.
+
+--- ld/testsuite/ld-elfvsb/sh1.c.jj	2003-05-05 17:46:50.000000000 -0400
++++ ld/testsuite/ld-elfvsb/sh1.c	2004-08-03 13:15:48.000000000 -0400
+@@ -13,7 +13,11 @@ extern int mainvar;
+ /* This variable is defined in the shared library, and overridden by
+    the main program.  */
+ #ifndef XCOFF_TEST
++#ifdef SHARED
+ int overriddenvar = -1;
++#else
++extern int overriddenvar;
++#endif
+ #endif
+ 
+ /* This variable is defined in the shared library.  */
+@@ -76,12 +80,14 @@ shlib_shlibcall2 ()
+   return shlib_overriddencall2 ();
+ }
+ 
++#ifdef SHARED
+ int
+ shlib_overriddencall2 ()
+ {
+   return 7;
+ }
+ #endif
++#endif
+ 
+ /* This function calls a function defined by the main program.  */
+ 
+--- ld/testsuite/ld-elfvsb/elfvsb.exp.jj	2004-05-27 14:26:05.000000000 -0400
++++ ld/testsuite/ld-elfvsb/elfvsb.exp	2004-08-03 13:13:40.000000000 -0400
+@@ -315,8 +315,8 @@ proc visibility_run {visibility} {
+ 
+ 	# Now compile the code using -fpic.
+ 
+-	if { ![ld_compile &quot;$CC -g $CFLAGS $SHCFLAG $VSBCFLAG $picflag&quot; $srcdir/$subdir/sh1.c $tmpdir/sh1p.o] 
+-	    || ![ld_compile &quot;$CC -g $CFLAGS $SHCFLAG $VSBCFLAG $picflag&quot; $srcdir/$subdir/sh2.c $tmpdir/sh2p.o] } {
++	if { ![ld_compile &quot;$CC -g $CFLAGS $SHCFLAG $VSBCFLAG -DSHARED $picflag&quot; $srcdir/$subdir/sh1.c $tmpdir/sh1p.o] 
++	    || ![ld_compile &quot;$CC -g $CFLAGS $SHCFLAG $VSBCFLAG -DSHARED $picflag&quot; $srcdir/$subdir/sh2.c $tmpdir/sh2p.o] } {
+ 	    unresolved &quot;visibility ($visibility)&quot;
+ 	} else {
+ 	    if { [ string match $visibility &quot;protected&quot; ]
+@@ -337,7 +337,7 @@ proc visibility_run {visibility} {
+     }
+ 
+     # Now do the same tests again, but this time compile main.c PIC.
+-    if ![ld_compile &quot;$CC -g $CFLAGS $SHCFLAG $VSBCFLAG $picflag&quot; $srcdir/$subdir/main.c $tmpdir/mainp.o] {
++    if ![ld_compile &quot;$CC -g $CFLAGS $SHCFLAG $VSBCFLAG -DSHARED $picflag&quot; $srcdir/$subdir/main.c $tmpdir/mainp.o] {
+ 	unresolved &quot;visibility ($visibility) (PIC main, non PIC so)&quot;
+ 	unresolved &quot;visibility ($visibility) (PIC main)&quot;
+     } else {
+@@ -446,7 +446,7 @@ if { ![ld_compile &quot;$CC -g $CFLAGS&quot; $srcd
+ if { ![ld_compile &quot;$CC -g $CFLAGS&quot; $srcdir/$subdir/test.c tmpdir/test.o] } {
+     unresolved &quot;weak hidden symbol&quot;
+ } else {
+-   if { ![ld_compile &quot;$CC -g $CFLAGS $picflag&quot; $srcdir/$subdir/sh3.c tmpdir/sh3.o] } {
++   if { ![ld_compile &quot;$CC -g $CFLAGS -DSHARED $picflag&quot; $srcdir/$subdir/sh3.c tmpdir/sh3.o] } {
+ 	unresolved &quot;weak hidden symbol&quot;
+     } else {
+ 	if ![ld_simple_link $ld tmpdir/sh3.so &quot;-shared tmpdir/sh3.o&quot;] {
+--- ld/testsuite/ld-elfvsb/sh2.c.jj	2003-05-05 17:46:50.000000000 -0400
++++ ld/testsuite/ld-elfvsb/sh2.c	2004-08-03 13:14:22.000000000 -0400
+@@ -44,3 +44,13 @@ visibility_func_weak ()
+   return 2;
+ }
+ #endif
++
++#if !defined (XCOFF_TEST) &amp;&amp; !defined (SHARED)
++int overriddenvar = -1;
++
++int
++shlib_overriddencall2 ()
++{
++  return 7;
++}
++#endif
+

Added: branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-fixsyms.patch
===================================================================
--- branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-fixsyms.patch	                        (rev 0)
+++ branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-fixsyms.patch	2008-06-09 23:18:27 UTC (rev 6350)
@@ -0,0 +1,82 @@
+2006-10-23  Alan Modra  &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">amodra at bigpond.net.au</A>&gt;
+
+	* linker.c (fix_syms): Choose best of previous and next
+	section based on section flags and vma.
+
+--- bfd/linker.c	17 Oct 2006 13:41:47 -0000	1.55
++++ bfd/linker.c	23 Oct 2006 02:35:38 -0000	1.56
+@@ -3092,25 +3092,62 @@ fix_syms (struct bfd_link_hash_entry *h,
+ 	  &amp;&amp; (s-&gt;output_section-&gt;flags &amp; SEC_EXCLUDE) != 0
+ 	  &amp;&amp; bfd_section_removed_from_list (obfd, s-&gt;output_section))
+ 	{
+-	  asection *op;
+-	  for (op = s-&gt;output_section-&gt;prev; op != NULL; op = op-&gt;prev)
++	  asection *op, *op1;
++
++	  h-&gt;u.def.value += s-&gt;output_offset + s-&gt;output_section-&gt;vma;
++
++	  /* Find preceding kept section.  */
++	  for (op1 = s-&gt;output_section-&gt;prev; op1 != NULL; op1 = op1-&gt;prev)
++	    if ((op1-&gt;flags &amp; SEC_EXCLUDE) == 0
++		&amp;&amp; !bfd_section_removed_from_list (obfd, op1))
++	      break;
++
++	  /* Find following kept section.  Start at prev-&gt;next because
++	     other sections may have been added after S was removed.  */
++	  if (s-&gt;output_section-&gt;prev != NULL)
++	    op = s-&gt;output_section-&gt;prev-&gt;next;
++	  else
++	    op = s-&gt;output_section-&gt;owner-&gt;sections;
++	  for (; op != NULL; op = op-&gt;next)
+ 	    if ((op-&gt;flags &amp; SEC_EXCLUDE) == 0
+ 		&amp;&amp; !bfd_section_removed_from_list (obfd, op))
+ 	      break;
+-	  if (op == NULL)
++
++	  /* Choose better of two sections, based on flags.  The idea
++	     is to choose a section that will be in the same segment
++	     as S would have been if it was kept.  */
++	  if (op1 == NULL)
+ 	    {
+-	      if (s-&gt;output_section-&gt;prev != NULL)
+-		op = s-&gt;output_section-&gt;prev-&gt;next;
+-	      else
+-		op = s-&gt;output_section-&gt;owner-&gt;sections;
+-	      for (; op != NULL; op = op-&gt;next)
+-		if ((op-&gt;flags &amp; SEC_EXCLUDE) == 0
+-		    &amp;&amp; !bfd_section_removed_from_list (obfd, op))
+-		  break;
+ 	      if (op == NULL)
+ 		op = bfd_abs_section_ptr;
+ 	    }
+-	  h-&gt;u.def.value += s-&gt;output_offset + s-&gt;output_section-&gt;vma;
++	  else if (op == NULL)
++	    op = op1;
++	  else if (((op1-&gt;flags ^ op-&gt;flags)
++		    &amp; (SEC_ALLOC | SEC_THREAD_LOCAL)) != 0)
++	    {
++	      if (((op-&gt;flags ^ s-&gt;flags)
++		   &amp; (SEC_ALLOC | SEC_THREAD_LOCAL)) != 0)
++		op = op1;
++	    }
++	  else if (((op1-&gt;flags ^ op-&gt;flags) &amp; SEC_READONLY) != 0)
++	    {
++	      if (((op-&gt;flags ^ s-&gt;flags) &amp; SEC_READONLY) != 0)
++		op = op1;
++	    }
++	  else if (((op1-&gt;flags ^ op-&gt;flags) &amp; SEC_CODE) != 0)
++	    {
++	      if (((op-&gt;flags ^ s-&gt;flags) &amp; SEC_CODE) != 0)
++		op = op1;
++	    }
++	  else
++	    {
++	      /* Flags we care about are the same.  Prefer the following
++		 section if that will result in a positive valued sym.  */
++	      if (h-&gt;u.def.value &lt; op-&gt;vma)
++		op = op1;
++	    }
++
+ 	  h-&gt;u.def.value -= op-&gt;vma;
+ 	  h-&gt;u.def.section = op;
+ 	}

Added: branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-gas-debug-ranges-revert.patch
===================================================================
--- branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-gas-debug-ranges-revert.patch	                        (rev 0)
+++ branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-gas-debug-ranges-revert.patch	2008-06-09 23:18:27 UTC (rev 6350)
@@ -0,0 +1,343 @@
+gas/
+2006-10-13  Sterling Augstine  &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">sterling at tensilica.com</A>&gt;
+
+	* dwarf2dbg.c (out_debug_info): Use TC_DWARF2_EMIT_OFFSET to emit
+	a disjoint DW_AT range.
+
+2006-08-08  Bob Wilson  &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">bob.wilson at acm.org</A>&gt;
+
+	* dwarf2dbg.c (DWARF2_USE_FIXED_ADVANCE_PC): New.
+	(out_sleb128): New.
+	(out_fixed_inc_line_addr): New.
+	(process_entries): Use out_fixed_inc_line_addr when
+	DWARF2_USE_FIXED_ADVANCE_PC is set.
+	* config/tc-xtensa.h (DWARF2_USE_FIXED_ADVANCE_PC): Define.
+
+2006-08-08  Sterling Augustine  &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">sterling at tensilica.com</A>&gt;
+
+	* dwarf2dbg.c (out_debug_info): Add new parameter ranges_seg
+	and emit DW_AT_ranges when code in compilation unit is not
+	contiguous.
+	(out_debug_abbrev): Emit DW_AT_ranges abbreviation if code in
+	is not contiguous.
+	(dwarf2_finish): Create and pass ranges_seg to out_debug_info.
+	(out_debug_ranges): New function to emit .debug_ranges section
+	when code is not contiguous.
+gas/testsuite/
+2006-08-08  Bob Wilson  &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">bob.wilson at acm.org</A>&gt;
+
+	* gas/lns/lns-common-1-alt.d: New file.
+	* gas/lns/lns.exp: Use lns-common-1-alt.d for xtensa targets.
+
+--- gas/dwarf2dbg.c	2006-07-15 14:23:50.000000000 -0400
++++ gas/dwarf2dbg.c	2006-10-20 14:50:58.000000000 -0400
+@@ -88,6 +88,13 @@
+ #define DL_FILES	1
+ #define DL_BODY		2
+ 
++/* If linker relaxation might change offsets in the code, the DWARF special
++   opcodes and variable-length operands cannot be used.  If this macro is
++   nonzero, use the DW_LNS_fixed_advance_pc opcode instead.  */
++#ifndef DWARF2_USE_FIXED_ADVANCE_PC
++# define DWARF2_USE_FIXED_ADVANCE_PC	0
++#endif
++
+ /* First special line opcde - leave room for the standard opcodes.
+    Note: If you want to change this, you'll have to update the
+    &quot;standard_opcode_lengths&quot; table that is emitted below in
+@@ -191,22 +198,22 @@ static void out_two (int);
+ static void out_four (int);
+ static void out_abbrev (int, int);
+ static void out_uleb128 (addressT);
++static void out_sleb128 (addressT);
+ static offsetT get_frag_fix (fragS *, segT);
+ static void out_set_addr (symbolS *);
+ static int size_inc_line_addr (int, addressT);
+ static void emit_inc_line_addr (int, addressT, char *, int);
+ static void out_inc_line_addr (int, addressT);
++static void out_fixed_inc_line_addr (int, symbolS *, symbolS *);
+ static void relax_inc_line_addr (int, symbolS *, symbolS *);
+ static void process_entries (segT, struct line_entry *);
+ static void out_file_list (void);
+ static void out_debug_line (segT);
+ static void out_debug_aranges (segT, segT);
+ static void out_debug_abbrev (segT);
+-static void out_debug_info (segT, segT, segT);
+ 
+ #ifndef TC_DWARF2_EMIT_OFFSET
+-# define TC_DWARF2_EMIT_OFFSET  generic_dwarf2_emit_offset
+-static void generic_dwarf2_emit_offset (symbolS *, unsigned int);
++#define TC_DWARF2_EMIT_OFFSET  generic_dwarf2_emit_offset
+ 
+ /* Create an offset to .dwarf2_*.  */
+ 
+@@ -746,6 +753,14 @@ out_uleb128 (addressT value)
+   output_leb128 (frag_more (sizeof_leb128 (value, 0)), value, 0);
+ }
+ 
++/* Emit a signed &quot;little-endian base 128&quot; number.  */
++
++static void
++out_sleb128 (addressT value)
++{
++  output_leb128 (frag_more (sizeof_leb128 (value, 1)), value, 1);
++}
++
+ /* Emit a tuple for .debug_abbrev.  */
+ 
+ static inline void
+@@ -979,6 +994,45 @@ out_inc_line_addr (int line_delta, addre
+   emit_inc_line_addr (line_delta, addr_delta, frag_more (len), len);
+ }
+ 
++/* Write out an alternative form of line and address skips using
++   DW_LNS_fixed_advance_pc opcodes.  This uses more space than the default
++   line and address information, but it helps support linker relaxation that
++   changes the code offsets.  */
++
++static void
++out_fixed_inc_line_addr (int line_delta, symbolS *to_sym, symbolS *from_sym)
++{
++  expressionS expr;
++
++  /* INT_MAX is a signal that this is actually a DW_LNE_end_sequence.  */
++  if (line_delta == INT_MAX)
++    {
++      out_opcode (DW_LNS_fixed_advance_pc);
++      expr.X_op = O_subtract;
++      expr.X_add_symbol = to_sym;
++      expr.X_op_symbol = from_sym;
++      expr.X_add_number = 0;
++      emit_expr (&amp;expr, 2);
++
++      out_opcode (DW_LNS_extended_op);
++      out_byte (1);
++      out_opcode (DW_LNE_end_sequence);
++      return;
++    }
++
++  out_opcode (DW_LNS_advance_line);
++  out_sleb128 (line_delta);
++
++  out_opcode (DW_LNS_fixed_advance_pc);
++  expr.X_op = O_subtract;
++  expr.X_add_symbol = to_sym;
++  expr.X_op_symbol = from_sym;
++  expr.X_add_number = 0;
++  emit_expr (&amp;expr, 2);
++
++  out_opcode (DW_LNS_copy);
++}
++
+ /* Generate a variant frag that we can use to relax address/line
+    increments between fragments of the target segment.  */
+ 
+@@ -1129,6 +1183,8 @@ process_entries (segT seg, struct line_e
+ 	  out_set_addr (lab);
+ 	  out_inc_line_addr (line_delta, 0);
+ 	}
++      else if (DWARF2_USE_FIXED_ADVANCE_PC)
++	out_fixed_inc_line_addr (line_delta, lab, last_lab);
+       else if (frag == last_frag)
+ 	out_inc_line_addr (line_delta, frag_ofs - last_frag_ofs);
+       else
+@@ -1148,7 +1204,12 @@ process_entries (segT seg, struct line_e
+   /* Emit a DW_LNE_end_sequence for the end of the section.  */
+   frag = last_frag_for_seg (seg);
+   frag_ofs = get_frag_fix (frag, seg);
+-  if (frag == last_frag)
++  if (DWARF2_USE_FIXED_ADVANCE_PC)
++    {
++      lab = symbol_temp_new (seg, frag_ofs, frag);
++      out_fixed_inc_line_addr (INT_MAX, lab, last_lab);
++    }
++  else if (frag == last_frag)
+     out_inc_line_addr (INT_MAX, frag_ofs - last_frag_ofs);
+   else
+     {
+@@ -1290,6 +1351,54 @@ out_debug_line (segT line_seg)
+   symbol_set_value_now (line_end);
+ }
+ 
++static void
++out_debug_ranges (segT ranges_seg)
++{
++  unsigned int addr_size = sizeof_address;
++  struct line_seg *s;
++  expressionS expr;
++  unsigned int i;
++
++  subseg_set (ranges_seg, 0);
++
++  /* Base Address Entry.  */
++  for (i = 0; i &lt; addr_size; i++) 
++    out_byte (0xff);
++  for (i = 0; i &lt; addr_size; i++) 
++    out_byte (0);
++
++  /* Range List Entry.  */
++  for (s = all_segs; s; s = s-&gt;next)
++    {
++      fragS *frag;
++      symbolS *beg, *end;
++
++      frag = first_frag_for_seg (s-&gt;seg);
++      beg = symbol_temp_new (s-&gt;seg, 0, frag);
++      s-&gt;text_start = beg;
++
++      frag = last_frag_for_seg (s-&gt;seg);
++      end = symbol_temp_new (s-&gt;seg, get_frag_fix (frag, s-&gt;seg), frag);
++      s-&gt;text_end = end;
++
++      expr.X_op = O_symbol;
++      expr.X_add_symbol = beg;
++      expr.X_add_number = 0;
++      emit_expr (&amp;expr, addr_size);
++
++      expr.X_op = O_symbol;
++      expr.X_add_symbol = end;
++      expr.X_add_number = 0;
++      emit_expr (&amp;expr, addr_size);
++    }
++
++  /* End of Range Entry.   */
++  for (i = 0; i &lt; addr_size; i++) 
++    out_byte (0);
++  for (i = 0; i &lt; addr_size; i++) 
++    out_byte (0);
++}
++
+ /* Emit data for .debug_aranges.  */
+ 
+ static void
+@@ -1382,6 +1491,13 @@ out_debug_abbrev (segT abbrev_seg)
+       out_abbrev (DW_AT_low_pc, DW_FORM_addr);
+       out_abbrev (DW_AT_high_pc, DW_FORM_addr);
+     }
++  else
++    {
++      if (DWARF2_FORMAT () == dwarf2_format_32bit)
++	out_abbrev (DW_AT_ranges, DW_FORM_data4);
++      else
++	out_abbrev (DW_AT_ranges, DW_FORM_data8);
++    }
+   out_abbrev (DW_AT_name, DW_FORM_string);
+   out_abbrev (DW_AT_comp_dir, DW_FORM_string);
+   out_abbrev (DW_AT_producer, DW_FORM_string);
+@@ -1395,7 +1511,7 @@ out_debug_abbrev (segT abbrev_seg)
+ /* Emit a description of this compilation unit for .debug_info.  */
+ 
+ static void
+-out_debug_info (segT info_seg, segT abbrev_seg, segT line_seg)
++out_debug_info (segT info_seg, segT abbrev_seg, segT line_seg, segT ranges_seg)
+ {
+   char producer[128];
+   char *comp_dir;
+@@ -1458,8 +1574,7 @@ out_debug_info (segT info_seg, segT abbr
+   /* ??? sizeof_offset */
+   TC_DWARF2_EMIT_OFFSET (section_symbol (line_seg), 4);
+ 
+-  /* These two attributes may only be emitted if all of the code is
+-     contiguous.  Multiple sections are not that.  */
++  /* These two attributes are emitted if all of the code is contiguous.  */
+   if (all_segs-&gt;next == NULL)
+     {
+       /* DW_AT_low_pc */
+@@ -1474,6 +1589,12 @@ out_debug_info (segT info_seg, segT abbr
+       expr.X_add_number = 0;
+       emit_expr (&amp;expr, sizeof_address);
+     }
++  else
++    {
++      /* This attribute is emitted if the code is disjoint.  */
++      /* DW_AT_ranges.  */
++      TC_DWARF2_EMIT_OFFSET (section_symbol (ranges_seg), sizeof_offset);
++    }
+ 
+   /* DW_AT_name.  We don't have the actual file name that was present
+      on the command line, so assume files[1] is the main input file.
+@@ -1564,6 +1685,7 @@ dwarf2_finish (void)
+     {
+       segT abbrev_seg;
+       segT aranges_seg;
++      segT ranges_seg;
+ 
+       assert (all_segs);
+       
+@@ -1580,8 +1702,19 @@ dwarf2_finish (void)
+ 
+       record_alignment (aranges_seg, ffs (2 * sizeof_address) - 1);
+ 
++      if (all_segs-&gt;next == NULL)
++	ranges_seg = NULL;
++      else
++	{
++	  ranges_seg = subseg_new (&quot;.debug_ranges&quot;, 0);
++	  bfd_set_section_flags (stdoutput, ranges_seg, 
++				 SEC_READONLY | SEC_DEBUGGING);
++	  record_alignment (ranges_seg, ffs (2 * sizeof_address) - 1);
++	  out_debug_ranges (ranges_seg);
++	}
++
+       out_debug_aranges (aranges_seg, info_seg);
+       out_debug_abbrev (abbrev_seg);
+-      out_debug_info (info_seg, abbrev_seg, line_seg);
++      out_debug_info (info_seg, abbrev_seg, line_seg, ranges_seg);
+     }
+ }
+--- gas/testsuite/gas/lns/lns-common-1-alt.d	1969-12-31 19:00:00.000000000 -0500
++++ gas/testsuite/gas/lns/lns-common-1-alt.d	2006-09-24 11:19:58.000000000 -0400
+@@ -0,0 +1,39 @@
++#source: lns-common-1.s
++#readelf: -wl
++#name: lns-common-1
++Dump of debug contents of section \.debug_line:
++#...
++  Initial value of 'is_stmt':  1
++#...
++ Line Number Statements:
++  Extended opcode 2: set Address to .*
++  Copy
++  Set column to 3
++  Advance Line by 1 to 2
++  Advance PC by fixed size amount .* to .*
++  Copy
++  Set prologue_end to true
++  Advance Line by 1 to 3
++  Advance PC by fixed size amount .* to .*
++  Copy
++  Set column to 0
++  Set epilogue_begin to true
++  Advance Line by 1 to 4
++  Advance PC by fixed size amount .* to .*
++  Copy
++  Set ISA to 1
++  Set basic block
++  Advance Line by 1 to 5
++  Advance PC by fixed size amount .* to .*
++  Copy
++  Set is_stmt to 0
++  Advance Line by 1 to 6
++  Advance PC by fixed size amount .* to .*
++  Copy
++  Set is_stmt to 1
++  Advance Line by 1 to 7
++  Advance PC by fixed size amount .* to .*
++  Copy
++  Advance PC by fixed size amount .* to .*
++  Extended opcode 1: End of Sequence
++#...
+--- gas/testsuite/gas/lns/lns.exp	2005-11-13 12:16:35.000000000 -0500
++++ gas/testsuite/gas/lns/lns.exp	2006-09-24 11:19:58.000000000 -0400
+@@ -23,5 +23,10 @@ run_list_test &quot;lns-diag-1&quot; &quot;&quot;
+ # defined a macro...
+ if { ![istarget ia64*-*-*] &amp;&amp; ![istarget i370-*-*] &amp;&amp; ![istarget i960-*-*]
+      &amp;&amp; ![istarget or32-*-*] &amp;&amp; ![istarget s390*-*-*] } {
+-  run_dump_test &quot;lns-common-1&quot;
++  # Use alternate file for targets using DW_LNS_fixed_advance_pc opcodes.
++  if { [istarget xtensa-*-*] } {
++    run_dump_test &quot;lns-common-1-alt&quot;
++  } else {
++    run_dump_test &quot;lns-common-1&quot;
++  }
+ }

Added: branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-ia64-lib64.patch
===================================================================
--- branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-ia64-lib64.patch	                        (rev 0)
+++ branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-ia64-lib64.patch	2008-06-09 23:18:27 UTC (rev 6350)
@@ -0,0 +1,36 @@
+2004-05-14  Jakub Jelinek  &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">jakub at redhat.com</A>&gt;
+
+	* emulparams/elf64_ia64.sh (LIBPATH_SUFFIX): Use */lib64 paths on
+	ia64-linux if /lib64 tree is present.
+
+--- ld/emulparams/elf64_ia64.sh.jj	2004-02-18 20:06:03.000000000 +0100
++++ ld/emulparams/elf64_ia64.sh	2004-05-14 10:11:22.992278608 +0200
+@@ -37,3 +37,13 @@ OTHER_READONLY_SECTIONS=&quot;${OTHER_READONL
+ # .dtors.  They have to be next to .sbss/.sbss2/.sdata/.sdata2.
+ SMALL_DATA_CTOR=&quot; &quot;
+ SMALL_DATA_DTOR=&quot; &quot;
++
++# Linux modify the default library search path to first include
++# a 64-bit specific directory.
++case &quot;$target&quot; in
++  ia64*-linux*)
++    case &quot;$EMULATION_NAME&quot; in
++      *64*) test -d /lib64 &amp;&amp; LIBPATH_SUFFIX=64 ;;
++    esac
++    ;;
++esac
+--- ltconfig	2003-02-03 16:56:49.000000000 +0900
++++ ltconfig	2003-02-03 16:56:49.000000000 +0900
+@@ -1240,10 +1240,10 @@
+ 
+   # Find out which ABI we are using (multilib hack).
+   case &quot;$host_cpu&quot; in
+-  x86_64*|s390*|sparc*|ppc*|powerpc*)
++  x86_64*|s390*|sparc*|ppc*|powerpc*|ia64)
+     echo &quot;$progname:@lineno@: checking multilib ABI type&quot; 1&gt;&amp;5
+     touch conftest.$ac_ext
+-    if { (eval echo $progname: \&quot;$ac_compile\&quot;) 1&gt;&amp;5; (eval $ac_compile) 2&gt;conftest.err; } &amp;&amp; test -s conftest.$objext; then
++    if test -d /lib64 &amp;&amp; { (eval echo $progname: \&quot;$ac_compile\&quot;) 1&gt;&amp;5; (eval $ac_compile) 2&gt;conftest.err; } &amp;&amp; test -s conftest.$objext; then
+       case `/usr/bin/file conftest.o` in
+       *64-bit*)
+ 	sys_lib_dlsearch_path_spec=&quot;/lib64 /usr/lib64&quot;

Added: branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-kept-section.patch
===================================================================
--- branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-kept-section.patch	                        (rev 0)
+++ branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-kept-section.patch	2008-06-09 23:18:27 UTC (rev 6350)
@@ -0,0 +1,60 @@
+2006-04-24  Michael Matz  &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">matz at suse.de</A>&gt;
+	    H.J. Lu  &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">hongjiu.lu at intel.com</A>&gt;
+
+	* elf-bfd.h (bfd_elf_section_data): Add kept_section.
+	(elf_kept_section): New.
+
+	* elflink.c (_bfd_elf_check_kept_section): Cache the result in
+	elf_kept_section.
+
+--- bfd/elf-bfd.h.kept	2006-03-16 12:37:42.000000000 -0800
++++ bfd/elf-bfd.h	2006-04-24 20:11:00.000000000 -0700
+@@ -1168,6 +1168,10 @@ struct bfd_elf_section_data
+      the linker.  */
+   asection *next_in_group;
+ 
++  /* The pointer to the real kept section. It is computed from the
++     kept_section field in asection due to section group.  */ 
++  asection *kept_section;
++
+   /* A pointer used for various section optimizations.  */
+   void *sec_info;
+ };
+@@ -1180,6 +1184,7 @@ struct bfd_elf_section_data
+ #define elf_group_id(sec)      (elf_section_data(sec)-&gt;group.id)
+ #define elf_next_in_group(sec) (elf_section_data(sec)-&gt;next_in_group)
+ #define elf_sec_group(sec)	(elf_section_data(sec)-&gt;sec_group)
++#define elf_kept_section(sec) (elf_section_data(sec)-&gt;kept_section)
+ 
+ /* Return TRUE if section has been discarded.  */
+ #define elf_discarded_section(sec)				\
+--- bfd/elflink.c.kept	2006-04-24 15:36:18.000000000 -0700
++++ bfd/elflink.c	2006-04-24 20:18:03.000000000 -0700
+@@ -6798,7 +6799,14 @@ _bfd_elf_check_kept_section (asection *s
+ {
+   asection *kept;
+ 
++  kept = elf_kept_section (sec);
++  if (kept)
++    return kept;
++
+   kept = sec-&gt;kept_section;
++  if (!kept)
++    return kept;
++
+   if (kept != NULL)
+     {
+       if (elf_sec_group (sec) != NULL)
+@@ -6806,6 +6814,12 @@ _bfd_elf_check_kept_section (asection *s
+       if (kept != NULL &amp;&amp; sec-&gt;size != kept-&gt;size)
+ 	kept = NULL;
+     }
++
++  if (kept)
++    elf_kept_section (sec) = kept;
++  else
++    sec-&gt;kept_section = NULL;
++
+   return kept;
+ }
+ 

Added: branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-ltconfig-multilib.patch
===================================================================
--- branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-ltconfig-multilib.patch	                        (rev 0)
+++ branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-ltconfig-multilib.patch	2008-06-09 23:18:27 UTC (rev 6350)
@@ -0,0 +1,26 @@
+--- ltconfig.jj	2003-02-03 16:56:49.000000000 +0900
++++ ltconfig	2003-02-03 16:56:49.000000000 +0900
+@@ -1237,6 +1237,23 @@
+   # people can always --disable-shared, the test was removed, and we
+   # assume the GNU/Linux dynamic linker is in use.
+   dynamic_linker='GNU/Linux ld.so'
++
++  # Find out which ABI we are using (multilib hack).
++  case &quot;$host_cpu&quot; in
++  x86_64*|s390*|sparc*|ppc*|powerpc*)
++    echo &quot;$progname:@lineno@: checking multilib ABI type&quot; 1&gt;&amp;5
++    touch conftest.$ac_ext
++    if { (eval echo $progname: \&quot;$ac_compile\&quot;) 1&gt;&amp;5; (eval $ac_compile) 2&gt;conftest.err; } &amp;&amp; test -s conftest.$objext; then
++      case `/usr/bin/file conftest.o` in
++      *64-bit*)
++	sys_lib_dlsearch_path_spec=&quot;/lib64 /usr/lib64&quot;
++	sys_lib_search_path_spec=&quot;/lib64 /usr/lib64 /usr/local/lib64&quot;
++        ;;
++      esac
++    fi
++    rm -rf conftest*
++    ;;
++  esac
+   ;;
+ 
+ netbsd*)

Added: branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-place-orphan.patch
===================================================================
--- branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-place-orphan.patch	                        (rev 0)
+++ branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-place-orphan.patch	2008-06-09 23:18:27 UTC (rev 6350)
@@ -0,0 +1,16 @@
+2003-08-05  Jakub Jelinek  &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">jakub at redhat.com</A>&gt;
+
+	* emulparams/elf64ppc.sh (OTHER_GOT_RELOC_SECTIONS): Add .rela.opd.
+
+--- ld/emulparams/elf64ppc.sh.jj	2003-07-28 10:24:45.000000000 -0400
++++ ld/emulparams/elf64ppc.sh	2003-08-05 08:35:58.000000000 -0400
+@@ -28,7 +28,8 @@ else
+   .toc		0 : { *(.toc) }&quot;
+ fi
+ OTHER_GOT_RELOC_SECTIONS=&quot;
+-  .rela.toc	${RELOCATING-0} : { *(.rela.toc) }&quot;
++  .rela.toc	${RELOCATING-0} : { *(.rela.toc) }
++  .rela.opd	${RELOCATING-0} : { *(.rela.opd) }&quot;
+ OTHER_READWRITE_SECTIONS=&quot;
+   .toc1		${RELOCATING-0}${RELOCATING+ALIGN(8)} : { *(.toc1) }
+   .opd		${RELOCATING-0}${RELOCATING+ALIGN(8)} : { KEEP (*(.opd)) }&quot;

Added: branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-popcnt.patch
===================================================================
--- branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-popcnt.patch	                        (rev 0)
+++ branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-popcnt.patch	2008-06-09 23:18:27 UTC (rev 6350)
@@ -0,0 +1,156 @@
+2006-10-23  Dwarakanath Rajagopal  &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dwarak.rajagopal at amd.com</A>&gt;
+
+opcodes/
+	* i386-dis.c (dis386): Add support for the change in POPCNT opcode in 
+	amdfam10 architecture.
+	(PREGRP37): NEW.
+	(print_insn): Disallow REP prefix for POPCNT.
+include/
+	* i386.h :  Modify opcode to support for the change in POPCNT opcode 
+	in amdfam10 architecture.
+gas/
+	* doc/c-i386.texi : Document amdfam10,.sse4a and .abm in cpu_type.
+gas/testsuite/
+	* gas/i386/amdfam10.d : Modify to support for the change in POPCNT
+	opcode in amdfam10 architecture.
+	* gas/i386/x86-64-amdfam10.d : Ditto.
+	 
+--- opcodes/i386-dis.c	24 Sep 2006 17:25:47 -0000	1.89
++++ opcodes/i386-dis.c	23 Oct 2006 22:53:29 -0000	1.90
+@@ -471,6 +471,8 @@ fetch_data (struct disassemble_info *inf
+ #define PREGRP34  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 34, NULL, 0, NULL, 0
+ #define PREGRP35  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 35, NULL, 0, NULL, 0
+ #define PREGRP36  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 36, NULL, 0, NULL, 0
++#define PREGRP37  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 37, NULL, 0, NULL, 0
++
+ 
+ #define X86_64_0  NULL, NULL, X86_64_SPECIAL, NULL,  0, NULL, 0, NULL, 0
+ 
+@@ -1028,7 +1030,7 @@ static const struct dis386 dis386_twobyt
+   { &quot;movz{bR|x|bR|x}&quot;,	Gv, Eb, XX, XX },
+   { &quot;movz{wR|x|wR|x}&quot;,	Gv, Ew, XX, XX }, /* yes, there really is movzww ! */
+   /* b8 */
+-  { &quot;popcntS&quot;,          Gv, Ev, XX, XX },
++  { PREGRP37 },
+   { &quot;ud2b&quot;,		XX, XX, XX, XX },
+   { GRP8 },
+   { &quot;btcS&quot;,		Ev, Gv, XX, XX },
+@@ -1820,6 +1822,13 @@ static const struct dis386 prefix_user_t
+     { &quot;(bad)&quot;,  XX, XX, XX, XX },
+   },
+ 
++  /* PREGRP37 */
++  {
++    { &quot;(bad)&quot;,  XX, XX, XX, XX },
++    { &quot;popcntS&quot;,Gv, Ev, XX, XX },
++    { &quot;(bad)&quot;,  XX, XX, XX, XX },
++    { &quot;(bad)&quot;,  XX, XX, XX, XX },    
++  },
+ };
+ 
+ static const struct dis386 x86_64_table[][2] = {
+@@ -2827,13 +2836,14 @@ print_insn (bfd_vma pc, disassemble_info
+       uses_LOCK_prefix = 0;
+     }
+   
+-  /*&quot;lzcnt&quot;=0xBD is the only non-sse instruction which uses F3 in the opcode without any &quot;rep(z|nz)&quot;*/
+-  if (!uses_SSE_prefix &amp;&amp; (prefixes &amp; PREFIX_REPZ) &amp;&amp; *codep !=0xBD)
++  /*&quot;lzcnt&quot;=0xBD and &quot;popcnt&quot;=0xB8 are the only two non-sse 
++    instruction which uses F3 in the opcode without any &quot;rep(z|nz)&quot;*/
++  if (!uses_SSE_prefix &amp;&amp; (prefixes &amp; PREFIX_REPZ) &amp;&amp; *codep != 0xBD &amp;&amp; *codep != 0xB8)
+     {
+       oappend (&quot;repz &quot;);
+       used_prefixes |= PREFIX_REPZ;
+     }
+-  if (!uses_SSE_prefix &amp;&amp; (prefixes &amp; PREFIX_REPNZ) &amp;&amp; *codep !=0xBD)
++  if (!uses_SSE_prefix &amp;&amp; (prefixes &amp; PREFIX_REPNZ) &amp;&amp; *codep != 0xBD &amp;&amp; *codep != 0xB8)
+     {
+       oappend (&quot;repnz &quot;);
+       used_prefixes |= PREFIX_REPNZ;
+--- include/opcode/i386.h	28 Sep 2006 14:06:36 -0000	1.71
++++ include/opcode/i386.h	23 Oct 2006 22:53:28 -0000	1.72
+@@ -1472,7 +1472,7 @@ static const template i386_optab[] =
+ {&quot;insertq&quot;,  4, 0xf20f78,  X, CpuSSE4a, NoSuf|IgnoreSize|Modrm, { Imm8, Imm8, RegXMM, RegXMM} },
+ 
+ /* ABM instructions */
+-{&quot;popcnt&quot;,   2,   0x0fb8,  X, CpuABM, wlq_Suf|Modrm,          { WordReg|WordMem, WordReg, 0} },
++{&quot;popcnt&quot;,   2, 0xf30fb8,  X, CpuABM, wlq_Suf|Modrm,          { WordReg|WordMem, WordReg, 0} },
+ {&quot;lzcnt&quot;,    2, 0xf30fbd,  X, CpuABM, wlq_Suf|Modrm,          { WordReg|WordMem, WordReg, 0} },
+ 
+ 
+--- gas/doc/c-i386.texi	28 Sep 2006 14:06:36 -0000	1.16
++++ gas/doc/c-i386.texi	23 Oct 2006 22:53:28 -0000	1.17
+@@ -753,10 +753,11 @@ supported on the CPU specified.  The cho
+ @item @samp{i486} @tab @samp{i586} @tab @samp{i686} @tab @samp{pentium}
+ @item @samp{pentiumpro} @tab @samp{pentiumii} @tab @samp{pentiumiii} @tab @samp{pentium4}
+ @item @samp{prescott} @tab @samp{nocona} @tab @samp{core} @tab @samp{core2}
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">++ at item</A> @samp{amdfam10}
+ @item @samp{k6} @tab @samp{athlon} @tab @samp{sledgehammer} @tab @samp{k8} 
+ @item @samp{.mmx} @tab @samp{.sse} @tab @samp{.sse2} @tab @samp{.sse3}
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">+- at item</A> @samp{.3dnow} @tab @samp{.3dnowa} @tab @samp{.padlock} @tab @samp{.pacifica}
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">+- at item</A> @samp{.svme}
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">++ at item</A> @samp{.sse4a} @tab @samp{.3dnow} @tab @samp{.3dnowa} @tab @samp{.padlock}
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">++ at item</A> @samp{.pacifica} @tab @samp{.svme} @tab @samp{.abm}
+ @end multitable
+ 
+ Apart from the warning, there are only two other effects on
+--- gas/testsuite/gas/i386/amdfam10.d	20 Jul 2006 23:09:32 -0000	1.2
++++ gas/testsuite/gas/i386/amdfam10.d	23 Oct 2006 22:53:28 -0000	1.3
+@@ -10,15 +10,14 @@ Disassembly of section .text:
+    4:	f3 66 0f bd 19[ 	 ]+lzcnt  \(%ecx\),%bx
+    9:	f3 0f bd d9[ 	 ]+lzcnt  %ecx,%ebx
+    d:	f3 66 0f bd d9[ 	 ]+lzcnt  %cx,%bx
+-  12:	0f b8 19[ 	]+popcnt \(%ecx\),%ebx
+-  15:	66 0f b8 19[ 	]+popcnt \(%ecx\),%bx
+-  19:	0f b8 d9[ 	]+popcnt %ecx,%ebx
+-  1c:	66 0f b8 d9[ 	]+popcnt %cx,%bx
+-  20:	66 0f 79 ca[ 	]+extrq  %xmm2,%xmm1
+-  24:	66 0f 78 c1 02 04[ 	]*extrq  \$0x4,\$0x2,%xmm1
+-  2a:	f2 0f 79 ca[ 	]+insertq %xmm2,%xmm1
+-  2e:	f2 0f 78 ca 02 04[ 	]*insertq \$0x4,\$0x2,%xmm2,%xmm1
+-  34:	f2 0f 2b 09[ 	]+movntsd %xmm1,\(%ecx\)
+-  38:	f3 0f 2b 09[ 	]+movntss %xmm1,\(%ecx\)
+-  3c:	00 00 [ 	]+add    %al,\(%eax\)
+-	...
++  12:	f3 0f b8 19[ 	]+popcnt \(%ecx\),%ebx
++  16:	f3 66 0f b8 19[ 	]+popcnt \(%ecx\),%bx
++  1b:	f3 0f b8 d9[ 	]+popcnt %ecx,%ebx
++  1f:	f3 66 0f b8 d9[ 	]+popcnt %cx,%bx
++  24:	66 0f 79 ca[ 	]+extrq  %xmm2,%xmm1
++  28:	66 0f 78 c1 02 04[ 	]*extrq  \$0x4,\$0x2,%xmm1
++  2e:	f2 0f 79 ca[ 	]+insertq %xmm2,%xmm1
++  32:	f2 0f 78 ca 02 04[ 	]*insertq \$0x4,\$0x2,%xmm2,%xmm1
++  38:	f2 0f 2b 09[ 	]+movntsd %xmm1,\(%ecx\)
++  3c:	f3 0f 2b 09[ 	]+movntss %xmm1,\(%ecx\)
++
+--- gas/testsuite/gas/i386/x86-64-amdfam10.d	20 Jul 2006 23:09:32 -0000	1.2
++++ gas/testsuite/gas/i386/x86-64-amdfam10.d	23 Oct 2006 22:53:28 -0000	1.3
+@@ -12,16 +12,16 @@ Disassembly of section .text:
+    e:	f3 48 0f bd d9[ 	]+lzcnt  %rcx,%rbx
+   13:	f3 0f bd d9[ 	]+lzcnt  %ecx,%ebx
+   17:	f3 66 0f bd d9[ 	]+lzcnt  %cx,%bx
+-  1c:	48 0f b8 19[ 	]+popcnt \(%rcx\),%rbx
+-  20:	0f b8 19[ 	]+popcnt \(%rcx\),%ebx
+-  23:	66 0f b8 19[ 	]+popcnt \(%rcx\),%bx
+-  27:	48 0f b8 d9[ 	]+popcnt %rcx,%rbx
+-  2b:	0f b8 d9[ 	]+popcnt %ecx,%ebx
+-  2e:	66 0f b8 d9[ 	]+popcnt %cx,%bx
+-  32:	66 0f 79 ca[ 	]+extrq  %xmm2,%xmm1
+-  36:	66 0f 78 c1 02 04[ 	]+extrq  \$0x4,\$0x2,%xmm1
+-  3c:	f2 0f 79 ca[ 	]+insertq %xmm2,%xmm1
+-  40:	f2 0f 78 ca 02 04[ 	]+insertq \$0x4,\$0x2,%xmm2,%xmm1
+-  46:	f2 0f 2b 09[ 	]+movntsd %xmm1,\(%rcx\)
+-  4a:	f3 0f 2b 09[ 	]+movntss %xmm1,\(%rcx\)
++  1c:	f3 48 0f b8 19[ 	]+popcnt \(%rcx\),%rbx
++  21:	f3 0f b8 19[ 	]+popcnt \(%rcx\),%ebx
++  25:	f3 66 0f b8 19[ 	]+popcnt \(%rcx\),%bx
++  2a:	f3 48 0f b8 d9[ 	]+popcnt %rcx,%rbx
++  2f:	f3 0f b8 d9[ 	]+popcnt %ecx,%ebx
++  33:	f3 66 0f b8 d9[ 	]+popcnt %cx,%bx
++  38:	66 0f 79 ca[ 	]+extrq  %xmm2,%xmm1
++  3c:	66 0f 78 c1 02 04[ 	]+extrq  \$0x4,\$0x2,%xmm1
++  42:	f2 0f 79 ca[ 	]+insertq %xmm2,%xmm1
++  46:	f2 0f 78 ca 02 04[ 	]+insertq \$0x4,\$0x2,%xmm2,%xmm1
++  4c:	f2 0f 2b 09[ 	]+movntsd %xmm1,\(%rcx\)
++  50:	f3 0f 2b 09[ 	]+movntss %xmm1,\(%rcx\)
+ 	...

Added: branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-power6-insns.patch
===================================================================
--- branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-power6-insns.patch	                        (rev 0)
+++ branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-power6-insns.patch	2008-06-09 23:18:27 UTC (rev 6350)
@@ -0,0 +1,25 @@
+2006-07-11  Peter Bergner  &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">bergner at vnet.ibm.com</A>&gt;
+
+	* ppc-opc.c (POWER6): Define.
+	(powerpc_opcodes): Add &quot;mffgpr&quot; and &quot;mftgpr&quot; opcodes.
+
+--- opcodes/ppc-opc.c	15 Nov 2005 21:33:04 -0000	1.85
++++ opcodes/ppc-opc.c	11 Jul 2006 21:56:59 -0000
+@@ -1823,6 +1823,7 @@ extract_tbr (unsigned long insn,
+ #define NOPOWER4 PPC_OPCODE_NOPOWER4 | PPCCOM
+ #define POWER4	PPC_OPCODE_POWER4
+ #define POWER5	PPC_OPCODE_POWER5
++#define POWER6	PPC_OPCODE_POWER6
+ #define PPC32   PPC_OPCODE_32 | PPC_OPCODE_PPC
+ #define PPC64   PPC_OPCODE_64 | PPC_OPCODE_PPC
+ #define PPC403	PPC_OPCODE_403
+@@ -4255,6 +4256,9 @@ const struct powerpc_opcode powerpc_opco
+ 
+ { &quot;lfdxe&quot;,   X(31,607), X_MASK,		BOOKE64,	{ FRT, RA0, RB } },
+ 
++{ &quot;mffgpr&quot;,  XRC(31,607,0), XRA_MASK,	POWER6,		{ FRT, RB } },
++{ &quot;mftgpr&quot;,  XRC(31,735,0), XRA_MASK,	POWER6,		{ RT, FRB } },
++
+ { &quot;mfsri&quot;,   X(31,627), X_MASK,		PWRCOM,		{ RT, RA, RB } },
+ 
+ { &quot;dclst&quot;,   X(31,630), XRB_MASK,	PWRCOM,		{ RS, RA } },

Added: branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-ppc-relbrlt-test.patch
===================================================================
--- branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-ppc-relbrlt-test.patch	                        (rev 0)
+++ branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-ppc-relbrlt-test.patch	2008-06-09 23:18:27 UTC (rev 6350)
@@ -0,0 +1,150 @@
+2006-10-24  Alan Modra  &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">amodra at bigpond.net.au</A>&gt;
+
+	* ld-powerpc/plt1.s: New.
+	* ld-powerpc/plt1.d: New.
+	* ld-powerpc/relbrlt.s: New.
+	* ld-powerpc/relbrlt.d: New.
+	* ld-powerpc/powerpc.exp: Run them.
+
+--- ld/testsuite/ld-powerpc/powerpc.exp	3 Mar 2006 09:32:01 -0000	1.15
++++ ld/testsuite/ld-powerpc/powerpc.exp	24 Oct 2006 13:29:37 -0000	1.16
+@@ -1,5 +1,5 @@
+ # Expect script for ld-powerpc tests
+-#   Copyright 2002, 2003, 2005 Free Software Foundation
++#   Copyright 2002, 2003, 2005, 2006 Free Software Foundation
+ #
+ # This file is free software; you can redistribute it and/or modify
+ # it under the terms of the GNU General Public License as published by
+@@ -143,4 +143,7 @@ run_ld_link_tests $ppcelftests
+ 
+ if [ supports_ppc64 ] then {
+     run_ld_link_tests $ppc64elftests
++    run_dump_test &quot;relbrlt&quot;
+ }
++
++run_dump_test &quot;plt1&quot;
+--- ld/testsuite/ld-powerpc/plt1.d	1 Jan 1970 00:00:00 -0000
++++ ld/testsuite/ld-powerpc/plt1.d	24 Oct 2006 13:29:37 -0000	1.1
+@@ -0,0 +1,20 @@
++#source: plt1.s
++#as: -a32
++#objdump: -dr
++#target: powerpc*-*-*
++
++.*:     file format elf32-powerpc
++
++Disassembly of section .text:
++
++0+ &lt;_start&gt;:
++   0:	42 9f 00 05 	bcl-    20,4\*cr7\+so,4 .*
++   4:	7f c8 02 a6 	mflr    r30
++   8:	3f de 00 00 	addis   r30,r30,0
++			a: R_PPC_REL16_HA	_GLOBAL_OFFSET_TABLE_\+0x6
++   c:	3b de 00 0a 	addi    r30,r30,10
++			e: R_PPC_REL16_LO	_GLOBAL_OFFSET_TABLE_\+0xa
++  10:	48 00 00 01 	bl      10 .*
++			10: R_PPC_PLTREL24	_exit
++  14:	48 00 00 00 	b       14 .*
++			14: R_PPC_REL24	_start
+--- ld/testsuite/ld-powerpc/plt1.s	1 Jan 1970 00:00:00 -0000
++++ ld/testsuite/ld-powerpc/plt1.s	24 Oct 2006 13:29:37 -0000	1.1
+@@ -0,0 +1,9 @@
++	.text
++	.global _start
++_start:
++	bcl 20,31,1f
++1:	mflr 30
++	addis 30,30,(_GLOBAL_OFFSET_TABLE_-1b)@ha
++	addi 30,30,(_GLOBAL_OFFSET_TABLE_-1b)@l
++	bl <A HREF="http://lists.repoforge.org/mailman/listinfo/commits">_exit at plt</A>
++	b _start
+--- ld/testsuite/ld-powerpc/relbrlt.d	1 Jan 1970 00:00:00 -0000
++++ ld/testsuite/ld-powerpc/relbrlt.d	24 Oct 2006 13:29:37 -0000	1.1
+@@ -0,0 +1,50 @@
++#source: relbrlt.s
++#as: -a64
++#ld: -melf64ppc --emit-relocs
++#objdump: -dr
++
++.*:     file format elf64-powerpc
++
++Disassembly of section \.text:
++
++0*100000a8 &lt;_start&gt;:
++    100000a8:	49 bf 00 31 	bl      11bf00d8 .*
++			100000a8: R_PPC64_REL24	\.text\+0x37e0044
++    100000ac:	60 00 00 00 	nop
++    100000b0:	49 bf 00 19 	bl      11bf00c8 .*
++			100000b0: R_PPC64_REL24	\.text\+0x3bf0020
++    100000b4:	60 00 00 00 	nop
++    100000b8:	49 bf 00 25 	bl      11bf00dc .*
++			100000b8: R_PPC64_REL24	\.text\+0x57e0024
++    100000bc:	60 00 00 00 	nop
++    100000c0:	00 00 00 00 	\.long 0x0
++    100000c4:	4b ff ff e4 	b       100000a8 &lt;_start&gt;
++	\.\.\.
++
++0*11bf00c8 &lt;.*plt_branch.*&gt;:
++    11bf00c8:	3d 82 05 7e 	addis   r12,r2,1406
++    11bf00cc:	e9 6c 80 58 	ld      r11,-32680\(r12\)
++    11bf00d0:	7d 69 03 a6 	mtctr   r11
++    11bf00d4:	4e 80 04 20 	bctr
++
++0*11bf00d8 &lt;.*long_branch.*&gt;:
++    11bf00d8:	49 bf 00 14 	b       137e00ec &lt;far&gt;
++			11bf00d8: R_PPC64_REL24	\*ABS\*\+0x137e00ec
++
++0*11bf00dc &lt;.*plt_branch.*&gt;:
++    11bf00dc:	3d 82 05 7e 	addis   r12,r2,1406
++    11bf00e0:	e9 6c 80 60 	ld      r11,-32672\(r12\)
++    11bf00e4:	7d 69 03 a6 	mtctr   r11
++    11bf00e8:	4e 80 04 20 	bctr
++	\.\.\.
++
++0*137e00ec &lt;far&gt;:
++    137e00ec:	4e 80 00 20 	blr
++	\.\.\.
++
++0*13bf00c8 &lt;far2far&gt;:
++    13bf00c8:	4e 80 00 20 	blr
++	\.\.\.
++
++0*157e00cc &lt;huge&gt;:
++    157e00cc:	4e 80 00 20 	blr
+--- ld/testsuite/ld-powerpc/relbrlt.s	1 Jan 1970 00:00:00 -0000
++++ ld/testsuite/ld-powerpc/relbrlt.s	24 Oct 2006 13:29:37 -0000	1.1
+@@ -0,0 +1,34 @@
++ .text
++ .global _start
++_start:
++1:
++ bl far
++ nop
++ bl far2far
++ nop
++ bl huge
++ nop
++ .long 0
++ b 1b
++ .space 0x1bf0000
++
++ .section .text.pad1,&quot;ax&quot;
++ .space 0x1bf0000
++
++ .section .text.far,&quot;ax&quot;
++far:
++ blr
++
++ .section .text.pad2,&quot;ax&quot;
++ .space 0x40ffd8
++
++ .section .text.far2far,&quot;ax&quot;
++far2far:
++ blr
++
++ .section .text.pad3,&quot;ax&quot;
++ .space 0x1bf0000
++
++ .section .text.huge,&quot;ax&quot;
++huge:
++ blr

Added: branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-ppc64-pie.patch
===================================================================
--- branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-ppc64-pie.patch	                        (rev 0)
+++ branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-ppc64-pie.patch	2008-06-09 23:18:27 UTC (rev 6350)
@@ -0,0 +1,16 @@
+--- bfd/elf64-ppc.c.jj	2004-09-27 16:46:06.000000000 -0400
++++ bfd/elf64-ppc.c	2004-10-04 09:09:50.000000000 -0400
+@@ -9681,7 +9681,12 @@ ppc64_elf_relocate_section (bfd *output_
+ 	      else if (!SYMBOL_REFERENCES_LOCAL (info, &amp;h-&gt;elf)
+ 		       &amp;&amp; !is_opd
+ 		       &amp;&amp; r_type != R_PPC64_TOC)
+-		outrel.r_info = ELF64_R_INFO (h-&gt;elf.dynindx, r_type);
++		{
++		  outrel.r_info = ELF64_R_INFO (h-&gt;elf.dynindx, r_type);
++		  if (h-&gt;elf.dynindx == -1
++		      &amp;&amp; h-&gt;elf.root.type == bfd_link_hash_undefweak)
++		  memset (&amp;outrel, 0, sizeof outrel);
++		}
+ 	      else
+ 		{
+ 		  /* This symbol is local, or marked to become local,

Added: branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-ppc64-version-script.patch
===================================================================
--- branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-ppc64-version-script.patch	                        (rev 0)
+++ branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-ppc64-version-script.patch	2008-06-09 23:18:27 UTC (rev 6350)
@@ -0,0 +1,57 @@
+2007-05-14  Andreas Schwab  &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">schwab at suse.de</A>&gt;
+
+	* emultempl/ppc64elf.em (gld${EMULATION_NAME}_new_vers_pattern):
+	Handle null pattern.
+
+--- ld/emultempl/ppc64elf.em	26 Mar 2007 11:10:44 -0000	1.52
++++ ld/emultempl/ppc64elf.em	14 May 2007 08:53:23 -0000	1.53
+@@ -414,17 +414,22 @@ gld${EMULATION_NAME}_new_vers_pattern (s
+   unsigned int len;
+   char *dot_pat;
+ 
+-  if (!dotsyms || entry-&gt;pattern[0] == '*' || entry-&gt;pattern[0] == '.')
++  if (!dotsyms
++      || (entry-&gt;pattern != NULL
++	  &amp;&amp; (entry-&gt;pattern[0] == '*' || entry-&gt;pattern[0] == '.')))
+     return entry;
+ 
+   dot_entry = xmalloc (sizeof *dot_entry);
+   *dot_entry = *entry;
+   dot_entry-&gt;next = entry;
+-  len = strlen (entry-&gt;pattern) + 2;
+-  dot_pat = xmalloc (len);
+-  dot_pat[0] = '.';
+-  memcpy (dot_pat + 1, entry-&gt;pattern, len - 1);
+-  dot_entry-&gt;pattern = dot_pat;
++  if (entry-&gt;pattern != NULL)
++    {
++      len = strlen (entry-&gt;pattern) + 2;
++      dot_pat = xmalloc (len);
++      dot_pat[0] = '.';
++      memcpy (dot_pat + 1, entry-&gt;pattern, len - 1);
++      dot_entry-&gt;pattern = dot_pat;
++    }
+   if (entry-&gt;symbol != NULL)
+     {
+       len = strlen (entry-&gt;symbol) + 2;
+	* ld-elf/dl2a.list: New file.
+	* ld-elf/shared.exp: Add test using --dynamic-list=dl2a.list.
+
+--- ld/testsuite/ld-elf/dl2a.list	1 Jan 1970 00:00:00 -0000
++++ ld/testsuite/ld-elf/dl2a.list	14 May 2007 08:53:23 -0000	1.1
+@@ -0,0 +1,3 @@
++{
++  &quot;foo&quot;;
++};
+--- ld/testsuite/ld-elf/shared.exp	14 Feb 2007 14:15:52 -0000	1.6
++++ ld/testsuite/ld-elf/shared.exp	15 May 2007 13:57:03 -0000	1.8
+@@ -72,6 +72,9 @@ set build_tests {
+   {&quot;Build libdl2a.so with --dynamic-list=dl2.list&quot;
+    &quot;-shared -Wl,--dynamic-list=dl2.list&quot; &quot;-fPIC&quot;
+    {dl2.c dl2xxx.c} {} &quot;libdl2a.so&quot;}
++  {&quot;Build libdl2a.so with --dynamic-list=dl2a.list&quot;
++   &quot;-shared -Wl,--dynamic-list=dl2a.list&quot; &quot;-fPIC&quot;
++   {dl2.c dl2xxx.c} {} &quot;libdl2a.so&quot;}
+   {&quot;Build libdl2b.so with --dynamic-list=dl2.list and dl2xxx.list&quot;
+    &quot;-shared -Wl,--dynamic-list=dl2.list,--dynamic-list=dl2xxx.list&quot; &quot;-fPIC&quot;
+    {dl2.c dl2xxx.c} {} &quot;libdl2b.so&quot;}

Added: branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-rh223181.patch
===================================================================
--- branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-rh223181.patch	                        (rev 0)
+++ branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-rh223181.patch	2008-06-09 23:18:27 UTC (rev 6350)
@@ -0,0 +1,151 @@
+207-01-19  Jakub Jelinek  &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">jakub at redhat.com</A>&gt;
+
+	* elf.c (elf_sort_elf_symbol): Removed.
+	(bfd_elf_match_symbols_in_sections): Remove unnecessary expensive
+	sorting of the symbol tables.
+
+--- bfd/elf.c.jj	2006-10-20 20:50:57.000000000 +0200
++++ bfd/elf.c	2007-01-19 14:54:04.000000000 +0100
+@@ -8623,33 +8623,6 @@ _bfd_elf_get_synthetic_symtab (bfd *abfd
+   return n;
+ }
+ 
+-/* Sort symbol by binding and section. We want to put definitions
+-   sorted by section at the beginning.  */
+-
+-static int
+-elf_sort_elf_symbol (const void *arg1, const void *arg2)
+-{
+-  const Elf_Internal_Sym *s1;
+-  const Elf_Internal_Sym *s2;
+-  int shndx;
+-
+-  /* Make sure that undefined symbols are at the end.  */
+-  s1 = (const Elf_Internal_Sym *) arg1;
+-  if (s1-&gt;st_shndx == SHN_UNDEF)
+-    return 1;
+-  s2 = (const Elf_Internal_Sym *) arg2;
+-  if (s2-&gt;st_shndx == SHN_UNDEF)
+-    return -1;
+-
+-  /* Sorted by section index.  */
+-  shndx = s1-&gt;st_shndx - s2-&gt;st_shndx;
+-  if (shndx != 0)
+-    return shndx;
+-
+-  /* Sorted by binding.  */
+-  return ELF_ST_BIND (s1-&gt;st_info)  - ELF_ST_BIND (s2-&gt;st_info);
+-}
+-
+ struct elf_symbol
+ {
+   Elf_Internal_Sym *sym;
+@@ -8675,9 +8648,8 @@ bfd_elf_match_symbols_in_sections (asect
+   Elf_Internal_Shdr *hdr1, *hdr2;
+   bfd_size_type symcount1, symcount2;
+   Elf_Internal_Sym *isymbuf1, *isymbuf2;
+-  Elf_Internal_Sym *isymstart1 = NULL, *isymstart2 = NULL, *isym;
+-  Elf_Internal_Sym *isymend;
+-  struct elf_symbol *symp, *symtable1 = NULL, *symtable2 = NULL;
++  Elf_Internal_Sym *isym, *isymend;
++  struct elf_symbol *symtable1 = NULL, *symtable2 = NULL;
+   bfd_size_type count1, count2, i;
+   int shndx1, shndx2;
+   bfd_boolean result;
+@@ -8733,75 +8705,36 @@ bfd_elf_match_symbols_in_sections (asect
+   if (isymbuf1 == NULL || isymbuf2 == NULL)
+     goto done;
+ 
+-  /* Sort symbols by binding and section. Global definitions are at
+-     the beginning.  */
+-  qsort (isymbuf1, symcount1, sizeof (Elf_Internal_Sym),
+-	 elf_sort_elf_symbol);
+-  qsort (isymbuf2, symcount2, sizeof (Elf_Internal_Sym),
+-	 elf_sort_elf_symbol);
++  symtable1 = bfd_malloc2 (symcount1, sizeof (struct elf_symbol));
++  symtable2 = bfd_malloc2 (symcount2, sizeof (struct elf_symbol));
+ 
+-  /* Count definitions in the section.  */
+-  count1 = 0;
+-  for (isym = isymbuf1, isymend = isym + symcount1;
+-       isym &lt; isymend; isym++)
+-    {
+-      if (isym-&gt;st_shndx == (unsigned int) shndx1)
+-	{
+-	  if (count1 == 0)
+-	    isymstart1 = isym;
+-	  count1++;
+-	}
++  if (symtable1 == NULL || symtable2 == NULL)
++    goto done;
+ 
+-      if (count1 &amp;&amp; isym-&gt;st_shndx != (unsigned int) shndx1)
+-	break;
+-    }
++  /* Choose symbol definitions in the section.  */
++  count1 = 0;
++  for (isym = isymbuf1, isymend = isym + symcount1; isym &lt; isymend; isym++)
++    if (isym-&gt;st_shndx == (unsigned int) shndx1)
++      symtable1[count1++].sym = isym;
+ 
+   count2 = 0;
+-  for (isym = isymbuf2, isymend = isym + symcount2;
+-       isym &lt; isymend; isym++)
+-    {
+-      if (isym-&gt;st_shndx == (unsigned int) shndx2)
+-	{
+-	  if (count2 == 0)
+-	    isymstart2 = isym;
+-	  count2++;
+-	}
+-
+-      if (count2 &amp;&amp; isym-&gt;st_shndx != (unsigned int) shndx2)
+-	break;
+-    }
++  for (isym = isymbuf2, isymend = isym + symcount2; isym &lt; isymend; isym++)
++    if (isym-&gt;st_shndx == (unsigned int) shndx2)
++      symtable2[count2++].sym = isym;
+ 
+   if (count1 == 0 || count2 == 0 || count1 != count2)
+     goto done;
+ 
+-  symtable1 = bfd_malloc (count1 * sizeof (struct elf_symbol));
+-  symtable2 = bfd_malloc (count1 * sizeof (struct elf_symbol));
+-
+-  if (symtable1 == NULL || symtable2 == NULL)
+-    goto done;
++  for (i = 0; i &lt; count1; i++)
++    symtable1[i].name
++      = bfd_elf_string_from_elf_section (bfd1, hdr1-&gt;sh_link,
++					 symtable1[i].sym-&gt;st_name);
++
++  for (i = 0; i &lt; count2; i++)
++    symtable2[i].name
++      = bfd_elf_string_from_elf_section (bfd2, hdr2-&gt;sh_link,
++					 symtable2[i].sym-&gt;st_name);
+ 
+-  symp = symtable1;
+-  for (isym = isymstart1, isymend = isym + count1;
+-       isym &lt; isymend; isym++)
+-    {
+-      symp-&gt;sym = isym;
+-      symp-&gt;name = bfd_elf_string_from_elf_section (bfd1,
+-						    hdr1-&gt;sh_link,
+-						    isym-&gt;st_name);
+-      symp++;
+-    }
+- 
+-  symp = symtable2;
+-  for (isym = isymstart2, isymend = isym + count1;
+-       isym &lt; isymend; isym++)
+-    {
+-      symp-&gt;sym = isym;
+-      symp-&gt;name = bfd_elf_string_from_elf_section (bfd2,
+-						    hdr2-&gt;sh_link,
+-						    isym-&gt;st_name);
+-      symp++;
+-    }
+-  
+   /* Sort symbol by name.  */
+   qsort (symtable1, count1, sizeof (struct elf_symbol),
+ 	 elf_sym_name_compare);

Added: branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-rh235221.patch
===================================================================
--- branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-rh235221.patch	                        (rev 0)
+++ branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-rh235221.patch	2008-06-09 23:18:27 UTC (rev 6350)
@@ -0,0 +1,436 @@
+2007-02-13  Alan Modra  &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">amodra at bigpond.net.au</A>&gt;
+
+	* elf64-ppc.c (create_linkage_sections): Use section &quot;.branch_lt&quot;
+	for branch lookup table.
+
+	* emulparams/elf64ppc.sh (OTHER_READWRITE_SECTIONS): Add &quot;.branch_lt&quot;.
+	* emultempl/ppc64elf.em (ppc_add_stub_section): Create without
+	SEC_RELOC flag set.
+
+	* ld-powerpc/relbrlt.d: Update.
+	* ld-powerpc/tlsexe.r: Update.
+	* ld-powerpc/tlsexetoc.r: Update.
+	* ld-powerpc/tlsso.r: Update.
+	* ld-powerpc/tlstocso.r: Update.
+
+2007-02-12  Alan Modra  &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">amodra at bigpond.net.au</A>&gt;
+
+	* elf64-ppc.c (create_linkage_sections): Don't create
+	.rela.rodata.brlt for --emit-relocs.
+	(ppc_build_one_stub): Create relocs for brlt --emit-relocs here.
+	(ppc_size_one_stub): Count them.  Simplify test of stub type
+	when counting stub relocs.  Set SEC_RELOC too.
+	(ppc64_elf_size_stubs): Clear reloc_count and SEC_RELOC.
+	(ppc64_elf_finish_dynamic_sections): Output brlt relocs.
+
+	* ld-powerpc/relbrlt.d: Update.
+
+--- bfd/elf64-ppc.c	1 Feb 2007 05:35:58 -0000	1.255
++++ bfd/elf64-ppc.c	13 Feb 2007 01:53:02 -0000	1.257
+@@ -3818,45 +3818,22 @@ create_linkage_sections (bfd *dynobj, st
+     return FALSE;
+ 
+   /* Create branch lookup table for plt_branch stubs.  */
+-  if (info-&gt;shared)
+-    {
+-      flags = (SEC_ALLOC | SEC_LOAD
+-	       | SEC_HAS_CONTENTS | SEC_IN_MEMORY | SEC_LINKER_CREATED);
+-      htab-&gt;brlt
+-	= bfd_make_section_anyway_with_flags (dynobj, &quot;.data.rel.ro.brlt&quot;,
+-					      flags);
+-    }
+-  else
+-    {
+-      flags = (SEC_ALLOC | SEC_LOAD | SEC_READONLY
+-	       | SEC_HAS_CONTENTS | SEC_IN_MEMORY | SEC_LINKER_CREATED);
+-      htab-&gt;brlt
+-	= bfd_make_section_anyway_with_flags (dynobj, &quot;.rodata.brlt&quot;, flags);
+-    }
+-
++  flags = (SEC_ALLOC | SEC_LOAD
++	   | SEC_HAS_CONTENTS | SEC_IN_MEMORY | SEC_LINKER_CREATED);
++  htab-&gt;brlt = bfd_make_section_anyway_with_flags (dynobj, &quot;.branch_lt&quot;,
++						   flags);
+   if (htab-&gt;brlt == NULL
+       || ! bfd_set_section_alignment (dynobj, htab-&gt;brlt, 3))
+     return FALSE;
+ 
+-  if (info-&gt;shared)
+-    {
+-      flags = (SEC_ALLOC | SEC_LOAD | SEC_READONLY
+-	       | SEC_HAS_CONTENTS | SEC_IN_MEMORY | SEC_LINKER_CREATED);
+-      htab-&gt;relbrlt
+-	= bfd_make_section_anyway_with_flags (dynobj, &quot;.rela.data.rel.ro.brlt&quot;,
+-					      flags);
+-    }
+-  else if (info-&gt;emitrelocations)
+-    {
+-      flags = (SEC_ALLOC | SEC_LOAD | SEC_READONLY
+-	       | SEC_HAS_CONTENTS | SEC_IN_MEMORY | SEC_LINKER_CREATED);
+-      htab-&gt;relbrlt
+-	= bfd_make_section_anyway_with_flags (dynobj, &quot;.rela.rodata.brlt&quot;,
+-					      flags);
+-    }
+-  else
++  if (!info-&gt;shared)
+     return TRUE;
+ 
++  flags = (SEC_ALLOC | SEC_LOAD | SEC_READONLY
++	   | SEC_HAS_CONTENTS | SEC_IN_MEMORY | SEC_LINKER_CREATED);
++  htab-&gt;relbrlt = bfd_make_section_anyway_with_flags (dynobj,
++						      &quot;.rela.branch_lt&quot;,
++						      flags);
+   if (!htab-&gt;relbrlt
+       || ! bfd_set_section_alignment (dynobj, htab-&gt;relbrlt, 3))
+     return FALSE;
+@@ -8394,6 +8371,33 @@ ppc_build_one_stub (struct bfd_hash_entr
+ 	  rl += htab-&gt;relbrlt-&gt;reloc_count++ * sizeof (Elf64_External_Rela);
+ 	  bfd_elf64_swap_reloca_out (htab-&gt;relbrlt-&gt;owner, &amp;rela, rl);
+ 	}
++      else if (info-&gt;emitrelocations)
++	{
++	  Elf_Internal_Rela *relocs, *r;
++	  struct bfd_elf_section_data *elfsec_data;
++
++	  elfsec_data = elf_section_data (htab-&gt;brlt);
++	  relocs = elfsec_data-&gt;relocs;
++	  if (relocs == NULL)
++	    {
++	      bfd_size_type relsize;
++	      relsize = htab-&gt;brlt-&gt;reloc_count * sizeof (*relocs);
++	      relocs = bfd_alloc (htab-&gt;brlt-&gt;owner, relsize);
++	      if (relocs == NULL)
++		return FALSE;
++	      elfsec_data-&gt;relocs = relocs;
++	      elfsec_data-&gt;rel_hdr.sh_size = relsize;
++	      elfsec_data-&gt;rel_hdr.sh_entsize = 24;
++	      htab-&gt;brlt-&gt;reloc_count = 0;
++	    }
++	  r = relocs + htab-&gt;brlt-&gt;reloc_count;
++	  htab-&gt;brlt-&gt;reloc_count += 1;
++	  r-&gt;r_offset = (br_entry-&gt;offset
++			 + htab-&gt;brlt-&gt;output_offset
++			 + htab-&gt;brlt-&gt;output_section-&gt;vma);
++	  r-&gt;r_info = ELF64_R_INFO (0, R_PPC64_RELATIVE);
++	  r-&gt;r_addend = off;
++	}
+ 
+       off = (br_entry-&gt;offset
+ 	     + htab-&gt;brlt-&gt;output_offset
+@@ -8623,6 +8627,11 @@ ppc_size_one_stub (struct bfd_hash_entry
+ 
+ 	      if (htab-&gt;relbrlt != NULL)
+ 		htab-&gt;relbrlt-&gt;size += sizeof (Elf64_External_Rela);
++	      else if (info-&gt;emitrelocations)
++		{
++		  htab-&gt;brlt-&gt;reloc_count += 1;
++		  htab-&gt;brlt-&gt;flags |= SEC_RELOC;
++		}
+ 	    }
+ 
+ 	  stub_entry-&gt;stub_type += ppc_stub_plt_branch - ppc_stub_long_branch;
+@@ -8630,11 +8639,11 @@ ppc_size_one_stub (struct bfd_hash_entry
+ 	  if (stub_entry-&gt;stub_type != ppc_stub_plt_branch)
+ 	    size = 28;
+ 	}
+-
+-      if (info-&gt;emitrelocations
+-	  &amp;&amp; (stub_entry-&gt;stub_type == ppc_stub_long_branch
+-	      || stub_entry-&gt;stub_type == ppc_stub_long_branch_r2off))
+-	stub_entry-&gt;stub_sec-&gt;reloc_count += 1;
++      else if (info-&gt;emitrelocations)
++	{
++	  stub_entry-&gt;stub_sec-&gt;reloc_count += 1;
++	  stub_entry-&gt;stub_sec-&gt;flags |= SEC_RELOC;
++	}
+     }
+ 
+   stub_entry-&gt;stub_sec-&gt;size += size;
+@@ -9426,9 +9435,12 @@ ppc64_elf_size_stubs (bfd *output_bfd,
+ 	    stub_sec-&gt;rawsize = stub_sec-&gt;size;
+ 	    stub_sec-&gt;size = 0;
+ 	    stub_sec-&gt;reloc_count = 0;
++	    stub_sec-&gt;flags &amp;= ~SEC_RELOC;
+ 	  }
+ 
+       htab-&gt;brlt-&gt;size = 0;
++      htab-&gt;brlt-&gt;reloc_count = 0;
++      htab-&gt;brlt-&gt;flags &amp;= ~SEC_RELOC;
+       if (htab-&gt;relbrlt != NULL)
+ 	htab-&gt;relbrlt-&gt;size = 0;
+ 
+@@ -11442,6 +11454,17 @@ ppc64_elf_finish_dynamic_sections (bfd *
+ 	= PLT_ENTRY_SIZE;
+     }
+ 
++  /* brlt is SEC_LINKER_CREATED, so we need to write out relocs for
++     brlt ourselves if emitrelocations.  */
++  if (htab-&gt;brlt != NULL
++      &amp;&amp; htab-&gt;brlt-&gt;reloc_count != 0
++      &amp;&amp; !_bfd_elf_link_output_relocs (output_bfd,
++				       htab-&gt;brlt,
++				       &amp;elf_section_data (htab-&gt;brlt)-&gt;rel_hdr,
++				       elf_section_data (htab-&gt;brlt)-&gt;relocs,
++				       NULL))
++    return FALSE;
++
+   /* We need to handle writing out multiple GOT sections ourselves,
+      since we didn't add them to DYNOBJ.  We know dynobj is the first
+      bfd.  */
+--- ld/emulparams/elf64ppc.sh	30 May 2006 16:45:32 -0000	1.18
++++ ld/emulparams/elf64ppc.sh	13 Feb 2007 01:53:03 -0000	1.19
+@@ -31,7 +31,8 @@ OTHER_GOT_RELOC_SECTIONS=&quot;
+   .rela.toc	${RELOCATING-0} : { *(.rela.toc) }&quot;
+ OTHER_READWRITE_SECTIONS=&quot;
+   .toc1		${RELOCATING-0} :${RELOCATING+ ALIGN(8)} { *(.toc1) }
+-  .opd		${RELOCATING-0} :${RELOCATING+ ALIGN(8)} { KEEP (*(.opd)) }&quot;
++  .opd		${RELOCATING-0} :${RELOCATING+ ALIGN(8)} { KEEP (*(.opd)) }
++  .branch_lt	${RELOCATING-0} :${RELOCATING+ ALIGN(8)} { *(.branch_lt) }&quot;
+ 
+ # Treat a host that matches the target with the possible exception of &quot;64&quot;
+ # in the name as if it were native.
+--- ld/emultempl/ppc64elf.em	20 Jun 2006 02:22:14 -0000	1.50
++++ ld/emultempl/ppc64elf.em	13 Feb 2007 01:53:03 -0000	1.51
+@@ -225,7 +225,7 @@ ppc_add_stub_section (const char *stub_s
+     goto err_ret;
+ 
+   flags = (SEC_ALLOC | SEC_LOAD | SEC_READONLY | SEC_CODE
+-	   | SEC_HAS_CONTENTS | SEC_RELOC | SEC_IN_MEMORY | SEC_KEEP);
++	   | SEC_HAS_CONTENTS | SEC_IN_MEMORY | SEC_KEEP);
+   if (!bfd_set_section_flags (stub_file-&gt;the_bfd, stub_sec, flags))
+     goto err_ret;
+ 
+--- ld/testsuite/ld-powerpc/relbrlt.d	24 Oct 2006 13:29:37 -0000	1.1
++++ ld/testsuite/ld-powerpc/relbrlt.d	13 Feb 2007 01:53:03 -0000	1.3
+@@ -7,44 +7,44 @@
+ 
+ Disassembly of section \.text:
+ 
+-0*100000a8 &lt;_start&gt;:
+-    100000a8:	49 bf 00 31 	bl      11bf00d8 .*
+-			100000a8: R_PPC64_REL24	\.text\+0x37e0044
+-    100000ac:	60 00 00 00 	nop
+-    100000b0:	49 bf 00 19 	bl      11bf00c8 .*
+-			100000b0: R_PPC64_REL24	\.text\+0x3bf0020
+-    100000b4:	60 00 00 00 	nop
+-    100000b8:	49 bf 00 25 	bl      11bf00dc .*
+-			100000b8: R_PPC64_REL24	\.text\+0x57e0024
+-    100000bc:	60 00 00 00 	nop
+-    100000c0:	00 00 00 00 	\.long 0x0
+-    100000c4:	4b ff ff e4 	b       100000a8 &lt;_start&gt;
++0*100000b0 &lt;_start&gt;:
++[0-9a-f	 ]*:	49 bf 00 31 	bl      .*
++[0-9a-f	 ]*: R_PPC64_REL24	\.text\+0x37e0044
++[0-9a-f	 ]*:	60 00 00 00 	nop
++[0-9a-f	 ]*:	49 bf 00 19 	bl      .*
++[0-9a-f	 ]*: R_PPC64_REL24	\.text\+0x3bf0020
++[0-9a-f	 ]*:	60 00 00 00 	nop
++[0-9a-f	 ]*:	49 bf 00 25 	bl      .*
++[0-9a-f	 ]*: R_PPC64_REL24	\.text\+0x57e0024
++[0-9a-f	 ]*:	60 00 00 00 	nop
++[0-9a-f	 ]*:	00 00 00 00 	\.long 0x0
++[0-9a-f	 ]*:	4b ff ff e4 	b       .* &lt;_start&gt;
+ 	\.\.\.
+ 
+-0*11bf00c8 &lt;.*plt_branch.*&gt;:
+-    11bf00c8:	3d 82 05 7e 	addis   r12,r2,1406
+-    11bf00cc:	e9 6c 80 58 	ld      r11,-32680\(r12\)
+-    11bf00d0:	7d 69 03 a6 	mtctr   r11
+-    11bf00d4:	4e 80 04 20 	bctr
+-
+-0*11bf00d8 &lt;.*long_branch.*&gt;:
+-    11bf00d8:	49 bf 00 14 	b       137e00ec &lt;far&gt;
+-			11bf00d8: R_PPC64_REL24	\*ABS\*\+0x137e00ec
+-
+-0*11bf00dc &lt;.*plt_branch.*&gt;:
+-    11bf00dc:	3d 82 05 7e 	addis   r12,r2,1406
+-    11bf00e0:	e9 6c 80 60 	ld      r11,-32672\(r12\)
+-    11bf00e4:	7d 69 03 a6 	mtctr   r11
+-    11bf00e8:	4e 80 04 20 	bctr
++[0-9a-f	 ]*&lt;.*plt_branch.*&gt;:
++[0-9a-f	 ]*:	3d 82 00 00 	addis   r12,r2,0
++[0-9a-f	 ]*:	e9 6c 80 00 	ld      r11,-32768\(r12\)
++[0-9a-f	 ]*:	7d 69 03 a6 	mtctr   r11
++[0-9a-f	 ]*:	4e 80 04 20 	bctr
++
++[0-9a-f	 ]*&lt;.*long_branch.*&gt;:
++[0-9a-f	 ]*:	49 bf 00 14 	b       .* &lt;far&gt;
++[0-9a-f	 ]*: R_PPC64_REL24	\*ABS\*\+0x137e00f4
++
++[0-9a-f	 ]*&lt;.*plt_branch.*&gt;:
++[0-9a-f	 ]*:	3d 82 00 00 	addis   r12,r2,0
++[0-9a-f	 ]*:	e9 6c 80 08 	ld      r11,-32760\(r12\)
++[0-9a-f	 ]*:	7d 69 03 a6 	mtctr   r11
++[0-9a-f	 ]*:	4e 80 04 20 	bctr
+ 	\.\.\.
+ 
+-0*137e00ec &lt;far&gt;:
+-    137e00ec:	4e 80 00 20 	blr
++0*137e00f4 &lt;far&gt;:
++[0-9a-f	 ]*:	4e 80 00 20 	blr
+ 	\.\.\.
+ 
+-0*13bf00c8 &lt;far2far&gt;:
+-    13bf00c8:	4e 80 00 20 	blr
++[0-9a-f	 ]*&lt;far2far&gt;:
++[0-9a-f	 ]*:	4e 80 00 20 	blr
+ 	\.\.\.
+ 
+-0*157e00cc &lt;huge&gt;:
+-    157e00cc:	4e 80 00 20 	blr
++[0-9a-f	 ]*&lt;huge&gt;:
++[0-9a-f	 ]*:	4e 80 00 20 	blr
+--- ld/testsuite/ld-powerpc/tlsexe.r	17 Aug 2006 08:21:06 -0000	1.18
++++ ld/testsuite/ld-powerpc/tlsexe.r	13 Feb 2007 01:53:03 -0000	1.19
+@@ -17,10 +17,10 @@ Section Headers:
+  +\[ 5\] \.rela\.dyn +.*
+  +\[ 6\] \.rela\.plt +.*
+  +\[ 7\] \.text +PROGBITS .* 0+100 0+ +AX +0 +0 +8
+- +\[ 8\] \.rodata + PROGBITS .* 0+ 0+ +A +0 +0 +8
+- +\[ 9\] \.tdata +PROGBITS .* 0+38 0+ WAT +0 +0 +8
+- +\[10\] \.tbss +NOBITS .* 0+38 0+ WAT +0 +0 +8
+- +\[11\] \.dynamic +DYNAMIC .* 0+150 10 +WA +4 +0 +8
++ +\[ 8\] \.tdata +PROGBITS .* 0+38 0+ WAT +0 +0 +8
++ +\[ 9\] \.tbss +NOBITS .* 0+38 0+ WAT +0 +0 +8
++ +\[10\] \.dynamic +DYNAMIC .* 0+150 10 +WA +4 +0 +8
++ +\[11\] \.branch_lt + PROGBITS .* 0+ 0+ +WA +0 +0 +8
+  +\[12\] \.got +PROGBITS .* 0+30 08 +WA +0 +0 +8
+  +\[13\] \.plt +.*
+  +\[14\] \.shstrtab +.*
+@@ -67,7 +67,7 @@ Symbol table '\.dynsym' contains [0-9]+ 
+ .* TLS +GLOBAL DEFAULT +UND gd
+ .* FUNC +GLOBAL DEFAULT +UND __tls_get_addr
+ .* TLS +GLOBAL DEFAULT +UND ld
+-.* TLS +GLOBAL DEFAULT +10 ld2
++.* TLS +GLOBAL DEFAULT +9 ld2
+ .* NOTYPE +GLOBAL DEFAULT +ABS __bss_start
+ .* NOTYPE +GLOBAL DEFAULT +ABS _edata
+ .* NOTYPE +GLOBAL DEFAULT +ABS _end
+@@ -88,26 +88,26 @@ Symbol table '\.symtab' contains .* entr
+ .* SECTION LOCAL +DEFAULT +11 
+ .* SECTION LOCAL +DEFAULT +12 
+ .* SECTION LOCAL +DEFAULT +13 
+-.* TLS +LOCAL +DEFAULT +9 gd4
+-.* TLS +LOCAL +DEFAULT +9 ld4
+-.* TLS +LOCAL +DEFAULT +9 ld5
+-.* TLS +LOCAL +DEFAULT +9 ld6
+-.* TLS +LOCAL +DEFAULT +9 ie4
+-.* TLS +LOCAL +DEFAULT +9 le4
+-.* TLS +LOCAL +DEFAULT +9 le5
+-.* OBJECT +LOCAL +HIDDEN +11 _DYNAMIC
++.* TLS +LOCAL +DEFAULT +8 gd4
++.* TLS +LOCAL +DEFAULT +8 ld4
++.* TLS +LOCAL +DEFAULT +8 ld5
++.* TLS +LOCAL +DEFAULT +8 ld6
++.* TLS +LOCAL +DEFAULT +8 ie4
++.* TLS +LOCAL +DEFAULT +8 le4
++.* TLS +LOCAL +DEFAULT +8 le5
++.* OBJECT +LOCAL +HIDDEN +10 _DYNAMIC
+ .* FUNC +LOCAL +DEFAULT +UND \.__tls_get_addr
+ .* GLOBAL DEFAULT +UND gd
+-.* GLOBAL DEFAULT +10 le0
++.* GLOBAL DEFAULT +9 le0
+ .* GLOBAL DEFAULT +UND __tls_get_addr
+-.* GLOBAL DEFAULT +10 ld0
+-.* GLOBAL DEFAULT +10 le1
++.* GLOBAL DEFAULT +9 ld0
++.* GLOBAL DEFAULT +9 le1
+ .* GLOBAL DEFAULT +UND ld
+ .* NOTYPE +GLOBAL DEFAULT +7 _start
+-.* TLS +GLOBAL DEFAULT +10 ld2
+-.* TLS +GLOBAL DEFAULT +10 ld1
++.* TLS +GLOBAL DEFAULT +9 ld2
++.* TLS +GLOBAL DEFAULT +9 ld1
+ .* NOTYPE +GLOBAL DEFAULT +ABS __bss_start
+ .* NOTYPE +GLOBAL DEFAULT +ABS _edata
+ .* NOTYPE +GLOBAL DEFAULT +ABS _end
+-.* TLS +GLOBAL DEFAULT +10 gd0
+-.* TLS +GLOBAL DEFAULT +10 ie0
++.* TLS +GLOBAL DEFAULT +9 gd0
++.* TLS +GLOBAL DEFAULT +9 ie0
+--- ld/testsuite/ld-powerpc/tlsexetoc.r	17 Aug 2006 08:21:06 -0000	1.19
++++ ld/testsuite/ld-powerpc/tlsexetoc.r	13 Feb 2007 01:53:03 -0000	1.20
+@@ -17,10 +17,10 @@ Section Headers:
+  +\[ 5\] \.rela\.dyn +.*
+  +\[ 6\] \.rela\.plt +.*
+  +\[ 7\] \.text +PROGBITS .* 0+c0 0+ +AX +0 +0 +8
+- +\[ 8\] \.rodata +PROGBITS .* 0+ 0+ +A +0 +0 +8
+- +\[ 9\] \.tdata +PROGBITS .* 0+38 0+ WAT +0 +0 +8
+- +\[10\] \.tbss +NOBITS .* 0+38 0+ WAT +0 +0 +8
+- +\[11\] \.dynamic +DYNAMIC .* 0+150 10 +WA +4 +0 +8
++ +\[ 8\] \.tdata +PROGBITS .* 0+38 0+ WAT +0 +0 +8
++ +\[ 9\] \.tbss +NOBITS .* 0+38 0+ WAT +0 +0 +8
++ +\[10\] \.dynamic +DYNAMIC .* 0+150 10 +WA +4 +0 +8
++ +\[11\] \.branch_lt +PROGBITS .* 0+ 0+ +WA +0 +0 +8
+  +\[12\] \.got +PROGBITS .* 0+58 08 +WA +0 +0 +8
+  +\[13\] \.plt +.*
+  +\[14\] \.shstrtab +.*
+@@ -87,27 +87,27 @@ Symbol table '\.symtab' contains .* entr
+ .* SECTION LOCAL +DEFAULT +11 
+ .* SECTION LOCAL +DEFAULT +12 
+ .* SECTION LOCAL +DEFAULT +13 
+-.* TLS +LOCAL +DEFAULT +9 gd4
+-.* TLS +LOCAL +DEFAULT +9 ld4
+-.* TLS +LOCAL +DEFAULT +9 ld5
+-.* TLS +LOCAL +DEFAULT +9 ld6
+-.* TLS +LOCAL +DEFAULT +9 ie4
+-.* TLS +LOCAL +DEFAULT +9 le4
+-.* TLS +LOCAL +DEFAULT +9 le5
++.* TLS +LOCAL +DEFAULT +8 gd4
++.* TLS +LOCAL +DEFAULT +8 ld4
++.* TLS +LOCAL +DEFAULT +8 ld5
++.* TLS +LOCAL +DEFAULT +8 ld6
++.* TLS +LOCAL +DEFAULT +8 ie4
++.* TLS +LOCAL +DEFAULT +8 le4
++.* TLS +LOCAL +DEFAULT +8 le5
+ .* NOTYPE +LOCAL +DEFAULT +12 \.Lie0
+-.* OBJECT +LOCAL +HIDDEN +11 _DYNAMIC
++.* OBJECT +LOCAL +HIDDEN +10 _DYNAMIC
+ .* FUNC +LOCAL +DEFAULT +UND \.__tls_get_addr
+ .* TLS +GLOBAL DEFAULT +UND gd
+-.* TLS +GLOBAL DEFAULT +10 le0
++.* TLS +GLOBAL DEFAULT +9 le0
+ .* FUNC +GLOBAL DEFAULT +UND __tls_get_addr
+-.* TLS +GLOBAL DEFAULT +10 ld0
+-.* TLS +GLOBAL DEFAULT +10 le1
++.* TLS +GLOBAL DEFAULT +9 ld0
++.* TLS +GLOBAL DEFAULT +9 le1
+ .* TLS +GLOBAL DEFAULT +UND ld
+ .* NOTYPE +GLOBAL DEFAULT +7 _start
+-.* TLS +GLOBAL DEFAULT +10 ld2
+-.* TLS +GLOBAL DEFAULT +10 ld1
++.* TLS +GLOBAL DEFAULT +9 ld2
++.* TLS +GLOBAL DEFAULT +9 ld1
+ .* NOTYPE +GLOBAL DEFAULT +ABS __bss_start
+ .* NOTYPE +GLOBAL DEFAULT +ABS _edata
+ .* NOTYPE +GLOBAL DEFAULT +ABS _end
+-.* TLS +GLOBAL DEFAULT +10 gd0
+-.* TLS +GLOBAL DEFAULT +10 ie0
++.* TLS +GLOBAL DEFAULT +9 gd0
++.* TLS +GLOBAL DEFAULT +9 ie0
+--- ld/testsuite/ld-powerpc/tlsso.r	17 Oct 2006 13:41:48 -0000	1.18
++++ ld/testsuite/ld-powerpc/tlsso.r	13 Feb 2007 01:53:03 -0000	1.19
+@@ -17,8 +17,8 @@ Section Headers:
+  +\[ 6\] \.text .*
+  +\[ 7\] \.tdata +PROGBITS .* 0+38 0+ WAT +0 +0 +8
+  +\[ 8\] \.tbss +NOBITS .* 0+38 0+ WAT +0 +0 +8
+- +\[ 9\] \.data\.rel\.ro .*
+- +\[10\] \.dynamic .*
++ +\[ 9\] \.dynamic .*
++ +\[10\] \.branch_lt .*
+  +\[11\] \.got .*
+  +\[12\] \.plt .*
+  +\[13\] \.shstrtab .*
+--- ld/testsuite/ld-powerpc/tlstocso.r	17 Oct 2006 13:41:48 -0000	1.18
++++ ld/testsuite/ld-powerpc/tlstocso.r	13 Feb 2007 01:53:03 -0000	1.19
+@@ -17,8 +17,8 @@ Section Headers:
+  +\[ 6\] \.text .*
+  +\[ 7\] \.tdata +PROGBITS .* 0+38 0+ WAT +0 +0 +8
+  +\[ 8\] \.tbss +NOBITS .* 0+38 0+ WAT +0 +0 +8
+- +\[ 9\] \.data\.rel\.ro .*
+- +\[10\] \.dynamic .*
++ +\[ 9\] \.dynamic .*
++ +\[10\] \.branch_lt .*
+  +\[11\] \.got .*
+  +\[12\] \.plt .*
+  +\[13\] \.shstrtab .*

Added: branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-rh241252.patch
===================================================================
--- branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-rh241252.patch	                        (rev 0)
+++ branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-rh241252.patch	2008-06-09 23:18:27 UTC (rev 6350)
@@ -0,0 +1,17 @@
+2007-05-03  Alan Modra  &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">amodra at bigpond.net.au</A>&gt;
+
+	* scripttempl/elf.sc: Add .debug_pubtypes and .debug_ranges.
+
+--- ld/scripttempl/elf.sc	26 Oct 2006 00:31:59 -0000	1.79
++++ ld/scripttempl/elf.sc	3 May 2007 07:06:13 -0000	1.80
+@@ -505,6 +505,10 @@ cat &lt;&lt;EOF
+   .debug_typenames 0 : { *(.debug_typenames) }
+   .debug_varnames  0 : { *(.debug_varnames) }
+ 
++  /* DWARF 3 */
++  .debug_pubtypes 0 : { *(.debug_pubtypes) }
++  .debug_ranges   0 : { *(.debug_ranges) }
++
+   ${TINY_DATA_SECTION}
+   ${TINY_BSS_SECTION}
+ 

Added: branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-sse4.patch
===================================================================
--- branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-sse4.patch	                        (rev 0)
+++ branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-sse4.patch	2008-06-09 23:18:27 UTC (rev 6350)
@@ -0,0 +1,2847 @@
+gas/
+2007-05-03  H.J. Lu  &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">hongjiu.lu at intel.com</A>&gt;
+
+	* config/tc-i386.c (match_template): Don't explicitly check
+	suffix for crc32 in Intel mode.
+	(process_suffix): Issue an error for crc32 if the operand size
+	is ambiguous.
+
+2007-05-01  H.J. Lu  &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">hongjiu.lu at intel.com</A>&gt;
+
+	* config/tc-i386.c (match_template): Check suffix for crc32 in
+	Intel mdoe.
+	(process_suffix): Default the suffix of 8bit crc32 to
+	BYTE_MNEM_SUFFIX.
+	(check_byte_reg): Skip check for 8bit crc32.
+
+2007-04-18  H.J. Lu &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">hongjiu.lu at intel.com</A>&gt;
+
+	* doc/c-i386.texi; Document .ssse3, .sse4.1, .sse4.2 and .sse4.
+
+2007-04-18  H.J. Lu &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">hongjiu.lu at intel.com</A>&gt;
+
+	* config/tc-i386.c (cpu_arch): Add .sse4.2 and .sse4.
+	(match_template): Handle operand size for crc32 in SSE4.2.
+	(process_suffix): Handle operand type for crc32 in SSE4.2.
+	(output_insn): Support SSE4.2.
+
+2007-04-18  H.J. Lu &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">hongjiu.lu at intel.com</A>&gt;
+
+	* config/tc-i386.c (cpu_arch): Add .sse4.1.
+	(process_operands): Adjust implicit operand for blendvpd,
+	blendvps and pblendvb in SSE4.1.
+	(output_insn): Support SSE4.1.
+
+gas/testsuite/
+2007-05-03  H.J. Lu  &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">hongjiu.lu at intel.com</A>&gt;
+
+	* gas/i386/crc32-intel.d: Updated.
+	* gas/i386/crc32.d: Likewise.
+	* gas/i386/sse4_2.d: Likewise.
+	* gas/i386/x86-64-crc32-intel.d: Likewise.
+	* gas/i386/x86-64-crc32.d: Likewise.
+	* gas/i386/x86-64-sse4_2.d: Likewise.
+
+	* gas/i386/crc32.s: Remove crc32 instructions with ambiguous
+	operand size and suffix in crc32 instructions in Intel mode.
+	* gas/i386/x86-64-crc32.s: Likewise.
+
+	* gas/i386/sse4_2.s: Remove crc32 instructions with ambiguous
+	operand size.
+	* gas/i386/x86-64-sse4_2.s: Likewise.
+
+	* gas/i386/i386.exp: Run inval-crc32 and x86-64-inval-crc32.
+
+	* gas/i386/inval-crc32.l: New.
+	* gas/i386/inval-crc32.s: Likewise.
+	* gas/i386/x86-64-inval-crc32.l: Likewise.
+	* gas/i386/x86-64-inval-crc32.s: Likewise.
+
+2007-05-01  H.J. Lu  &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">hongjiu.lu at intel.com</A>&gt;
+
+	* gas/i386/crc32-intel.d: New file.
+	* gas/i386/crc32.d:Likewise.
+	* gas/i386/crc32.s:Likewise.
+	* gas/i386/x86-64-crc32-intel.d:Likewise.
+	* gas/i386/x86-64-crc32.d:Likewise.
+	* gas/i386/x86-64-crc32.s:Likewise.
+
+	* gas/i386/i386.exp: Run crc32, crc32-intel, x86-64-crc32
+	and x86-64-crc32-intel.
+
+2007-04-18  H.J. Lu &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">hongjiu.lu at intel.com</A>&gt;
+
+	* gas/i386/i386.exp: Add sse4.2 and x86-64-sse4.2.
+
+	* gas/i386/sse4_2.d: New file.
+	* gas/i386/sse4_2.s: Likewise.
+	* gas/i386/x86-64-sse4_2.d: Likewise.
+	* gas/i386/x86-64-sse4_2.s: Likewise.
+
+2007-04-18  H.J. Lu &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">hongjiu.lu at intel.com</A>&gt;
+
+	* gas/i386/i386.exp: Add sse4.1 and x86-64-sse4.1.
+
+	* gas/i386/sse4_1.d: New file.
+	* gas/i386/sse4_1.s: Likewise.
+	* gas/i386/x86-64-sse4_1.d: Likewise.
+	* gas/i386/x86-64-sse4_1.s: Likewise.
+
+opcodes/
+2007-05-07  H.J. Lu  &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">hongjiu.lu at intel.com</A>&gt;
+
+	* i386-dis.c (threebyte_0x38_uses_DATA_prefix): Correct entries
+	for SSE4.
+	(threebyte_0x3a_uses_DATA_prefix): Likewise.
+
+2007-05-03  H.J. Lu  &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">hongjiu.lu at intel.com</A>&gt;
+
+	* i386-dis.c (CRC32_Fixup): Don't print suffix in Intel mode.
+
+	* i386-opc.c (i386_optab): Remove IgnoreSize and correct operand
+	type for crc32.
+
+2007-05-01  H.J. Lu  &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">hongjiu.lu at intel.com</A>&gt;
+
+	* i386-dis.c (CRC32_Fixup): Properly handle Intel mode and
+	check data size prefix in 16bit mode.
+
+	* i386-opc.c (i386_optab): Default crc32 to non-8bit and
+	support Intel mode.
+
+2007-04-18  H.J. Lu &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">hongjiu.lu at intel.com</A>&gt;
+
+	* i386-dis.c (CRC32_Fixup): New.
+	(PREGRP85, PREGRP86, PREGRP87, PREGRP88, PREGRP89, PREGRP90,
+	 PREGRP91): New.
+	(threebyte_0x38_uses_DATA_prefix): Updated for SSE4.2.
+	(threebyte_0x3a_uses_DATA_prefix): Likewise.
+	(prefix_user_table): Add PREGRP85, PREGRP86, PREGRP87,
+	PREGRP88, PREGRP89, PREGRP90 and PREGRP91.
+	(three_byte_table): Likewise.
+
+	* i386-opc.c (i386_optab): Add SSE4.2 opcodes.
+
+2006-11-09  H.J. Lu  &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">hongjiu.lu at intel.com</A>&gt;
+
+	* i386-dis.c (print_insn): Check PREFIX_REPNZ before
+	PREFIX_DATA when prefix user table is used.
+
+2006-11-09  H.J. Lu  &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">hongjiu.lu at intel.com</A>&gt;
+
+	* i386-dis.c (twobyte_uses_SSE_prefix): Renamed to ...
+	(twobyte_uses_DATA_prefix): This.
+	(twobyte_uses_REPNZ_prefix): New.
+	(twobyte_uses_REPZ_prefix): Likewise.
+	(threebyte_0x38_uses_DATA_prefix): Likewise.
+	(threebyte_0x38_uses_REPNZ_prefix): Likewise.
+	(threebyte_0x38_uses_REPZ_prefix): Likewise.
+	(threebyte_0x3a_uses_DATA_prefix): Likewise.
+	(threebyte_0x3a_uses_REPNZ_prefix): Likewise.
+	(threebyte_0x3a_uses_REPZ_prefix): Likewise.
+	(print_insn): Updated checking usages of DATA/REPNZ/REPZ
+	prefixes.
+
+2007-04-18  H.J. Lu &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">hongjiu.lu at intel.com</A>&gt;
+
+	* i386-dis.c (XMM_Fixup): New.
+	(Edqb): New.
+	(Edqd): New.
+	(XMM0): New.
+	(dqb_mode): New.
+	(dqd_mode): New.
+	(PREGRP39 ... PREGRP85): New.
+	(threebyte_0x38_uses_DATA_prefix): Updated for SSE4.
+	(threebyte_0x3a_uses_DATA_prefix): Likewise.
+	(prefix_user_table): Add PREGRP39 ... PREGRP85.
+	(three_byte_table): Likewise.
+	(putop): Handle 'K'.
+	(intel_operand_size): Handle dqb_mode, dqd_mode):
+	(OP_E): Likewise.
+	(OP_G): Likewise.
+
+	* i386-opc.c (i386_optab): Add SSE4.1 opcodes.
+
+	* i386-opc.h (CpuSSE4_1): New.
+	(CpuUnknownFlags): Add CpuSSE4_1.
+	(regKludge): Update comment.
+
+--- include/opcode/i386.h.jj	2007-05-07 10:48:24.000000000 +0200
++++ include/opcode/i386.h	2007-05-07 12:46:35.000000000 +0200
+@@ -1197,6 +1197,10 @@ static const template i386_optab[] =
+ {&quot;pavgw&quot;,     2, 0x660fe3,  X, CpuSSE2,NoSuf|IgnoreSize|Modrm,	{ RegXMM|LLongMem, RegXMM, 0 } },
+ {&quot;pextrw&quot;,    3, 0x0fc5,    X, CpuMMX2,lq_Suf|IgnoreSize|Modrm,	{ Imm8, RegMMX, Reg32|Reg64 } },
+ {&quot;pextrw&quot;,    3, 0x660fc5,  X, CpuSSE2,lq_Suf|IgnoreSize|Modrm,	{ Imm8, RegXMM, Reg32|Reg64 } },
++
++/* Streaming SIMD extensions 4.1 Instructions.  */
++{&quot;pextrw&quot;,    3, 0x660f3a15,X, CpuSSE4_1, NoSuf|IgnoreSize|Modrm, { Imm8, RegXMM, Reg32|Reg64|ShortMem } },
++
+ {&quot;pinsrw&quot;,    3, 0x0fc4,    X, CpuMMX2,lq_Suf|IgnoreSize|Modrm,	{ Imm8, Reg32|Reg64|ShortMem, RegMMX } },
+ {&quot;pinsrw&quot;,    3, 0x660fc4,  X, CpuSSE2,lq_Suf|IgnoreSize|Modrm,	{ Imm8, Reg32|Reg64|ShortMem, RegXMM } },
+ {&quot;pmaxsw&quot;,    2, 0x0fee,    X, CpuMMX2,NoSuf|IgnoreSize|Modrm,	{ RegMMX|LLongMem, RegMMX, 0 } },
+@@ -1410,6 +1414,71 @@ static const template i386_optab[] =
+ {&quot;pabsd&quot;,    2,    0x0f381e,X, CpuSSSE3, NoSuf|IgnoreSize|Modrm,	{ RegMMX|LongMem, RegMMX, 0 } },
+ {&quot;pabsd&quot;,    2,  0x660f381e,X, CpuSSSE3, NoSuf|IgnoreSize|Modrm,	{ RegXMM|LLongMem, RegXMM, 0 } },
+ 
++/* Streaming SIMD extensions 4.1 Instructions.  */
++
++{&quot;blendpd&quot;,  3,  0x660f3a0d,X, CpuSSE4_1, NoSuf|IgnoreSize|Modrm,	{ Imm8, RegXMM|LLongMem, RegXMM } },
++{&quot;blendps&quot;,  3,  0x660f3a0c,X, CpuSSE4_1, NoSuf|IgnoreSize|Modrm,	{ Imm8, RegXMM|LLongMem, RegXMM } },
++{&quot;blendvpd&quot;, 3,  0x660f3815,X, CpuSSE4_1, NoSuf|IgnoreSize|Modrm|regKludge, { RegXMM, RegXMM|LLongMem, RegXMM } },
++{&quot;blendvps&quot;, 3,  0x660f3814,X, CpuSSE4_1, NoSuf|IgnoreSize|Modrm|regKludge, { RegXMM, RegXMM|LLongMem, RegXMM } },
++{&quot;dppd&quot;,     3,  0x660f3a41,X, CpuSSE4_1, NoSuf|IgnoreSize|Modrm,	{ Imm8, RegXMM|LLongMem, RegXMM } },
++{&quot;dpps&quot;,     3,  0x660f3a40,X, CpuSSE4_1, NoSuf|IgnoreSize|Modrm,	{ Imm8, RegXMM|LLongMem, RegXMM } },
++{&quot;extractps&quot;,3,  0x660f3a17,X, CpuSSE4_1, NoSuf|IgnoreSize|Modrm,	{ Imm8, RegXMM, Reg32|Reg64|LongMem } },
++{&quot;insertps&quot;, 3,  0x660f3a21,X, CpuSSE4_1, NoSuf|IgnoreSize|Modrm,	{ Imm8, RegXMM|LongMem, RegXMM } },
++{&quot;movntdqa&quot;, 2,  0x660f382a,X, CpuSSE4_1, NoSuf|IgnoreSize|Modrm,	{ LLongMem, RegXMM, 0 } },
++{&quot;mpsadbw&quot;,  3,  0x660f3a42,X, CpuSSE4_1, NoSuf|IgnoreSize|Modrm,	{ Imm8, RegXMM|LLongMem, RegXMM } },
++{&quot;packusdw&quot;, 2,  0x660f382b,X, CpuSSE4_1, NoSuf|IgnoreSize|Modrm,	{ RegXMM|LLongMem, RegXMM, 0 } },
++{&quot;pblendvb&quot;, 3,  0x660f3810,X, CpuSSE4_1, NoSuf|IgnoreSize|Modrm|regKludge, { RegXMM, RegXMM|LLongMem, RegXMM } },
++{&quot;pblendw&quot;,  3,  0x660f3a0e,X, CpuSSE4_1, NoSuf|IgnoreSize|Modrm,	{ Imm8, RegXMM|LLongMem, RegXMM } },
++{&quot;pcmpeqq&quot;,  2,  0x660f3829,X, CpuSSE4_1, NoSuf|IgnoreSize|Modrm,	{ RegXMM|LLongMem, RegXMM, 0 } },
++{&quot;pextrb&quot;,   3,  0x660f3a14,X, CpuSSE4_1, NoSuf|IgnoreSize|Modrm,	{ Imm8, RegXMM, Reg32|Reg64|ByteMem } },
++{&quot;pextrd&quot;,   3,  0x660f3a16,X, CpuSSE4_1, NoSuf|IgnoreSize|Modrm,	{ Imm8, RegXMM, Reg32|LongMem } },
++{&quot;pextrq&quot;,   3,  0x660f3a16,X, CpuSSE4_1|Cpu64, NoSuf|IgnoreSize|Modrm|Size64, { Imm8, RegXMM, Reg64|LLongMem } },
++{&quot;phminposuw&quot;,2, 0x660f3841,X, CpuSSE4_1, NoSuf|IgnoreSize|Modrm,      { RegXMM|LLongMem, RegXMM, 0 } },
++{&quot;pinsrb&quot;,   3,  0x660f3a20,X, CpuSSE4_1, NoSuf|IgnoreSize|Modrm,	{ Imm8, Reg32|Reg64|ByteMem, RegXMM } },
++{&quot;pinsrd&quot;,   3,  0x660f3a22,X, CpuSSE4_1, NoSuf|IgnoreSize|Modrm,	{ Imm8, Reg32|LongMem, RegXMM } },
++{&quot;pinsrq&quot;,   3,  0x660f3a22,X, CpuSSE4_1|Cpu64, NoSuf|IgnoreSize|Modrm|Size64, { Imm8, Reg64|LLongMem, RegXMM } },
++{&quot;pmaxsb&quot;,   2,  0x660f383c,X, CpuSSE4_1, NoSuf|IgnoreSize|Modrm,	{ RegXMM|LLongMem, RegXMM, 0 } },
++{&quot;pmaxsd&quot;,   2,  0x660f383d,X, CpuSSE4_1, NoSuf|IgnoreSize|Modrm,	{ RegXMM|LLongMem, RegXMM, 0 } },
++{&quot;pmaxud&quot;,   2,  0x660f383f,X, CpuSSE4_1, NoSuf|IgnoreSize|Modrm,	{ RegXMM|LLongMem, RegXMM, 0 } },
++{&quot;pmaxuw&quot;,   2,  0x660f383e,X, CpuSSE4_1, NoSuf|IgnoreSize|Modrm,	{ RegXMM|LLongMem, RegXMM, 0 } },
++{&quot;pminsb&quot;,   2,  0x660f3838,X, CpuSSE4_1, NoSuf|IgnoreSize|Modrm,	{ RegXMM|LLongMem, RegXMM, 0 } },
++{&quot;pminsd&quot;,   2,  0x660f3839,X, CpuSSE4_1, NoSuf|IgnoreSize|Modrm,	{ RegXMM|LLongMem, RegXMM, 0 } },
++{&quot;pminud&quot;,   2,  0x660f383b,X, CpuSSE4_1, NoSuf|IgnoreSize|Modrm,	{ RegXMM|LLongMem, RegXMM, 0 } },
++{&quot;pminuw&quot;,   2,  0x660f383a,X, CpuSSE4_1, NoSuf|IgnoreSize|Modrm,	{ RegXMM|LLongMem, RegXMM, 0 } },
++{&quot;pmovsxbw&quot;, 2,  0x660f3820,X, CpuSSE4_1, NoSuf|IgnoreSize|Modrm,	{ RegXMM|LLongMem, RegXMM, 0 } },
++{&quot;pmovsxbd&quot;, 2,  0x660f3821,X, CpuSSE4_1, NoSuf|IgnoreSize|Modrm,	{ RegXMM|LongMem, RegXMM, 0 } },
++{&quot;pmovsxbq&quot;, 2,  0x660f3822,X, CpuSSE4_1, NoSuf|IgnoreSize|Modrm,	{ RegXMM|ShortMem, RegXMM, 0 } },
++{&quot;pmovsxwd&quot;, 2,  0x660f3823,X, CpuSSE4_1, NoSuf|IgnoreSize|Modrm,	{ RegXMM|LLongMem, RegXMM, 0 } },
++{&quot;pmovsxwq&quot;, 2,  0x660f3824,X, CpuSSE4_1, NoSuf|IgnoreSize|Modrm,	{ RegXMM|LongMem, RegXMM, 0 } },
++{&quot;pmovsxdq&quot;, 2,  0x660f3825,X, CpuSSE4_1, NoSuf|IgnoreSize|Modrm,	{ RegXMM|LLongMem, RegXMM, 0 } },
++{&quot;pmovzxbw&quot;, 2,  0x660f3830,X, CpuSSE4_1, NoSuf|IgnoreSize|Modrm,	{ RegXMM|LLongMem, RegXMM, 0 } },
++{&quot;pmovzxbd&quot;, 2,  0x660f3831,X, CpuSSE4_1, NoSuf|IgnoreSize|Modrm,	{ RegXMM|LongMem, RegXMM, 0 } },
++{&quot;pmovzxbq&quot;, 2,  0x660f3832,X, CpuSSE4_1, NoSuf|IgnoreSize|Modrm,	{ RegXMM|ShortMem, RegXMM, 0 } },
++{&quot;pmovzxwd&quot;, 2,  0x660f3833,X, CpuSSE4_1, NoSuf|IgnoreSize|Modrm,	{ RegXMM|LLongMem, RegXMM, 0 } },
++{&quot;pmovzxwq&quot;, 2,  0x660f3834,X, CpuSSE4_1, NoSuf|IgnoreSize|Modrm,	{ RegXMM|LongMem, RegXMM, 0 } },
++{&quot;pmovzxdq&quot;, 2,  0x660f3835,X, CpuSSE4_1, NoSuf|IgnoreSize|Modrm,	{ RegXMM|LLongMem, RegXMM, 0 } },
++{&quot;pmuldq&quot;,   2,  0x660f3828,X, CpuSSE4_1, NoSuf|IgnoreSize|Modrm,	{ RegXMM|LLongMem, RegXMM, 0 } },
++{&quot;pmulld&quot;,   2,  0x660f3840,X, CpuSSE4_1, NoSuf|IgnoreSize|Modrm,	{ RegXMM|LLongMem, RegXMM, 0 } },
++{&quot;ptest&quot;,    2,  0x660f3817,X, CpuSSE4_1, NoSuf|IgnoreSize|Modrm,	{ RegXMM|LLongMem, RegXMM, 0 } },
++{&quot;roundpd&quot;,  3,  0x660f3a09,X, CpuSSE4_1, NoSuf|IgnoreSize|Modrm,	{ Imm8, RegXMM|LLongMem, RegXMM } },
++{&quot;roundps&quot;,  3,  0x660f3a08,X, CpuSSE4_1, NoSuf|IgnoreSize|Modrm,	{ Imm8, RegXMM|LLongMem, RegXMM } },
++{&quot;roundsd&quot;,  3,  0x660f3a0b,X, CpuSSE4_1, NoSuf|IgnoreSize|Modrm,	{ Imm8, RegXMM|LLongMem, RegXMM } },
++{&quot;roundss&quot;,  3,  0x660f3a0a,X, CpuSSE4_1, NoSuf|IgnoreSize|Modrm,	{ Imm8, RegXMM|LongMem, RegXMM } },
++
++/* Streaming SIMD extensions 4.2 Instructions.  */
++
++{&quot;pcmpgtq&quot;,   2,  0x660f3837,X, CpuSSE4_2, NoSuf|IgnoreSize|Modrm,	{ RegXMM|LLongMem, RegXMM, 0 } },
++{&quot;pcmpestri&quot;, 3,  0x660f3a61,X, CpuSSE4_2, NoSuf|IgnoreSize|Modrm,	{ Imm8, RegXMM|LLongMem, RegXMM } },
++{&quot;pcmpestrm&quot;, 3,  0x660f3a60,X, CpuSSE4_2, NoSuf|IgnoreSize|Modrm,	{ Imm8, RegXMM|LLongMem, RegXMM } },
++{&quot;pcmpistri&quot;, 3,  0x660f3a63,X, CpuSSE4_2, NoSuf|IgnoreSize|Modrm,	{ Imm8, RegXMM|LLongMem, RegXMM } },
++{&quot;pcmpistrm&quot;, 3,  0x660f3a62,X, CpuSSE4_2, NoSuf|IgnoreSize|Modrm,	{ Imm8, RegXMM|LLongMem, RegXMM } },
++/* We put non-8bit version before 8bit so that crc32 with memory operand
++   defaults to non-8bit.  */
++{&quot;crc32&quot;,     2,  0xf20f38f1,X, CpuSSE4_2, wl_Suf|Modrm,		{ Reg16|Reg32|ShortMem|LongMem, Reg32, 0 } },
++{&quot;crc32&quot;,     2,  0xf20f38f1,X, CpuSSE4_2|Cpu64, q_Suf|Modrm|Rex64,	{ Reg64|LLongMem, Reg64, 0 } },
++{&quot;crc32&quot;,     2,  0xf20f38f0,X, CpuSSE4_2, b_Suf|Modrm,			{ Reg8|ByteMem, Reg32, 0 } },
++{&quot;crc32&quot;,     2,  0xf20f38f0,X, CpuSSE4_2|Cpu64, b_Suf|Modrm|Rex64,	{ Reg8|ByteMem, Reg64, 0 } },
++
+ /* AMD 3DNow! instructions.  */
+ 
+ {&quot;prefetch&quot;, 1, 0x0f0d,	   0, Cpu3dnow, NoSuf|IgnoreSize|Modrm,	{ ByteMem, 0, 0 } },
+@@ -1472,7 +1541,7 @@ static const template i386_optab[] =
+ {&quot;insertq&quot;,  4, 0xf20f78,  X, CpuSSE4a, NoSuf|IgnoreSize|Modrm, { Imm8, Imm8, RegXMM, RegXMM} },
+ 
+ /* ABM instructions */
+-{&quot;popcnt&quot;,   2, 0xf30fb8,  X, CpuABM, wlq_Suf|Modrm,          { WordReg|WordMem, WordReg, 0} },
++{&quot;popcnt&quot;,   2, 0xf30fb8,  X, CpuABM|CpuSSE4_2, wlq_Suf|Modrm, { WordReg|WordMem, WordReg, 0} },
+ {&quot;lzcnt&quot;,    2, 0xf30fbd,  X, CpuABM, wlq_Suf|Modrm,          { WordReg|WordMem, WordReg, 0} },
+ 
+ 
+--- opcodes/i386-dis.c.jj	2007-05-07 10:48:24.000000000 +0200
++++ opcodes/i386-dis.c	2007-05-07 15:11:20.000000000 +0200
+@@ -105,6 +105,8 @@ static void BadOp (void);
+ static void SEG_Fixup (int, int);
+ static void VMX_Fixup (int, int);
+ static void REP_Fixup (int, int);
++static void XMM_Fixup (int, int);
++static void CRC32_Fixup (int, int);
+ 
+ struct dis_private {
+   /* Points to first byte not fetched.  */
+@@ -213,6 +215,8 @@ fetch_data (struct disassemble_info *inf
+ #define Eq OP_E, q_mode
+ #define Edq OP_E, dq_mode
+ #define Edqw OP_E, dqw_mode
++#define Edqb OP_E, dqb_mode
++#define Edqd OP_E, dqd_mode
+ #define indirEv OP_indirE, stack_v_mode
+ #define indirEp OP_indirE, f_mode
+ #define stackEv OP_E, stack_v_mode
+@@ -319,6 +323,7 @@ fetch_data (struct disassemble_info *inf
+ #define VM OP_VMX, q_mode
+ #define OPSUF OP_3DNowSuffix, 0
+ #define OPSIMD OP_SIMD_Suffix, 0
++#define XMM0 XMM_Fixup, 0
+ 
+ /* Used handle &quot;rep&quot; prefix for string instructions.  */
+ #define Xbr REP_Fixup, eSI_reg
+@@ -352,6 +357,8 @@ fetch_data (struct disassemble_info *inf
+ #define f_mode 13 /* 4- or 6-byte pointer operand */
+ #define const_1_mode 14
+ #define stack_v_mode 15 /* v_mode for stack-related opcodes.  */
++#define dqb_mode 18 /* registers like dq_mode, memory like b_mode.  */
++#define dqd_mode 19 /* registers like dq_mode, memory like d_mode.  */
+ 
+ #define es_reg 100
+ #define cs_reg 101
+@@ -472,7 +479,61 @@ fetch_data (struct disassemble_info *inf
+ #define PREGRP35  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 35, NULL, 0, NULL, 0
+ #define PREGRP36  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 36, NULL, 0, NULL, 0
+ #define PREGRP37  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 37, NULL, 0, NULL, 0
+-
++#define PREGRP38  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 38, NULL, 0, NULL, 0
++#define PREGRP39  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 39, NULL, 0, NULL, 0
++#define PREGRP40  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 40, NULL, 0, NULL, 0
++#define PREGRP41  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 41, NULL, 0, NULL, 0
++#define PREGRP42  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 42, NULL, 0, NULL, 0
++#define PREGRP43  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 43, NULL, 0, NULL, 0
++#define PREGRP44  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 44, NULL, 0, NULL, 0
++#define PREGRP45  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 45, NULL, 0, NULL, 0
++#define PREGRP46  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 46, NULL, 0, NULL, 0
++#define PREGRP47  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 47, NULL, 0, NULL, 0
++#define PREGRP48  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 48, NULL, 0, NULL, 0
++#define PREGRP49  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 49, NULL, 0, NULL, 0
++#define PREGRP50  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 50, NULL, 0, NULL, 0
++#define PREGRP51  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 51, NULL, 0, NULL, 0
++#define PREGRP52  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 52, NULL, 0, NULL, 0
++#define PREGRP53  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 53, NULL, 0, NULL, 0
++#define PREGRP54  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 54, NULL, 0, NULL, 0
++#define PREGRP55  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 55, NULL, 0, NULL, 0
++#define PREGRP56  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 56, NULL, 0, NULL, 0
++#define PREGRP57  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 57, NULL, 0, NULL, 0
++#define PREGRP58  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 58, NULL, 0, NULL, 0
++#define PREGRP59  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 59, NULL, 0, NULL, 0
++#define PREGRP60  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 60, NULL, 0, NULL, 0
++#define PREGRP61  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 61, NULL, 0, NULL, 0
++#define PREGRP62  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 62, NULL, 0, NULL, 0
++#define PREGRP63  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 63, NULL, 0, NULL, 0
++#define PREGRP64  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 64, NULL, 0, NULL, 0
++#define PREGRP65  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 65, NULL, 0, NULL, 0
++#define PREGRP66  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 66, NULL, 0, NULL, 0
++#define PREGRP67  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 67, NULL, 0, NULL, 0
++#define PREGRP68  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 68, NULL, 0, NULL, 0
++#define PREGRP69  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 69, NULL, 0, NULL, 0
++#define PREGRP70  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 70, NULL, 0, NULL, 0
++#define PREGRP71  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 71, NULL, 0, NULL, 0
++#define PREGRP72  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 72, NULL, 0, NULL, 0
++#define PREGRP73  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 73, NULL, 0, NULL, 0
++#define PREGRP74  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 74, NULL, 0, NULL, 0
++#define PREGRP75  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 75, NULL, 0, NULL, 0
++#define PREGRP76  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 76, NULL, 0, NULL, 0
++#define PREGRP77  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 77, NULL, 0, NULL, 0
++#define PREGRP78  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 78, NULL, 0, NULL, 0
++#define PREGRP79  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 79, NULL, 0, NULL, 0
++#define PREGRP80  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 80, NULL, 0, NULL, 0
++#define PREGRP81  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 81, NULL, 0, NULL, 0
++#define PREGRP82  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 82, NULL, 0, NULL, 0
++#define PREGRP83  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 83, NULL, 0, NULL, 0
++#define PREGRP84  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 84, NULL, 0, NULL, 0
++#define PREGRP85  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 85, NULL, 0, NULL, 0
++#define PREGRP86  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 86, NULL, 0, NULL, 0
++#define PREGRP87  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 87, NULL, 0, NULL, 0
++#define PREGRP88  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 88, NULL, 0, NULL, 0
++#define PREGRP89  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 89, NULL, 0, NULL, 0
++#define PREGRP90  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 90, NULL, 0, NULL, 0
++#define PREGRP91  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 91, NULL, 0, NULL, 0
++#define PREGRP92  NULL, NULL, USE_PREFIX_USER_TABLE, NULL, 92, NULL, 0, NULL, 0
+ 
+ #define X86_64_0  NULL, NULL, X86_64_SPECIAL, NULL,  0, NULL, 0, NULL, 0
+ 
+@@ -504,6 +565,7 @@ struct dis386 {
+    'I' =&gt; honor following macro letter even in Intel mode (implemented only
+    .      for some of the macro letters)
+    'J' =&gt; print 'l'
++   'K' =&gt; print 'd' or 'q' if rex prefix is present.
+    'L' =&gt; print 'l' if suffix_always is true
+    'N' =&gt; print 'n' if instruction has no wait &quot;prefix&quot;
+    'O' =&gt; print 'd', or 'o'
+@@ -1158,7 +1220,7 @@ static const unsigned char twobyte_has_m
+   /*       0 1 2 3 4 5 6 7 8 9 a b c d e f        */
+ };
+ 
+-static const unsigned char twobyte_uses_SSE_prefix[256] = {
++static const unsigned char twobyte_uses_DATA_prefix[256] = {
+   /*       0 1 2 3 4 5 6 7 8 9 a b c d e f        */
+   /*       -------------------------------        */
+   /* 00 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 0f */
+@@ -1181,6 +1243,196 @@ static const unsigned char twobyte_uses_
+   /*       0 1 2 3 4 5 6 7 8 9 a b c d e f        */
+ };
+ 
++static const unsigned char twobyte_uses_REPNZ_prefix[256] = {
++  /*       0 1 2 3 4 5 6 7 8 9 a b c d e f        */
++  /*       -------------------------------        */
++  /* 00 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 0f */
++  /* 10 */ 1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 1f */
++  /* 20 */ 0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0, /* 2f */
++  /* 30 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 3f */
++  /* 40 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 4f */
++  /* 50 */ 0,1,0,0,0,0,0,0,1,1,1,0,1,1,1,1, /* 5f */
++  /* 60 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 6f */
++  /* 70 */ 1,0,0,0,0,0,0,0,1,1,0,0,1,1,0,0, /* 7f */
++  /* 80 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 8f */
++  /* 90 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 9f */
++  /* a0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* af */
++  /* b0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* bf */
++  /* c0 */ 0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0, /* cf */
++  /* d0 */ 1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0, /* df */
++  /* e0 */ 0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0, /* ef */
++  /* f0 */ 1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* ff */
++  /*       -------------------------------        */
++  /*       0 1 2 3 4 5 6 7 8 9 a b c d e f        */
++};
++
++static const unsigned char twobyte_uses_REPZ_prefix[256] = {
++  /*       0 1 2 3 4 5 6 7 8 9 a b c d e f        */
++  /*       -------------------------------        */
++  /* 00 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 0f */
++  /* 10 */ 1,1,1,0,0,0,1,0,0,0,0,0,0,0,0,0, /* 1f */
++  /* 20 */ 0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0, /* 2f */
++  /* 30 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 3f */
++  /* 40 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 4f */
++  /* 50 */ 0,1,1,1,0,0,0,0,1,1,1,1,1,1,1,1, /* 5f */
++  /* 60 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1, /* 6f */
++  /* 70 */ 1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1, /* 7f */
++  /* 80 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 8f */
++  /* 90 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 9f */
++  /* a0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* af */
++  /* b0 */ 0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0, /* bf */
++  /* c0 */ 0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0, /* cf */
++  /* d0 */ 0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0, /* df */
++  /* e0 */ 0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0, /* ef */
++  /* f0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* ff */
++  /*       -------------------------------        */
++  /*       0 1 2 3 4 5 6 7 8 9 a b c d e f        */
++};
++
++/* This is used to determine if opcode 0f 38 XX uses DATA prefix.  */ 
++static const unsigned char threebyte_0x38_uses_DATA_prefix[256] = {
++  /*       0 1 2 3 4 5 6 7 8 9 a b c d e f        */
++  /*       -------------------------------        */
++  /* 00 */ 1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0, /* 0f */
++  /* 10 */ 1,0,0,0,1,1,0,1,0,0,0,0,1,1,1,0, /* 1f */
++  /* 20 */ 1,1,1,1,1,1,0,0,1,1,1,1,0,0,0,0, /* 2f */
++  /* 30 */ 1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1, /* 3f */
++  /* 40 */ 1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 4f */
++  /* 50 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 5f */
++  /* 60 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 6f */
++  /* 70 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 7f */
++  /* 80 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 8f */
++  /* 90 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 9f */
++  /* a0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* af */
++  /* b0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* bf */
++  /* c0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* cf */
++  /* d0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* df */
++  /* e0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* ef */
++  /* f0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* ff */
++  /*       -------------------------------        */
++  /*       0 1 2 3 4 5 6 7 8 9 a b c d e f        */
++};
++
++/* This is used to determine if opcode 0f 38 XX uses REPNZ prefix.  */ 
++static const unsigned char threebyte_0x38_uses_REPNZ_prefix[256] = {
++  /*       0 1 2 3 4 5 6 7 8 9 a b c d e f        */
++  /*       -------------------------------        */
++  /* 00 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 0f */
++  /* 10 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 1f */
++  /* 20 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 2f */
++  /* 30 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 3f */
++  /* 40 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 4f */
++  /* 50 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 5f */
++  /* 60 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 6f */
++  /* 70 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 7f */
++  /* 80 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 8f */
++  /* 90 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 9f */
++  /* a0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* af */
++  /* b0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* bf */
++  /* c0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* cf */
++  /* d0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* df */
++  /* e0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* ef */
++  /* f0 */ 1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* ff */
++  /*       -------------------------------        */
++  /*       0 1 2 3 4 5 6 7 8 9 a b c d e f        */
++};
++
++/* This is used to determine if opcode 0f 38 XX uses REPZ prefix.  */ 
++static const unsigned char threebyte_0x38_uses_REPZ_prefix[256] = {
++  /*       0 1 2 3 4 5 6 7 8 9 a b c d e f        */
++  /*       -------------------------------        */
++  /* 00 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 0f */
++  /* 10 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 1f */
++  /* 20 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 2f */
++  /* 30 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 3f */
++  /* 40 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 4f */
++  /* 50 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 5f */
++  /* 60 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 6f */
++  /* 70 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 7f */
++  /* 80 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 8f */
++  /* 90 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 9f */
++  /* a0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* af */
++  /* b0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* bf */
++  /* c0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* cf */
++  /* d0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* df */
++  /* e0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* ef */
++  /* f0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* ff */
++  /*       -------------------------------        */
++  /*       0 1 2 3 4 5 6 7 8 9 a b c d e f        */
++};
++
++/* This is used to determine if opcode 0f 3a XX uses DATA prefix.  */ 
++static const unsigned char threebyte_0x3a_uses_DATA_prefix[256] = {
++  /*       0 1 2 3 4 5 6 7 8 9 a b c d e f        */
++  /*       -------------------------------        */
++  /* 00 */ 0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1, /* 0f */
++  /* 10 */ 0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0, /* 1f */
++  /* 20 */ 1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 2f */
++  /* 30 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 3f */
++  /* 40 */ 1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 4f */
++  /* 50 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 5f */
++  /* 60 */ 1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0, /* 6f */
++  /* 70 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 7f */
++  /* 80 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 8f */
++  /* 90 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 9f */
++  /* a0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* af */
++  /* b0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* bf */
++  /* c0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* cf */
++  /* d0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* df */
++  /* e0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* ef */
++  /* f0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* ff */
++  /*       -------------------------------        */
++  /*       0 1 2 3 4 5 6 7 8 9 a b c d e f        */
++};
++
++/* This is used to determine if opcode 0f 3a XX uses REPNZ prefix.  */ 
++static const unsigned char threebyte_0x3a_uses_REPNZ_prefix[256] = {
++  /*       0 1 2 3 4 5 6 7 8 9 a b c d e f        */
++  /*       -------------------------------        */
++  /* 00 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 0f */
++  /* 10 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 1f */
++  /* 20 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 2f */
++  /* 30 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 3f */
++  /* 40 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 4f */
++  /* 50 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 5f */
++  /* 60 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 6f */
++  /* 70 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 7f */
++  /* 80 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 8f */
++  /* 90 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 9f */
++  /* a0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* af */
++  /* b0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* bf */
++  /* c0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* cf */
++  /* d0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* df */
++  /* e0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* ef */
++  /* f0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* ff */
++  /*       -------------------------------        */
++  /*       0 1 2 3 4 5 6 7 8 9 a b c d e f        */
++};
++
++/* This is used to determine if opcode 0f 3a XX uses REPZ prefix.  */ 
++static const unsigned char threebyte_0x3a_uses_REPZ_prefix[256] = {
++  /*       0 1 2 3 4 5 6 7 8 9 a b c d e f        */
++  /*       -------------------------------        */
++  /* 00 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 0f */
++  /* 10 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 1f */
++  /* 20 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 2f */
++  /* 30 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 3f */
++  /* 40 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 4f */
++  /* 50 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 5f */
++  /* 60 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 6f */
++  /* 70 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 7f */
++  /* 80 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 8f */
++  /* 90 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* 9f */
++  /* a0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* af */
++  /* b0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* bf */
++  /* c0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* cf */
++  /* d0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* df */
++  /* e0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* ef */
++  /* f0 */ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, /* ff */
++  /*       -------------------------------        */
++  /*       0 1 2 3 4 5 6 7 8 9 a b c d e f        */
++};
++
+ static char obuf[100];
+ static char *obufp;
+ static char scratchbuf[100];
+@@ -1729,105 +1981,545 @@ static const struct dis386 prefix_user_t
+   },
+   /* PREGRP24 */
+   {
+-    { &quot;(bad)&quot;, MX, EX, XX, XX },
+-    { &quot;(bad)&quot;, XM, EX, XX, XX },
+-    { &quot;punpckhqdq&quot;, XM, EX, XX, XX },
+-    { &quot;(bad)&quot;, XM, EX, XX, XX },
++    { &quot;(bad)&quot;, MX, EX, XX, XX },
++    { &quot;(bad)&quot;, XM, EX, XX, XX },
++    { &quot;punpckhqdq&quot;, XM, EX, XX, XX },
++    { &quot;(bad)&quot;, XM, EX, XX, XX },
++  },
++  /* PREGRP25 */
++  {
++    { &quot;movntq&quot;, EM, MX, XX, XX },
++    { &quot;(bad)&quot;, EM, XM, XX, XX },
++    { &quot;movntdq&quot;, EM, XM, XX, XX },
++    { &quot;(bad)&quot;, EM, XM, XX, XX },
++  },
++  /* PREGRP26 */
++  {
++    { &quot;(bad)&quot;, MX, EX, XX, XX },
++    { &quot;(bad)&quot;, XM, EX, XX, XX },
++    { &quot;punpcklqdq&quot;, XM, EX, XX, XX },
++    { &quot;(bad)&quot;, XM, EX, XX, XX },
++  },
++  /* PREGRP27 */
++  {
++    { &quot;(bad)&quot;, MX, EX, XX, XX },
++    { &quot;(bad)&quot;, XM, EX, XX, XX },
++    { &quot;addsubpd&quot;, XM, EX, XX, XX },
++    { &quot;addsubps&quot;, XM, EX, XX, XX },
++  },
++  /* PREGRP28 */
++  {
++    { &quot;(bad)&quot;, MX, EX, XX, XX },
++    { &quot;(bad)&quot;, XM, EX, XX, XX },
++    { &quot;haddpd&quot;, XM, EX, XX, XX },
++    { &quot;haddps&quot;, XM, EX, XX, XX },
++  },
++  /* PREGRP29 */
++  {
++    { &quot;(bad)&quot;, MX, EX, XX, XX },
++    { &quot;(bad)&quot;, XM, EX, XX, XX },
++    { &quot;hsubpd&quot;, XM, EX, XX, XX },
++    { &quot;hsubps&quot;, XM, EX, XX, XX },
++  },
++  /* PREGRP30 */
++  {
++    { &quot;movlpX&quot;, XM, EX, SIMD_Fixup, 'h', XX }, /* really only 2 operands */
++    { &quot;movsldup&quot;, XM, EX, XX, XX },
++    { &quot;movlpd&quot;, XM, EX, XX, XX },
++    { &quot;movddup&quot;, XM, EX, XX, XX },
++  },
++  /* PREGRP31 */
++  {
++    { &quot;movhpX&quot;, XM, EX, SIMD_Fixup, 'l', XX },
++    { &quot;movshdup&quot;, XM, EX, XX, XX },
++    { &quot;movhpd&quot;, XM, EX, XX, XX },
++    { &quot;(bad)&quot;, XM, EX, XX, XX },
++  },
++  /* PREGRP32 */
++  {
++    { &quot;(bad)&quot;, XM, EX, XX, XX },
++    { &quot;(bad)&quot;, XM, EX, XX, XX },
++    { &quot;(bad)&quot;, XM, EX, XX, XX },
++    { &quot;lddqu&quot;, XM, M, XX, XX },
++  },
++  /* PREGRP33 */
++  {
++    {&quot;movntps&quot;,Ev, XM, XX, XX},
++    {&quot;movntss&quot;,Ev, XM, XX, XX},
++    {&quot;movntpd&quot;,Ev, XM, XX, XX},
++    {&quot;movntsd&quot;,Ev, XM, XX, XX},
++  },
++
++  /* PREGRP34 */
++  {
++    {&quot;vmread&quot;, Em, Gm, XX, XX},
++    {&quot;(bad)&quot;,  XX, XX, XX, XX},
++    {&quot;extrq&quot;,  XS, Ib, Ib, XX},
++    {&quot;insertq&quot;,XM, XS, Ib, Ib},
++  },
++  
++ /* PREGRP35 */  
++  {
++    {&quot;vmwrite&quot;, Gm, Em, XX, XX},
++    {&quot;(bad)&quot;,   XX, XX, XX, XX},
++    {&quot;extrq&quot;,   XM, XS, XX, XX},
++    {&quot;insertq&quot;, XM, XS, XX, XX},
++  }, 
++
++  /* PREGRP36 */
++  {
++    { &quot;bsrS&quot;,   Gv, Ev, XX, XX },
++    { &quot;lzcntS&quot;, Gv, Ev, XX, XX },
++    { &quot;bsrS&quot;,  Gv, Ev, XX, XX },
++    { &quot;(bad)&quot;,  XX, XX, XX, XX },
++  },
++
++  /* PREGRP37 */
++  {
++    { &quot;(bad)&quot;,  XX, XX, XX, XX },
++    { &quot;popcntS&quot;,Gv, Ev, XX, XX },
++    { &quot;(bad)&quot;,  XX, XX, XX, XX },
++    { &quot;(bad)&quot;,  XX, XX, XX, XX },    
++  },
++
++  /* PREGRP38 */
++  {
++    { &quot;(bad)&quot;,  XX, XX, XX, XX },
++    { &quot;(bad)&quot;,  XX, XX, XX, XX },
++    { &quot;(bad)&quot;,  XX, XX, XX, XX },
++    { &quot;(bad)&quot;,  XX, XX, XX, XX },    
++  },
++
++  /* PREGRP39 */
++  {
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;pblendvb&quot;, XM, EX, XMM0, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++  },
++
++  /* PREGRP40 */
++  {
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;blendvps&quot;, XM, EX, XMM0, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++  },
++
++  /* PREGRP41 */
++  {
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;blendvpd&quot;, XM, EX, XMM0, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++  },
++
++  /* PREGRP42 */
++  {
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;ptest&quot;,  XM, EX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++  },
++
++  /* PREGRP43 */
++  {
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;pmovsxbw&quot;, XM, EX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++  },
++
++  /* PREGRP44 */
++  {
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;pmovsxbd&quot;, XM, EX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++  },
++
++  /* PREGRP45 */
++  {
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;pmovsxbq&quot;, XM, EX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++  },
++
++  /* PREGRP46 */
++  {
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;pmovsxwd&quot;, XM, EX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++  },
++
++  /* PREGRP47 */
++  {
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;pmovsxwq&quot;, XM, EX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++  },
++
++  /* PREGRP48 */
++  {
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;pmovsxdq&quot;, XM, EX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++  },
++
++  /* PREGRP49 */
++  {
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;pmuldq&quot;, XM, EX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++  },
++
++  /* PREGRP50 */
++  {
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;pcmpeqq&quot;, XM, EX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++  },
++
++  /* PREGRP51 */
++  {
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;movntdqa&quot;, XM, EM, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++  },
++
++  /* PREGRP52 */
++  {
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;packusdw&quot;, XM, EX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++  },
++
++  /* PREGRP53 */
++  {
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;pmovzxbw&quot;, XM, EX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++  },
++
++  /* PREGRP54 */
++  {
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;pmovzxbd&quot;, XM, EX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++  },
++
++  /* PREGRP55 */
++  {
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;pmovzxbq&quot;, XM, EX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++  },
++
++  /* PREGRP56 */
++  {
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;pmovzxwd&quot;, XM, EX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++  },
++
++  /* PREGRP57 */
++  {
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;pmovzxwq&quot;, XM, EX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++  },
++
++  /* PREGRP58 */
++  {
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;pmovzxdq&quot;, XM, EX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++  },
++
++  /* PREGRP59 */
++  {
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;pminsb&quot;,	XM, EX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++  },
++
++  /* PREGRP60 */
++  {
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;pminsd&quot;,	XM, EX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++  },
++
++  /* PREGRP61 */
++  {
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;pminuw&quot;,	XM, EX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++  },
++
++  /* PREGRP62 */
++  {
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;pminud&quot;,	XM, EX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++  },
++
++  /* PREGRP63 */
++  {
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;pmaxsb&quot;,	XM, EX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++  },
++
++  /* PREGRP64 */
++  {
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;pmaxsd&quot;,	XM, EX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++  },
++
++  /* PREGRP65 */
++  {
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;pmaxuw&quot;, XM, EX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++  },
++
++  /* PREGRP66 */
++  {
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;pmaxud&quot;, XM, EX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++  },
++
++  /* PREGRP67 */
++  {
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;pmulld&quot;, XM, EX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++  },
++
++  /* PREGRP68 */
++  {
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;phminposuw&quot;, XM, EX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++  },
++
++  /* PREGRP69 */
++  {
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;roundps&quot;, XM, EX, Ib, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++  },
++
++  /* PREGRP70 */
++  {
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;roundpd&quot;, XM, EX, Ib, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++  },
++
++  /* PREGRP71 */
++  {
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;roundss&quot;, XM, EX, Ib, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++  },
++
++  /* PREGRP72 */
++  {
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;roundsd&quot;, XM, EX, Ib, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++  },
++
++  /* PREGRP73 */
++  {
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;blendps&quot;, XM, EX, Ib, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++  },
++
++  /* PREGRP74 */
++  {
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;blendpd&quot;, XM, EX, Ib, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++  },
++
++  /* PREGRP75 */
++  {
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;pblendw&quot;, XM, EX, Ib, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++  },
++
++  /* PREGRP76 */
++  {
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;pextrb&quot;,	Edqb, XM, Ib, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++  },
++
++  /* PREGRP77 */
++  {
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;pextrw&quot;,	Edqw, XM, Ib, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++  },
++
++  /* PREGRP78 */
++  {
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;pextrK&quot;,	Edq, XM, Ib, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++  },
++
++  /* PREGRP79 */
++  {
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;extractps&quot;, Edqd, XM, Ib, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
+   },
+-  /* PREGRP25 */
++
++  /* PREGRP80 */
+   {
+-    { &quot;movntq&quot;, EM, MX, XX, XX },
+-    { &quot;(bad)&quot;, EM, XM, XX, XX },
+-    { &quot;movntdq&quot;, EM, XM, XX, XX },
+-    { &quot;(bad)&quot;, EM, XM, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;pinsrb&quot;,	XM, Edqb, Ib, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
+   },
+-  /* PREGRP26 */
++
++  /* PREGRP81 */
+   {
+-    { &quot;(bad)&quot;, MX, EX, XX, XX },
+-    { &quot;(bad)&quot;, XM, EX, XX, XX },
+-    { &quot;punpcklqdq&quot;, XM, EX, XX, XX },
+-    { &quot;(bad)&quot;, XM, EX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;insertps&quot;, XM, EX, Ib, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
+   },
+-  /* PREGRP27 */
++
++  /* PREGRP82 */
+   {
+-    { &quot;(bad)&quot;, MX, EX, XX, XX },
+-    { &quot;(bad)&quot;, XM, EX, XX, XX },
+-    { &quot;addsubpd&quot;, XM, EX, XX, XX },
+-    { &quot;addsubps&quot;, XM, EX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;pinsrK&quot;,	XM, Edq, Ib, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
+   },
+-  /* PREGRP28 */
++
++  /* PREGRP83 */
+   {
+-    { &quot;(bad)&quot;, MX, EX, XX, XX },
+-    { &quot;(bad)&quot;, XM, EX, XX, XX },
+-    { &quot;haddpd&quot;, XM, EX, XX, XX },
+-    { &quot;haddps&quot;, XM, EX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;dpps&quot;,	XM, EX, Ib, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
+   },
+-  /* PREGRP29 */
++
++  /* PREGRP84 */
+   {
+-    { &quot;(bad)&quot;, MX, EX, XX, XX },
+-    { &quot;(bad)&quot;, XM, EX, XX, XX },
+-    { &quot;hsubpd&quot;, XM, EX, XX, XX },
+-    { &quot;hsubps&quot;, XM, EX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;dppd&quot;,	XM, EX, Ib, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
+   },
+-  /* PREGRP30 */
++
++  /* PREGRP85 */
+   {
+-    { &quot;movlpX&quot;, XM, EX, SIMD_Fixup, 'h', XX }, /* really only 2 operands */
+-    { &quot;movsldup&quot;, XM, EX, XX, XX },
+-    { &quot;movlpd&quot;, XM, EX, XX, XX },
+-    { &quot;movddup&quot;, XM, EX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;mpsadbw&quot;, XM, EX, Ib, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
+   },
+-  /* PREGRP31 */
++
++  /* PREGRP86 */
+   {
+-    { &quot;movhpX&quot;, XM, EX, SIMD_Fixup, 'l', XX },
+-    { &quot;movshdup&quot;, XM, EX, XX, XX },
+-    { &quot;movhpd&quot;, XM, EX, XX, XX },
+-    { &quot;(bad)&quot;, XM, EX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;pcmpgtq&quot;, XM, EX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
+   },
+-  /* PREGRP32 */
++
++  /* PREGRP87 */
+   {
+-    { &quot;(bad)&quot;, XM, EX, XX, XX },
+-    { &quot;(bad)&quot;, XM, EX, XX, XX },
+-    { &quot;(bad)&quot;, XM, EX, XX, XX },
+-    { &quot;lddqu&quot;, XM, M, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;crc32&quot;,	Gdq, CRC32_Fixup, b_mode, XX, XX },	
+   },
+-  /* PREGRP33 */
++
++  /* PREGRP88 */
+   {
+-    {&quot;movntps&quot;,Ev, XM, XX, XX},
+-    {&quot;movntss&quot;,Ev, XM, XX, XX},
+-    {&quot;movntpd&quot;,Ev, XM, XX, XX},
+-    {&quot;movntsd&quot;,Ev, XM, XX, XX},
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;crc32&quot;,	Gdq, CRC32_Fixup, v_mode, XX, XX },	
+   },
+ 
+-  /* PREGRP34 */
++  /* PREGRP89 */
+   {
+-    {&quot;vmread&quot;, Em, Gm, XX, XX},
+-    {&quot;(bad)&quot;,  XX, XX, XX, XX},
+-    {&quot;extrq&quot;,  XS, Ib, Ib, XX},
+-    {&quot;insertq&quot;,XM, XS, Ib, Ib},
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;pcmpestrm&quot;, XM, EX, Ib, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
+   },
+-  
+- /* PREGRP35 */  
++
++  /* PREGRP90 */
+   {
+-    {&quot;vmwrite&quot;, Gm, Em, XX, XX},
+-    {&quot;(bad)&quot;,   XX, XX, XX, XX},
+-    {&quot;extrq&quot;,   XM, XS, XX, XX},
+-    {&quot;insertq&quot;, XM, XS, XX, XX},
+-  }, 
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;pcmpestri&quot;, XM, EX, Ib, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++  },
+ 
+-  /* PREGRP36 */
++  /* PREGRP91 */
+   {
+-    { &quot;bsrS&quot;,   Gv, Ev, XX, XX },
+-    { &quot;lzcntS&quot;, Gv, Ev, XX, XX },
+-    { &quot;bsrS&quot;,  Gv, Ev, XX, XX },
+-    { &quot;(bad)&quot;,  XX, XX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;pcmpistrm&quot;, XM, EX, Ib, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
+   },
+ 
+-  /* PREGRP37 */
++  /* PREGRP92 */
+   {
+-    { &quot;(bad)&quot;,  XX, XX, XX, XX },
+-    { &quot;popcntS&quot;,Gv, Ev, XX, XX },
+-    { &quot;(bad)&quot;,  XX, XX, XX, XX },
+-    { &quot;(bad)&quot;,  XX, XX, XX, XX },    
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
++    { &quot;pcmpistri&quot;, XM, EX, Ib, XX },
++    { &quot;(bad)&quot;,	XX, XX, XX, XX },
+   },
+ };
+ 
+@@ -1836,6 +2528,7 @@ static const struct dis386 x86_64_table[
+     { &quot;arpl&quot;, Ew, Gw, XX, XX },
+     { &quot;movs{||lq|xd}&quot;, Gv, Ed, XX, XX },
+   },
++
+ };
+ 
+ static const struct dis386 three_byte_table[][256] = {
+@@ -1860,14 +2553,14 @@ static const struct dis386 three_byte_ta
+     { &quot;(bad)&quot;,		XX, XX, XX, XX },
+     { &quot;(bad)&quot;,		XX, XX, XX, XX },
+     /* 10 */
++    { PREGRP39 },
+     { &quot;(bad)&quot;,		XX, XX, XX, XX },
+     { &quot;(bad)&quot;,		XX, XX, XX, XX },
+     { &quot;(bad)&quot;,		XX, XX, XX, XX },
++    { PREGRP40 },
++    { PREGRP41 },
+     { &quot;(bad)&quot;,		XX, XX, XX, XX },
+-    { &quot;(bad)&quot;,		XX, XX, XX, XX },
+-    { &quot;(bad)&quot;,		XX, XX, XX, XX },
+-    { &quot;(bad)&quot;,		XX, XX, XX, XX },
+-    { &quot;(bad)&quot;,		XX, XX, XX, XX },
++    { PREGRP42 },
+     /* 18 */
+     { &quot;(bad)&quot;,		XX, XX, XX, XX },
+     { &quot;(bad)&quot;,		XX, XX, XX, XX },
+@@ -1878,44 +2571,44 @@ static const struct dis386 three_byte_ta
+     { &quot;pabsd&quot;,		MX, EM, XX, XX },
+     { &quot;(bad)&quot;,		XX, XX, XX, XX },
+     /* 20 */
+-    { &quot;(bad)&quot;,		XX, XX, XX, XX },
+-    { &quot;(bad)&quot;,		XX, XX, XX, XX },
+-    { &quot;(bad)&quot;,		XX, XX, XX, XX },
+-    { &quot;(bad)&quot;,		XX, XX, XX, XX },
+-    { &quot;(bad)&quot;,		XX, XX, XX, XX },
+-    { &quot;(bad)&quot;,		XX, XX, XX, XX },
++    { PREGRP43 },
++    { PREGRP44 },
++    { PREGRP45 },
++    { PREGRP46 },
++    { PREGRP47 },
++    { PREGRP48 },
+     { &quot;(bad)&quot;,		XX, XX, XX, XX },
+     { &quot;(bad)&quot;,		XX, XX, XX, XX },
+     /* 28 */
+-    { &quot;(bad)&quot;,		XX, XX, XX, XX },
+-    { &quot;(bad)&quot;,		XX, XX, XX, XX },
+-    { &quot;(bad)&quot;,		XX, XX, XX, XX },
+-    { &quot;(bad)&quot;,		XX, XX, XX, XX },
++    { PREGRP49 },
++    { PREGRP50 },
++    { PREGRP51 },
++    { PREGRP52 },
+     { &quot;(bad)&quot;,		XX, XX, XX, XX },
+     { &quot;(bad)&quot;,		XX, XX, XX, XX },
+     { &quot;(bad)&quot;,		XX, XX, XX, XX },
+     { &quot;(bad)&quot;,		XX, XX, XX, XX },
+     /* 30 */
++    { PREGRP53 },
++    { PREGRP54 },
++    { PREGRP55 },
++    { PREGRP56 },
++    { PREGRP57 },
++    { PREGRP58 },
+     { &quot;(bad)&quot;,		XX, XX, XX, XX },
+-    { &quot;(bad)&quot;,		XX, XX, XX, XX },
+-    { &quot;(bad)&quot;,		XX, XX, XX, XX },
+-    { &quot;(bad)&quot;,		XX, XX, XX, XX },
+-    { &quot;(bad)&quot;,		XX, XX, XX, XX },
+-    { &quot;(bad)&quot;,		XX, XX, XX, XX },
+-    { &quot;(bad)&quot;,		XX, XX, XX, XX },
+-    { &quot;(bad)&quot;,		XX, XX, XX, XX },
++    { PREGRP86 },
+     /* 38 */
+-    { &quot;(bad)&quot;,		XX, XX, XX, XX },
+-    { &quot;(bad)&quot;,		XX, XX, XX, XX },
+-    { &quot;(bad)&quot;,		XX, XX, XX, XX },
+-    { &quot;(bad)&quot;,		XX, XX, XX, XX },
+-    { &quot;(bad)&quot;,		XX, XX, XX, XX },
+-    { &quot;(bad)&quot;,		XX, XX, XX, XX },
+-    { &quot;(bad)&quot;,		XX, XX, XX, XX },
+-    { &quot;(bad)&quot;,		XX, XX, XX, XX },
++    { PREGRP59 },
++    { PREGRP60 },
++    { PREGRP61 },
++    { PREGRP62 },
++    { PREGRP63 },
++    { PREGRP64 },
++    { PREGRP65 },
++    { PREGRP66 },
+     /* 40 */
+-    { &quot;(bad)&quot;,		XX, XX, XX, XX },
+-    { &quot;(bad)&quot;,		XX, XX, XX, XX },
++    { PREGRP67 },
++    { PREGRP68 },
+     { &quot;(bad)&quot;,		XX, XX, XX, XX },
+     { &quot;(bad)&quot;,		XX, XX, XX, XX },
+     { &quot;(bad)&quot;,		XX, XX, XX, XX },
+@@ -2112,8 +2805,8 @@ static const struct dis386 three_byte_ta
+     { &quot;(bad)&quot;,		XX, XX, XX, XX },
+     { &quot;(bad)&quot;,		XX, XX, XX, XX },
+     /* f0 */
+-    { &quot;(bad)&quot;,		XX, XX, XX, XX },
+-    { &quot;(bad)&quot;,		XX, XX, XX, XX },
++    { PREGRP87 },
++    { PREGRP88 },
+     { &quot;(bad)&quot;,		XX, XX, XX, XX },
+     { &quot;(bad)&quot;,		XX, XX, XX, XX },
+     { &quot;(bad)&quot;,		XX, XX, XX, XX },
+@@ -2142,23 +2835,23 @@ static const struct dis386 three_byte_ta
+     { &quot;(bad)&quot;,		XX, XX, XX, XX },
+     { &quot;(bad)&quot;,		XX, XX, XX, XX },
+     /* 08 */
+-    { &quot;(bad)&quot;,		XX, XX, XX, XX },
+-    { &quot;(bad)&quot;,		XX, XX, XX, XX },
+-    { &quot;(bad)&quot;,		XX, XX, XX, XX },
+-    { &quot;(bad)&quot;,		XX, XX, XX, XX },
+-    { &quot;(bad)&quot;,		XX, XX, XX, XX },
+-    { &quot;(bad)&quot;,		XX, XX, XX, XX },
+-    { &quot;(bad)&quot;,		XX, XX, XX, XX },
++    { PREGRP69 },
++    { PREGRP70 },
++    { PREGRP71 },
++    { PREGRP72 },
++    { PREGRP73 },
++    { PREGRP74 },
++    { PREGRP75 },
+     { &quot;palignr&quot;,	MX, EM, Ib, XX },
+     /* 10 */
+     { &quot;(bad)&quot;,		XX, XX, XX, XX },
+     { &quot;(bad)&quot;,		XX, XX, XX, XX },
+     { &quot;(bad)&quot;,		XX, XX, XX, XX },
+     { &quot;(bad)&quot;,		XX, XX, XX, XX },
+-    { &quot;(bad)&quot;,		XX, XX, XX, XX },
+-    { &quot;(bad)&quot;,		XX, XX, XX, XX },
+-    { &quot;(bad)&quot;,		XX, XX, XX, XX },
+-    { &quot;(bad)&quot;,		XX, XX, XX, XX },
++    { PREGRP76 },
++    { PREGRP77 },
++    { PREGRP78 },
++    { PREGRP79 },
+     /* 18 */
+     { &quot;(bad)&quot;,		XX, XX, XX, XX },
+     { &quot;(bad)&quot;,		XX, XX, XX, XX },
+@@ -2169,9 +2862,9 @@ static const struct dis386 three_byte_ta
+     { &quot;(bad)&quot;,		XX, XX, XX, XX },
+     { &quot;(bad)&quot;,		XX, XX, XX, XX },
+     /* 20 */
+-    { &quot;(bad)&quot;,		XX, XX, XX, XX },
+-    { &quot;(bad)&quot;,		XX, XX, XX, XX },
+-    { &quot;(bad)&quot;,		XX, XX, XX, XX },
++    { PREGRP80 },
++    { PREGRP81 },
++    { PREGRP82 },
+     { &quot;(bad)&quot;,		XX, XX, XX, XX },
+     { &quot;(bad)&quot;,		XX, XX, XX, XX },
+     { &quot;(bad)&quot;,		XX, XX, XX, XX },
+@@ -2205,9 +2898,9 @@ static const struct dis386 three_byte_ta
+     { &quot;(bad)&quot;,		XX, XX, XX, XX },
+     { &quot;(bad)&quot;,		XX, XX, XX, XX },
+     /* 40 */
+-    { &quot;(bad)&quot;,		XX, XX, XX, XX },
+-    { &quot;(bad)&quot;,		XX, XX, XX, XX },
+-    { &quot;(bad)&quot;,		XX, XX, XX, XX },
++    { PREGRP83 },
++    { PREGRP84 },
++    { PREGRP85 },
+     { &quot;(bad)&quot;,		XX, XX, XX, XX },
+     { &quot;(bad)&quot;,		XX, XX, XX, XX },
+     { &quot;(bad)&quot;,		XX, XX, XX, XX },
+@@ -2241,10 +2934,10 @@ static const struct dis386 three_byte_ta
+     { &quot;(bad)&quot;,		XX, XX, XX, XX },
+     { &quot;(bad)&quot;,		XX, XX, XX, XX },
+     /* 60 */
+-    { &quot;(bad)&quot;,		XX, XX, XX, XX },
+-    { &quot;(bad)&quot;,		XX, XX, XX, XX },
+-    { &quot;(bad)&quot;,		XX, XX, XX, XX },
+-    { &quot;(bad)&quot;,		XX, XX, XX, XX },
++    { PREGRP89 },
++    { PREGRP90 },
++    { PREGRP91 },
++    { PREGRP92 },
+     { &quot;(bad)&quot;,		XX, XX, XX, XX },
+     { &quot;(bad)&quot;,		XX, XX, XX, XX },
+     { &quot;(bad)&quot;,		XX, XX, XX, XX },
+@@ -2649,10 +3342,12 @@ print_insn (bfd_vma pc, disassemble_info
+   int i;
+   char *first, *second, *third, *fourth;
+   int needcomma;
+-  unsigned char uses_SSE_prefix, uses_LOCK_prefix;
++  unsigned char uses_DATA_prefix, uses_LOCK_prefix;
++  unsigned char uses_REPNZ_prefix, uses_REPZ_prefix;
+   int sizeflag;
+   const char *p;
+   struct dis_private priv;
++  unsigned char op;
+ 
+   if (info-&gt;mach == bfd_mach_x86_64_intel_syntax
+       || info-&gt;mach == bfd_mach_x86_64)
+@@ -2820,37 +3515,62 @@ print_insn (bfd_vma pc, disassemble_info
+       return 1;
+     }
+ 
++  op = 0;
+   if (*codep == 0x0f)
+     {
++      unsigned char threebyte;
+       FETCH_DATA (info, codep + 2);
+-      dp = &amp;dis386_twobyte[*++codep];
++      threebyte = *++codep;
++      dp = &amp;dis386_twobyte[threebyte];
+       need_modrm = twobyte_has_modrm[*codep];
+-      uses_SSE_prefix = twobyte_uses_SSE_prefix[*codep];
++      uses_DATA_prefix = twobyte_uses_DATA_prefix[*codep];
++      uses_REPNZ_prefix = twobyte_uses_REPNZ_prefix[*codep];
++      uses_REPZ_prefix = twobyte_uses_REPZ_prefix[*codep];
+       uses_LOCK_prefix = (*codep &amp; ~0x02) == 0x20;
++      codep++;
++      if (dp-&gt;name == NULL &amp;&amp; dp-&gt;bytemode1 == IS_3BYTE_OPCODE)
++	{
++	  FETCH_DATA (info, codep + 2);
++	  op = *codep++;
++	  switch (threebyte)
++	    {
++	    case 0x38:
++	      uses_DATA_prefix = threebyte_0x38_uses_DATA_prefix[op];
++	      uses_REPNZ_prefix = threebyte_0x38_uses_REPNZ_prefix[op];
++	      uses_REPZ_prefix = threebyte_0x38_uses_REPZ_prefix[op];
++	      break;
++	    case 0x3a:
++	      uses_DATA_prefix = threebyte_0x3a_uses_DATA_prefix[op];
++	      uses_REPNZ_prefix = threebyte_0x3a_uses_REPNZ_prefix[op];
++	      uses_REPZ_prefix = threebyte_0x3a_uses_REPZ_prefix[op];
++	      break;
++	    default:
++	      break;
++	    }
++	}
+     }
+   else
+     {
+       dp = &amp;dis386[*codep];
+       need_modrm = onebyte_has_modrm[*codep];
+-      uses_SSE_prefix = 0;
++      uses_DATA_prefix = 0;
++      uses_REPNZ_prefix = 0;
++      uses_REPZ_prefix = 0;
+       uses_LOCK_prefix = 0;
++      codep++;
+     }
+   
+-  /*&quot;lzcnt&quot;=0xBD and &quot;popcnt&quot;=0xB8 are the only two non-sse 
+-    instruction which uses F3 in the opcode without any &quot;rep(z|nz)&quot;*/
+-  if (!uses_SSE_prefix &amp;&amp; (prefixes &amp; PREFIX_REPZ) &amp;&amp; *codep != 0xBD &amp;&amp; *codep != 0xB8)
++  if (!uses_REPZ_prefix &amp;&amp; (prefixes &amp; PREFIX_REPZ))
+     {
+       oappend (&quot;repz &quot;);
+       used_prefixes |= PREFIX_REPZ;
+     }
+-  if (!uses_SSE_prefix &amp;&amp; (prefixes &amp; PREFIX_REPNZ) &amp;&amp; *codep != 0xBD &amp;&amp; *codep != 0xB8)
++  if (!uses_REPNZ_prefix &amp;&amp; (prefixes &amp; PREFIX_REPNZ))
+     {
+       oappend (&quot;repnz &quot;);
+       used_prefixes |= PREFIX_REPNZ;
+     }
+ 
+-  codep++;
+-
+   if (!uses_LOCK_prefix &amp;&amp; (prefixes &amp; PREFIX_LOCK))
+     {
+       oappend (&quot;lock &quot;);
+@@ -2870,7 +3590,7 @@ print_insn (bfd_vma pc, disassemble_info
+ 	}
+     }
+ 
+-  if (!uses_SSE_prefix &amp;&amp; (prefixes &amp; PREFIX_DATA))
++  if (!uses_DATA_prefix &amp;&amp; (prefixes &amp; PREFIX_DATA))
+     {
+       sizeflag ^= DFLAG;
+       if (dp-&gt;bytemode3 == cond_jump_mode
+@@ -2887,8 +3607,7 @@ print_insn (bfd_vma pc, disassemble_info
+ 
+   if (dp-&gt;name == NULL &amp;&amp; dp-&gt;bytemode1 == IS_3BYTE_OPCODE)
+     {
+-      FETCH_DATA (info, codep + 2);
+-      dp = &amp;three_byte_table[dp-&gt;bytemode2][*codep++];
++      dp = &amp;three_byte_table[dp-&gt;bytemode2][op];
+       mod = (*codep &gt;&gt; 6) &amp; 3;
+       reg = (*codep &gt;&gt; 3) &amp; 7;
+       rm = *codep &amp; 7;
+@@ -2923,14 +3642,16 @@ print_insn (bfd_vma pc, disassemble_info
+ 		index = 1;
+ 	      else
+ 		{
+-		  used_prefixes |= (prefixes &amp; PREFIX_DATA);
+-		  if (prefixes &amp; PREFIX_DATA)
+-		    index = 2;
++		  /* We should check PREFIX_REPNZ and PREFIX_REPZ
++		     before PREFIX_DATA.  */
++		  used_prefixes |= (prefixes &amp; PREFIX_REPNZ);
++		  if (prefixes &amp; PREFIX_REPNZ)
++		    index = 3;
+ 		  else
+ 		    {
+-		      used_prefixes |= (prefixes &amp; PREFIX_REPNZ);
+-		      if (prefixes &amp; PREFIX_REPNZ)
+-			index = 3;
++		      used_prefixes |= (prefixes &amp; PREFIX_DATA);
++		      if (prefixes &amp; PREFIX_DATA)
++			index = 2;
+ 		    }
+ 		}
+ 	      dp = &amp;prefix_user_table[dp-&gt;bytemode2][index];
+@@ -3569,6 +4290,13 @@ putop (const char *template, int sizefla
+ 	    break;
+ 	  *obufp++ = 'l';
+ 	  break;
++	case 'K':
++	  USED_REX (REX_MODE64);
++	  if (rex &amp; REX_MODE64)
++	    *obufp++ = 'q';
++	  else
++	    *obufp++ = 'd';
++	  break;
+ 	case 'Z':
+ 	  if (intel_syntax)
+ 	    break;
+@@ -3879,6 +4607,7 @@ intel_operand_size (int bytemode, int si
+   switch (bytemode)
+     {
+     case b_mode:
++    case dqb_mode:
+       oappend (&quot;BYTE PTR &quot;);
+       break;
+     case w_mode:
+@@ -3905,6 +4634,7 @@ intel_operand_size (int bytemode, int si
+       used_prefixes |= (prefixes &amp; PREFIX_DATA);
+       break;
+     case d_mode:
++    case dqd_mode:
+       oappend (&quot;DWORD PTR &quot;);
+       break;
+     case q_mode:
+@@ -3985,6 +4715,8 @@ OP_E (int bytemode, int sizeflag)
+ 	  /* FALLTHRU */
+ 	case v_mode:
+ 	case dq_mode:
++	case dqb_mode:
++	case dqd_mode:
+ 	case dqw_mode:
+ 	  USED_REX (REX_MODE64);
+ 	  if (rex &amp; REX_MODE64)
+@@ -4239,6 +4971,8 @@ OP_G (int bytemode, int sizeflag)
+       break;
+     case v_mode:
+     case dq_mode:
++    case dqb_mode:
++    case dqd_mode:
+     case dqw_mode:
+       USED_REX (REX_MODE64);
+       if (rex &amp; REX_MODE64)
+@@ -5530,3 +6264,76 @@ REP_Fixup (int bytemode, int sizeflag)
+       break;
+     }
+ }
++
++static void
++XMM_Fixup (int reg, int sizeflag ATTRIBUTE_UNUSED)
++{
++  sprintf (scratchbuf, &quot;%%xmm%d&quot;, reg);
++  oappend (scratchbuf + intel_syntax);
++}
++
++static void
++CRC32_Fixup (int bytemode, int sizeflag)
++{
++  /* Add proper suffix to &quot;crc32&quot;.  */
++  char *p = obuf + strlen (obuf);
++
++  switch (bytemode)
++    {
++    case b_mode:
++      if (intel_syntax)
++	break;
++
++      *p++ = 'b';
++      break;
++    case v_mode:
++      if (intel_syntax)
++	break;
++
++      USED_REX (REX_MODE64);
++      if (rex &amp; REX_MODE64)
++	*p++ = 'q';
++      else if (sizeflag &amp; DFLAG)
++	*p++ = 'l';
++      else
++	*p++ = 'w';
++      used_prefixes |= (prefixes &amp; PREFIX_DATA);
++      break;
++    default:
++      oappend (INTERNAL_DISASSEMBLER_ERROR);
++      break;
++    }
++  *p = '\0';
++
++  if (mod == 3)
++    {
++      int add;
++
++      /* Skip mod/rm byte.  */
++      MODRM_CHECK;
++      codep++;
++
++      USED_REX (REX_EXTZ);
++      add = (rex &amp; REX_EXTZ) ? 8 : 0;
++      if (bytemode == b_mode)
++	{
++	  USED_REX (0);
++	  if (rex)
++	    oappend (names8rex[rm + add]);
++	  else
++	    oappend (names8[rm + add]);
++	}
++      else
++	{
++	  USED_REX (REX_MODE64);
++	  if (rex &amp; REX_MODE64)
++	    oappend (names64[rm + add]);
++	  else if ((prefixes &amp; PREFIX_DATA))
++	    oappend (names16[rm + add]);
++	  else
++	    oappend (names32[rm + add]);
++	}
++    }
++  else
++    OP_E (bytemode, sizeflag);
++}
+--- gas/testsuite/gas/i386/x86-64-sse4_1.d.jj	2007-05-07 11:15:33.000000000 +0200
++++ gas/testsuite/gas/i386/x86-64-sse4_1.d	2007-05-07 11:15:33.000000000 +0200
+@@ -0,0 +1,110 @@
++#objdump: -dw
++#name: x86-64 SSE4.1
++
++.*:     file format .*
++
++Disassembly of section .text:
++
++0+000 &lt;foo&gt;:
++[ 	]*[0-9a-f]+:	66 0f 3a 0d 01 00    	blendpd \$0x0,\(%rcx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 3a 0d c1 00    	blendpd \$0x0,%xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 3a 0c 01 00    	blendps \$0x0,\(%rcx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 3a 0c c1 00    	blendps \$0x0,%xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 15 01       	blendvpd %xmm0,\(%rcx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 15 c1       	blendvpd %xmm0,%xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 14 01       	blendvps %xmm0,\(%rcx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 14 c1       	blendvps %xmm0,%xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 3a 41 01 00    	dppd   \$0x0,\(%rcx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 3a 41 c1 00    	dppd   \$0x0,%xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 3a 40 01 00    	dpps   \$0x0,\(%rcx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 3a 40 c1 00    	dpps   \$0x0,%xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 48 0f 3a 17 c1 00 	extractps \$0x0,%xmm0,%rcx
++[ 	]*[0-9a-f]+:	66 0f 3a 17 c1 00    	extractps \$0x0,%xmm0,%ecx
++[ 	]*[0-9a-f]+:	66 0f 3a 17 01 00    	extractps \$0x0,%xmm0,\(%rcx\)
++[ 	]*[0-9a-f]+:	66 0f 3a 21 c1 00    	insertps \$0x0,%xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 3a 21 01 00    	insertps \$0x0,\(%rcx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 2a 01       	movntdqa \(%rcx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 3a 42 01 00    	mpsadbw \$0x0,\(%rcx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 3a 42 c1 00    	mpsadbw \$0x0,%xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 2b 01       	packusdw \(%rcx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 2b c1       	packusdw %xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 10 01       	pblendvb %xmm0,\(%rcx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 10 c1       	pblendvb %xmm0,%xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 3a 0e 01 00    	pblendw \$0x0,\(%rcx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 3a 0e c1 00    	pblendw \$0x0,%xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 29 c1       	pcmpeqq %xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 29 01       	pcmpeqq \(%rcx\),%xmm0
++[ 	]*[0-9a-f]+:	66 48 0f 3a 14 c1 00 	pextrb \$0x0,%xmm0,%rcx
++[ 	]*[0-9a-f]+:	66 0f 3a 14 c1 00    	pextrb \$0x0,%xmm0,%ecx
++[ 	]*[0-9a-f]+:	66 0f 3a 14 01 00    	pextrb \$0x0,%xmm0,\(%rcx\)
++[ 	]*[0-9a-f]+:	66 0f 3a 16 c1 00    	pextrd \$0x0,%xmm0,%ecx
++[ 	]*[0-9a-f]+:	66 0f 3a 16 01 00    	pextrd \$0x0,%xmm0,\(%rcx\)
++[ 	]*[0-9a-f]+:	66 48 0f 3a 16 c1 00 	pextrq \$0x0,%xmm0,%rcx
++[ 	]*[0-9a-f]+:	66 48 0f 3a 16 01 00 	pextrq \$0x0,%xmm0,\(%rcx\)
++[ 	]*[0-9a-f]+:	66 48 0f c5 c8 00    	pextrw \$0x0,%xmm0,%rcx
++[ 	]*[0-9a-f]+:	66 0f c5 c8 00       	pextrw \$0x0,%xmm0,%ecx
++[ 	]*[0-9a-f]+:	66 0f 3a 15 01 00    	pextrw \$0x0,%xmm0,\(%rcx\)
++[ 	]*[0-9a-f]+:	66 0f 38 41 c1       	phminposuw %xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 41 01       	phminposuw \(%rcx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 3a 20 01 00    	pinsrb \$0x0,\(%rcx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 3a 20 c1 00    	pinsrb \$0x0,%ecx,%xmm0
++[ 	]*[0-9a-f]+:	66 48 0f 3a 20 c1 00 	pinsrb \$0x0,%rcx,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 3a 22 01 00    	pinsrd \$0x0,\(%rcx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 3a 22 c1 00    	pinsrd \$0x0,%ecx,%xmm0
++[ 	]*[0-9a-f]+:	66 48 0f 3a 22 01 00 	pinsrq \$0x0,\(%rcx\),%xmm0
++[ 	]*[0-9a-f]+:	66 48 0f 3a 22 c1 00 	pinsrq \$0x0,%rcx,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 3c c1       	pmaxsb %xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 3c 01       	pmaxsb \(%rcx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 3d c1       	pmaxsd %xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 3d 01       	pmaxsd \(%rcx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 3f c1       	pmaxud %xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 3f 01       	pmaxud \(%rcx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 3e c1       	pmaxuw %xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 3e 01       	pmaxuw \(%rcx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 38 c1       	pminsb %xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 38 01       	pminsb \(%rcx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 39 c1       	pminsd %xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 39 01       	pminsd \(%rcx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 3b c1       	pminud %xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 3b 01       	pminud \(%rcx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 3a c1       	pminuw %xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 3a 01       	pminuw \(%rcx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 20 c1       	pmovsxbw %xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 20 01       	pmovsxbw \(%rcx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 21 c1       	pmovsxbd %xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 21 01       	pmovsxbd \(%rcx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 22 c1       	pmovsxbq %xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 22 01       	pmovsxbq \(%rcx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 23 c1       	pmovsxwd %xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 23 01       	pmovsxwd \(%rcx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 24 c1       	pmovsxwq %xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 24 01       	pmovsxwq \(%rcx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 25 c1       	pmovsxdq %xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 25 01       	pmovsxdq \(%rcx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 30 c1       	pmovzxbw %xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 30 01       	pmovzxbw \(%rcx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 31 c1       	pmovzxbd %xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 31 01       	pmovzxbd \(%rcx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 32 c1       	pmovzxbq %xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 32 01       	pmovzxbq \(%rcx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 33 c1       	pmovzxwd %xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 33 01       	pmovzxwd \(%rcx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 34 c1       	pmovzxwq %xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 34 01       	pmovzxwq \(%rcx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 35 c1       	pmovzxdq %xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 35 01       	pmovzxdq \(%rcx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 28 c1       	pmuldq %xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 28 01       	pmuldq \(%rcx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 40 c1       	pmulld %xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 40 01       	pmulld \(%rcx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 17 c1       	ptest  %xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 17 01       	ptest  \(%rcx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 3a 09 01 00    	roundpd \$0x0,\(%rcx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 3a 09 c1 00    	roundpd \$0x0,%xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 3a 08 01 00    	roundps \$0x0,\(%rcx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 3a 08 c1 00    	roundps \$0x0,%xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 3a 0b 01 00    	roundsd \$0x0,\(%rcx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 3a 0b c1 00    	roundsd \$0x0,%xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 3a 0a 01 00    	roundss \$0x0,\(%rcx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 3a 0a c1 00    	roundss \$0x0,%xmm1,%xmm0
++#pass
+--- gas/testsuite/gas/i386/sse4_2.s.jj	2007-05-07 11:15:33.000000000 +0200
++++ gas/testsuite/gas/i386/sse4_2.s	2007-05-07 12:45:25.000000000 +0200
+@@ -0,0 +1,33 @@
++# Streaming SIMD extensions 4.2 Instructions
++
++	.text
++foo:
++	crc32		%cl,%ebx
++	crc32		%cx,%ebx
++	crc32		%ecx,%ebx
++	crc32b		(%ecx),%ebx
++	crc32w		(%ecx),%ebx
++	crc32l		(%ecx),%ebx
++	crc32b		%cl,%ebx
++	crc32w		%cx,%ebx
++	crc32l		%ecx,%ebx
++	pcmpgtq		(%ecx),%xmm0
++	pcmpgtq		%xmm1,%xmm0
++	pcmpestri	$0x0,(%ecx),%xmm0
++	pcmpestri	$0x0,%xmm1,%xmm0
++	pcmpestrm	$0x1,(%ecx),%xmm0
++	pcmpestrm	$0x1,%xmm1,%xmm0
++	pcmpistri	$0x2,(%ecx),%xmm0
++	pcmpistri	$0x2,%xmm1,%xmm0
++	pcmpistrm	$0x3,(%ecx),%xmm0
++	pcmpistrm	$0x3,%xmm1,%xmm0
++	popcnt		(%ecx),%bx
++	popcnt		(%ecx),%ebx
++	popcntw		(%ecx),%bx
++	popcntl		(%ecx),%ebx
++	popcnt		%cx,%bx
++	popcnt		%ecx,%ebx
++	popcntw		%cx,%bx
++	popcntl		%ecx,%ebx
++
++	.p2align	4,0
+--- gas/testsuite/gas/i386/inval-crc32.s.jj	2007-05-07 15:16:51.000000000 +0200
++++ gas/testsuite/gas/i386/inval-crc32.s	2007-05-07 12:45:25.000000000 +0200
+@@ -0,0 +1,23 @@
++# Check illegal crc32 in SSE4.2
++
++	.text
++foo:
++
++crc32b (%esi), %al
++crc32w (%esi), %ax
++crc32 (%esi), %al
++crc32 (%esi), %ax
++crc32 (%esi), %eax
++crc32  %al, %al
++crc32b  %al, %al
++crc32  %ax, %ax
++crc32w  %ax, %ax
++
++.intel_syntax noprefix
++crc32  al,byte ptr [esi]
++crc32  ax, word ptr [esi]
++crc32  al, [esi]
++crc32  ax, [esi]
++crc32  eax, [esi]
++crc32  al,al
++crc32  ax, ax
+--- gas/testsuite/gas/i386/x86-64-inval-crc32.l.jj	2007-05-07 15:16:51.000000000 +0200
++++ gas/testsuite/gas/i386/x86-64-inval-crc32.l	2007-05-07 12:45:25.000000000 +0200
+@@ -0,0 +1,65 @@
++.*: Assembler messages:
++.*:6: Error: .*
++.*:7: Error: .*
++.*:8: Error: .*
++.*:9: Error: .*
++.*:10: Error: .*
++.*:11: Error: .*
++.*:12: Error: .*
++.*:13: Error: .*
++.*:14: Error: .*
++.*:15: Error: .*
++.*:16: Error: .*
++.*:17: Error: .*
++.*:18: Error: .*
++.*:19: Error: .*
++.*:20: Error: .*
++.*:21: Error: .*
++.*:24: Error: .*
++.*:25: Error: .*
++.*:26: Error: .*
++.*:27: Error: .*
++.*:28: Error: .*
++.*:29: Error: .*
++.*:30: Error: .*
++.*:31: Error: .*
++.*:32: Error: .*
++.*:33: Error: .*
++.*:34: Error: .*
++GAS LISTING .*
++
++
++[ 	]*1[ 	]+\# Check illegal 64bit crc32 in SSE4\.2
++[ 	]*2[ 	]+
++[ 	]*3[ 	]+\.text
++[ 	]*4[ 	]+foo:
++[ 	]*5[ 	]+
++[ 	]*6[ 	]+crc32b \(%rsi\), %al
++[ 	]*7[ 	]+crc32w \(%rsi\), %ax
++[ 	]*8[ 	]+crc32 \(%rsi\), %al
++[ 	]*9[ 	]+crc32 \(%rsi\), %ax
++[ 	]*10[ 	]+crc32 \(%rsi\), %eax
++[ 	]*11[ 	]+crc32 \(%rsi\), %rax
++[ 	]*12[ 	]+crc32  %al, %al
++[ 	]*13[ 	]+crc32b  %al, %al
++[ 	]*14[ 	]+crc32  %ax, %ax
++[ 	]*15[ 	]+crc32w  %ax, %ax
++[ 	]*16[ 	]+crc32  %rax, %eax
++[ 	]*17[ 	]+crc32  %eax, %rax
++[ 	]*18[ 	]+crc32l  %rax, %eax
++[ 	]*19[ 	]+crc32l  %eax, %rax
++[ 	]*20[ 	]+crc32q  %eax, %rax
++[ 	]*21[ 	]+crc32q  %rax, %eax
++[ 	]*22[ 	]+
++[ 	]*23[ 	]+\.intel_syntax noprefix
++[ 	]*24[ 	]+crc32  al,byte ptr \[rsi\]
++[ 	]*25[ 	]+crc32  ax, word ptr \[rsi\]
++[ 	]*26[ 	]+crc32  rax,word ptr \[rsi\]
++[ 	]*27[ 	]+crc32  rax,dword ptr \[rsi\]
++[ 	]*28[ 	]+crc32  al,\[rsi\]
++[ 	]*29[ 	]+crc32  ax,\[rsi\]
++[ 	]*30[ 	]+crc32  eax,\[rsi\]
++[ 	]*31[ 	]+crc32  rax,\[rsi\]
++[ 	]*32[ 	]+crc32  al,al
++[ 	]*33[ 	]+crc32  ax, ax
++[ 	]*34[ 	]+crc32  rax,eax
+--- gas/testsuite/gas/i386/x86-64-inval-crc32.s.jj	2007-05-07 15:16:51.000000000 +0200
++++ gas/testsuite/gas/i386/x86-64-inval-crc32.s	2007-05-07 12:45:25.000000000 +0200
+@@ -0,0 +1,34 @@
++# Check illegal 64bit crc32 in SSE4.2
++
++	.text
++foo:
++
++crc32b (%rsi), %al
++crc32w (%rsi), %ax
++crc32 (%rsi), %al
++crc32 (%rsi), %ax
++crc32 (%rsi), %eax
++crc32 (%rsi), %rax
++crc32  %al, %al
++crc32b  %al, %al
++crc32  %ax, %ax
++crc32w  %ax, %ax
++crc32  %rax, %eax
++crc32  %eax, %rax
++crc32l  %rax, %eax
++crc32l  %eax, %rax
++crc32q  %eax, %rax
++crc32q  %rax, %eax
++
++.intel_syntax noprefix
++crc32  al,byte ptr [rsi]
++crc32  ax, word ptr [rsi]
++crc32  rax,word ptr [rsi]
++crc32  rax,dword ptr [rsi]
++crc32  al,[rsi]
++crc32  ax,[rsi]
++crc32  eax,[rsi]
++crc32  rax,[rsi]
++crc32  al,al
++crc32  ax, ax
++crc32  rax,eax
+--- gas/testsuite/gas/i386/sse4_2.d.jj	2007-05-07 11:15:33.000000000 +0200
++++ gas/testsuite/gas/i386/sse4_2.d	2007-05-07 14:25:52.000000000 +0200
+@@ -0,0 +1,36 @@
++#objdump: -dw
++#name: i386 SSE4.2
++
++.*:     file format .*
++
++Disassembly of section .text:
++
++0+000 &lt;foo&gt;:
++[ 	]*[0-9a-f]+:	f2 0f 38 f0 d9       	crc32b %cl,%ebx
++[ 	]*[0-9a-f]+:	(66 f2|f2 66) 0f 38 f1 d9    	crc32w %cx,%ebx
++[ 	]*[0-9a-f]+:	f2 0f 38 f1 d9       	crc32l %ecx,%ebx
++[ 	]*[0-9a-f]+:	f2 0f 38 f0 19       	crc32b \(%ecx\),%ebx
++[ 	]*[0-9a-f]+:	(66 f2|f2 66) 0f 38 f1 19    	crc32w \(%ecx\),%ebx
++[ 	]*[0-9a-f]+:	f2 0f 38 f1 19       	crc32l \(%ecx\),%ebx
++[ 	]*[0-9a-f]+:	f2 0f 38 f0 d9       	crc32b %cl,%ebx
++[ 	]*[0-9a-f]+:	(66 f2|f2 66) 0f 38 f1 d9    	crc32w %cx,%ebx
++[ 	]*[0-9a-f]+:	f2 0f 38 f1 d9       	crc32l %ecx,%ebx
++[ 	]*[0-9a-f]+:	66 0f 38 37 01       	pcmpgtq \(%ecx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 37 c1       	pcmpgtq %xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 3a 61 01 00    	pcmpestri \$0x0,\(%ecx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 3a 61 c1 00    	pcmpestri \$0x0,%xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 3a 60 01 01    	pcmpestrm \$0x1,\(%ecx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 3a 60 c1 01    	pcmpestrm \$0x1,%xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 3a 63 01 02    	pcmpistri \$0x2,\(%ecx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 3a 63 c1 02    	pcmpistri \$0x2,%xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 3a 62 01 03    	pcmpistrm \$0x3,\(%ecx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 3a 62 c1 03    	pcmpistrm \$0x3,%xmm1,%xmm0
++[ 	]*[0-9a-f]+:	(66 f3|f3 66) 0f b8 19       	popcnt \(%ecx\),%bx
++[ 	]*[0-9a-f]+:	f3 0f b8 19          	popcnt \(%ecx\),%ebx
++[ 	]*[0-9a-f]+:	(66 f3|f3 66) 0f b8 19       	popcnt \(%ecx\),%bx
++[ 	]*[0-9a-f]+:	f3 0f b8 19          	popcnt \(%ecx\),%ebx
++[ 	]*[0-9a-f]+:	(66 f3|f3 66) 0f b8 d9       	popcnt %cx,%bx
++[ 	]*[0-9a-f]+:	f3 0f b8 d9          	popcnt %ecx,%ebx
++[ 	]*[0-9a-f]+:	(66 f3|f3 66) 0f b8 d9       	popcnt %cx,%bx
++[ 	]*[0-9a-f]+:	f3 0f b8 d9          	popcnt %ecx,%ebx
++#pass
+--- gas/testsuite/gas/i386/crc32-intel.d.jj	2007-05-07 15:16:51.000000000 +0200
++++ gas/testsuite/gas/i386/crc32-intel.d	2007-05-07 14:25:52.000000000 +0200
+@@ -0,0 +1,25 @@
++#objdump: -dwMintel
++#name: i386 crc32 (Intel disassembly)
++#source: crc32.s
++
++.*: +file format .*
++
++Disassembly of section .text:
++
++0+ &lt;foo&gt;:
++[ 	]*[a-f0-9]+:	f2 0f 38 f0 06       	crc32  eax,BYTE PTR \[esi\]
++[ 	]*[a-f0-9]+:	(66 f2|f2 66) 0f 38 f1 06    	crc32  eax,WORD PTR \[esi\]
++[ 	]*[a-f0-9]+:	f2 0f 38 f1 06       	crc32  eax,DWORD PTR \[esi\]
++[ 	]*[a-f0-9]+:	f2 0f 38 f0 c0       	crc32  eax,al
++[ 	]*[a-f0-9]+:	f2 0f 38 f0 c0       	crc32  eax,al
++[ 	]*[a-f0-9]+:	(66 f2|f2 66) 0f 38 f1 c0    	crc32  eax,ax
++[ 	]*[a-f0-9]+:	(66 f2|f2 66) 0f 38 f1 c0    	crc32  eax,ax
++[ 	]*[a-f0-9]+:	f2 0f 38 f1 c0       	crc32  eax,eax
++[ 	]*[a-f0-9]+:	f2 0f 38 f1 c0       	crc32  eax,eax
++[ 	]*[a-f0-9]+:	f2 0f 38 f0 06       	crc32  eax,BYTE PTR \[esi\]
++[ 	]*[a-f0-9]+:	(66 f2|f2 66) 0f 38 f1 06    	crc32  eax,WORD PTR \[esi\]
++[ 	]*[a-f0-9]+:	f2 0f 38 f1 06       	crc32  eax,DWORD PTR \[esi\]
++[ 	]*[a-f0-9]+:	f2 0f 38 f0 c0       	crc32  eax,al
++[ 	]*[a-f0-9]+:	(66 f2|f2 66) 0f 38 f1 c0    	crc32  eax,ax
++[ 	]*[a-f0-9]+:	f2 0f 38 f1 c0       	crc32  eax,eax
++#pass
+--- gas/testsuite/gas/i386/x86-64-crc32.s.jj	2007-05-07 15:16:51.000000000 +0200
++++ gas/testsuite/gas/i386/x86-64-crc32.s	2007-05-07 12:45:25.000000000 +0200
+@@ -0,0 +1,34 @@
++# Check 64bit crc32 in SSE4.2
++
++	.text
++foo:
++
++crc32b (%rsi), %eax
++crc32b (%rsi), %rax
++crc32w (%rsi), %eax
++crc32l (%rsi), %eax
++crc32q (%rsi), %rax
++crc32  %al, %eax
++crc32b  %al, %eax
++crc32  %al, %rax
++crc32b  %al, %rax
++crc32  %ax, %eax
++crc32w  %ax, %eax
++crc32  %eax, %eax
++crc32l  %eax, %eax
++crc32  %rax, %rax
++crc32q  %rax, %rax
++
++.intel_syntax noprefix
++crc32  rax,byte ptr [rsi]
++crc32  eax,byte ptr [rsi]
++crc32  eax, word ptr [rsi]
++crc32  eax,dword ptr [rsi]
++crc32  rax,qword ptr [rsi]
++crc32  eax,al
++crc32  rax,al
++crc32  eax, ax
++crc32  eax,eax
++crc32  rax,rax
++
++.p2align 4,0
+--- gas/testsuite/gas/i386/x86-64-sse4_1.s.jj	2007-05-07 11:15:33.000000000 +0200
++++ gas/testsuite/gas/i386/x86-64-sse4_1.s	2007-05-07 11:15:33.000000000 +0200
+@@ -0,0 +1,107 @@
++# Streaming SIMD extensions 4.1 Instructions
++
++	.text
++foo:
++	blendpd		$0x0,(%rcx),%xmm0
++	blendpd		$0x0,%xmm1,%xmm0
++	blendps		$0x0,(%rcx),%xmm0
++	blendps		$0x0,%xmm1,%xmm0
++	blendvpd	%xmm0,(%rcx),%xmm0
++	blendvpd	%xmm0,%xmm1,%xmm0
++	blendvps	%xmm0,(%rcx),%xmm0
++	blendvps	%xmm0,%xmm1,%xmm0
++	dppd		$0x0,(%rcx),%xmm0
++	dppd		$0x0,%xmm1,%xmm0
++	dpps		$0x0,(%rcx),%xmm0
++	dpps		$0x0,%xmm1,%xmm0
++	extractps	$0x0,%xmm0,%rcx
++	extractps	$0x0,%xmm0,%ecx
++	extractps	$0x0,%xmm0,(%rcx)
++	insertps	$0x0,%xmm1,%xmm0
++	insertps	$0x0,(%rcx),%xmm0
++	movntdqa	(%rcx),%xmm0
++	mpsadbw		$0x0,(%rcx),%xmm0
++	mpsadbw		$0x0,%xmm1,%xmm0
++	packusdw	(%rcx),%xmm0
++	packusdw	%xmm1,%xmm0
++	pblendvb	%xmm0,(%rcx),%xmm0
++	pblendvb	%xmm0,%xmm1,%xmm0
++	pblendw		$0x0,(%rcx),%xmm0
++	pblendw		$0x0,%xmm1,%xmm0
++	pcmpeqq		%xmm1,%xmm0
++	pcmpeqq		(%rcx),%xmm0
++	pextrb          $0x0,%xmm0,%rcx
++	pextrb          $0x0,%xmm0,%ecx
++	pextrb          $0x0,%xmm0,(%rcx)
++	pextrd          $0x0,%xmm0,%ecx
++	pextrd          $0x0,%xmm0,(%rcx)
++	pextrq          $0x0,%xmm0,%rcx
++	pextrq          $0x0,%xmm0,(%rcx)
++	pextrw          $0x0,%xmm0,%rcx
++	pextrw          $0x0,%xmm0,%ecx
++	pextrw          $0x0,%xmm0,(%rcx)
++	phminposuw	%xmm1,%xmm0
++	phminposuw	(%rcx),%xmm0
++	pinsrb		$0x0,(%rcx),%xmm0
++	pinsrb		$0x0,%ecx,%xmm0
++	pinsrb		$0x0,%rcx,%xmm0
++	pinsrd		$0x0,(%rcx),%xmm0
++	pinsrd		$0x0,%ecx,%xmm0
++	pinsrq		$0x0,(%rcx),%xmm0
++	pinsrq		$0x0,%rcx,%xmm0
++	pmaxsb		%xmm1,%xmm0
++	pmaxsb		(%rcx),%xmm0
++	pmaxsd		%xmm1,%xmm0
++	pmaxsd		(%rcx),%xmm0
++	pmaxud		%xmm1,%xmm0
++	pmaxud		(%rcx),%xmm0
++	pmaxuw		%xmm1,%xmm0
++	pmaxuw		(%rcx),%xmm0
++	pminsb		%xmm1,%xmm0
++	pminsb		(%rcx),%xmm0
++	pminsd		%xmm1,%xmm0
++	pminsd		(%rcx),%xmm0
++	pminud		%xmm1,%xmm0
++	pminud		(%rcx),%xmm0
++	pminuw		%xmm1,%xmm0
++	pminuw		(%rcx),%xmm0
++	pmovsxbw	%xmm1,%xmm0
++	pmovsxbw	(%rcx),%xmm0
++	pmovsxbd	%xmm1,%xmm0
++	pmovsxbd	(%rcx),%xmm0
++	pmovsxbq	%xmm1,%xmm0
++	pmovsxbq	(%rcx),%xmm0
++	pmovsxwd	%xmm1,%xmm0
++	pmovsxwd	(%rcx),%xmm0
++	pmovsxwq	%xmm1,%xmm0
++	pmovsxwq	(%rcx),%xmm0
++	pmovsxdq	%xmm1,%xmm0
++	pmovsxdq	(%rcx),%xmm0
++	pmovzxbw	%xmm1,%xmm0
++	pmovzxbw	(%rcx),%xmm0
++	pmovzxbd	%xmm1,%xmm0
++	pmovzxbd	(%rcx),%xmm0
++	pmovzxbq	%xmm1,%xmm0
++	pmovzxbq	(%rcx),%xmm0
++	pmovzxwd	%xmm1,%xmm0
++	pmovzxwd	(%rcx),%xmm0
++	pmovzxwq	%xmm1,%xmm0
++	pmovzxwq	(%rcx),%xmm0
++	pmovzxdq	%xmm1,%xmm0
++	pmovzxdq	(%rcx),%xmm0
++	pmuldq		%xmm1,%xmm0
++	pmuldq		(%rcx),%xmm0
++	pmulld		%xmm1,%xmm0
++	pmulld		(%rcx),%xmm0
++	ptest		%xmm1,%xmm0
++	ptest		(%rcx),%xmm0
++	roundpd		$0x0,(%rcx),%xmm0
++	roundpd		$0x0,%xmm1,%xmm0
++	roundps		$0x0,(%rcx),%xmm0
++	roundps		$0x0,%xmm1,%xmm0
++	roundsd		$0x0,(%rcx),%xmm0
++	roundsd		$0x0,%xmm1,%xmm0
++	roundss		$0x0,(%rcx),%xmm0
++	roundss		$0x0,%xmm1,%xmm0
++
++	.p2align	4,0
+--- gas/testsuite/gas/i386/x86-64-sse4_2.s.jj	2007-05-07 11:15:33.000000000 +0200
++++ gas/testsuite/gas/i386/x86-64-sse4_2.s	2007-05-07 12:45:25.000000000 +0200
+@@ -0,0 +1,42 @@
++# Streaming SIMD extensions 4.2 Instructions
++
++	.text
++foo:
++	crc32		%cl,%ebx
++	crc32		%cl,%rbx
++	crc32		%cx,%ebx
++	crc32		%ecx,%ebx
++	crc32		%rcx,%rbx
++	crc32b		(%rcx),%ebx
++	crc32w		(%rcx),%ebx
++	crc32l		(%rcx),%ebx
++	crc32q		(%rcx),%rbx
++	crc32b		%cl,%ebx
++	crc32b		%cl,%rbx
++	crc32w		%cx,%ebx
++	crc32l		%ecx,%ebx
++	crc32q		%rcx,%rbx
++	pcmpgtq		(%rcx),%xmm0
++	pcmpgtq		%xmm1,%xmm0
++	pcmpestri	$0x0,(%rcx),%xmm0
++	pcmpestri	$0x0,%xmm1,%xmm0
++	pcmpestrm	$0x1,(%rcx),%xmm0
++	pcmpestrm	$0x1,%xmm1,%xmm0
++	pcmpistri	$0x2,(%rcx),%xmm0
++	pcmpistri	$0x2,%xmm1,%xmm0
++	pcmpistrm	$0x3,(%rcx),%xmm0
++	pcmpistrm	$0x3,%xmm1,%xmm0
++	popcnt		(%rcx),%bx
++	popcnt		(%rcx),%ebx
++	popcnt		(%rcx),%rbx
++	popcntw		(%rcx),%bx
++	popcntl		(%rcx),%ebx
++	popcntq		(%rcx),%rbx
++	popcnt		%cx,%bx
++	popcnt		%ecx,%ebx
++	popcnt		%rcx,%rbx
++	popcntw		%cx,%bx
++	popcntl		%ecx,%ebx
++	popcntq		%rcx,%rbx
++
++	.p2align	4,0
+--- gas/testsuite/gas/i386/x86-64-sse4_2.d.jj	2007-05-07 11:15:33.000000000 +0200
++++ gas/testsuite/gas/i386/x86-64-sse4_2.d	2007-05-07 14:25:52.000000000 +0200
+@@ -0,0 +1,45 @@
++#objdump: -dw
++#name: x86-64 SSE4.2
++
++.*:     file format .*
++
++Disassembly of section .text:
++
++0+000 &lt;foo&gt;:
++[ 	]*[0-9a-f]+:	f2 0f 38 f0 d9       	crc32b %cl,%ebx
++[ 	]*[0-9a-f]+:	f2 48 0f 38 f0 d9    	crc32b %cl,%rbx
++[ 	]*[0-9a-f]+:	(66 f2|f2 66) 0f 38 f1 d9    	crc32w %cx,%ebx
++[ 	]*[0-9a-f]+:	f2 0f 38 f1 d9       	crc32l %ecx,%ebx
++[ 	]*[0-9a-f]+:	f2 48 0f 38 f1 d9    	crc32q %rcx,%rbx
++[ 	]*[0-9a-f]+:	f2 0f 38 f0 19       	crc32b \(%rcx\),%ebx
++[ 	]*[0-9a-f]+:	(66 f2|f2 66) 0f 38 f1 19    	crc32w \(%rcx\),%ebx
++[ 	]*[0-9a-f]+:	f2 0f 38 f1 19       	crc32l \(%rcx\),%ebx
++[ 	]*[0-9a-f]+:	f2 48 0f 38 f1 19    	crc32q \(%rcx\),%rbx
++[ 	]*[0-9a-f]+:	f2 0f 38 f0 d9       	crc32b %cl,%ebx
++[ 	]*[0-9a-f]+:	f2 48 0f 38 f0 d9    	crc32b %cl,%rbx
++[ 	]*[0-9a-f]+:	(66 f2|f2 66) 0f 38 f1 d9    	crc32w %cx,%ebx
++[ 	]*[0-9a-f]+:	f2 0f 38 f1 d9       	crc32l %ecx,%ebx
++[ 	]*[0-9a-f]+:	f2 48 0f 38 f1 d9    	crc32q %rcx,%rbx
++[ 	]*[0-9a-f]+:	66 0f 38 37 01       	pcmpgtq \(%rcx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 37 c1       	pcmpgtq %xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 3a 61 01 00    	pcmpestri \$0x0,\(%rcx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 3a 61 c1 00    	pcmpestri \$0x0,%xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 3a 60 01 01    	pcmpestrm \$0x1,\(%rcx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 3a 60 c1 01    	pcmpestrm \$0x1,%xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 3a 63 01 02    	pcmpistri \$0x2,\(%rcx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 3a 63 c1 02    	pcmpistri \$0x2,%xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 3a 62 01 03    	pcmpistrm \$0x3,\(%rcx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 3a 62 c1 03    	pcmpistrm \$0x3,%xmm1,%xmm0
++[ 	]*[0-9a-f]+:	(66 f3|f3 66) 0f b8 19       	popcnt \(%rcx\),%bx
++[ 	]*[0-9a-f]+:	f3 0f b8 19          	popcnt \(%rcx\),%ebx
++[ 	]*[0-9a-f]+:	f3 48 0f b8 19       	popcnt \(%rcx\),%rbx
++[ 	]*[0-9a-f]+:	(66 f3|f3 66) 0f b8 19       	popcnt \(%rcx\),%bx
++[ 	]*[0-9a-f]+:	f3 0f b8 19          	popcnt \(%rcx\),%ebx
++[ 	]*[0-9a-f]+:	f3 48 0f b8 19       	popcnt \(%rcx\),%rbx
++[ 	]*[0-9a-f]+:	(66 f3|f3 66) 0f b8 d9       	popcnt %cx,%bx
++[ 	]*[0-9a-f]+:	f3 0f b8 d9          	popcnt %ecx,%ebx
++[ 	]*[0-9a-f]+:	f3 48 0f b8 d9       	popcnt %rcx,%rbx
++[ 	]*[0-9a-f]+:	(66 f3|f3 66) 0f b8 d9       	popcnt %cx,%bx
++[ 	]*[0-9a-f]+:	f3 0f b8 d9          	popcnt %ecx,%ebx
++[ 	]*[0-9a-f]+:	f3 48 0f b8 d9       	popcnt %rcx,%rbx
++#pass
+--- gas/testsuite/gas/i386/x86-64-crc32-intel.d.jj	2007-05-07 15:16:51.000000000 +0200
++++ gas/testsuite/gas/i386/x86-64-crc32-intel.d	2007-05-07 14:25:52.000000000 +0200
+@@ -0,0 +1,35 @@
++#objdump: -drwMintel
++#name: x86-64 crc32 (Intel mode)
++#source: x86-64-crc32.s
++
++.*: +file format .*
++
++Disassembly of section .text:
++
++0+ &lt;foo&gt;:
++[ 	]*[a-f0-9]+:	f2 0f 38 f0 06       	crc32  eax,BYTE PTR \[rsi\]
++[ 	]*[a-f0-9]+:	f2 48 0f 38 f0 06    	crc32  rax,BYTE PTR \[rsi\]
++[ 	]*[a-f0-9]+:	(66 f2|f2 66) 0f 38 f1 06    	crc32  eax,WORD PTR \[rsi\]
++[ 	]*[a-f0-9]+:	f2 0f 38 f1 06       	crc32  eax,DWORD PTR \[rsi\]
++[ 	]*[a-f0-9]+:	f2 48 0f 38 f1 06    	crc32  rax,QWORD PTR \[rsi\]
++[ 	]*[a-f0-9]+:	f2 0f 38 f0 c0       	crc32  eax,al
++[ 	]*[a-f0-9]+:	f2 0f 38 f0 c0       	crc32  eax,al
++[ 	]*[a-f0-9]+:	f2 48 0f 38 f0 c0    	crc32  rax,al
++[ 	]*[a-f0-9]+:	f2 48 0f 38 f0 c0    	crc32  rax,al
++[ 	]*[a-f0-9]+:	(66 f2|f2 66) 0f 38 f1 c0    	crc32  eax,ax
++[ 	]*[a-f0-9]+:	(66 f2|f2 66) 0f 38 f1 c0    	crc32  eax,ax
++[ 	]*[a-f0-9]+:	f2 0f 38 f1 c0       	crc32  eax,eax
++[ 	]*[a-f0-9]+:	f2 0f 38 f1 c0       	crc32  eax,eax
++[ 	]*[a-f0-9]+:	f2 48 0f 38 f1 c0    	crc32  rax,rax
++[ 	]*[a-f0-9]+:	f2 48 0f 38 f1 c0    	crc32  rax,rax
++[ 	]*[a-f0-9]+:	f2 48 0f 38 f0 06    	crc32  rax,BYTE PTR \[rsi\]
++[ 	]*[a-f0-9]+:	f2 0f 38 f0 06       	crc32  eax,BYTE PTR \[rsi\]
++[ 	]*[a-f0-9]+:	(66 f2|f2 66) 0f 38 f1 06    	crc32  eax,WORD PTR \[rsi\]
++[ 	]*[a-f0-9]+:	f2 0f 38 f1 06       	crc32  eax,DWORD PTR \[rsi\]
++[ 	]*[a-f0-9]+:	f2 48 0f 38 f1 06    	crc32  rax,QWORD PTR \[rsi\]
++[ 	]*[a-f0-9]+:	f2 0f 38 f0 c0       	crc32  eax,al
++[ 	]*[a-f0-9]+:	f2 48 0f 38 f0 c0    	crc32  rax,al
++[ 	]*[a-f0-9]+:	(66 f2|f2 66) 0f 38 f1 c0    	crc32  eax,ax
++[ 	]*[a-f0-9]+:	f2 0f 38 f1 c0       	crc32  eax,eax
++[ 	]*[a-f0-9]+:	f2 48 0f 38 f1 c0    	crc32  rax,rax
++#pass
+--- gas/testsuite/gas/i386/crc32.s.jj	2007-05-07 15:16:51.000000000 +0200
++++ gas/testsuite/gas/i386/crc32.s	2007-05-07 12:45:25.000000000 +0200
+@@ -0,0 +1,24 @@
++# Check crc32 in SSE4.2
++
++	.text
++foo:
++
++crc32b (%esi), %eax
++crc32w (%esi), %eax
++crc32l (%esi), %eax
++crc32  %al, %eax
++crc32b  %al, %eax
++crc32  %ax, %eax
++crc32w  %ax, %eax
++crc32  %eax, %eax
++crc32l  %eax, %eax
++
++.intel_syntax noprefix
++crc32  eax,byte ptr [esi]
++crc32  eax, word ptr [esi]
++crc32  eax,dword ptr [esi]
++crc32  eax,al
++crc32  eax, ax
++crc32  eax,eax
++
++.p2align 4,0
+--- gas/testsuite/gas/i386/sse4_1.d.jj	2007-05-07 11:15:33.000000000 +0200
++++ gas/testsuite/gas/i386/sse4_1.d	2007-05-07 11:15:33.000000000 +0200
+@@ -0,0 +1,102 @@
++#objdump: -dw
++#name: i386 SSE4.1
++
++.*:     file format .*
++
++Disassembly of section .text:
++
++0+000 &lt;foo&gt;:
++[ 	]*[0-9a-f]+:	66 0f 3a 0d 01 00    	blendpd \$0x0,\(%ecx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 3a 0d c1 00    	blendpd \$0x0,%xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 3a 0c 01 00    	blendps \$0x0,\(%ecx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 3a 0c c1 00    	blendps \$0x0,%xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 15 01       	blendvpd %xmm0,\(%ecx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 15 c1       	blendvpd %xmm0,%xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 14 01       	blendvps %xmm0,\(%ecx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 14 c1       	blendvps %xmm0,%xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 3a 41 01 00    	dppd   \$0x0,\(%ecx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 3a 41 c1 00    	dppd   \$0x0,%xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 3a 40 01 00    	dpps   \$0x0,\(%ecx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 3a 40 c1 00    	dpps   \$0x0,%xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 3a 17 c1 00    	extractps \$0x0,%xmm0,%ecx
++[ 	]*[0-9a-f]+:	66 0f 3a 17 01 00    	extractps \$0x0,%xmm0,\(%ecx\)
++[ 	]*[0-9a-f]+:	66 0f 3a 21 c1 00    	insertps \$0x0,%xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 3a 21 01 00    	insertps \$0x0,\(%ecx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 2a 01       	movntdqa \(%ecx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 3a 42 01 00    	mpsadbw \$0x0,\(%ecx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 3a 42 c1 00    	mpsadbw \$0x0,%xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 2b 01       	packusdw \(%ecx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 2b c1       	packusdw %xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 10 01       	pblendvb %xmm0,\(%ecx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 10 c1       	pblendvb %xmm0,%xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 3a 0e 01 00    	pblendw \$0x0,\(%ecx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 3a 0e c1 00    	pblendw \$0x0,%xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 29 c1       	pcmpeqq %xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 29 01       	pcmpeqq \(%ecx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 3a 14 c1 00    	pextrb \$0x0,%xmm0,%ecx
++[ 	]*[0-9a-f]+:	66 0f 3a 14 01 00    	pextrb \$0x0,%xmm0,\(%ecx\)
++[ 	]*[0-9a-f]+:	66 0f 3a 16 c1 00    	pextrd \$0x0,%xmm0,%ecx
++[ 	]*[0-9a-f]+:	66 0f 3a 16 01 00    	pextrd \$0x0,%xmm0,\(%ecx\)
++[ 	]*[0-9a-f]+:	66 0f c5 c8 00       	pextrw \$0x0,%xmm0,%ecx
++[ 	]*[0-9a-f]+:	66 0f 3a 15 01 00    	pextrw \$0x0,%xmm0,\(%ecx\)
++[ 	]*[0-9a-f]+:	66 0f 38 41 c1       	phminposuw %xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 41 01       	phminposuw \(%ecx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 3a 20 01 00    	pinsrb \$0x0,\(%ecx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 3a 20 c1 00    	pinsrb \$0x0,%ecx,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 3a 22 01 00    	pinsrd \$0x0,\(%ecx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 3a 22 c1 00    	pinsrd \$0x0,%ecx,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 3c c1       	pmaxsb %xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 3c 01       	pmaxsb \(%ecx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 3d c1       	pmaxsd %xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 3d 01       	pmaxsd \(%ecx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 3f c1       	pmaxud %xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 3f 01       	pmaxud \(%ecx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 3e c1       	pmaxuw %xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 3e 01       	pmaxuw \(%ecx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 38 c1       	pminsb %xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 38 01       	pminsb \(%ecx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 39 c1       	pminsd %xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 39 01       	pminsd \(%ecx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 3b c1       	pminud %xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 3b 01       	pminud \(%ecx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 3a c1       	pminuw %xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 3a 01       	pminuw \(%ecx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 20 c1       	pmovsxbw %xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 20 01       	pmovsxbw \(%ecx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 21 c1       	pmovsxbd %xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 21 01       	pmovsxbd \(%ecx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 22 c1       	pmovsxbq %xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 22 01       	pmovsxbq \(%ecx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 23 c1       	pmovsxwd %xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 23 01       	pmovsxwd \(%ecx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 24 c1       	pmovsxwq %xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 24 01       	pmovsxwq \(%ecx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 25 c1       	pmovsxdq %xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 25 01       	pmovsxdq \(%ecx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 30 c1       	pmovzxbw %xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 30 01       	pmovzxbw \(%ecx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 31 c1       	pmovzxbd %xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 31 01       	pmovzxbd \(%ecx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 32 c1       	pmovzxbq %xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 32 01       	pmovzxbq \(%ecx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 33 c1       	pmovzxwd %xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 33 01       	pmovzxwd \(%ecx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 34 c1       	pmovzxwq %xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 34 01       	pmovzxwq \(%ecx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 35 c1       	pmovzxdq %xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 35 01       	pmovzxdq \(%ecx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 28 c1       	pmuldq %xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 28 01       	pmuldq \(%ecx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 40 c1       	pmulld %xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 40 01       	pmulld \(%ecx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 17 c1       	ptest  %xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 38 17 01       	ptest  \(%ecx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 3a 09 01 00    	roundpd \$0x0,\(%ecx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 3a 09 c1 00    	roundpd \$0x0,%xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 3a 08 01 00    	roundps \$0x0,\(%ecx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 3a 08 c1 00    	roundps \$0x0,%xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 3a 0b 01 00    	roundsd \$0x0,\(%ecx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 3a 0b c1 00    	roundsd \$0x0,%xmm1,%xmm0
++[ 	]*[0-9a-f]+:	66 0f 3a 0a 01 00    	roundss \$0x0,\(%ecx\),%xmm0
++[ 	]*[0-9a-f]+:	66 0f 3a 0a c1 00    	roundss \$0x0,%xmm1,%xmm0
++#pass
+--- gas/testsuite/gas/i386/sse4_1.s.jj	2007-05-07 11:15:33.000000000 +0200
++++ gas/testsuite/gas/i386/sse4_1.s	2007-05-07 11:15:33.000000000 +0200
+@@ -0,0 +1,99 @@
++# Streaming SIMD extensions 4.1 Instructions
++
++	.text
++foo:
++	blendpd		$0,(%ecx),%xmm0
++	blendpd		$0,%xmm1,%xmm0
++	blendps		$0,(%ecx),%xmm0
++	blendps		$0,%xmm1,%xmm0
++	blendvpd	%xmm0,(%ecx),%xmm0
++	blendvpd	%xmm0,%xmm1,%xmm0
++	blendvps	%xmm0,(%ecx),%xmm0
++	blendvps	%xmm0,%xmm1,%xmm0
++	dppd		$0,(%ecx),%xmm0
++	dppd		$0,%xmm1,%xmm0
++	dpps		$0,(%ecx),%xmm0
++	dpps		$0,%xmm1,%xmm0
++	extractps	$0,%xmm0,%ecx
++	extractps	$0,%xmm0,(%ecx)
++	insertps	$0,%xmm1,%xmm0
++	insertps	$0,(%ecx),%xmm0
++	movntdqa	(%ecx),%xmm0
++	mpsadbw		$0,(%ecx),%xmm0
++	mpsadbw		$0,%xmm1,%xmm0
++	packusdw	(%ecx),%xmm0
++	packusdw	%xmm1,%xmm0
++	pblendvb	%xmm0,(%ecx),%xmm0
++	pblendvb	%xmm0,%xmm1,%xmm0
++	pblendw		$0,(%ecx),%xmm0
++	pblendw		$0,%xmm1,%xmm0
++	pcmpeqq		%xmm1,%xmm0
++	pcmpeqq		(%ecx),%xmm0
++	pextrb          $0,%xmm0,%ecx
++	pextrb          $0,%xmm0,(%ecx)
++	pextrd          $0,%xmm0,%ecx
++	pextrd          $0,%xmm0,(%ecx)
++	pextrw          $0,%xmm0,%ecx
++	pextrw          $0,%xmm0,(%ecx)
++	phminposuw	%xmm1,%xmm0
++	phminposuw	(%ecx),%xmm0
++	pinsrb		$0,(%ecx),%xmm0
++	pinsrb		$0,%ecx,%xmm0
++	pinsrd		$0,(%ecx),%xmm0
++	pinsrd		$0,%ecx,%xmm0
++	pmaxsb		%xmm1,%xmm0
++	pmaxsb		(%ecx),%xmm0
++	pmaxsd		%xmm1,%xmm0
++	pmaxsd		(%ecx),%xmm0
++	pmaxud		%xmm1,%xmm0
++	pmaxud		(%ecx),%xmm0
++	pmaxuw		%xmm1,%xmm0
++	pmaxuw		(%ecx),%xmm0
++	pminsb		%xmm1,%xmm0
++	pminsb		(%ecx),%xmm0
++	pminsd		%xmm1,%xmm0
++	pminsd		(%ecx),%xmm0
++	pminud		%xmm1,%xmm0
++	pminud		(%ecx),%xmm0
++	pminuw		%xmm1,%xmm0
++	pminuw		(%ecx),%xmm0
++	pmovsxbw	%xmm1,%xmm0
++	pmovsxbw	(%ecx),%xmm0
++	pmovsxbd	%xmm1,%xmm0
++	pmovsxbd	(%ecx),%xmm0
++	pmovsxbq	%xmm1,%xmm0
++	pmovsxbq	(%ecx),%xmm0
++	pmovsxwd	%xmm1,%xmm0
++	pmovsxwd	(%ecx),%xmm0
++	pmovsxwq	%xmm1,%xmm0
++	pmovsxwq	(%ecx),%xmm0
++	pmovsxdq	%xmm1,%xmm0
++	pmovsxdq	(%ecx),%xmm0
++	pmovzxbw	%xmm1,%xmm0
++	pmovzxbw	(%ecx),%xmm0
++	pmovzxbd	%xmm1,%xmm0
++	pmovzxbd	(%ecx),%xmm0
++	pmovzxbq	%xmm1,%xmm0
++	pmovzxbq	(%ecx),%xmm0
++	pmovzxwd	%xmm1,%xmm0
++	pmovzxwd	(%ecx),%xmm0
++	pmovzxwq	%xmm1,%xmm0
++	pmovzxwq	(%ecx),%xmm0
++	pmovzxdq	%xmm1,%xmm0
++	pmovzxdq	(%ecx),%xmm0
++	pmuldq		%xmm1,%xmm0
++	pmuldq		(%ecx),%xmm0
++	pmulld		%xmm1,%xmm0
++	pmulld		(%ecx),%xmm0
++	ptest		%xmm1,%xmm0
++	ptest		(%ecx),%xmm0
++	roundpd		$0,(%ecx),%xmm0
++	roundpd		$0,%xmm1,%xmm0
++	roundps		$0,(%ecx),%xmm0
++	roundps		$0,%xmm1,%xmm0
++	roundsd		$0,(%ecx),%xmm0
++	roundsd		$0,%xmm1,%xmm0
++	roundss		$0,(%ecx),%xmm0
++	roundss		$0,%xmm1,%xmm0
++
++	.p2align	4,0
+--- gas/testsuite/gas/i386/crc32.d.jj	2007-05-07 15:16:51.000000000 +0200
++++ gas/testsuite/gas/i386/crc32.d	2007-05-07 14:25:52.000000000 +0200
+@@ -0,0 +1,24 @@
++#objdump: -dw
++#name: i386 crc32
++
++.*:     file format .*
++
++Disassembly of section .text:
++
++0+ &lt;foo&gt;:
++[ 	]*[a-f0-9]+:	f2 0f 38 f0 06       	crc32b \(%esi\),%eax
++[ 	]*[a-f0-9]+:	(66 f2|f2 66) 0f 38 f1 06    	crc32w \(%esi\),%eax
++[ 	]*[a-f0-9]+:	f2 0f 38 f1 06       	crc32l \(%esi\),%eax
++[ 	]*[a-f0-9]+:	f2 0f 38 f0 c0       	crc32b %al,%eax
++[ 	]*[a-f0-9]+:	f2 0f 38 f0 c0       	crc32b %al,%eax
++[ 	]*[a-f0-9]+:	(66 f2|f2 66) 0f 38 f1 c0    	crc32w %ax,%eax
++[ 	]*[a-f0-9]+:	(66 f2|f2 66) 0f 38 f1 c0    	crc32w %ax,%eax
++[ 	]*[a-f0-9]+:	f2 0f 38 f1 c0       	crc32l %eax,%eax
++[ 	]*[a-f0-9]+:	f2 0f 38 f1 c0       	crc32l %eax,%eax
++[ 	]*[a-f0-9]+:	f2 0f 38 f0 06       	crc32b \(%esi\),%eax
++[ 	]*[a-f0-9]+:	(66 f2|f2 66) 0f 38 f1 06    	crc32w \(%esi\),%eax
++[ 	]*[a-f0-9]+:	f2 0f 38 f1 06       	crc32l \(%esi\),%eax
++[ 	]*[a-f0-9]+:	f2 0f 38 f0 c0       	crc32b %al,%eax
++[ 	]*[a-f0-9]+:	(66 f2|f2 66) 0f 38 f1 c0    	crc32w %ax,%eax
++[ 	]*[a-f0-9]+:	f2 0f 38 f1 c0       	crc32l %eax,%eax
++#pass
+--- gas/testsuite/gas/i386/i386.exp.jj	2006-10-20 20:50:59.000000000 +0200
++++ gas/testsuite/gas/i386/i386.exp	2007-05-07 12:45:25.000000000 +0200
+@@ -83,6 +83,11 @@ if [expr ([istarget &quot;i*86-*-*&quot;] ||  [ist
+     run_dump_test &quot;nops-2-merom&quot;
+     run_dump_test &quot;addr16&quot;
+     run_dump_test &quot;addr32&quot;
++    run_dump_test &quot;sse4_1&quot;
++    run_dump_test &quot;sse4_2&quot;
++    run_dump_test &quot;crc32&quot;
++    run_dump_test &quot;crc32-intel&quot;
++    run_list_test &quot;inval-crc32&quot; &quot;-al&quot;
+ 
+     # These tests require support for 8 and 16 bit relocs,
+     # so we only run them for ELF and COFF targets.
+@@ -163,6 +168,11 @@ if [expr ([istarget &quot;i*86-*-*&quot;] || [ista
+     run_dump_test &quot;x86-64-nops-1-k8&quot;
+     run_dump_test &quot;x86-64-nops-1-nocona&quot;
+     run_dump_test &quot;x86-64-nops-1-merom&quot;
++    run_dump_test &quot;x86-64-sse4_1&quot;
++    run_dump_test &quot;x86-64-sse4_2&quot;
++    run_dump_test &quot;x86-64-crc32&quot;
++    run_dump_test &quot;x86-64-crc32-intel&quot;
++    run_list_test &quot;x86-64-inval-crc32&quot; &quot;-al&quot;
+ 
+     if { ![istarget &quot;*-*-aix*&quot;]
+       &amp;&amp; ![istarget &quot;*-*-beos*&quot;]
+--- gas/testsuite/gas/i386/x86-64-crc32.d.jj	2007-05-07 15:16:51.000000000 +0200
++++ gas/testsuite/gas/i386/x86-64-crc32.d	2007-05-07 14:25:52.000000000 +0200
+@@ -0,0 +1,34 @@
++#objdump: -dw
++#name: x86-64 crc32
++
++.*:     file format .*
++
++Disassembly of section .text:
++
++0+ &lt;foo&gt;:
++[ 	]*[a-f0-9]+:	f2 0f 38 f0 06       	crc32b \(%rsi\),%eax
++[ 	]*[a-f0-9]+:	f2 48 0f 38 f0 06    	crc32b \(%rsi\),%rax
++[ 	]*[a-f0-9]+:	(66 f2|f2 66) 0f 38 f1 06    	crc32w \(%rsi\),%eax
++[ 	]*[a-f0-9]+:	f2 0f 38 f1 06       	crc32l \(%rsi\),%eax
++[ 	]*[a-f0-9]+:	f2 48 0f 38 f1 06    	crc32q \(%rsi\),%rax
++[ 	]*[a-f0-9]+:	f2 0f 38 f0 c0       	crc32b %al,%eax
++[ 	]*[a-f0-9]+:	f2 0f 38 f0 c0       	crc32b %al,%eax
++[ 	]*[a-f0-9]+:	f2 48 0f 38 f0 c0    	crc32b %al,%rax
++[ 	]*[a-f0-9]+:	f2 48 0f 38 f0 c0    	crc32b %al,%rax
++[ 	]*[a-f0-9]+:	(66 f2|f2 66) 0f 38 f1 c0    	crc32w %ax,%eax
++[ 	]*[a-f0-9]+:	(66 f2|f2 66) 0f 38 f1 c0    	crc32w %ax,%eax
++[ 	]*[a-f0-9]+:	f2 0f 38 f1 c0       	crc32l %eax,%eax
++[ 	]*[a-f0-9]+:	f2 0f 38 f1 c0       	crc32l %eax,%eax
++[ 	]*[a-f0-9]+:	f2 48 0f 38 f1 c0    	crc32q %rax,%rax
++[ 	]*[a-f0-9]+:	f2 48 0f 38 f1 c0    	crc32q %rax,%rax
++[ 	]*[a-f0-9]+:	f2 48 0f 38 f0 06    	crc32b \(%rsi\),%rax
++[ 	]*[a-f0-9]+:	f2 0f 38 f0 06       	crc32b \(%rsi\),%eax
++[ 	]*[a-f0-9]+:	(66 f2|f2 66) 0f 38 f1 06    	crc32w \(%rsi\),%eax
++[ 	]*[a-f0-9]+:	f2 0f 38 f1 06       	crc32l \(%rsi\),%eax
++[ 	]*[a-f0-9]+:	f2 48 0f 38 f1 06    	crc32q \(%rsi\),%rax
++[ 	]*[a-f0-9]+:	f2 0f 38 f0 c0       	crc32b %al,%eax
++[ 	]*[a-f0-9]+:	f2 48 0f 38 f0 c0    	crc32b %al,%rax
++[ 	]*[a-f0-9]+:	(66 f2|f2 66) 0f 38 f1 c0    	crc32w %ax,%eax
++[ 	]*[a-f0-9]+:	f2 0f 38 f1 c0       	crc32l %eax,%eax
++[ 	]*[a-f0-9]+:	f2 48 0f 38 f1 c0    	crc32q %rax,%rax
++#pass
+--- gas/testsuite/gas/i386/inval-crc32.l.jj	2007-05-07 15:16:51.000000000 +0200
++++ gas/testsuite/gas/i386/inval-crc32.l	2007-05-07 12:45:25.000000000 +0200
+@@ -0,0 +1,43 @@
++.*: Assembler messages:
++.*:6: Error: .*
++.*:7: Error: .*
++.*:8: Error: .*
++.*:9: Error: .*
++.*:10: Error: .*
++.*:11: Error: .*
++.*:12: Error: .*
++.*:13: Error: .*
++.*:14: Error: .*
++.*:17: Error: .*
++.*:18: Error: .*
++.*:19: Error: .*
++.*:20: Error: .*
++.*:21: Error: .*
++.*:22: Error: .*
++.*:23: Error: .*
++GAS LISTING .*
++
++
++[ 	]*1[ 	]+\# Check illegal crc32 in SSE4\.2
++[ 	]*2[ 	]+
++[ 	]*3[ 	]+\.text
++[ 	]*4[ 	]+foo:
++[ 	]*5[ 	]+
++[ 	]*6[ 	]+crc32b \(%esi\), %al
++[ 	]*7[ 	]+crc32w \(%esi\), %ax
++[ 	]*8[ 	]+crc32 \(%esi\), %al
++[ 	]*9[ 	]+crc32 \(%esi\), %ax
++[ 	]*10[ 	]+crc32 \(%esi\), %eax
++[ 	]*11[ 	]+crc32  %al, %al
++[ 	]*12[ 	]+crc32b  %al, %al
++[ 	]*13[ 	]+crc32  %ax, %ax
++[ 	]*14[ 	]+crc32w  %ax, %ax
++[ 	]*15[ 	]+
++[ 	]*16[ 	]+\.intel_syntax noprefix
++[ 	]*17[ 	]+crc32  al,byte ptr \[esi\]
++[ 	]*18[ 	]+crc32  ax, word ptr \[esi\]
++[ 	]*19[ 	]+crc32  al, \[esi\]
++[ 	]*20[ 	]+crc32  ax, \[esi\]
++[ 	]*21[ 	]+crc32  eax, \[esi\]
++[ 	]*22[ 	]+crc32  al,al
++[ 	]*23[ 	]+crc32  ax, ax
+--- gas/config/tc-i386.c.jj	2006-10-20 20:50:59.000000000 +0200
++++ gas/config/tc-i386.c	2007-05-07 13:00:02.000000000 +0200
+@@ -511,6 +511,12 @@ static const arch_entry cpu_arch[] =
+    CpuMMX|CpuMMX2|CpuSSE|CpuSSE2|CpuSSE3},
+   {&quot;.ssse3&quot;, PROCESSOR_UNKNOWN,
+    CpuMMX|CpuMMX2|CpuSSE|CpuSSE2|CpuSSE3|CpuSSSE3},
++  {&quot;.sse4.1&quot;, PROCESSOR_UNKNOWN,
++   CpuMMX|CpuMMX2|CpuSSE|CpuSSE2|CpuSSE3|CpuSSSE3|CpuSSE4_1},
++  {&quot;.sse4.2&quot;, PROCESSOR_UNKNOWN,
++   CpuMMX|CpuMMX2|CpuSSE|CpuSSE2|CpuSSE3|CpuSSSE3|CpuSSE4},
++  {&quot;.sse4&quot;, PROCESSOR_UNKNOWN,
++   CpuMMX|CpuMMX2|CpuSSE|CpuSSE2|CpuSSE3|CpuSSSE3|CpuSSE4},
+   {&quot;.3dnow&quot;, PROCESSOR_UNKNOWN,
+    CpuMMX|Cpu3dnow},
+   {&quot;.3dnowa&quot;, PROCESSOR_UNKNOWN,
+@@ -2697,9 +2703,10 @@ match_template ()
+ 	      || !MATCH (overlap1, i.types[1], operand_types[1])
+ 	      /* monitor in SSE3 is a very special case.  The first
+ 		 register and the second register may have different
+-		 sizes.  */
++		 sizes.  The same applies to crc32 in SSE4.2.  */
+ 	      || !((t-&gt;base_opcode == 0x0f01
+ 		    &amp;&amp; t-&gt;extension_opcode == 0xc8)
++		   || t-&gt;base_opcode == 0xf20f38f1
+ 		   || CONSISTENT_REGISTER_MATCH (overlap0, i.types[0],
+ 						 operand_types[0],
+ 						 overlap1, i.types[1],
+@@ -2856,19 +2863,44 @@ process_suffix (void)
+ 	{
+ 	  /* We take i.suffix from the last register operand specified,
+ 	     Destination register type is more significant than source
+-	     register type.  */
+-	  int op;
+-
+-	  for (op = i.operands; --op &gt;= 0;)
+-	    if ((i.types[op] &amp; Reg)
+-		&amp;&amp; !(i.tm.operand_types[op] &amp; InOutPortReg))
+-	      {
+-		i.suffix = ((i.types[op] &amp; Reg8) ? BYTE_MNEM_SUFFIX :
+-			    (i.types[op] &amp; Reg16) ? WORD_MNEM_SUFFIX :
+-			    (i.types[op] &amp; Reg64) ? QWORD_MNEM_SUFFIX :
++	     register type.  crc32 in SSE4.2 prefers source register
++	     type. */
++	  if (i.tm.base_opcode == 0xf20f38f1)
++	    {
++	      if ((i.types[0] &amp; Reg))
++		i.suffix = ((i.types[0] &amp; Reg16) ? WORD_MNEM_SUFFIX :
+ 			    LONG_MNEM_SUFFIX);
+-		break;
+-	      }
++	    }
++	  else if (i.tm.base_opcode == 0xf20f38f0)
++	    {
++	      if ((i.types[0] &amp; Reg8))
++		i.suffix = BYTE_MNEM_SUFFIX;
++	    }
++
++	  if (!i.suffix)
++	    {
++	      int op;
++
++	      if (i.tm.base_opcode == 0xf20f38f1
++		  || i.tm.base_opcode == 0xf20f38f0)
++		{
++		  /* We have to know the operand size for crc32.  */
++		  as_bad (_(&quot;ambiguous memory operand size for `%s`&quot;),
++			  i.tm.name);
++		  return 0;
++		}
++
++	      for (op = i.operands; --op &gt;= 0;)
++		if ((i.types[op] &amp; Reg)
++		    &amp;&amp; !(i.tm.operand_types[op] &amp; InOutPortReg))
++		  {
++		    i.suffix = ((i.types[op] &amp; Reg8) ? BYTE_MNEM_SUFFIX :
++				(i.types[op] &amp; Reg16) ? WORD_MNEM_SUFFIX :
++				(i.types[op] &amp; Reg64) ? QWORD_MNEM_SUFFIX :
++				LONG_MNEM_SUFFIX);
++		    break;
++		  }
++	    }
+ 	}
+       else if (i.suffix == BYTE_MNEM_SUFFIX)
+ 	{
+@@ -3047,6 +3079,10 @@ check_byte_reg (void)
+ 	      || i.tm.base_opcode == 0xfbf))
+ 	continue;
+ 
++      /* crc32 doesn't generate this warning.  */
++      if (i.tm.base_opcode == 0xf20f38f0)
++	continue;
++
+       if ((i.types[op] &amp; WordReg) &amp;&amp; i.op[op].regs-&gt;reg_num &lt; 4)
+ 	{
+ 	  /* Prohibit these changes in the 64bit mode, since the
+@@ -3302,12 +3338,45 @@ process_operands ()
+      is converted into xor %reg, %reg.  */
+   if (i.tm.opcode_modifier &amp; regKludge)
+     {
+-      unsigned int first_reg_op = (i.types[0] &amp; Reg) ? 0 : 1;
+-      /* Pretend we saw the extra register operand.  */
+-      assert (i.op[first_reg_op + 1].regs == 0);
+-      i.op[first_reg_op + 1].regs = i.op[first_reg_op].regs;
+-      i.types[first_reg_op + 1] = i.types[first_reg_op];
+-      i.reg_operands = 2;
++       if ((i.tm.cpu_flags &amp; CpuSSE4_1))
++	 {
++	   /* The first operand in instruction blendvpd, blendvps and
++	      pblendvb in SSE4.1 is implicit and must be xmm0.  */
++	   assert (i.operands == 3
++		   &amp;&amp; i.reg_operands &gt;= 2
++		   &amp;&amp; i.types[0] == RegXMM);
++	   if (i.op[0].regs-&gt;reg_num != 0)
++	     {
++	       if (intel_syntax)
++		 as_bad (_(&quot;the last operand of `%s' must be `xmm0'&quot;),
++			 i.tm.name);
++	       else
++		 as_bad (_(&quot;the first operand of `%s' must be `%%xmm0'&quot;),
++			 i.tm.name);
++	       return 0;
++	     }
++	   i.op[0] = i.op[1];
++	   i.op[1] = i.op[2];
++	   i.types[0] = i.types[1];
++	   i.types[1] = i.types[2];
++	   i.operands--;
++	   i.reg_operands--;
++
++	   /* We need to adjust fields in i.tm since they are used by
++	      build_modrm_byte.  */
++	   i.tm.operand_types [0] = i.tm.operand_types [1];
++	   i.tm.operand_types [1] = i.tm.operand_types [2];
++	   i.tm.operands--;
++	 }
++       else
++	 {
++	   unsigned int first_reg_op = (i.types[0] &amp; Reg) ? 0 : 1;
++	   /* Pretend we saw the extra register operand.  */
++	   assert (i.op[first_reg_op + 1].regs == 0);
++	   i.op[first_reg_op + 1].regs = i.op[first_reg_op].regs;
++	   i.types[first_reg_op + 1] = i.types[first_reg_op];
++	   i.reg_operands = 2;
++	 }
+     }
+ 
+   if (i.tm.opcode_modifier &amp; ShortForm)
+@@ -3891,11 +3960,12 @@ output_insn ()
+       unsigned char *q;
+       unsigned int prefix;
+ 
+-      /* All opcodes on i386 have either 1 or 2 bytes.  Supplemental
+-	 Streaming SIMD extensions 3 Instructions have 3 bytes.  We may
+-	 use one more higher byte to specify a prefix the instruction
+-	 requires.  */
+-      if ((i.tm.cpu_flags &amp; CpuSSSE3) != 0)
++      /* All opcodes on i386 have either 1 or 2 bytes.  SSSE3 and
++	 SSE4 instructions have 3 bytes.  We may use one more higher
++	 byte to specify a prefix the instruction requires.  Exclude
++	 instructions which are in both SSE4 and ABM.  */
++      if ((i.tm.cpu_flags &amp; (CpuSSSE3 | CpuSSE4)) != 0
++	  &amp;&amp; (i.tm.cpu_flags &amp; CpuABM) == 0)
+ 	{
+ 	  if (i.tm.base_opcode &amp; 0xff000000)
+ 	    {
+@@ -3936,7 +4006,8 @@ output_insn ()
+ 	}
+       else
+ 	{
+-	  if ((i.tm.cpu_flags &amp; CpuSSSE3) != 0)
++	  if ((i.tm.cpu_flags &amp; (CpuSSSE3 | CpuSSE4)) != 0
++	      &amp;&amp; (i.tm.cpu_flags &amp; CpuABM) == 0)
+ 	    {
+ 	      p = frag_more (3);
+ 	      *p++ = (i.tm.base_opcode &gt;&gt; 16) &amp; 0xff;
+--- gas/config/tc-i386.h.jj	2006-10-20 20:50:59.000000000 +0200
++++ gas/config/tc-i386.h	2007-05-07 12:27:46.000000000 +0200
+@@ -190,6 +190,11 @@ typedef struct
+ #define CpuSSSE3      0x80000	/* Supplemental Streaming SIMD extensions 3 required */
+ #define CpuSSE4a     0x100000   /* SSE4a New Instuctions required */ 
+ #define CpuABM       0x200000   /* ABM New Instructions required */
++#define CpuSSE4_1    0x400000	/* SSE4.1 Instructions required */
++#define CpuSSE4_2    0x800000	/* SSE4.2 Instructions required */
++
++/* SSE4.1/4.2 Instructions required */
++#define CpuSSE4			(CpuSSE4_1|CpuSSE4_2)
+ 
+   /* These flags are set by gas depending on the flag_code.  */
+ #define Cpu64	     0x4000000   /* 64bit support required  */
+@@ -198,7 +203,8 @@ typedef struct
+   /* The default value for unknown CPUs - enable all features to avoid problems.  */
+ #define CpuUnknownFlags (Cpu186|Cpu286|Cpu386|Cpu486|Cpu586|Cpu686 \
+ 	|CpuP4|CpuSledgehammer|CpuMMX|CpuMMX2|CpuSSE|CpuSSE2|CpuPNI|CpuVMX \
+-	|Cpu3dnow|Cpu3dnowA|CpuK6|CpuPadLock|CpuSVME|CpuSSSE3|CpuABM|CpuSSE4a)
++	|Cpu3dnow|Cpu3dnowA|CpuK6|CpuPadLock|CpuSVME|CpuSSSE3|CpuSSE4_1 \
++	|CpuSSE4_2|CpuABM|CpuSSE4a)
+ 
+   /* the bits in opcode_modifier are used to generate the final opcode from
+      the base_opcode.  These bits also are used to detect alternate forms of
+@@ -234,7 +240,9 @@ typedef struct
+ #define No_xSuf       0x800000  /* x suffix on instruction illegal */
+ #define FWait	     0x1000000	/* instruction needs FWAIT */
+ #define IsString     0x2000000	/* quick test for string instructions */
+-#define regKludge    0x4000000	/* fake an extra reg operand for clr, imul */
++#define regKludge    0x4000000	/* fake an extra reg operand for clr, imul
++				   and special register processing for
++				   some instructions.  */
+ #define IsPrefix     0x8000000	/* opcode is a prefix */
+ #define ImmExt	    0x10000000	/* instruction has extension in 8 bit imm */
+ #define NoRex64	    0x20000000  /* instruction don't need Rex64 prefix.  */
+--- gas/doc/c-i386.texi.jj	2007-05-07 10:48:24.000000000 +0200
++++ gas/doc/c-i386.texi	2007-05-07 11:15:33.000000000 +0200
+@@ -756,6 +756,7 @@ supported on the CPU specified.  The cho
+ @item @samp{amdfam10}
+ @item @samp{k6} @tab @samp{athlon} @tab @samp{sledgehammer} @tab @samp{k8} 
+ @item @samp{.mmx} @tab @samp{.sse} @tab @samp{.sse2} @tab @samp{.sse3}
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">++ at item</A> @samp{.ssse3} @tab @samp{.sse4.1} @tab @samp{.sse4.2} @tab @samp{.sse4}
+ @item @samp{.sse4a} @tab @samp{.3dnow} @tab @samp{.3dnowa} @tab @samp{.padlock}
+ @item @samp{.pacifica} @tab @samp{.svme} @tab @samp{.abm}
+ @end multitable

Added: branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-standards.patch
===================================================================
--- branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-standards.patch	                        (rev 0)
+++ branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-standards.patch	2008-06-09 23:18:27 UTC (rev 6350)
@@ -0,0 +1,878 @@
+--- etc/standards.texi.jj	2002-02-27 11:32:17.000000000 +0100
++++ etc/standards.texi	2005-08-18 19:05:42.000000000 +0200
+@@ -3,16 +3,13 @@
+ @setfilename standards.info
+ @settitle GNU Coding Standards
+ @c This date is automagically updated when you save this file:
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">+- at set</A> lastupdate February 14, 2002
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">++ at set</A> lastupdate June 8, 2005
+ @c %**end of header
+ 
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">+- at ifnottex</A>
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">+- at format</A>
+-START-INFO-DIR-ENTRY
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">++ at dircategory</A> GNU organization
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">++ at direntry</A>
+ * Standards: (standards).        GNU coding standards.
+-END-INFO-DIR-ENTRY
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">+- at end</A> format
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">+- at end</A> ifnottex
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">++ at end</A> direntry
+ 
+ @c @setchapternewpage odd
+ @setchapternewpage off
+@@ -32,9 +29,11 @@ END-INFO-DIR-ENTRY
+ @set CHAPTER node
+ @end ifnottex
+ 
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">+- at ifnottex</A>
+-GNU Coding Standards
+-Copyright (C) 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001 Free Software Foundation, Inc.
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">++ at copying</A>
++The GNU coding standards, last updated @value{lastupdate}.
++
++Copyright (C) 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000,
++2001, 2002, 2003, 2004, 2005 Free Software Foundation, Inc.
+ 
+ Permission is granted to copy, distribute and/or modify this document
+ under the terms of the GNU Free Documentation License, Version 1.1
+@@ -43,32 +42,25 @@ with no Invariant Sections, with no
+ Front-Cover Texts, and with no Back-Cover Texts.
+ A copy of the license is included in the section entitled ``GNU
+ Free Documentation License''.
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">+- at end</A> ifnottex
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">++ at end</A> copying
+ 
+ @titlepage
+ @title GNU Coding Standards
+ @author Richard Stallman, et al.
+ @author last updated @value{lastupdate}
+ @page
+-
+ @vskip 0pt plus 1filll
+-Copyright @copyright{} 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001 Free Software Foundation, Inc.
+-
+-Permission is granted to copy, distribute and/or modify this document
+-under the terms of the GNU Free Documentation License, Version 1.1
+-or any later version published by the Free Software Foundation;
+-with no Invariant Sections, with no
+-Front-Cover Texts, and with no Back-Cover Texts.
+-A copy of the license is included in the section entitled ``GNU
+-Free Documentation License''.
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">++ at insertcopying</A>
+ @end titlepage
+ 
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">+- at ifnottex</A>
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">++ at contents</A>
++
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">++ at ifnottex</A>
+ @node Top, Preface, (dir), (dir)
+ @top Version
+ 
+-Last updated @value{lastupdate}.
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">+- at end</A> ifnottex
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">++ at insertcopying</A>
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">++ at end</A> ifnottex
+ 
+ @menu
+ * Preface::                     About the GNU Coding Standards
+@@ -101,15 +93,10 @@ This release of the GNU Coding Standards
+ @cindex where to obtain @code{standards.texi}
+ @cindex downloading this manual
+ If you did not obtain this file directly from the GNU project and
+-recently, please check for a newer version.  You can ftp the GNU
+-Coding Standards from any GNU FTP host in the directory
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">+- at file</A>{/pub/gnu/standards/}.  The GNU Coding Standards are available
+-there in several different formats: @file{standards.text},
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">+- at file</A>{standards.info}, and @file{standards.dvi}, as well as the
+-Texinfo ``source'' which is divided in two files:
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">+- at file</A>{standards.texi} and @file{make-stds.texi}.  The GNU Coding
+-Standards are also available on the GNU World Wide Web server:
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">+- at uref</A>{<A HREF="http://www.gnu.org/prep/standards_toc.html">http://www.gnu.org/prep/standards_toc.html</A>}.
++recently, please check for a newer version.  You can get the GNU
++Coding Standards from the GNU web server in many
++different formats, including the Texinfo source, PDF, HTML, DVI, plain
++text, and more, at: @uref{<A HREF="http://www.gnu.org/prep/standards/">http://www.gnu.org/prep/standards/</A>}.
+ 
+ Corrections or suggestions for this document should be sent to
+ @email{bug-standards@@gnu.org}.  If you make a suggestion, please include a
+@@ -129,11 +116,15 @@ be self-consistent---try to stick to the
+ to document them as much as possible.  That way, your program will be
+ more maintainable by others.
+ 
++The GNU Hello program serves as an example of how to follow the GNU
++coding standards for a trivial program which prints @samp{Hello,
++world!}.  @uref{<A HREF="http://www.gnu.org/software/hello/hello.html">http://www.gnu.org/software/hello/hello.html</A>}.
++
+ @node Legal Issues
+ @chapter Keeping Free Software Free
+ @cindex legal aspects
+ 
+-This @value{CHAPTER} discusses how you can make sure that GNU software
++This chapter discusses how you can make sure that GNU software
+ avoids legal difficulties, and other related issues.
+ 
+ @menu
+@@ -211,7 +202,7 @@ You might have to take that code out aga
+ You don't need papers for changes of a few lines here or there, since
+ they are not significant for copyright purposes.  Also, you don't need
+ papers if all you get from the suggestion is some ideas, not actual code
+-which you use.  For example, if someone send you one implementation, but
++which you use.  For example, if someone sent you one implementation, but
+ you write a different implementation of the same idea, you don't need to
+ get papers.
+ 
+@@ -221,7 +212,8 @@ result.
+ 
+ We have more detailed advice for maintainers of programs; if you have
+ reached the stage of actually maintaining a program for GNU (whether
+-released or not), please ask us for a copy.
++released or not), please ask us for a copy.  It is also available
++online for your perusal: @uref{<A HREF="http://www.gnu.org/prep/maintain/">http://www.gnu.org/prep/maintain/</A>}.
+ 
+ @node Trademarks
+ @section Trademarks
+@@ -232,24 +224,33 @@ packages or documentation.
+ 
+ Trademark acknowledgements are the statements that such-and-such is a
+ trademark of so-and-so.  The GNU Project has no objection to the basic
+-idea of trademarks, but these acknowledgements feel like kowtowing, so
+-we don't use them.  There is no legal requirement for them.
++idea of trademarks, but these acknowledgements feel like kowtowing, 
++and there is no legal requirement for them, so we don't use them.
+ 
+ What is legally required, as regards other people's trademarks, is to
+-avoid using them in ways which a reader might read as naming or labeling
+-our own programs or activities.  For example, since ``Objective C'' is
+-(or at least was) a trademark, we made sure to say that we provide a
+-``compiler for the Objective C language'' rather than an ``Objective C
+-compiler''.  The latter is meant to be short for the former, but it does
+-not explicitly state the relationship, so it could be misinterpreted as
+-using ``Objective C'' as a label for the compiler rather than for the
+-language.
++avoid using them in ways which a reader might reasonably understand as
++naming or labeling our own programs or activities.  For example, since
++``Objective C'' is (or at least was) a trademark, we made sure to say
++that we provide a ``compiler for the Objective C language'' rather
++than an ``Objective C compiler''.  The latter would have been meant as
++a shorter way of saying the former, but it does not explicitly state
++the relationship, so it could be misinterpreted as using ``Objective
++C'' as a label for the compiler rather than for the language.
++
++Please don't use ``win'' as an abbreviation for Microsoft Windows in
++GNU software or documentation.  In hacker terminology, calling
++something a ``win'' is a form of praise.  If you wish to praise
++Microsoft Windows when speaking on your own, by all means do so, but
++not in GNU software.  Usually we write the name ``Windows'' in full,
++but when brevity is very important (as in file names and sometimes
++symbol names), we abbreviate it to ``w''.  For instance, the files and
++functions in Emacs that deal with Windows start with @samp{w32}.
+ 
+ @node Design Advice
+ @chapter General Program Design
+ @cindex program design
+ 
+-This @value{CHAPTER} discusses some of the issues you should take into
++This chapter discusses some of the issues you should take into
+ account when designing your program.
+ 
+ @c                         Standard or ANSI C
+@@ -263,7 +264,7 @@ account when designing your program.
+ @c A major revision of the C Standard appeared in 1999.
+ 
+ @menu
+-* Source Language::             Which languges to use.
++* Source Language::             Which languages to use.
+ * Compatibility::               Compatibility with other implementations
+ * Using Extensions::            Using non-standard features
+ * Standard C::                  Using Standard C features
+@@ -272,7 +273,7 @@ account when designing your program.
+ 
+ @node Source Language
+ @section Which Languages to Use
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">+- at cindex</A> programming languges
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">++ at cindex</A> programming languages
+ 
+ When you want to use a language that gets compiled and runs at high
+ speed, the best language to use is C.  Using another language is like
+@@ -476,6 +477,7 @@ For example, please write
+     ...
+ @end smallexample
+ 
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">++ at noindent</A>
+ instead of:
+ 
+ @smallexample
+@@ -488,11 +490,12 @@ instead of:
+ 
+ A modern compiler such as GCC will generate exactly the same code in
+ both cases, and we have been using similar techniques with good success
+-in several projects.
++in several projects.  Of course, the former method assumes that
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">++ at code</A>{HAS_FOO} is defined as either 0 or 1.
+ 
+ While this is not a silver bullet solving all portability problems,
+-following this policy would have saved the GCC project alone many person
+-hours if not days per year.
++and is not always appropriate, following this policy would have saved
++GCC developers many hours, or even days, per year.
+ 
+ In the case of function-like macros like @code{REVERSIBLE_CC_MODE} in
+ GCC which cannot be simply used in @code{if( ...)} statements, there is
+@@ -510,7 +513,7 @@ an easy workaround.  Simply introduce an
+ @node Program Behavior
+ @chapter Program Behavior for All Programs
+ 
+-This @value{CHAPTER} describes conventions for writing robust
++This chapter describes conventions for writing robust
+ software.  It also describes general standards for error messages, the
+ command line interface, and how libraries should behave.
+ 
+@@ -679,10 +682,12 @@ Error messages from compilers should loo
+ @end example
+ 
+ @noindent
+-If you want to mention the column number, use this format:
++If you want to mention the column number, use one of these formats:
+ 
+ @example
+ @var{source-file-name}:@var{lineno}:@var{column}: @var{message}
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">++ at var</A>{source-file-name}:@var{lineno}<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">. at var</A>{column}: @var{message}   
++
+ @end example
+ 
+ @noindent
+@@ -692,6 +697,24 @@ of these conventions are chosen for comp
+ numbers assuming that space and all ASCII printing characters have
+ equal width, and assuming tab stops every 8 columns.
+ 
++The error message can also give both the starting and ending positions
++of the erroneous text.  There are several formats so that you can
++avoid redundant information such as a duplicate line number.
++Here are the possible formats:
++
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">++ at example</A>
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">++ at var</A>{source-file-name}:@var{lineno-1}<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">. at var</A>{column-1}<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">- at var</A>{lineno-2}<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">. at var</A>{column-2}: @var{message}
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">++ at var</A>{source-file-name}:@var{lineno-1}<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">. at var</A>{column-1}<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">- at var</A>{column-2}: @var{message}
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">++ at var</A>{source-file-name}:@var{lineno-1}<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">- at var</A>{lineno-2}: @var{message}
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">++ at end</A> example
++
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">++ at noindent</A>
++When an error is spread over several files, you can use this format:
++
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">++ at example</A>
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">++ at var</A>{file-1}:@var{lineno-1}<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">. at var</A>{column-1}<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">- at var</A>{file-2}:@var{lineno-2}<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">. at var</A>{column-2}: @var{message}
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">++ at end</A> example
++
+ Error messages from other noninteractive programs should look like this:
+ 
+ @example
+@@ -722,8 +745,9 @@ input from a source other than a termina
+ would do best to print error messages using the noninteractive style.)
+ 
+ The string @var{message} should not begin with a capital letter when
+-it follows a program name and/or file name.  Also, it should not end
+-with a period.
++it follows a program name and/or file name, because that isn't the
++beginning of a sentence.  (The sentence conceptually starts at the
++beginning of the line.)  Also, it should not end with a period.
+ 
+ Error messages from interactive programs, and other messages such as
+ usage messages, should start with a capital letter.  But they should not
+@@ -767,9 +791,9 @@ multi-column format.
+ @section Standards for Graphical Interfaces
+ @cindex graphical user interface
+ 
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">+- at cindex</A> gtk
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">++ at cindex</A> gtk+
+ When you write a program that provides a graphical user interface,
+-please make it work with X Windows and the GTK toolkit unless the
++please make it work with X Windows and the GTK+ toolkit unless the
+ functionality specifically requires some alternative (for example,
+ ``displaying jpeg images while in console mode'').
+ 
+@@ -819,8 +843,15 @@ option as another way to specify it.  Th
+ among GNU utilities, and fewer idiosyncracies for users to remember.
+ 
+ @cindex standard command-line options
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">++ at cindex</A> options, standard command-line
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">++ at cindex</A> CGI programs, standard options for
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">++ at cindex</A> PATH_INFO, specifying standard options as
+ All programs should support two standard options: @samp{--version}
+-and @samp{--help}.
++and @samp{--help}.  CGI programs should accept these as command-line
++options, and also if given as the @env{PATH_INFO}; for instance,
++visiting @url{<A HREF="http://example.org/p.cgi/--help">http://example.org/p.cgi/--help</A>} in a browser should
++output the same information as invoking @samp{p.cgi --help} from the
++command line.
+ 
+ @table @code
+ @cindex @samp{--version} option
+@@ -1461,9 +1492,7 @@ Used in @code{gawk}.
+ Used in @code{su}.
+ 
+ @item machine
+-No listing of which programs already use this;
+-someone should check to
+-see if any actually do, and tell @email{gnu@@gnu.org}.
++Used in @code{uname}.
+ 
+ @item macro-name
+ @samp{-M} in @code{ptx}.
+@@ -1573,6 +1602,9 @@ Used in GDB.
+ @item no-sort
+ @samp{-p} in @code{nm}.
+ 
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">++ at item</A> no-splash
++Don't print a startup splash screen.
++
+ @item no-split
+ Used in @code{makeinfo}.
+ 
+@@ -1740,7 +1772,7 @@ Specify an HTTP proxy.
+ @samp{-q} in Make.
+ 
+ @item quiet
+-Used in many programs to inhibit the usual output.  @strong{Note:} every
++Used in many programs to inhibit the usual output.  Every
+ program accepting @samp{--quiet} should accept @samp{--silent} as a
+ synonym.
+ 
+@@ -1855,7 +1887,7 @@ Used by @code{recode} to chose files or 
+ 
+ @item silent
+ Used in many programs to inhibit the usual output.
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">+- at strong</A>{Note:} every program accepting
++Every program accepting
+ @samp{--silent} should accept @samp{--quiet} as a synonym.
+ 
+ @item size
+@@ -2098,7 +2130,7 @@ directory.
+ @node Writing C
+ @chapter Making The Best Use of C
+ 
+-This @value{CHAPTER} provides advice on how best to use the C language
++This chapter provides advice on how best to use the C language
+ when writing GNU software.
+ 
+ @menu
+@@ -2128,13 +2160,12 @@ These tools will not work on code not fo
+ It is also important for function definitions to start the name of the
+ function in column zero.  This helps people to search for function
+ definitions, and may also help certain tools recognize them.  Thus,
+-the proper format is this:
++using Standard C syntax, the format is this:
+ 
+ @example
+ static char *
+-concat (s1, s2)        /* Name starts in column zero here */
+-     char *s1, *s2;
+-@{                     /* Open brace in column zero here */
++concat (char *s1, char *s2)
++@{
+   @dots{}
+ @}
+ @end example
+@@ -2145,8 +2176,9 @@ this:
+ 
+ @example
+ static char *
+-concat (char *s1, char *s2)
+-@{
++concat (s1, s2)        /* Name starts in column zero here */
++     char *s1, *s2;
++@{                     /* Open brace in column zero here */
+   @dots{}
+ @}
+ @end example
+@@ -2383,7 +2415,7 @@ functions.
+ @cindex temporary variables
+ It used to be common practice to use the same local variables (with
+ names like @code{tem}) over and over for different values within one
+-function.  Instead of doing this, it is better declare a separate local
++function.  Instead of doing this, it is better to declare a separate local
+ variable for each distinct purpose, and give it a name which is
+ meaningful.  This not only makes programs easier to understand, it also
+ facilitates optimization by good compilers.  You can also move the
+@@ -2584,11 +2616,20 @@ Avoid using the format of semi-internal 
+ when there is a higher-level alternative (@code{readdir}).
+ 
+ @cindex <A HREF="http://lists.repoforge.org/mailman/listinfo/commits">non- at sc</A>{posix} systems, and portability
+-As for systems that are not like Unix, such as MSDOS, Windows, the
+-Macintosh, VMS, and MVS, supporting them is often a lot of work.  When
+-that is the case, it is better to spend your time adding features that
+-will be useful on GNU and GNU/Linux, rather than on supporting other
+-incompatible systems.
++As for systems that are not like Unix, such as MSDOS, Windows, VMS,
++MVS, and older Macintosh systems, supporting them is often a lot of
++work.  When that is the case, it is better to spend your time adding
++features that will be useful on GNU and GNU/Linux, rather than on
++supporting other incompatible systems.
++
++If you do support Windows, please do not abbreviate it as ``win''.  In
++hacker terminology, calling something a ``win'' is a form of praise.
++You're free to praise Microsoft Windows on your own if you want, but
++please don't do this in GNU packages.  Instead of abbreviating
++``Windows'' to ``un'', you can write it in full or abbreviate it to
++``woe'' or ``w''.  In GNU Emacs, for instance, we use @samp{w32} in
++file names of Windows-specific files, but the macro for Windows
++conditionals is called @code{WINDOWSNT}.
+ 
+ It is a good idea to define the ``feature test macro''
+ @code{_GNU_SOURCE} when compiling your C files.  When you compile on GNU
+@@ -2644,37 +2685,50 @@ while ((c = getchar()) != EOF)
+   write(file_descriptor, &amp;c, 1);
+ @end example
+ 
+-When calling functions, you need not worry about the difference between
+-pointers of various types, or between pointers and integers.  On most
+-machines, there's no difference anyway.  As for the few machines where
+-there is a difference, all of them support Standard C prototypes, so you can
+-use prototypes (perhaps conditionalized to be active only in Standard C)
+-to make the code work on those systems.
+-
+-In certain cases, it is ok to pass integer and pointer arguments
+-indiscriminately to the same function, and use no prototype on any
+-system.  For example, many GNU programs have error-reporting functions
+-that pass their arguments along to @code{printf} and friends:
+-
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">+- at example</A>
+-error (s, a1, a2, a3)
+-     char *s;
+-     char *a1, *a2, *a3;
+-@{
+-  fprintf (stderr, &quot;error: &quot;);
+-  fprintf (stderr, s, a1, a2, a3);
+-@}
++It used to be ok to not worry about the difference between pointers
++and integers when passing arguments to functions.  However, on most
++modern 64-bit machines pointers are wider than @code{int}.
++Conversely, integer types like @code{long long int} and @code{off_t}
++are wider than pointers on most modern 32-bit machines.  Hence it's
++often better nowadays to use prototypes to define functions whose
++argument types are not trivial.
++
++In particular, if functions accept varying argument counts or types
++they should be declared using prototypes containing @samp{...} and
++defined using @file{stdarg.h}.  For an example of this, please see the
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">++ at uref</A>{<A HREF="http://www.gnu.org/software/gnulib/,">http://www.gnu.org/software/gnulib/,</A> Gnulib} error module, which
++declares and defines the following function:
++
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">++ at example</A>
++/* Print a message with `fprintf (stderr, FORMAT, ...)';
++   if ERRNUM is nonzero, follow it with &quot;: &quot; and strerror (ERRNUM).
++   If STATUS is nonzero, terminate the program with `exit (STATUS)'.  */
++
++void error (int status, int errnum, const char *format, ...);
+ @end example
+ 
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">+- at noindent</A>
+-In practice, this works on all machines, since a pointer is generally
+-the widest possible kind of argument; it is much simpler than any
+-``correct'' alternative.  Be sure @emph{not} to use a prototype for such
+-functions.
++A simple way to use the Gnulib error module is to obtain the two
++source files @file{error.c} and @file{error.h} from the Gnulib library
++source code repository at
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">++ at uref</A>{<A HREF="http://savannah.gnu.org/cgi-bin/viewcvs/gnulib/gnulib/lib/">http://savannah.gnu.org/cgi-bin/viewcvs/gnulib/gnulib/lib/</A>}.
++Here's a sample use:
+ 
+-If you have decided to use Standard C, then you can instead define
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">+- at code</A>{error} using @file{stdarg.h}, and pass the arguments along to
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">+- at code</A>{vfprintf}.
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">++ at example</A>
++#include &quot;error.h&quot;
++#include &lt;errno.h&gt;
++#include &lt;stdio.h&gt;
++
++char *program_name = &quot;myprogram&quot;;
++
++FILE *
++xfopen (char const *name)
++@{
++  FILE *fp = fopen (name, &quot;r&quot;);
++  if (! fp)
++    error (1, errno, &quot;cannot read %s&quot;, name);
++  return fp;
++@}
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">++ at end</A> example
+ 
+ @cindex casting pointers to integers
+ Avoid casting pointers to integers if you can.  Such casts greatly
+@@ -3000,10 +3054,13 @@ together, we can make the whole subject 
+ 
+ The manual which discusses a program should certainly document all of
+ the program's command-line options and all of its commands.  It should
+-give examples of their use.  But don't organize the manual as a list of
+-features.  Instead, organize it logically, by subtopics.  Address the
+-questions that a user will ask when thinking about the job that the
+-program does.
++give examples of their use.  But don't organize the manual as a list
++of features.  Instead, organize it logically, by subtopics.  Address
++the questions that a user will ask when thinking about the job that
++the program does.  Don't just tell the reader what each feature can
++do---say what jobs it is good for, and show how to use it for those
++jobs.  Explain what is recommended usage, and what kinds of usage
++users should avoid.
+ 
+ In general, a GNU manual should serve both as tutorial and reference.
+ It should be set up for convenient access to each topic through Info,
+@@ -3030,9 +3087,9 @@ functions, variables, options, and impor
+ the program.  One combined Index should do for a short manual, but
+ sometimes for a complex package it is better to use multiple indices.
+ The Texinfo manual includes advice on preparing good index entries, see
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">+- at ref</A>{Index Entries, , Making Index Entries, texinfo, The GNU Texinfo
+-Manual}, and see @ref{Indexing Commands, , Defining the Entries of an
+-Index, texinfo, The GNU Texinfo manual}.
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">++ at ref</A>{Index Entries, , Making Index Entries, texinfo, GNU Texinfo}, and
++see @ref{Indexing Commands, , Defining the Entries of an
++Index, texinfo, GNU Texinfo}.
+ 
+ Don't use Unix man pages as a model for how to write GNU documentation;
+ most of them are terse, badly structured, and give inadequate
+@@ -3041,15 +3098,15 @@ exceptions.)  Also, Unix man pages use a
+ different from what we use in GNU manuals.
+ 
+ Please include an email address in the manual for where to report
+-bugs @emph{in the manual}.
++bugs @emph{in the text of the manual}.
+ 
+ Please do not use the term ``pathname'' that is used in Unix
+ documentation; use ``file name'' (two words) instead.  We use the term
+ ``path'' only for search paths, which are lists of directory names.
+ 
+-Please do not use the term ``illegal'' to refer to erroneous input to a
+-computer program.  Please use ``invalid'' for this, and reserve the term
+-``illegal'' for activities punishable by law.
++Please do not use the term ``illegal'' to refer to erroneous input to
++a computer program.  Please use ``invalid'' for this, and reserve the
++term ``illegal'' for activities prohibited by law.
+ 
+ @node Doc Strings and Manuals
+ @section Doc Strings and Manuals
+@@ -3092,7 +3149,7 @@ Each program documented in the manual sh
+ @samp{@var{program} Invocation} or @samp{Invoking @var{program}}.  This
+ node (together with its subnodes, if any) should describe the program's
+ command line arguments and how to run it (the sort of information people
+-would look in a man page for).  Start with an @samp{@@example}
++would look for in a man page).  Start with an @samp{@@example}
+ containing a template for all the options and arguments that the program
+ uses.
+ 
+@@ -3210,6 +3267,11 @@ code.  For example, ``New function'' is 
+ you add a function, because there should be a comment before the
+ function definition to explain what it does.
+ 
++In the past, we recommended not mentioning changes in non-software
++files (manuals, help files, etc.) in change logs.  However, we've been
++advised that it is a good idea to include them, for the sake of
++copyright records.
++
+ However, sometimes it is useful to write one line to describe the
+ overall purpose of a batch of changes.
+ 
+@@ -3224,9 +3286,9 @@ Then describe the changes you made to th
+ @cindex change logs, style
+ 
+ Here are some simple examples of change log entries, starting with the
+-header line that says who made the change and when, followed by
+-descriptions of specific changes.  (These examples are drawn from Emacs
+-and GCC.)
++header line that says who made the change and when it was installed,
++followed by descriptions of specific changes.  (These examples are
++drawn from Emacs and GCC.)
+ 
+ @example
+ 1998-08-17  Richard Stallman  &lt;rms@@gnu.org&gt;
+@@ -3270,6 +3332,27 @@ Break long lists of function names by cl
+ (Fexecute_extended_command): Deal with `keymap' property.
+ @end example
+ 
++When you install someone else's changes, put the contributor's name in
++the change log entry rather than in the text of the entry.  In other
++words, write this:
++
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">++ at example</A>
++2002-07-14  John Doe  &lt;jdoe@@gnu.org&gt;
++
++        * sewing.c: Make it sew.
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">++ at end</A> example
++
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">++ at noindent</A>
++rather than this:
++
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">++ at example</A>
++2002-07-14  Usual Maintainer  &lt;usual@@gnu.org&gt;
++
++        * sewing.c: Make it sew.  Patch by jdoe@@gnu.org.
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">++ at end</A> example
++
++As for the date, that should be the date you applied the change.
++
+ @node Simple Changes
+ @subsection Simple Changes
+ 
+@@ -3291,12 +3374,17 @@ When you change just comments or doc str
+ entry for the file, without mentioning the functions.  Just ``Doc
+ fixes'' is enough for the change log.
+ 
+-There's no need to make change log entries for documentation files.
+-This is because documentation is not susceptible to bugs that are hard
+-to fix.  Documentation does not consist of parts that must interact in a
+-precisely engineered fashion.  To correct an error, you need not know
+-the history of the erroneous passage; it is enough to compare what the
+-documentation says with the way the program actually works.
++There's no technical need to make change log entries for documentation
++files.  This is because documentation is not susceptible to bugs that
++are hard to fix.  Documentation does not consist of parts that must
++interact in a precisely engineered fashion.  To correct an error, you
++need not know the history of the erroneous passage; it is enough to
++compare what the documentation says with the way the program actually
++works.
++
++However, you should keep change logs for documentation files when the
++project gets copyright assignments from its contributors, so as to
++make the records of authorship more accurate.
+ 
+ @node Conditional Changes
+ @subsection Conditional Changes
+@@ -3387,6 +3475,25 @@ page explaining that you don't maintain 
+ is more authoritative.  The note should say how to access the Texinfo
+ documentation.
+ 
++Be sure that man pages include a copyright statement and free
++license.  The simple all-permissive license is appropriate for simple
++man pages:
++
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">++ at example</A>
++Copying and distribution of this file, with or without modification,
++are permitted in any medium without royalty provided the copyright
++notice and this notice are preserved.
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">++ at end</A> example
++
++For long man pages, with enough explanation and documentation that
++they can be considered true manuals, use the GFDL (@pxref{License for
++Manuals}).
++
++Finally, the GNU help2man program
++(@uref{<A HREF="http://www.gnu.org/software/help2man/">http://www.gnu.org/software/help2man/</A>}) is one way to automate
++generation of a man page, in this case from @option{--help} output.
++This is sufficient in many cases.
++
+ @node Reading other Manuals
+ @section Reading other Manuals
+ 
+@@ -3486,19 +3593,26 @@ this:
+ @var{cpu}<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">- at var</A>{company}<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">- at var</A>{system}
+ @end example
+ 
+-For example, a Sun 3 might be @samp{m68k-sun-sunos4.1}.
++For example, an Athlon-based GNU/Linux system might be
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">++ at samp</A>{i686-pc-linux-gnu}.
+ 
+ The @code{configure} script needs to be able to decode all plausible
+-alternatives for how to describe a machine.  Thus, @samp{sun3-sunos4.1}
+-would be a valid alias.  For many programs, @samp{vax-dec-ultrix} would
+-be an alias for @samp{vax-dec-bsd}, simply because the differences
+-between Ultrix and @sc{bsd} are rarely noticeable, but a few programs
+-might need to distinguish them.
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">+- at c</A> Real 4.4BSD now runs on some Suns.
+-
+-There is a shell script called @file{config.sub} that you can use
++alternatives for how to describe a machine.  Thus,
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">++ at samp</A>{athlon-pc-gnu/linux} would be a valid alias.
++There is a shell script called
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">++ at uref</A>{<A HREF="ftp://ftp.gnu.org/gnu/config/config.sub,">ftp://ftp.gnu.org/gnu/config/config.sub,</A> @file{config.sub}}
++that you can use
+ as a subroutine to validate system types and canonicalize aliases.
+ 
++The @code{configure} script should also take the option
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">++ at option</A>{--build=@var{buildtype}}, which should be equivalent to a
++plain @var{buildtype} argument.  For example, @samp{configure
++--build=i686-pc-linux-gnu} is equivalent to @samp{configure
++i686-pc-linux-gnu}.  When the build type is not specified by an option
++or argument, the @code{configure} script should normally guess it
++using the shell script
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">++ at uref</A>{<A HREF="ftp://ftp.gnu.org/gnu/config/config.guess,">ftp://ftp.gnu.org/gnu/config/config.guess,</A> @file{config.guess}}.
++
+ @cindex optional features, configure-time
+ Other options are permitted to specify in more detail the software
+ or hardware present on the machine, and include or exclude optional
+@@ -3558,6 +3672,11 @@ The @code{configure} script should norma
+ system as both the host and the target, thus producing a program which
+ works for the same type of machine that it runs on.
+ 
++To compile a program to run on a host type that differs from the build
++type, use the configure option @option{--host=@var{hosttype}}, where
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">++ at var</A>{hosttype} uses the same syntax as @var{buildtype}.  The host type
++normally defaults to the build type.
++
+ To configure a cross-compiler, cross-assembler, or what have you, you
+ should specify a target different from the host, using the configure
+ option @samp{--target=@var{targettype}}.  The syntax for
+@@ -3565,22 +3684,14 @@ option @samp{--target=@var{targettype}}.
+ look like this:
+ 
+ @example
+-./configure @var{hosttype} --target=@var{targettype}
++./configure --host=@var{hosttype} --target=@var{targettype}
+ @end example
+ 
++The target type normally defaults to the host type.
+ Programs for which cross-operation is not meaningful need not accept the
+ @samp{--target} option, because configuring an entire operating system for
+ cross-operation is not a meaningful operation.
+ 
+-Bootstrapping a cross-compiler requires compiling it on a machine other
+-than the host it will run on.  Compilation packages accept a
+-configuration option @samp{--build=@var{buildtype}} for specifying the
+-configuration on which you will compile them, but the configure script
+-should normally guess the build machine type (using
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">+- at file</A>{config.guess}), so this option is probably not necessary.  The
+-host and target types normally default from the build type, so in
+-bootstrapping a cross-compiler you must specify them both explicitly.
+-
+ Some programs have ways of configuring themselves automatically.  If
+ your program is set up to do this, your @code{configure} script can simply
+ ignore most of its arguments.
+@@ -3596,6 +3707,10 @@ ignore most of its arguments.
+ @section Making Releases
+ @cindex packaging
+ 
++You should identify each release with a pair of version numbers, a
++major version and a minor.  We have no objection to using more than
++two numbers, but it is very unlikely that you really need them.
++
+ Package the distribution of @code{Foo version 69.96} up in a gzipped tar
+ file with the name @file{foo-69.96.tar.gz}.  It should unpack into a
+ subdirectory named @file{foo-69.96}.
+@@ -3644,13 +3759,6 @@ able to extract all the files even if th
+ 
+ Make sure that all the files in the distribution are world-readable.
+ 
+-Make sure that no file name in the distribution is more than 14
+-characters long.  Likewise, no file created by building the program
+-should have a name longer than 14 characters.  The reason for this is
+-that some systems adhere to a foolish interpretation of the @sc{posix}
+-standard, and refuse to open a longer name, rather than truncating as
+-they did in the past.
+-
+ Don't include any symbolic links in the distribution itself.  If the tar
+ file contains symbolic links, then people cannot even unpack it on
+ systems that don't support symbolic links.  Also, don't use multiple
+@@ -3682,16 +3790,27 @@ other files to get.
+ 
+ A GNU program should not recommend use of any non-free program.  We
+ can't stop some people from writing proprietary programs, or stop
+-other people from using them, but we can and should avoid helping to
++other people from using them, but we can and should refuse to
+ advertise them to new potential customers.  Proprietary software is a
+ social and ethical problem, and the point of GNU is to solve that
+ problem.
+ 
++The GNU definition of free software is found on the GNU web site at
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">++ at url</A>{<A HREF="http://www.gnu.org/philosophy/free-sw.html">http://www.gnu.org/philosophy/free-sw.html</A>}.  A list of
++important licenses and whether they qualify as free is in
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">++ at url</A>{<A HREF="http://www.gnu.org/licenses/license-list.html">http://www.gnu.org/licenses/license-list.html</A>}.  The terms
++``free'' and ``non-free'', used in this document, refer to that
++definition.  If it is not clear whether a license qualifies as free
++under this definition, please ask the GNU Project by writing to
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">++ at email</A>{licensing@@gnu.org}.  We will answer, and if the license is an
++important one, we will add it to the list.
++
+ When a non-free program or system is well known, you can mention it in
+ passing---that is harmless, since users who might want to use it
+ probably already know about it.  For instance, it is fine to explain
+-how to build your package on top of some non-free operating system, or
+-how to use it together with some widely used non-free program.
++how to build your package on top of some widely used non-free
++operating system, or how to use it together with some widely used
++non-free program.
+ 
+ However, you should give only the necessary information to help those
+ who already use the non-free program to use your program with
+@@ -3700,8 +3819,8 @@ proprietary program, and don't imply tha
+ enhances your program, or that its existence is in any way a good
+ thing.  The goal should be that people already using the proprietary
+ program will get the advice they need about how to use your free
+-program, while people who don't already use the proprietary program
+-will not see anything to lead them to take an interest in it.
++program with it, while people who don't already use the proprietary
++program will not see anything to lead them to take an interest in it.
+ 
+ If a non-free program or system is obscure in your program's domain,
+ your program should not mention or support it at all, since doing so
+@@ -3709,13 +3828,46 @@ would tend to popularize the non-free pr
+ your program.  (You cannot hope to find many additional users among
+ the users of Foobar if the users of Foobar are few.)
+ 
++Sometimes a program is free software in itself but depends on a
++non-free platform in order to run.  For instance, many Java programs
++depend on Sun's Java implementation, and won't run on the GNU Java
++Compiler (which does not yet have all the features) or won't run with
++the GNU Java libraries.  To recommend that program is inherently to
++recommend the non-free platform as well; if you should not do the
++latter, then don't do the former.
++
+ A GNU package should not refer the user to any non-free documentation
+ for free software.  Free documentation that can be included in free
+-operating systems is essential for completing the GNU system, so it is
+-a major focus of the GNU Project; to recommend use of documentation
+-that we are not allowed to use in GNU would undermine the efforts to
+-get documentation that we can include.  So GNU packages should never
+-recommend non-free documentation.
++operating systems is essential for completing the GNU system, or any
++free operating system, so it is a major focus of the GNU Project; to
++recommend use of documentation that we are not allowed to use in GNU
++would weaken the impetus for the community to produce documentation
++that we can include.  So GNU packages should never recommend non-free
++documentation.
++
++By contrast, it is ok to refer to journal articles and textbooks in
++the comments of a program for explanation of how it functions, even
++though they be non-free.  This is because we don't include such things
++in the GNU system even if we are allowed to--they are outside the
++scope of an operating system project.
++
++Referring to a web site that describes or recommends a non-free
++program is in effect promoting that software, so please do not make
++links (or mention by name) web sites that contain such material.  This
++policy is relevant particularly for the web pages for a GNU package.
++
++Following links from nearly any web site can lead to non-free
++software; this is an inescapable aspect of the nature of the web, and
++in itself is no objection to linking to a site.  As long as the site
++does not itself recommend a non-free program, there is no need be
++concerned about the sites it links to for other reasons.
++
++Thus, for example, you should not make a link to AT&amp;T's web site,
++because that recommends AT&amp;T's non-free software packages; you should
++not make a link to a site that links to AT&amp;T's site saying it is a
++place to get a non-free program; but if a site you want to link to
++refers to AT&amp;T's web site in some other context (such as long-distance
++telephone service), that is not a problem.
+ 
+ @node Copying This Manual
+ @appendix Copying This Manual
+@@ -3730,13 +3882,12 @@ recommend non-free documentation.
+ @unnumbered Index
+ @printindex cp
+ 
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">+- at contents</A>
+-
+ @bye
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">+- at c</A> Local variables:
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">+- at c</A> eval: (add-hook 'write-file-hooks 'time-stamp)
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">+- at c</A> time-stamp-start: &quot;@set lastupdate &quot;
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">+- at c</A> time-stamp-end: &quot;$&quot;
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">+- at c</A> time-stamp-format: &quot;%:b %:d, %:y&quot;
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">+- at c</A> compile-command: &quot;make just-standards&quot;
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">+- at c</A> End:
++
++Local variables:
++eval: (add-hook 'write-file-hooks 'time-stamp)
++time-stamp-start: &quot;@set lastupdate &quot;
++time-stamp-end: &quot;$&quot;
++time-stamp-format: &quot;%:b %:d, %:y&quot;
++compile-command: &quot;make just-standards&quot;
++End:

Added: branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-target-minix.patch
===================================================================
--- branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-target-minix.patch	                        (rev 0)
+++ branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-target-minix.patch	2008-06-09 23:18:27 UTC (rev 6350)
@@ -0,0 +1,614 @@
+diff -ruN binutils-2.17.50.0.6/bfd/config.bfd binutils-2.17.50.0.6.bs/bfd/config.bfd
+--- binutils-2.17.50.0.6/bfd/config.bfd	2006-10-20 20:50:57.000000000 +0200
++++ binutils-2.17.50.0.6.bs/bfd/config.bfd	2008-04-08 09:08:08.000000000 +0200
+@@ -638,6 +638,9 @@
+   i[3-7]86-none-*)
+     targ_defvec=i386coff_vec
+     ;;
++  i[3-7]86-*-minix)
++    targ_defvec=i386minix_vec
++    ;;
+   i[3-7]86-*-aout* | i[3-7]86*-*-vsta*)
+     targ_defvec=i386aout_vec
+     ;;
+diff -ruN binutils-2.17.50.0.6/bfd/configure binutils-2.17.50.0.6.bs/bfd/configure
+--- binutils-2.17.50.0.6/bfd/configure	2006-10-20 20:50:57.000000000 +0200
++++ binutils-2.17.50.0.6.bs/bfd/configure	2008-04-08 09:11:01.000000000 +0200
+@@ -10959,6 +10959,7 @@
+     i386lynx_aout_vec)		tb=&quot;$tb i386lynx.lo lynx-core.lo aout32.lo&quot; ;;
+     i386lynx_coff_vec)		tb=&quot;$tb cf-i386lynx.lo cofflink.lo lynx-core.lo&quot; ;;
+     i386mach3_vec)		tb=&quot;$tb i386mach3.lo aout32.lo&quot; ;;
++    i386minix_vec)		tb=&quot;$tb i386minix.lo&quot; ;;
+     i386msdos_vec)		tb=&quot;$tb i386msdos.lo&quot; ;;
+     i386netbsd_vec)		tb=&quot;$tb i386netbsd.lo aout32.lo&quot; ;;
+     i386os9k_vec)		tb=&quot;$tb i386os9k.lo aout32.lo&quot; ;;
+diff -ruN binutils-2.17.50.0.6/bfd/i386minix.c binutils-2.17.50.0.6.bs/bfd/i386minix.c
+--- binutils-2.17.50.0.6/bfd/i386minix.c	1970-01-01 01:00:00.000000000 +0100
++++ binutils-2.17.50.0.6.bs/bfd/i386minix.c	2008-04-08 09:29:27.000000000 +0200
+@@ -0,0 +1,325 @@
++/* BFD back-end for i386 minix a.out binaries.
++   Copyright 1990, 1991, 1992, 1994, 1996, 1997, 2001, 2002, 2003
++   Free Software Foundation, Inc.
++
++This file is part of BFD, the Binary File Descriptor library.
++
++This program is free software; you can redistribute it and/or modify
++it under the terms of the GNU General Public License as published by
++the Free Software Foundation; either version 2 of the License, or
++(at your option) any later version.
++
++This program is distributed in the hope that it will be useful,
++but WITHOUT ANY WARRANTY; without even the implied warranty of
++MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
++GNU General Public License for more details.
++
++You should have received a copy of the GNU General Public License
++along with this program; if not, write to the Free Software
++Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.  */
++
++/***************/
++/* EXEC FORMAT */
++/***************/
++#include &lt;a.out.h&gt;
++
++#define external_exec exec
++#define EXEC_BYTES_SIZE sizeof( struct exec )
++
++#define OMAGIC 0407		/* Object file or impure executable.  */
++#define NMAGIC 0410		/* Code indicating pure executable.  */
++#define ZMAGIC 0x0301	/* Code indicating demand-paged executable.  */
++#define BMAGIC 0415		/* Used by a b.out object.  */
++
++#ifndef QMAGIC
++#define QMAGIC 0314
++#endif
++# ifndef N_BADMAG
++#  define N_BADMAG(x)	  (N_MAGIC(x) != OMAGIC		\
++			&amp;&amp; N_MAGIC(x) != NMAGIC		\
++  			&amp;&amp; N_MAGIC(x) != ZMAGIC \
++		        &amp;&amp; N_MAGIC(x) != QMAGIC)
++# endif /* N_BADMAG */
++
++#define N_HEADER_IN_TEXT(x) 0
++
++#define N_TXTOFF(x) EXEC_BYTES_SIZE
++#define N_TXTADDR(x) 0
++
++#define N_TXTSIZE(x) ((x).a_text)
++#ifdef SUPPORT_SEP
++#define MINIX_IS_SEP(x) 0 /*-&gt; gcv.c HCLICK STUFF*/
++#define N_DATADDR(x) (MINIX_IS_SEP(x) ? align((x).a_text,HCLICK) : (x).a_text )
++#else
++#define N_DATADDR(x) ((x).a_text)
++#endif
++
++/* Are these values correct? */
++#define TARGET_PAGE_SIZE 1
++#define SEGMENT_SIZE 1
++
++#define DEFAULT_STACK 5 * 1024 * 1024 /* 5 MB stack */
++
++#define DEFAULT_ARCH bfd_arch_i386
++
++/* Do not &quot;beautify&quot; the CONCAT* macro args.  Traditional C will not
++   remove whitespace added here, and thus will fail to concatenate
++   the tokens.  */
++#define MY(OP) CONCAT2 (i386minix_,OP)
++#define NAME(a,b) i386minix_32_##b
++#define TARGETNAME &quot;a.out-i386-minix&quot;
++#define NO_WRITE_HEADER_KLUDGE 1
++
++#define ARCH_SIZE 32
++
++#include &quot;bfd.h&quot;
++#include &quot;sysdep.h&quot;
++/*#include &quot;libbfd.h&quot;*/
++#include &quot;aout/aout64.h&quot;
++#include &quot;libaout.h&quot;
++
++
++#define i386minix_32_get_section_contents _bfd_generic_get_section_contents
++
++#define SET_ARCH_MACH(abfd, exec) \
++	bfd_set_arch_mach(abfd, DEFAULT_ARCH, 0)
++
++static bfd_boolean i386minix_write_object_contents PARAMS ((bfd *));
++#define MY_write_object_contents i386minix_write_object_contents
++
++static int  MY(swap_exec_header_in)  PARAMS ((bfd *, struct external_exec *, struct internal_exec *));
++static void MY(swap_exec_header_out) PARAMS ((bfd *, struct internal_exec *, struct external_exec *));
++
++#define NAME_swap_exec_header_in	MY(swap_exec_header_in)
++#define NAME_swap_exec_header_out	MY(swap_exec_header_out)
++
++#define MY_object_p MY(object_p)
++static const bfd_target * MY(object_p) (bfd *);
++
++
++static bfd_boolean MY (set_sizes) PARAMS ((bfd *));
++
++#define MY_backend_data &amp;MY(backend_data)
++static const struct aout_backend_data MY(backend_data) = {
++  0,				/* zmagic contiguous */
++  1,				/* text incl header */
++  0,				/* entry is text address */
++  0,				/* exec_hdr_flags */
++  0,				/* text vma? */
++  MY(set_sizes),
++  1,				/* exec header not counted */
++  0,				/* add_dynamic_symbols */
++  0,				/* add_one_symbol */
++  0,				/* link_dynamic_object */
++  0,				/* write_dynamic_symbol */
++  0,				/* check_dynamic_reloc */
++  0				/* finish_dynamic_link */
++};
++
++#include &quot;aoutx.h&quot;
++
++#include &quot;aout-target.h&quot;
++
++/****************/
++/* WRITE HEADER */
++/****************/
++static void
++MY(swap_exec_header_out) (abfd, execp, bytes)
++     bfd *abfd;
++     struct internal_exec *execp;
++     struct external_exec *bytes;
++{
++  int total;
++  int stack;
++  
++  /* Now fill in fields in the raw data, from the fields in the exec struct.  */
++  H_PUT_16 (abfd, N_MAGIC(*execp), bytes-&gt;a_magic);
++  
++  bytes-&gt;a_flags = 0;
++  if ( bytes-&gt;a_syms )
++  	bytes-&gt;a_flags |= A_NSYM;
++
++  bytes-&gt;a_cpu = A_I80386;
++  
++  bytes-&gt;a_hdrlen = EXEC_BYTES_SIZE;
++  
++  bytes-&gt;a_unused = 0;
++  bytes-&gt;a_version = 0;
++  
++  PUT_WORD (abfd, execp-&gt;a_text  , &amp;bytes-&gt;a_text);
++  PUT_WORD (abfd, execp-&gt;a_data  , &amp;bytes-&gt;a_data);
++  PUT_WORD (abfd, execp-&gt;a_bss   , &amp;bytes-&gt;a_bss);
++  PUT_WORD (abfd, execp-&gt;a_entry , &amp;bytes-&gt;a_entry);
++  
++  stack = DEFAULT_STACK;
++  total = execp-&gt;a_data + execp-&gt;a_bss + stack;
++#if 0
++	if ( MINIX_IS_SEP( abfd ) )
++		bytes-&gt;a_flags |= A_SEP;
++	else
++#endif
++		total += execp-&gt;a_text;
++		
++  PUT_WORD (abfd, total          , &amp;bytes-&gt;a_total);		
++  PUT_WORD (abfd, execp-&gt;a_syms  , &amp;bytes-&gt;a_syms);
++  PUT_WORD (abfd, execp-&gt;a_trsize, &amp;bytes-&gt;a_trsize);
++  PUT_WORD (abfd, execp-&gt;a_drsize, &amp;bytes-&gt;a_drsize);
++  
++  bytes-&gt;a_tbase = bytes-&gt;a_dbase = 0;
++}
++
++#define i386minix_32_swap_exec_header_out MY(swap_exec_header_out)
++/* WRITE_HEADERS calls NAME(aout,swap_exec_header_out)
++   which I need to overwrite. Unfortunately aoutx.h doesn't have a
++   NAME_swap_exec_header_out like it does for -_in.
++   So I have to redefine the outcome of NAME(aout,swap_exec_header_out) to 
++   my own function before using WRITE_HEADERS */
++
++/* Set the machine type correctly.  */
++static bfd_boolean
++i386minix_write_object_contents (abfd)
++     bfd *abfd;
++{
++  struct external_exec exec_bytes;
++  struct internal_exec *execp = exec_hdr (abfd);
++
++  N_SET_MACHTYPE (*execp, M_386);
++  
++  obj_reloc_entry_size (abfd) = RELOC_STD_SIZE;
++
++  WRITE_HEADERS (abfd, execp);
++
++  return TRUE;
++}
++/* undo renaming to be able to include aoutx.h */
++#undef i386minix_32_swap_exec_header_out
++
++/***************/
++/* READ HEADER */
++/***************/
++/* define if aoutx.h is included: */
++/* UNTRUE: but including it generates a conflict with swap_exe_header_out, so don't include it */
++
++/* return -1 if header is wrong
++ * otherwise return the bytes left to read */
++static int
++MY(swap_exec_header_in) (abfd, bytes, execp)
++     bfd *abfd;
++     struct external_exec *bytes;
++     struct internal_exec *execp;
++{
++  /* The internal_exec structure has some fields that are unused in this
++     configuration (IE for i960), so ensure that all such uninitialized
++     fields are zero'd out.  There are places where two of these structs
++     are memcmp'd, and thus the contents do matter.  */
++  memset ((PTR) execp, 0, sizeof (struct internal_exec));
++  /* Now fill in fields in the execp, from the bytes in the raw data.  */
++  
++  /*fill a_info*/
++  N_SET_MAGIC(*execp, H_GET_16 (abfd, bytes-&gt;a_magic));
++  N_SET_MACHTYPE(*execp, M_386);
++  N_SET_FLAGS(*execp, 0);
++  
++  /*check integrity*/
++  if ( N_BADMAG( *execp ) )
++  	return -1;
++  
++  if ( bytes-&gt;a_cpu != A_I80386 )
++  	return -1;
++  	
++  if ( bytes-&gt;a_hdrlen &lt; A_MINHDR )
++  	return -1;
++  	
++#if 0
++	if ( bytes-&gt;a_flags &amp; A_SEP )
++		dosomething();
++#endif
++
++  /*fill the rest*/
++  execp-&gt;a_text   = GET_WORD (abfd, &amp;bytes-&gt;a_text);
++  execp-&gt;a_data   = GET_WORD (abfd, &amp;bytes-&gt;a_data);
++  execp-&gt;a_bss    = GET_WORD (abfd, &amp;bytes-&gt;a_bss);
++  execp-&gt;a_syms   = GET_WORD (abfd, &amp;bytes-&gt;a_syms);
++  execp-&gt;a_entry  = GET_WORD (abfd, &amp;bytes-&gt;a_entry);
++  
++  if ( bytes-&gt;a_hdrlen &lt; A_MINHDR + 2 * sizeof(long) )
++  	return bytes-&gt;a_hdrlen - A_MINHDR;
++
++  if (bfd_bread (&amp;bytes-&gt;a_trsize, 2 * sizeof(long), abfd) != 2 * sizeof(long))
++  	return -1;
++    
++  execp-&gt;a_trsize = GET_WORD (abfd, &amp;bytes-&gt;a_trsize);
++  execp-&gt;a_drsize = GET_WORD (abfd, &amp;bytes-&gt;a_drsize);
++
++  bfd_seek (abfd, -2 * sizeof(long), SEEK_CUR);  
++  
++  /*store other fields of external_exec?*/
++  return bytes-&gt;a_hdrlen - A_MINHDR;
++}
++
++static const bfd_target *
++MY(object_p) (abfd)
++     bfd *abfd;
++{
++  struct external_exec exec_bytes;	/* Raw exec header from file */
++  struct internal_exec exec;		/* Cleaned-up exec header */
++  const bfd_target *target;
++  int left;
++  bfd_size_type amt = A_MINHDR;
++  
++  if (bfd_bread ((PTR) &amp;exec_bytes, amt, abfd) != amt)
++    {
++      if (bfd_get_error () != bfd_error_system_call)
++	bfd_set_error (bfd_error_wrong_format);
++	
++      return 0;
++    }
++
++  /* let MY(swap_exec_header_in) check the header */
++  if ( (left = MY(swap_exec_header_in) (abfd, &amp;exec_bytes, &amp;exec)) == -1 )
++  {
++  	/* incorrect header */
++  	return 0;
++  }
++
++  /* skip rest of header */
++  if ( bfd_seek( abfd, left, SEEK_CUR ) )
++  	return 0;
++  
++  target = NAME(aout,some_aout_object_p) (abfd, &amp;exec, MY(callback));
++
++  int adjust = (A_MINHDR + left) - EXEC_BYTES_SIZE;
++  
++  /* adjust file positions with the bytes left to be read from the header */
++  obj_textsec (abfd)-&gt;filepos += adjust;
++  obj_datasec (abfd)-&gt;filepos += adjust;
++  
++  obj_textsec (abfd)-&gt;rel_filepos += adjust;
++  obj_datasec (abfd)-&gt;rel_filepos += adjust;
++  
++  obj_sym_filepos (abfd) += adjust;
++  obj_str_filepos (abfd) += adjust;
++
++  adata(abfd).exec_bytes_size = A_MINHDR + left;
++      
++#ifdef ENTRY_CAN_BE_ZERO
++  /* The NEWSOS3 entry-point is/was 0, which (amongst other lossage)
++   * means that it isn't obvious if EXEC_P should be set.
++   * All of the following must be true for an executable:
++   * There must be no relocations, the bfd can be neither an
++   * archive nor an archive element, and the file must be executable.  */
++
++  if (exec.a_trsize + exec.a_drsize == 0
++      &amp;&amp; bfd_get_format(abfd) == bfd_object &amp;&amp; abfd-&gt;my_archive == NULL)
++    {
++      struct stat buf;
++#ifndef S_IXUSR
++#define S_IXUSR 0100	/* Execute by owner.  */
++#endif
++      if (stat(abfd-&gt;filename, &amp;buf) == 0 &amp;&amp; (buf.st_mode &amp; S_IXUSR))
++	abfd-&gt;flags |= EXEC_P;
++    }
++#endif /* ENTRY_CAN_BE_ZERO */
++
++  return target;
++}
+diff -ruN binutils-2.17.50.0.6/bfd/targets.c binutils-2.17.50.0.6.bs/bfd/targets.c
+--- binutils-2.17.50.0.6/bfd/targets.c	2006-10-20 20:50:58.000000000 +0200
++++ binutils-2.17.50.0.6.bs/bfd/targets.c	2008-04-08 09:10:13.000000000 +0200
+@@ -706,6 +706,7 @@
+ extern const bfd_target i386lynx_aout_vec;
+ extern const bfd_target i386lynx_coff_vec;
+ extern const bfd_target i386mach3_vec;
++extern const bfd_target i386minix_vec;
+ extern const bfd_target i386msdos_vec;
+ extern const bfd_target i386netbsd_vec;
+ extern const bfd_target i386os9k_vec;
+diff -ruN binutils-2.17.50.0.6/gas/configure binutils-2.17.50.0.6.bs/gas/configure
+--- binutils-2.17.50.0.6/gas/configure	2006-10-20 20:50:58.000000000 +0200
++++ binutils-2.17.50.0.6.bs/gas/configure	2008-04-08 09:41:46.000000000 +0200
+@@ -4866,6 +4866,8 @@
+       # for the default linux configuration
+       # i386-*-linux*-elf) emulation=&quot;i386elf i386aout&quot; ;;
+       #
++
++      i386-*-minix-aout) ;;
+       i386-*-aout)	emulation=&quot;i386aout&quot; ;;
+       i386-*-coff)	emulation=&quot;i386coff&quot; ;;
+       i386-*-elf)	emulation=&quot;i386elf&quot; ;;
+diff -ruN binutils-2.17.50.0.6/gas/configure.tgt binutils-2.17.50.0.6.bs/gas/configure.tgt
+--- binutils-2.17.50.0.6/gas/configure.tgt	2006-09-24 17:19:58.000000000 +0200
++++ binutils-2.17.50.0.6.bs/gas/configure.tgt	2008-04-08 09:42:12.000000000 +0200
+@@ -216,6 +216,7 @@
+   i386-*-nto-qnx*)			fmt=elf ;;
+   i386-*-*nt*)				fmt=coff em=pe ;;
+   i386-*-chaos)				fmt=elf ;;
++  i386-*-minix)				fmt=aout em=minix ;;
+   i386-*-rdos*)				fmt=elf ;;
+ 
+   i860-*-*)				fmt=elf endian=little ;;
+diff -ruN binutils-2.17.50.0.6/ld/Makefile.in binutils-2.17.50.0.6.bs/ld/Makefile.in
+--- binutils-2.17.50.0.6/ld/Makefile.in	2006-10-20 20:50:59.000000000 +0200
++++ binutils-2.17.50.0.6.bs/ld/Makefile.in	2008-04-08 09:46:22.000000000 +0200
+@@ -457,6 +457,7 @@
+ 	ei386linux.o \
+ 	ei386lynx.o \
+ 	ei386mach.o \
++	ei386minix.o \
+ 	ei386moss.o \
+ 	ei386msdos.o \
+ 	ei386nbsd.o \
+@@ -1896,6 +1897,9 @@
+ ei386mach.c: $(srcdir)/emulparams/i386mach.sh \
+   $(srcdir)/emultempl/generic.em $(srcdir)/scripttempl/aout.sc ${GEN_DEPENDS}
+ 	${GENSCRIPTS} i386mach &quot;$(tdir_i386mach)&quot;
++ei386minix.c: $(srcdir)/emulparams/i386minix.sh \
++  $(srcdir)/emultempl/generic.em $(srcdir)/scripttempl/aout.sc ${GEN_DEPENDS}
++	${GENSCRIPTS} i386minix &quot;$(tdir_i386minix)&quot;
+ ei386moss.c: $(srcdir)/emulparams/i386moss.sh \
+   $(ELF_DEPS) $(srcdir)/scripttempl/elf.sc ${GEN_DEPENDS}
+ 	${GENSCRIPTS} i386moss &quot;$(tdir_i386moss)&quot;
+diff -ruN binutils-2.17.50.0.6/ld/configure.tgt binutils-2.17.50.0.6.bs/ld/configure.tgt
+--- binutils-2.17.50.0.6/ld/configure.tgt	2006-10-20 20:50:59.000000000 +0200
++++ binutils-2.17.50.0.6.bs/ld/configure.tgt	2008-04-08 09:50:28.000000000 +0200
+@@ -145,6 +145,7 @@
+ i[3-7]86-*-bsd386)	targ_emul=i386bsd ;;
+ i[3-7]86-*-bsdi*)	targ_emul=i386bsd ;;
+ i[3-7]86-*-aout)	targ_emul=i386aout ;;
++i[3-7]86-*-minix)       targ_emul=i386minix ;;
+ i[3-7]86-*-linux*aout*)	targ_emul=i386linux
+ 			targ_extra_emuls=elf_i386
+ 			tdir_elf_i386=`echo ${targ_alias} | sed -e 's/aout//'` ;;
+diff -ruN binutils-2.17.50.0.6/include/ansi.h binutils-2.17.50.0.6.bs/include/ansi.h
+--- binutils-2.17.50.0.6/include/ansi.h	1970-01-01 01:00:00.000000000 +0100
++++ binutils-2.17.50.0.6.bs/include/ansi.h	2005-09-14 03:59:36.000000000 +0200
+@@ -0,0 +1,69 @@
++/* The &lt;ansi.h&gt; header attempts to decide whether the compiler has enough
++ * conformance to Standard C for Minix to take advantage of.  If so, the
++ * symbol _ANSI is defined (as 31459).  Otherwise _ANSI is not defined
++ * here, but it may be defined by applications that want to bend the rules.
++ * The magic number in the definition is to inhibit unnecessary bending
++ * of the rules.  (For consistency with the new '#ifdef _ANSI&quot; tests in
++ * the headers, _ANSI should really be defined as nothing, but that would
++ * break many library routines that use &quot;#if _ANSI&quot;.)
++
++ * If _ANSI ends up being defined, a macro
++ *
++ *	_PROTOTYPE(function, params)
++ *
++ * is defined.  This macro expands in different ways, generating either
++ * ANSI Standard C prototypes or old-style K&amp;R (Kernighan &amp; Ritchie)
++ * prototypes, as needed.  Finally, some programs use _CONST, _VOIDSTAR etc
++ * in such a way that they are portable over both ANSI and K&amp;R compilers.
++ * The appropriate macros are defined here.
++ */
++
++#ifndef _ANSI_H
++#define _ANSI_H
++
++#if __STDC__ == 1
++#define _ANSI		31459	/* compiler claims full ANSI conformance */
++#endif
++
++#ifdef __GNUC__
++#define _ANSI		31459	/* gcc conforms enough even in non-ANSI mode */
++#endif
++
++#ifdef _ANSI
++
++/* Keep everything for ANSI prototypes. */
++#define	_PROTOTYPE(function, params)	function params
++#define	_ARGS(params)			params
++
++#define	_VOIDSTAR	void *
++#define	_VOID		void
++#define	_CONST		const
++#define	_VOLATILE	volatile
++#define _SIZET		size_t
++
++#else
++
++/* Throw away the parameters for K&amp;R prototypes. */
++#define	_PROTOTYPE(function, params)	function()
++#define	_ARGS(params)			()
++
++#define	_VOIDSTAR	void *
++#define	_VOID		void
++#define	_CONST
++#define	_VOLATILE
++#define _SIZET		int
++
++#endif /* _ANSI */
++
++/* This should be defined as restrict when a C99 compiler is used. */
++#define _RESTRICT
++
++/* Setting any of _MINIX, _POSIX_C_SOURCE or _POSIX2_SOURCE implies
++ * _POSIX_SOURCE.  (Seems wrong to put this here in ANSI space.)
++ */
++#if defined(_MINIX) || _POSIX_C_SOURCE &gt; 0 || defined(_POSIX2_SOURCE)
++#undef _POSIX_SOURCE
++#define _POSIX_SOURCE	1
++#endif
++
++#endif /* ANSI_H */
+diff -ruN binutils-2.17.50.0.6/include/a.out.h binutils-2.17.50.0.6.bs/include/a.out.h
+--- binutils-2.17.50.0.6/include/a.out.h	1970-01-01 01:00:00.000000000 +0100
++++ binutils-2.17.50.0.6.bs/include/a.out.h	2005-04-21 16:55:49.000000000 +0200
+@@ -0,0 +1,118 @@
++/* The &lt;a.out&gt; header file describes the format of executable files. */
++
++#ifndef _AOUT_H
++#define _AOUT_H
++
++struct	exec {			/* a.out header */
++  unsigned char	a_magic[2];	/* magic number */
++  unsigned char	a_flags;	/* flags, see below */
++  unsigned char	a_cpu;		/* cpu id */
++  unsigned char	a_hdrlen;	/* length of header */
++  unsigned char	a_unused;	/* reserved for future use */
++  unsigned short a_version;	/* version stamp (not used at present) */
++  long		a_text;		/* size of text segement in bytes */
++  long		a_data;		/* size of data segment in bytes */
++  long		a_bss;		/* size of bss segment in bytes */
++  long		a_entry;	/* entry point */
++  long		a_total;	/* total memory allocated */
++  long		a_syms;		/* size of symbol table */
++
++  /* SHORT FORM ENDS HERE */
++  long		a_trsize;	/* text relocation size */
++  long		a_drsize;	/* data relocation size */
++  long		a_tbase;	/* text relocation base */
++  long		a_dbase;	/* data relocation base */
++};
++
++#define A_MAGIC0      (unsigned char) 0x01
++#define A_MAGIC1      (unsigned char) 0x03
++#define BADMAG(X)     ((X).a_magic[0] != A_MAGIC0 ||(X).a_magic[1] != A_MAGIC1)
++
++/* CPU Id of TARGET machine (byte order coded in low order two bits) */
++#define A_NONE	0x00	/* unknown */
++#define A_I8086	0x04	/* intel i8086/8088 */
++#define A_M68K	0x0B	/* motorola m68000 */
++#define A_NS16K	0x0C	/* national semiconductor 16032 */
++#define A_I80386 0x10	/* intel i80386 */
++#define A_SPARC	0x17	/* Sun SPARC */
++
++#define A_BLR(cputype)	((cputype&amp;0x01)!=0) /* TRUE if bytes left-to-right */
++#define A_WLR(cputype)	((cputype&amp;0x02)!=0) /* TRUE if words left-to-right */
++
++/* Flags. */
++#define A_UZP	0x01	/* unmapped zero page (pages) */
++#define A_PAL	0x02	/* page aligned executable */
++#define A_NSYM	0x04	/* new style symbol table */
++#define A_IMG   0x08	/* image instead of executable (e.g. root FS) */
++#define A_EXEC	0x10	/* executable */
++#define A_SEP	0x20	/* separate I/D */
++#define A_PURE	0x40	/* pure text */		/* not used */
++#define A_TOVLY	0x80	/* text overlay */	/* not used */
++
++/* Offsets of various things. */
++#define A_MINHDR	32
++#define	A_TEXTPOS(X)	((long)(X).a_hdrlen)
++#define A_DATAPOS(X)	(A_TEXTPOS(X) + (X).a_text)
++#define	A_HASRELS(X)	((X).a_hdrlen &gt; (unsigned char) A_MINHDR)
++#define A_HASEXT(X)	((X).a_hdrlen &gt; (unsigned char) (A_MINHDR +  8))
++#define A_HASLNS(X)	((X).a_hdrlen &gt; (unsigned char) (A_MINHDR + 16))
++#define A_HASTOFF(X)	((X).a_hdrlen &gt; (unsigned char) (A_MINHDR + 24))
++#define A_TRELPOS(X)	(A_DATAPOS(X) + (X).a_data)
++#define A_DRELPOS(X)	(A_TRELPOS(X) + (X).a_trsize)
++#define A_SYMPOS(X)	(A_TRELPOS(X) + (A_HASRELS(X) ? \
++  			((X).a_trsize + (X).a_drsize) : 0))
++
++struct reloc {
++  long r_vaddr;			/* virtual address of reference */
++  unsigned short r_symndx;	/* internal segnum or extern symbol num */
++  unsigned short r_type;	/* relocation type */
++};
++
++/* r_tyep values: */
++#define R_ABBS		0
++#define R_RELLBYTE	2
++#define R_PCRBYTE	3
++#define R_RELWORD	4
++#define R_PCRWORD	5
++#define R_RELLONG	6
++#define R_PCRLONG	7
++#define R_REL3BYTE	8
++#define R_KBRANCHE	9
++
++/* r_symndx for internal segments */
++#define S_ABS		((unsigned short)-1)
++#define S_TEXT		((unsigned short)-2)
++#define S_DATA		((unsigned short)-3)
++#define S_BSS		((unsigned short)-4)
++
++struct nlist {			/* symbol table entry */
++  char n_name[8];		/* symbol name */
++  long n_value;			/* value */
++  unsigned char	n_sclass;	/* storage class */
++  unsigned char	n_numaux;	/* number of auxiliary entries (not used) */
++  unsigned short n_type;	/* language base and derived type (not used) */
++};
++
++/* Low bits of storage class (section). */
++#define	N_SECT		  07	/* section mask */
++#define N_UNDF		  00	/* undefined */
++#define N_ABS		  01	/* absolute */
++#define N_TEXT		  02	/* text */
++#define N_DATA		  03	/* data */
++#define	N_BSS		  04	/* bss */
++#define N_COMM		  05	/* (common) */
++
++/* High bits of storage class. */
++#define N_CLASS		0370	/* storage class mask */
++#define C_NULL
++#define C_EXT		0020	/* external symbol */
++#define C_STAT		0030	/* static */
++
++/* Function prototypes. */
++#ifndef _ANSI_H
++#include &lt;ansi.h&gt;
++#endif
++
++_PROTOTYPE( int nlist, (char *_file, struct nlist *_nl)			);
++
++#endif /* _AOUT_H */

Added: branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-tekhex.patch
===================================================================
--- branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-tekhex.patch	                        (rev 0)
+++ branches/rpms/brian/noarch-novendor-nosystem-binutils/binutils-2.17.50.0.6-tekhex.patch	2008-06-09 23:18:27 UTC (rev 6350)
@@ -0,0 +1,60 @@
+2007-01-05  Jakub Jelinek  &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">jakub at redhat.com</A>&gt;
+
+	* texhex.c (first_phase): Don't fall through into the default
+	case.
+	(pass_over): Replace abort () calls with return FALSE.  Fix
+	buffer overflow.
+
+--- bfd/tekhex.c.jj	2006-06-19 15:17:43.000000000 +0200
++++ bfd/tekhex.c	2007-01-05 11:08:25.000000000 +0100
+@@ -436,6 +436,7 @@ first_phase (bfd *abfd, int type, char *
+ 		if (!getvalue (&amp;src, &amp;val))
+ 		  return FALSE;
+ 		new-&gt;symbol.value = val - section-&gt;vma;
++		break;
+ 	      }
+ 	    default:
+ 	      return FALSE;
+@@ -457,11 +458,10 @@ pass_over (bfd *abfd, bfd_boolean (*func
+ 
+   /* To the front of the file.  */
+   if (bfd_seek (abfd, (file_ptr) 0, SEEK_SET) != 0)
+-    abort ();
++    return FALSE;
+   while (! eof)
+     {
+-      char buffer[MAXCHUNK];
+-      char *src = buffer;
++      char src[MAXCHUNK];
+       char type;
+ 
+       /* Find first '%'.  */
+@@ -471,22 +471,24 @@ pass_over (bfd *abfd, bfd_boolean (*func
+ 
+       if (eof)
+ 	break;
+-      src++;
+ 
+       /* Fetch the type and the length and the checksum.  */
+       if (bfd_bread (src, (bfd_size_type) 5, abfd) != 5)
+-	abort (); /* FIXME.  */
++	return FALSE;
+ 
+       type = src[2];
+ 
+       if (!ISHEX (src[0]) || !ISHEX (src[1]))
+ 	break;
+ 
+-      /* Already read five char.  */
++      /* Already read five chars.  */
+       chars_on_line = HEX (src) - 5;
+ 
++      if (chars_on_line &gt;= MAXCHUNK)
++	return FALSE;
++
+       if (bfd_bread (src, (bfd_size_type) chars_on_line, abfd) != chars_on_line)
+-	abort (); /* FIXME.  */
++	return FALSE;
+ 
+       /* Put a null at the end.  */
+       src[chars_on_line] = 0;

Added: branches/rpms/brian/noarch-novendor-nosystem-binutils/cross-binutils.spec
===================================================================
--- branches/rpms/brian/noarch-novendor-nosystem-binutils/cross-binutils.spec	                        (rev 0)
+++ branches/rpms/brian/noarch-novendor-nosystem-binutils/cross-binutils.spec	2008-06-09 23:18:27 UTC (rev 6350)
@@ -0,0 +1,134 @@
+%{!?target_arch: %define target_arch noarch}
+%{!?target_vendor: %define target_vendor novendor}
+%{!?target_system: %define target_system nosystem}
+%define target %{target_arch}-%{target_vendor}-%{target_system}
+
+Name:           %{target}-binutils
+Version:        2.17.50.0.6
+Release:        1%{?dist}
+Summary:        Cross Compiling GNU binutils targeted at %{target}
+Group:          Development/Tools
+License:        GPL
+URL:            <A HREF="http://www.gnu.org/software/binutils/">http://www.gnu.org/software/binutils/</A>
+Source0:        <A HREF="ftp://ftp.gnu.org/pub/gnu/binutils/binutils-%{version">ftp://ftp.gnu.org/pub/gnu/binutils/binutils-%{version</A>}.tar.bz2
+Source1:        README-binutils.fedora
+Patch1: binutils-2.17.50.0.6-ltconfig-multilib.patch
+Patch2: binutils-2.17.50.0.6-ppc64-pie.patch
+Patch3: binutils-2.17.50.0.6-place-orphan.patch
+Patch4: binutils-2.17.50.0.6-ia64-lib64.patch
+Patch5: binutils-2.17.50.0.6-elfvsb-test.patch
+Patch6: binutils-2.17.50.0.6-standards.patch
+Patch7: binutils-2.17.50.0.6-build-fixes.patch
+Patch8: binutils-2.17.50.0.6-kept-section.patch
+Patch9: binutils-2.17.50.0.6-power6-insns.patch
+Patch10: binutils-2.17.50.0.6-fixsyms.patch
+Patch11: binutils-2.17.50.0.6-gas-debug-ranges-revert.patch
+Patch12: binutils-2.17.50.0.6-popcnt.patch
+Patch13: binutils-2.17.50.0.6-rh223181.patch
+Patch14: binutils-2.17.50.0.6-tekhex.patch
+Patch15: binutils-2.17.50.0.6-bz4267.patch
+Patch16: binutils-2.17.50.0.6-ppc-relbrlt-test.patch
+Patch17: binutils-2.17.50.0.6-rh235221.patch
+Patch18: binutils-2.17.50.0.6-sse4.patch
+Patch19: binutils-2.17.50.0.6-ppc64-version-script.patch
+Patch20: binutils-2.17.50.0.6-rh241252.patch
+#Patch100:       <A HREF="http://kegel.com/crosstool/crosstool-0.43/patches/binutils-2.16.1/binutils-2.15-psignal.patch">http://kegel.com/crosstool/crosstool-0.43/patches/binutils-2.16.1/binutils-2.15-psignal.patch</A>
+#Patch101:       <A HREF="http://kegel.com/crosstool/crosstool-0.43/patches/binutils-2.16.1/binutils-skip-comments.patch">http://kegel.com/crosstool/crosstool-0.43/patches/binutils-2.16.1/binutils-skip-comments.patch</A>
+#Patch102:       <A HREF="http://kegel.com/crosstool/crosstool-0.43/patches/binutils-2.16.1/cross-gprof.patch">http://kegel.com/crosstool/crosstool-0.43/patches/binutils-2.16.1/cross-gprof.patch</A>
+#Patch103:       binutils-2.16.1-fortify-source.patch
+Patch104:       binutils-2.17-posix-1.patch
+Patch105:       binutils-2.17.50.0.6-target-minix.patch
+BuildRoot:      %{_tmppath}/%{name}-%{version}-%{release}-%(%{__id_u} -n)
+BuildRequires:  texinfo &gt;= 4.0, dejagnu, gettext, flex, bison, gcc
+
+%description
+This is a Cross Compiling version of GNU binutils, which can be used to
+assemble and link binaries for the %{target} platform, instead of for the
+native %{_arch} platform.
+
+
+%prep
+%setup -q -c
+pushd binutils-%{version}
+%patch1 -p0 -b .ltconfig-multilib~
+%patch3 -p0 -b .place-orphan~
+%patch5 -p0 -b .elfvsb-test~
+%patch6 -p0 -b .standards~
+%patch7 -p0 -b .build-fixes~
+%patch8 -p0 -b .kept-section~
+%patch10 -p0 -b .fixsyms~
+%patch12 -p0 -b .popcnt~
+#%patch13 -p0 -b .rh223181~
+#%patch15 -p0 -b .bz4267~
+#%patch20 -p0 -b .rh241252~
+%patch104 -p1
+%patch105 -p1
+popd
+cp %{SOURCE1} .
+
+
+%build
+mkdir -p build
+pushd build
+%define host %(echo ${MACHTYPE} | sed &quot;s/$(echo ${MACHTYPE} | cut -d- -f2)/cross/&quot;)
+../binutils-%{version}/configure --prefix=%{_prefix} --host=%{host} \
+  --target=%{target} --mandir=%{_mandir} --infodir=%{_infodir} \
+  --with-lib-path=%{_prefix}/%{target}/lib --disable-nls \
+  --enable-shared --disable-multilib
+make configure-host
+make 
+popd build
+
+
+%install
+rm -rf $RPM_BUILD_ROOT
+pushd build
+make install DESTDIR=$RPM_BUILD_ROOT
+popd build
+# these are for win targets only
+rm  $RPM_BUILD_ROOT%{_mandir}/man1/%{target}-{dlltool,nlmconv,windres}.1
+# we don't want these as we are a cross version
+rm -r $RPM_BUILD_ROOT%{_infodir}
+rm    $RPM_BUILD_ROOT%{_libdir}/libiberty.a
+
+
+%clean
+rm -rf $RPM_BUILD_ROOT
+
+
+%files
+%defattr(-,root,root,-)
+%doc binutils-%{version}/COPYING binutils-%{version}/COPYING.LIB
+%doc binutils-%{version}/README README-binutils.fedora
+%{_prefix}/%{target}
+%{_bindir}/%{target}-*
+/usr/%{host}
+%{_mandir}/man1/%{target}-*.1.gz
+
+
+%changelog
+* Mon Jun  4 2007 Hans de Goede &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">j.w.r.degoede at hhs.nl</A>&gt; 2.16.1-2
+- Add a patch from rtems fixing the issues when building with
+  -DFORTIFY_SOURCE=2, thanks Ralf!
+
+* Thu May 24 2007 Hans de Goede &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">j.w.r.degoede at hhs.nl</A>&gt; 2.16.1-1
+- Revert to GNU 2.16.1 release as that is what open2x uses and glibc-2.3.6
+  doesn't compile with newer binutils
+- Merge in all changes from avr-binutils
+- Add various patches from the crosstool project (also used by open2x):
+  <A HREF="http://open2x.svn.sourceforge.net/viewvc/open2x/trunk/toolchain-new/patches/binutils-2.16.1/">http://open2x.svn.sourceforge.net/viewvc/open2x/trunk/toolchain-new/patches/binutils-2.16.1/</A>
+
+* Sun Apr  1 2007 Hans de Goede &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">j.w.r.degoede at hhs.nl</A>&gt; 2.17.50.0.12-1
+- Bump to 2.17.50.0.12, to sync with rawhide / Fedora 7
+- &quot;Dynamicly Generate&quot; README.fedora so that macros can be used
+
+* Thu Mar 29 2007 Hans de Goede &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">j.w.r.degoede at hhs.nl</A>&gt; 2.17.50.0.9-1
+- Bump to 2.17.50.0.9
+- Use %%configure instead of ./configure
+- Various fixups
+
+* Wed Mar 28 2007 Koos Termeulen <A HREF="http://lists.repoforge.org/mailman/listinfo/commits">koostermeulen at gmail.com</A> 2.17-1
+- New version and some changes after unofficial review by Hans de Goede
+
+* Wed Mar 21 2007 Koos Termeulen <A HREF="http://lists.repoforge.org/mailman/listinfo/commits">koostermeulen at gmail.com</A> 2.16.1-1
+- Initial release

Added: branches/rpms/brian/noarch-novendor-nosystem-gcc/README-gcc.fedora
===================================================================
--- branches/rpms/brian/noarch-novendor-nosystem-gcc/README-gcc.fedora	                        (rev 0)
+++ branches/rpms/brian/noarch-novendor-nosystem-gcc/README-gcc.fedora	2008-06-09 23:18:27 UTC (rev 6350)
@@ -0,0 +1,4 @@
+This package does not include the gnu texinfo documentation because this would
+conflict with the native gcc. If you've installed the native gcc,
+you can find the info documentation there, notice that this might be for a
+different version though!

Added: branches/rpms/brian/noarch-novendor-nosystem-gcc/arm-linux-soft-float.patch
===================================================================
--- branches/rpms/brian/noarch-novendor-nosystem-gcc/arm-linux-soft-float.patch	                        (rev 0)
+++ branches/rpms/brian/noarch-novendor-nosystem-gcc/arm-linux-soft-float.patch	2008-06-09 23:18:27 UTC (rev 6350)
@@ -0,0 +1,30 @@
+diff -u -r gcc-4.0.2/gcc/config/arm/t-linux gcc-4.0.2/gcc/config/arm.new/t-linux
+--- gcc-4.0.2/gcc/config/arm/t-linux	2005-10-18 22:04:44.000000000 +1000
++++ gcc-4.0.2/gcc/config/arm.new/t-linux	2005-10-18 22:05:03.000000000 +1000
+@@ -4,7 +4,12 @@ TARGET_LIBGCC2_CFLAGS = -fomit-frame-poi
+ LIBGCC2_DEBUG_CFLAGS = -g0
+ 
+ LIB1ASMSRC = arm/lib1funcs.asm
+-LIB1ASMFUNCS = _udivsi3 _divsi3 _umodsi3 _modsi3 _dvmd_lnx
++LIB1ASMFUNCS = _udivsi3 _divsi3 _umodsi3 _modsi3 _dvmd_lnx \
++	_negdf2 _addsubdf3 _muldivdf3 _cmpdf2 _unorddf2 _fixdfsi _fixunsdfsi \
++	_truncdfsf2 _negsf2 _addsubsf3 _muldivsf3 _cmpsf2 _unordsf2 \
++	_fixsfsi _fixunssfsi _floatdidf _floatdisf \
++	_bb_init_func _call_via_rX _interwork_call_via_rX \
++	_lshrdi3 _ashrdi3 _ashldi3
+ 
+ # MULTILIB_OPTIONS = mhard-float/msoft-float
+ # MULTILIB_DIRNAMES = hard-float soft-float
+
+
+--- gcc-4.1.1/gcc/config/arm/linux-elf.h	2007-01-06 11:17:51.000000000 +0000
++++ gcc-4.1.1/gcc/config/arm/linux-elf-soft.h	2007-01-06 11:22:01.000000000 +0000
+@@ -49,7 +49,7 @@
+    %{shared:-lc} \
+    %{!shared:%{profile:-lc_p}%{!profile:-lc}}&quot;
+ 
+-#define LIBGCC_SPEC &quot;%{msoft-float:-lfloat} %{mfloat-abi=soft*:-lfloat} -lgcc&quot;
++/* #define LIBGCC_SPEC &quot;%{msoft-float:-lfloat} %{mfloat-abi=soft*:-lfloat} -lgcc&quot; */
+ 
+ #define LINUX_TARGET_INTERPRETER &quot;/lib/ld-linux.so.2&quot;
+ 

Added: branches/rpms/brian/noarch-novendor-nosystem-gcc/cross-gcc.spec
===================================================================
--- branches/rpms/brian/noarch-novendor-nosystem-gcc/cross-gcc.spec	                        (rev 0)
+++ branches/rpms/brian/noarch-novendor-nosystem-gcc/cross-gcc.spec	2008-06-09 23:18:27 UTC (rev 6350)
@@ -0,0 +1,249 @@
+%define use_cpu_defs 0
+%{!?target_arch: %define target_arch noarch}
+%{!?target_vendor: %define target_vendor novendor}
+%{!?target_system: %define target_system nosystem}
+%{?target_cpu: %define cpu_defs --with-cpu=%{target_cpu} --enable-cxx-flags=-mcpu=%{target_cpu}
+               %define use_cpu_defs 1}
+%define target_base_arch %(echo &quot;%{target_arch}&quot; | \
+  sed -e &quot;s/armeb/arm/g&quot; -e &quot;s/arm64/arm/g&quot; -e &quot;s/s390x/s390/g&quot; -e &quot;s/i[4-6]86/i386/g&quot; -e &quot;s/mipsel/mips/g&quot; -e &quot;s/ppc32/ppc/g&quot; -e &quot;s/powerpc/ppc/g&quot; )
+%{!?vendor_name: %define vendor_name %{target_vendor}}
+%define target %{target_arch}-%{target_vendor}-%{target_system}
+%define glibcversion 2.5.0
+%{!?bootstrap: %define bootstrap 0}
+%{!?use_softfp: %define use_softfp 0}
+
+%if !%{bootstrap}
+Name:           %{target}-gcc
+%else
+Name:           %{target}-gcc-static
+%endif
+Version:        4.1.2
+Release:        7%{?dist}
+Summary:        Cross Compiling GNU GCC targeted at %{target}
+Group:          Development/Languages
+License:        GPLv2+
+URL:            <A HREF="http://gcc.gnu.org/">http://gcc.gnu.org/</A>
+Source0:        <A HREF="ftp://ftp.gnu.org/gnu/gcc/gcc-%{version">ftp://ftp.gnu.org/gnu/gcc/gcc-%{version</A>}/gcc-4.1.2-20070626.tar.bz2
+Source1:        README-gcc.fedora
+Patch0:         arm-linux-soft-float.patch
+Patch1:         gcc40-cross-build-fixes.patch
+Patch2:         gcc-4.1.2-gcc_eh.patch
+Patch3:         gcc-4.1.2-version.patch
+Patch4:         gcc-4.1.1-cross_search_paths-1.patch
+BuildRoot:      %{_tmppath}/%{name}-%{version}-%{release}-%(%{__id_u} -n)
+BuildRequires:  %{target}-binutils zlib-devel
+Requires:       %{target}-binutils
+%if %{bootstrap}
+BuildRequires:  %{target}-%{target_system}-kernel-headers
+%else
+BuildRequires:  %{target}-glibc
+Requires:       %{target}-glibc
+Obsoletes:      %{target}-gcc-static
+%endif
+
+%description
+This is a Cross Compiling version of GNU GCC, which can be used to
+compile programs for the %{target} platform, instead of for the
+native %{_arch} platform.
+
+
+%if !%{bootstrap}
+
+%package c++
+Summary:        Cross Compiling GNU G++ targeted at %{target}
+Group:          Development/Languages
+Requires:       %{name} = %{version}-%{release}
+
+%description c++
+This package contains the Cross Compiling version of g++, which can be used to
+compile c++ code for the %{target} platform, instead of for the
+native %{_arch} platform.
+
+%endif
+
+
+%prep
+%setup -q -c -a 1
+cp -a %{SOURCE1} .
+pushd gcc-%{version}*
+%if %(test &quot;%{target_base_arch}&quot; = &quot;arm&quot; &amp;&amp; echo 1 || echo 0)
+#%patch0 -p1
+%endif
+%patch1 -p1
+%if !%{bootstrap}
+%patch3 -p1
+%patch4 -p1
+%else
+%patch2 -p1
+%endif
+sed -i 's/VERSUFFIX &quot;.*&quot;/VERSUFFIX &quot; (%{vendor_name} %{version}-%{release})&quot;/' \
+  gcc/version.c
+contrib/gcc_update --touch
+# Set up the compiler to take the include files from our toolchain
+echo &quot;
+#undef STARTFILE_PREFIX_SPEC
+#define STARTFILE_PREFIX_SPEC \&quot;%{_prefix}/%{target}/lib/\&quot;&quot; &gt;&gt; gcc/config/linux.h
+cp gcc/Makefile.in{,.orig}
+sed -e &quot;s@\(^CROSS_SYSTEM_HEADER_DIR =\).*@\1 %{_prefix}/%{target}/<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">include at g</A>&quot;     gcc/Makefile.in.orig &gt; gcc/Makefile.in
+popd
+
+# Extract %%__os_install_post into os_install_post~
+cat &lt;&lt; \EOF &gt; os_install_post~
+%__os_install_post
+EOF
+
+# Generate customized brp-*scripts
+cat os_install_post~ | while read a x y; do
+case $a in
+# Prevent brp-strip* from trying to handle foreign binaries
+*/brp-strip*)
+  b=$(basename $a)
+  sed -e 's,find $RPM_BUILD_ROOT,find $RPM_BUILD_ROOT%_bindir $RPM_BUILD_ROOT%_libexecdir,' $a &gt; $b
+  chmod a+x $b
+  ;;
+esac
+done
+
+sed -e 's,^[ ]*/usr/lib/rpm.*/brp-strip,./brp-strip,' \
+&lt; os_install_post~ &gt; os_install_post 
+
+%build
+%if %{bootstrap}
+%define languages 'c'
+%else
+%define languages 'c,c++'
+%endif
+mkdir -p build-%{target}-gcc
+pushd build-%{target}-gcc
+CC=&quot;%{__cc} ${RPM_OPT_FLAGS}&quot; \
+../gcc-%{version}*/configure --prefix=%{_prefix} \
+  --mandir=%{_mandir} --infodir=%{_infodir} \
+%if %{bootstrap}
+  --with-build-sysroot=%{_builddir}/%{name}-%{version}/sysroot \
+  --disable-threads --disable-shared \
+%if %{use_softfp}
+  --with-float=soft \
+%endif
+%else
+  --enable-long-long --enable-threads=posix \
+  --disable-libstdcxx-pch \
+  --enable-__cxa_atexit \
+  --enable-symvers=gnu \
+  --enable-version-specific-runtime-libs \
+  --enable-c99 \
+  --with-system-zlib \
+  --enable-shared \
+%endif
+  --target=%{target} --enable-languages=%{languages} \
+  --disable-libmudflap --disable-libssp --disable-multilib \
+%if %{use_cpu_defs}
+  %{cpu_defs} \
+%endif
+  --disable-nls
+
+# In general, building GCC is not smp-safe
+%if %{bootstrap}
+make all-gcc
+%else
+make AS_FOR_TARGET=&quot;%{target}-as&quot; \
+     LD_FOR_TARGET=&quot;%{target}-ld&quot;
+%endif
+popd
+
+
+%install
+rm -rf $RPM_BUILD_ROOT
+pushd build-%{target}-gcc
+%if %{bootstrap}
+make install-gcc DESTDIR=$RPM_BUILD_ROOT
+%else
+make install DESTDIR=$RPM_BUILD_ROOT
+%endif
+popd
+# we don't want these as we are a cross version
+rm -r $RPM_BUILD_ROOT%{_infodir}
+rm -r $RPM_BUILD_ROOT%{_mandir}/man7
+rm -f  $RPM_BUILD_ROOT%{_libdir}/libiberty.a
+# and these aren't usefull for embedded targets
+rm -fr $RPM_BUILD_ROOT%{_bindir}/gcc/%{target}/%{version}/install-tools
+rm -fr $RPM_BUILD_ROOT%{_libexecdir}/gcc/%{target}/%{version}/install-tools
+%if !%{bootstrap}
+rm -f $RPM_BUILD_ROOT%{_prefix}/%{target}/lib/libiberty.a
+rm -f $RPM_BUILD_ROOT%{_prefix}/%{target}/lib64/libiberty.a
+rm -f $RPM_BUILD_ROOT%{_bindir}/gcc/%{target}/%{version}/*.la
+%endif
+
+# creating links (&lt;cpu&gt;-&lt;system&gt;) of cross-tools for use with tsrpm
+for FILE in $RPM_BUILD_ROOT%{_bindir}/%{target}-*; do
+    ln ${FILE} `echo ${FILE} | sed -e &quot;s/\(.*%{version}.*\)%{target}\(.*\)/\1%{target_arch}-%{target_system}\2/g&quot;`
+done
+
+%define __os_install_post . ./os_install_post
+
+
+%clean
+rm -rf $RPM_BUILD_ROOT
+
+
+%files
+%defattr(-,root,root,-)
+%doc gcc-%{version}*/COPYING gcc-%{version}*/COPYING.LIB
+%doc gcc-%{version}*/README README-gcc.fedora
+%{_bindir}/%{target}-*
+%{_bindir}/%{target_arch}-%{target_system}-*
+%{_prefix}/lib*/gcc/%{target}/
+%{_libexecdir}/gcc/%{target}/
+%{_mandir}/man1/%{target}-*.1.gz
+
+%if !%{bootstrap}
+
+%exclude %{_bindir}/%{target}-?++
+%exclude %{_bindir}/%{target_arch}-%{target_system}-?++
+%exclude /usr/lib/gcc/%{target}/%{version}/lib*c++.a
+%exclude /usr/lib/gcc/%{target}/%{version}/include/c++
+%exclude %{_libexecdir}/gcc/%{target}/%{version}/cc1plus
+%exclude %{_includedir}/omp.h
+%exclude %{_mandir}/man1/%{target}-g++.1.gz
+
+
+%files c++
+%defattr(-,root,root,-)
+%{_bindir}/%{target}-?++
+%{_bindir}/%{target_arch}-%{target_system}-?++
+/usr/lib/gcc/%{target}/%{version}/lib*c++.a
+/usr/lib/gcc/%{target}/%{version}/include/c++
+%{_libexecdir}/gcc/%{target}/%{version}/cc1plus
+%{_mandir}/man1/%{target}-g++.1.gz
+
+%endif
+
+
+%changelog
+* Tue Mar 25 2008 Brian Schueler &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">brian.schueler at gmx.de</A>&gt; 4.1.2-7
+- switched from Linux threads to POSIX threads
+
+* Fri Aug 3 2007 Kevin Kofler &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">Kevin at tigcc.ticalc.org</A>&gt; 4.1.2-6
+- Disable bootstrap
+- Add &quot;GP2X&quot; to VERSUFFIX
+- Link C++ against -lgcc_eh to fix undefined references
+- Specify GPL version in License tag
+
+* Thu May 31 2007 Hans de Goede &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">j.w.r.degoede at hhs.nl</A>&gt; 4.1.2-5
+- Merge in avr-gcc cross compile changes
+
+* Thu May 31 2007 Koos Termeulen <A HREF="http://lists.repoforge.org/mailman/listinfo/commits">koostermeulen at gmail.com</A> 4.1.2-4
+- Moved kernel-headers to separate package
+- Added bootstrap option to define whether we want a bootstrapped gcc or not
+
+* Thu May 10 2007 Koos Termeulen <A HREF="http://lists.repoforge.org/mailman/listinfo/commits">koostermeulen at gmail.com</A> 4.1.2-3
+- Added &quot;linux-2.6.21-headers&quot; and &quot;glibc-2.3.5-headers&quot; for bootstrapping gcc
+- Glibc-2.3.5 is used because the arm is not supported in version 2.5
+
+* Thu Apr 26 2007 Koos Termeulen <A HREF="http://lists.repoforge.org/mailman/listinfo/commits">koostermeulen at gmail.com</A> 4.1.2-2
+- Correction in description
+- Changes in ./configure
+- Don't remove the devel-files from package
+- Removed CFLAGS because it didn't work properly
+
+* Thu Apr 20 2007 Koos Termeulen <A HREF="http://lists.repoforge.org/mailman/listinfo/commits">koostermeulen at gmail.com</A> 4.1.2-1
+- Initial release

Added: branches/rpms/brian/noarch-novendor-nosystem-gcc/gcc-4.1.1-cross_search_paths-1.patch
===================================================================
--- branches/rpms/brian/noarch-novendor-nosystem-gcc/gcc-4.1.1-cross_search_paths-1.patch	                        (rev 0)
+++ branches/rpms/brian/noarch-novendor-nosystem-gcc/gcc-4.1.1-cross_search_paths-1.patch	2008-06-09 23:18:27 UTC (rev 6350)
@@ -0,0 +1,49 @@
+Submitted by: Ryan Oliver &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">ryan.oliver at pha.com.au</A>&gt;
+Date: 2005-05-02
+Initial Package Version: 4.0.1
+Origin: Ryan Oliver (issue reported by Erik-Jan Post)
+        Rediffed against 4.1.0 by Chris Staub
+Upstream Status: N/A
+Description:
+  Removes standard_exec_prefix_2 from library search path when cross-compiling.
+  Removes both standard_exec_prefix_1 and standard_exec_prefix_2 from the gcc
+  executable search path when cross-compiling.
+
+  ie: if cross_compile = 1 in the specs file, do not
+      - do not add /usr/lib/gcc/${TARGET}/${GCC_VER} to the library search path
+      - do not add /usr/lib/gcc/${TARGET}/${GCC_VER} or
+                   /usr/libexec/gcc/${TARGET}/${GCC_VER}
+        to the executable search path
+
+  This avoids the possibility of linking in libraries from the host if they
+  exist under those directories.
+ 
+diff -Naur gcc-4.1.0.orig/gcc/gcc.c gcc-4.1.0/gcc/gcc.c
+--- gcc-4.1.0.orig/gcc/gcc.c	2006-01-21 13:29:08.000000000 -0500
++++ gcc-4.1.0/gcc/gcc.c	2006-02-28 22:20:05.000000000 -0500
+@@ -3818,16 +3818,22 @@
+ 	      PREFIX_PRIORITY_LAST, 2, 0);
+   add_prefix (&amp;exec_prefixes, standard_exec_prefix, &quot;BINUTILS&quot;,
+ 	      PREFIX_PRIORITY_LAST, 2, 0);
+-  add_prefix (&amp;exec_prefixes, standard_exec_prefix_1, &quot;BINUTILS&quot;,
++  if (*cross_compile == '0')
++    {
++      add_prefix (&amp;exec_prefixes, standard_exec_prefix_1, &quot;BINUTILS&quot;,
+ 	      PREFIX_PRIORITY_LAST, 2, 0);
+-  add_prefix (&amp;exec_prefixes, standard_exec_prefix_2, &quot;BINUTILS&quot;,
++      add_prefix (&amp;exec_prefixes, standard_exec_prefix_2, &quot;BINUTILS&quot;,
+ 	      PREFIX_PRIORITY_LAST, 2, 0);
++    }
+ #endif
+ 
+   add_prefix (&amp;startfile_prefixes, standard_exec_prefix, &quot;BINUTILS&quot;,
+ 	      PREFIX_PRIORITY_LAST, 1, 0);
+-  add_prefix (&amp;startfile_prefixes, standard_exec_prefix_2, &quot;BINUTILS&quot;,
++  if (*cross_compile == '0')
++    {
++      add_prefix (&amp;startfile_prefixes, standard_exec_prefix_2, &quot;BINUTILS&quot;,
+ 	      PREFIX_PRIORITY_LAST, 1, 0);
++    }
+ 
+   tooldir_prefix = concat (tooldir_base_prefix, spec_machine,
+ 			   dir_separator_str, NULL);


Property changes on: branches/rpms/brian/noarch-novendor-nosystem-gcc/gcc-4.1.1-cross_search_paths-1.patch
___________________________________________________________________
Name: svn:executable
   + *

Added: branches/rpms/brian/noarch-novendor-nosystem-gcc/gcc-4.1.2-gcc_eh.patch
===================================================================
--- branches/rpms/brian/noarch-novendor-nosystem-gcc/gcc-4.1.2-gcc_eh.patch	                        (rev 0)
+++ branches/rpms/brian/noarch-novendor-nosystem-gcc/gcc-4.1.2-gcc_eh.patch	2008-06-09 23:18:27 UTC (rev 6350)
@@ -0,0 +1,24 @@
+diff -ur gcc-4.1.2/gcc/cp/g++spec.c gcc-4.1.2-gcc_eh/gcc/cp/g++spec.c
+--- gcc-4.1.2/gcc/cp/g++spec.c	2005-06-25 02:59:41.000000000 +0200
++++ gcc-4.1.2-gcc_eh/gcc/cp/g++spec.c	2007-08-03 14:46:03.000000000 +0200
+@@ -251,7 +251,7 @@
+ #endif
+ 
+   /* Make sure to have room for the trailing NULL argument.  */
+-  num_args = argc + added + need_math + shared_libgcc + (library &gt; 0) + 1;
++  num_args = argc + added + need_math + shared_libgcc + 2 * (library &gt; 0) + 1;
+   arglist = xmalloc (num_args * sizeof (char *));
+ 
+   i = 0;
+@@ -311,7 +311,10 @@
+     {
+       arglist[j] = saw_profile_flag ? LIBSTDCXX_PROFILE : LIBSTDCXX;
+       if (arglist[j][0] != '-' || arglist[j][1] == 'l')
+-	added_libraries++;
++      {
++	arglist[++j] = &quot;-lgcc_eh&quot;;
++	added_libraries += 2;
++      }
+       j++;
+     }
+   if (saw_math)

Added: branches/rpms/brian/noarch-novendor-nosystem-gcc/gcc-4.1.2-version.patch
===================================================================
--- branches/rpms/brian/noarch-novendor-nosystem-gcc/gcc-4.1.2-version.patch	                        (rev 0)
+++ branches/rpms/brian/noarch-novendor-nosystem-gcc/gcc-4.1.2-version.patch	2008-06-09 23:18:27 UTC (rev 6350)
@@ -0,0 +1,6 @@
+diff -ruN gcc-4.1.2-20070626/gcc/BASE-VER gcc-4.1.2-20070626.new/gcc/BASE-VER
+--- gcc-4.1.2-20070626/gcc/BASE-VER	2007-06-22 13:14:40.000000000 +0200
++++ gcc-4.1.2-20070626.new/gcc/BASE-VER	2008-03-30 17:02:26.000000000 +0200
+@@ -1 +1 @@
+-4.1.3
++4.1.2

Added: branches/rpms/brian/noarch-novendor-nosystem-gcc/gcc40-cross-build-fixes.patch
===================================================================
--- branches/rpms/brian/noarch-novendor-nosystem-gcc/gcc40-cross-build-fixes.patch	                        (rev 0)
+++ branches/rpms/brian/noarch-novendor-nosystem-gcc/gcc40-cross-build-fixes.patch	2008-06-09 23:18:27 UTC (rev 6350)
@@ -0,0 +1,52 @@
+--- gcc-4.1.2/configure.cross-build-fixes	2007-01-25 16:47:43.000000000 +0100
++++ gcc-4.1.2/configure	2007-01-25 16:47:43.000000000 +0100
+@@ -3260,7 +3260,13 @@ CFLAGS_FOR_BUILD=${CFLAGS_FOR_BUILD-${CF
+ # being built; programs in there won't even run.
+ if test &quot;${build}&quot; = &quot;${host}&quot; &amp;&amp; test -d ${srcdir}/gcc; then
+   # Search for pre-installed headers if nothing else fits.
+-  FLAGS_FOR_TARGET=$FLAGS_FOR_TARGET' -B$(build_tooldir)/bin/ -B$(build_tooldir)/lib/ -isystem $(build_tooldir)/include -isystem $(build_tooldir)/sys-include'
++  FLAGS_FOR_TARGET=$FLAGS_FOR_TARGET' -B$(build_tooldir)/bin/ -B$(build_tooldir)/lib/'
++  if test &quot;${with_build_sysroot+set}&quot; = set; then
++    sysroot_dir=&quot;$with_build_sysroot&quot;
++  else
++    sysroot_dir='$(build_tooldir)/'
++  fi
++  FLAGS_FOR_TARGET=$FLAGS_FOR_TARGET&quot; -isystem $sysroot_dir/usr/include&quot;
+ fi
+ 
+ if test &quot;x${use_gnu_ld}&quot; = x &amp;&amp;
+--- gcc-4.1.2/gcc/mklibgcc.in.cross-build-fixes	2006-09-21 13:30:29.000000000 +0200
++++ gcc-4.1.2/gcc/mklibgcc.in	2007-01-25 16:47:43.000000000 +0100
+@@ -196,7 +196,7 @@ for ml in $MULTILIBS; do
+   shlib_slibdir_qual=
+   libgcc_a=$dir/libgcc.a
+   libgcov_a=$dir/libgcov.a
+-  libgcc_eh_a=
++  libgcc_eh_a=$dir/libgcc_eh.a
+   libgcc_s_so=
+   libunwind_a=
+   libunwind_so=
+@@ -205,7 +205,6 @@ for ml in $MULTILIBS; do
+     libunwind_a=$dir/libunwind.a
+   fi
+   if [ &quot;$SHLIB_LINK&quot; ]; then
+-    libgcc_eh_a=$dir/libgcc_eh.a
+     libgcc_s_so=$dir/libgcc_s${SHLIB_EXT}
+     if [ &quot;$LIBUNWIND&quot; ]; then
+       libunwind_so=$dir/libunwind${SHLIB_EXT}
+@@ -868,12 +867,11 @@ for ml in $MULTILIBS; do
+   echo '	$(INSTALL_DATA)' ${dir}/libgcov.a ${ldir}/
+   echo '	chmod 644'  ${ldir}/libgcov.a
+   echo '	$(RANLIB_FOR_TARGET)' ${ldir}/libgcov.a
++  echo '	$(INSTALL_DATA)' ${dir}/libgcc_eh.a ${ldir}/
++  echo '	chmod 644'  ${ldir}/libgcc_eh.a
++  echo '	$(RANLIB_FOR_TARGET)' ${ldir}/libgcc_eh.a
+ 
+   if [ &quot;$SHLIB_LINK&quot; ]; then
+-    echo '	$(INSTALL_DATA)' ${dir}/libgcc_eh.a ${ldir}/
+-    echo '	chmod 644'  ${ldir}/libgcc_eh.a
+-    echo '	$(RANLIB_FOR_TARGET)' ${ldir}/libgcc_eh.a
+-
+     shlib_slibdir_qual=
+     os_multilib_dir=`$GCC_FOR_TARGET $flags --print-multi-os-directory`
+     if [ &quot;$os_multilib_dir&quot; != . ]; then

Added: branches/rpms/brian/noarch-novendor-nosystem-glibc/README-glibc.fedora
===================================================================
--- branches/rpms/brian/noarch-novendor-nosystem-glibc/README-glibc.fedora	                        (rev 0)
+++ branches/rpms/brian/noarch-novendor-nosystem-glibc/README-glibc.fedora	2008-06-09 23:18:27 UTC (rev 6350)
@@ -0,0 +1,4 @@
+This package does not include the gnu texinfo documentation because this would
+conflict with the native glibc. If you've installed the native glibc,
+you can find the info documentation there, notice that this is for a different
+(newer) version though!

Added: branches/rpms/brian/noarch-novendor-nosystem-glibc/cross-glibc.spec
===================================================================
--- branches/rpms/brian/noarch-novendor-nosystem-glibc/cross-glibc.spec	                        (rev 0)
+++ branches/rpms/brian/noarch-novendor-nosystem-glibc/cross-glibc.spec	2008-06-09 23:18:27 UTC (rev 6350)
@@ -0,0 +1,127 @@
+%{!?target_arch: %define target_arch noarch}
+%{!?target_vendor: %define target_vendor novendor}
+%{!?target_system: %define target_system nosystem}
+%define target %{target_arch}-%{target_vendor}-%{target_system}
+%define host %(echo ${MACHTYPE} | sed &quot;s/$(echo ${MACHTYPE} | cut -d- -f2)/cross/&quot;)
+
+Name:           %{target}-glibc
+Version:        2.5.0
+Release:        4%{?dist}
+Summary:        Cross Compiled GNU C Library targeted at %{target}
+Group:          Development/Languages
+License:        LGPLv2+
+URL:            <A HREF="http://www.gnu.org/software/libc/">http://www.gnu.org/software/libc/</A>
+Source0:        <A HREF="ftp://ftp.gnu.org/gnu/glibc/glibc-2.5-20061008T1257.tar.bz2">ftp://ftp.gnu.org/gnu/glibc/glibc-2.5-20061008T1257.tar.bz2</A>
+Source1:        <A HREF="ftp://ftp.gnu.org/gnu/glibc/glibc-ports-2.5.tar.bz2">ftp://ftp.gnu.org/gnu/glibc/glibc-ports-2.5.tar.bz2</A>
+Source2:        README-glibc.fedora
+Patch100:       glibc-2.5-mips_fixes-1.patch
+Patch101:       glibc-2.5-libgcc_eh-1.patch
+Patch102:       glibc-2.5-localedef_segfault-1.patch
+BuildRoot:      %{_tmppath}/%{name}-%{version}-%{release}-%(%{__id_u} -n)
+BuildRequires:  %{target}-gcc-static %{target}-%{target_system}-kernel-headers
+BuildArch:      noarch
+Requires:       %{target}-%{target_system}-kernel-headers
+
+%description
+This is a Cross Compiled version of the GNU C Library, which can be used to
+compile and link binaries for the %{target} platform, instead of for the
+native %{_arch} platform.
+
+
+%prep
+%setup -q -c -a 2
+pushd glibc-2.5-20061008T1257
+tar -xf %{SOURCE1} 
+mv glibc-ports-2.5 ports
+%patch100 -p1
+%patch102 -p1
+cp nscd/Makefile{,.orig}
+  sed -e &quot;/nscd_stat.o: sysincludes = # nothing/d&quot; nscd/Makefile.orig &gt;     nscd/Makefile
+popd
+cp -a %{SOURCE2} .
+
+
+%build
+mkdir -p build-%{target}-glibc
+pushd build-%{target}-glibc
+# CFLAGS not used, maybe we should ?
+echo &quot;libc_cv_forced_unwind=yes&quot; &gt; config.cache
+echo &quot;libc_cv_c_cleanup=yes&quot; &gt;&gt; config.cache
+  BUILD_CC=&quot;gcc&quot; CC=&quot;%{target}-gcc&quot; \
+  AR=&quot;%{target}-ar&quot; RANLIB=&quot;%{target}-ranlib&quot; \
+../glibc-2.5-20061008T1257/configure --prefix=%{_prefix}/%{target} \
+  --host=%{target} \
+  --build=%{host} --disable-profile --enable-add-ons \
+  --with-tls --enable-kernel=2.6.9 --with-__thread \
+  --without-fp --without-selinux \
+  --with-binutils=%{_prefix}/%{target}/bin \
+  --with-headers=%{_prefix}/%{target}/include \
+  --cache-file=config.cache
+make %{?_smp_mflags}
+
+# generate stubs.h
+for i in io math misc posix stdlib streams; do
+  make -C ../glibc-2.5-20061008T1257/$i objdir=`pwd` stubs
+  cat $i/stubs &gt;&gt; subdir-stubs.h
+done
+
+sed '/^@/d' &lt; ../glibc-2.5-20061008T1257/include/stubs-prologue.h &gt; stubs.h
+sort subdir-stubs.h &gt;&gt; stubs.h
+
+popd
+
+
+%install
+rm -rf $RPM_BUILD_ROOT
+pushd build-%{target}-glibc
+make install install_root=$RPM_BUILD_ROOT
+#make install-lib-all install_root=$RPM_BUILD_ROOT
+#make install-headers install_root=$RPM_BUILD_ROOT
+install -m 644 bits/stdio_lim.h $RPM_BUILD_ROOT%{_prefix}/%{target}/include/bits
+#install -m 644 stubs.h $RPM_BUILD_ROOT%{_prefix}/%{target}/include/gnu
+popd
+
+# despite us being noarch redhat-rpm-config insists on stripping our files
+# and on running find-debuginfo.sh on our files
+%define __debug_install_post %{nil}
+%define __os_install_post /usr/lib/rpm/redhat/brp-compress
+
+# stop rpm from claiming we provide and need native glibc symbols &lt;sigh&gt;
+%define _use_internal_dependency_generator 0
+%define __find_requires %{nil}
+%define __find_provides %{nil}
+
+
+%clean
+rm -rf $RPM_BUILD_ROOT
+
+
+%files
+%defattr(-,root,root,-)
+%doc glibc-2.5-20061008T1257/BUGS glibc-2.5-20061008T1257/C* glibc-2.5-20061008T1257/FAQ
+%doc glibc-2.5-20061008T1257/LICENSES glibc-2.5-20061008T1257/README
+%doc glibc-2.5-20061008T1257/README.libm README-glibc.fedora
+%doc %{_prefix}/%{target}/info
+%{_prefix}/%{target}/include/*
+%{_prefix}/%{target}/lib
+%{_prefix}/%{target}/bin
+%{_prefix}/%{target}/etc
+%{_prefix}/%{target}/libexec
+%{_prefix}/%{target}/sbin
+%{_prefix}/%{target}/share
+
+
+%changelog
+* Sun Aug  5 2007 Hans de Goede &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">j.w.r.degoede at hhs.nl</A>&gt; 2.3.6-4
+- Do NOT provide and require native glibc symbols &lt;sigh&gt;
+
+* Fri Aug  3 2007 Hans de Goede &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">j.w.r.degoede at hhs.nl</A>&gt; 2.3.6-3
+- Change License tag to: LGPLv2+
+- Don't own %%{_prefix}/%%{target} and %%{_prefix}/%%{target}/include dirs, as
+  these are already owned by the required arm-gp2x-linux-kernel-headers rpm
+
+* Thu May 31 2007 Hans de Goede &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">j.w.r.degoede at hhs.nl</A>&gt; 2.3.6-2
+- Merge in latest avr-libc changes (make noarch, don't strip files)
+
+* Thu Apr 25 2007 Koos Termeulen <A HREF="http://lists.repoforge.org/mailman/listinfo/commits">koostermeulen at gmail.com</A> 2.3.6-1
+- Initial release

Added: branches/rpms/brian/noarch-novendor-nosystem-glibc/glibc-2.5-libgcc_eh-1.patch
===================================================================
--- branches/rpms/brian/noarch-novendor-nosystem-glibc/glibc-2.5-libgcc_eh-1.patch	                        (rev 0)
+++ branches/rpms/brian/noarch-novendor-nosystem-glibc/glibc-2.5-libgcc_eh-1.patch	2008-06-09 23:18:27 UTC (rev 6350)
@@ -0,0 +1,24 @@
+Submitted By: Jim Gifford (patches at jg555 dot com)
+Date: 2005-07-20
+Initial Package Version: 2.3.5
+Origin: Rene Rebe &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">rene at exactcode.de</A>&gt;
+Upstream Status: Unknown
+Description: Removes dependency for libgcc_eh
+ 
+--- glibc-2.3.5/Makeconfig.orig	2005-07-21 04:53:30.000000000 +0000
++++ glibc-2.3.5/Makeconfig	2005-07-21 04:53:49.000000000 +0000
+@@ -503,12 +503,12 @@
+   libunwind = -lunwind
+ endif
+ ifneq ($(have-as-needed),yes)
+- libgcc_eh := -lgcc_eh $(libunwind)
++ libgcc_eh := $(libunwind)
+ else
+  libgcc_eh := -Wl,--as-needed -lgcc_s$(libgcc_s_suffix) $(libunwind) -Wl,--no-as-needed
+ endif
+ gnulib := -lgcc $(libgcc_eh)
+-static-gnulib := -lgcc -lgcc_eh $(libunwind)
++static-gnulib := -lgcc $(libunwind)
+ libc.so-gnulib := -lgcc
+ endif
+ ifeq ($(elf),yes)


Property changes on: branches/rpms/brian/noarch-novendor-nosystem-glibc/glibc-2.5-libgcc_eh-1.patch
___________________________________________________________________
Name: svn:executable
   + *

Added: branches/rpms/brian/noarch-novendor-nosystem-glibc/glibc-2.5-localedef_segfault-1.patch
===================================================================
--- branches/rpms/brian/noarch-novendor-nosystem-glibc/glibc-2.5-localedef_segfault-1.patch	                        (rev 0)
+++ branches/rpms/brian/noarch-novendor-nosystem-glibc/glibc-2.5-localedef_segfault-1.patch	2008-06-09 23:18:27 UTC (rev 6350)
@@ -0,0 +1,58 @@
+Submitted By: Jim Gifford
+Date: 2006-10-10
+Initial Package Version: 2.5
+Origin: Debian
+Upstream Status: Submitted - <A HREF="http://sources.redhat.com/bugzilla/show_bug.cgi?id=3333">http://sources.redhat.com/bugzilla/show_bug.cgi?id=3333</A>
+Description: Fixes Segfault when using localdef.
+             This problem is only noticed when using PaX
+             and some architectures besides x86.
+             See debian bug # 231438
+
+Rediffed against Jim Gifford's patch, just to remove fuzz.
+
+diff -Naur glibc-2.5.orig/locale/programs/3level.h glibc-2.5/locale/programs/3level.h
+--- glibc-2.5.orig/locale/programs/3level.h	2005-12-07 05:47:27.000000000 +0000
++++ glibc-2.5/locale/programs/3level.h	2006-10-11 08:05:00.000000000 +0000
+@@ -202,6 +202,42 @@
+ 	}
+     }
+ }
++
++/* GCC ATM seems to do a poor job with pointers to nested functions passed
++   to inlined functions.  Help it a little bit with this hack.  */
++#define wchead_table_iterate(tp, fn) \
++do									      \
++  {									      \
++    struct wchead_table *t = (tp);					      \
++    uint32_t index1;							      \
++    for (index1 = 0; index1 &lt; t-&gt;level1_size; index1++)			      \
++      {									      \
++	uint32_t lookup1 = t-&gt;level1[index1];				      \
++	if (lookup1 != ((uint32_t) ~0))					      \
++	  {								      \
++	    uint32_t lookup1_shifted = lookup1 &lt;&lt; t-&gt;q;			      \
++	    uint32_t index2;						      \
++	    for (index2 = 0; index2 &lt; (1 &lt;&lt; t-&gt;q); index2++)		      \
++	      {								      \
++		uint32_t lookup2 = t-&gt;level2[index2 + lookup1_shifted];	      \
++		if (lookup2 != ((uint32_t) ~0))				      \
++		  {							      \
++		    uint32_t lookup2_shifted = lookup2 &lt;&lt; t-&gt;p;		      \
++		    uint32_t index3;					      \
++		    for (index3 = 0; index3 &lt; (1 &lt;&lt; t-&gt;p); index3++)	      \
++		      {							      \
++			struct element_t *lookup3			      \
++			  = t-&gt;level3[index3 + lookup2_shifted];	      \
++			if (lookup3 != NULL)				      \
++			  fn ((((index1 &lt;&lt; t-&gt;q) + index2) &lt;&lt; t-&gt;p) + index3, \
++			      lookup3);					      \
++		      }							      \
++		  }							      \
++	      }								      \
++	  }								      \
++      }									      \
++  } while (0)
++
+ #endif
+ 
+ #ifndef NO_FINALIZE


Property changes on: branches/rpms/brian/noarch-novendor-nosystem-glibc/glibc-2.5-localedef_segfault-1.patch
___________________________________________________________________
Name: svn:executable
   + *

Added: branches/rpms/brian/noarch-novendor-nosystem-glibc/glibc-2.5-mips_fixes-1.patch
===================================================================
--- branches/rpms/brian/noarch-novendor-nosystem-glibc/glibc-2.5-mips_fixes-1.patch	                        (rev 0)
+++ branches/rpms/brian/noarch-novendor-nosystem-glibc/glibc-2.5-mips_fixes-1.patch	2008-06-09 23:18:27 UTC (rev 6350)
@@ -0,0 +1,17 @@
+Submitted By: Jim Gifford (patches at jg555 dot com)
+Date: 2006-10-16
+Initial Package Version: 2.5
+Origin: Jim Gifford
+Upstream Status: Applied
+Description: Corrects Location of ld-rewrite for MIPS64
+
+diff -Naur glibc-2.5.orig/ports/sysdeps/unix/sysv/linux/mips/mips64/configure glibc-2.5/ports/sysdeps/unix/sysv/linux/mips/mips64/configure
+--- glibc-2.5.orig/ports/sysdeps/unix/sysv/linux/mips/mips64/configure	2006-03-11 08:18:41.000000000 -0800
++++ glibc-2.5/ports/sysdeps/unix/sysv/linux/mips/mips64/configure	2006-10-26 10:04:56.081721125 -0700
+@@ -1,4 +1,4 @@
+ # This file is generated from configure.in by Autoconf.  DO NOT EDIT!
+  # Local configure fragment for sysdeps/unix/sysv/linux/mips/mips64.
+ 
+-ldd_rewrite_script=$dest/ldd-rewrite.sed
++ldd_rewrite_script=../ports/sysdeps/unix/sysv/linux/mips/mips64/ldd-rewrite.sed
+


Property changes on: branches/rpms/brian/noarch-novendor-nosystem-glibc/glibc-2.5-mips_fixes-1.patch
___________________________________________________________________
Name: svn:executable
   + *

Added: branches/rpms/brian/noarch-novendor-nosystem-linux-kernel-headers/cross-kernel-headers.spec
===================================================================
--- branches/rpms/brian/noarch-novendor-nosystem-linux-kernel-headers/cross-kernel-headers.spec	                        (rev 0)
+++ branches/rpms/brian/noarch-novendor-nosystem-linux-kernel-headers/cross-kernel-headers.spec	2008-06-09 23:18:27 UTC (rev 6350)
@@ -0,0 +1,48 @@
+%{!?target_arch: %define target_arch noarch}
+%{!?target_vendor: %define target_vendor novendor}
+%{!?target_system: %define target_system nosystem}
+%define target %{target_arch}-%{target_vendor}-%{target_system}
+%define target_base_arch %(echo &quot;%{target_arch}&quot; | \
+  sed -e &quot;s/armeb/arm/g&quot; -e &quot;s/arm64/arm/g&quot; -e &quot;s/s390x/s390/g&quot; -e &quot;s/i[4-6]86/i386/g&quot; -e &quot;s/mipsel/mips/g&quot; -e &quot;s/ppc32/ppc/g&quot; -e &quot;s/powerpc/ppc/g&quot; )
+
+Name:           %{target}-linux-kernel-headers
+Version:        2.6.18
+Release:        1%{?dist}
+Summary:        Kernel headers for Cross Compiling to %{target}
+Group:          Development/Languages
+License:        GPL
+URL:            <A HREF="http://ep09.pld-linux.org/~mmazur/linux-libc-headers/">http://ep09.pld-linux.org/~mmazur/linux-libc-headers/</A>
+Source0:        <A HREF="http://ep09.pld-linux.org/~mmazur/linux-libc-headers/linux-libc-headers-%{version">http://ep09.pld-linux.org/~mmazur/linux-libc-headers/linux-libc-headers-%{version</A>}.tar.bz2
+BuildRoot:      %{_tmppath}/%{name}-%{version}-%{release}-%(%{__id_u} -n)
+BuildArch:      noarch
+
+%description
+Kernel headers for Cross Compiling to %{target}.
+
+
+%prep
+%setup -q -n linux-libc-headers-%{version}
+
+
+%build
+# nothing to build, headers only
+
+%install
+rm -rf $RPM_BUILD_ROOT
+mkdir -p $RPM_BUILD_ROOT%{_prefix}/%{target}/include
+cp -RHp include/asm-%{target_base_arch} $RPM_BUILD_ROOT%{_prefix}/%{target}/include/asm
+cp -RHp include/{asm-*,linux}   $RPM_BUILD_ROOT%{_prefix}/%{target}/include/
+
+
+%clean
+rm -rf $RPM_BUILD_ROOT
+
+
+%files
+%doc doc/*
+%{_prefix}/%{target}
+
+
+%changelog
+* Thu Apr 20 2007 Koos Termeulen <A HREF="http://lists.repoforge.org/mailman/listinfo/commits">koostermeulen at gmail.com</A> 2.6.12.0-1
+- Initial release


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="005148.html">[svn] r6349 - in branches/rpms/brian: . LBRC dkms-golden	dkms-linuxdvb dkms-openafs-kernel dkms-qc-usb dkms-sundance	dkms-truecrypt dkms-wis-go7007-linux dvb-apps libdvb novi	nozomi opencv player pybluez python-json stage thinkfinger	tsrpm vdr vdr-analogtv vdr-burn vdr-clock vdr-dvd vdr-femon	vdr-ffnetdev vdr-freecell vdr-mp3 vdr-osdteletext	vdr-reelchannelscan vdr-remote vdr-screenshot vdr-skinelchi	vdr-skinreel vdr-skins vdr-skinsoppalusikka vdr-softdevice	vdr-streamdev vdr-subtitles vdr-sudoku vdr-text2skin	vdr-timeline vdr-vdrrip vdr-wapd vdr-weather vdr-xine	vdradmin-am vdrsync xine xine-lib xournal
</A></li>
	<LI>Next message: <A HREF="005150.html">[svn] r6351 - in trunk/rpms: dirac ffe libgc smb4k
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5149">[ date ]</a>
              <a href="thread.html#5149">[ thread ]</a>
              <a href="subject.html#5149">[ subject ]</a>
              <a href="author.html#5149">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.repoforge.org/mailman/listinfo/commits">More information about the commits
mailing list</a><br>
</body></html>
