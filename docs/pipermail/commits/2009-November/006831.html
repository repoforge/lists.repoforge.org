<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [svn] r8036 - in trunk/tools/dstat: . docs plugins
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:commits%40lists.repoforge.org?Subject=Re:%20Re%3A%20%5Bsvn%5D%20r8036%20-%20in%20trunk/tools/dstat%3A%20.%20docs%20plugins&In-Reply-To=%3C200911240146.nAO1kVSk015203%40surya.karan.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="006830.html">
   <LINK REL="Next"  HREF="006832.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[svn] r8036 - in trunk/tools/dstat: . docs plugins</H1>
    <B>packagers at lists.rpmforge.net</B> 
    <A HREF="mailto:commits%40lists.repoforge.org?Subject=Re:%20Re%3A%20%5Bsvn%5D%20r8036%20-%20in%20trunk/tools/dstat%3A%20.%20docs%20plugins&In-Reply-To=%3C200911240146.nAO1kVSk015203%40surya.karan.org%3E"
       TITLE="[svn] r8036 - in trunk/tools/dstat: . docs plugins">packagers at lists.rpmforge.net
       </A><BR>
    <I>Tue Nov 24 02:46:31 CET 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="006830.html">[svn] r8035 - trunk/tools/dstat
</A></li>
        <LI>Next message: <A HREF="006832.html">[svn] r8037 - trunk/rpms/perl-WWW-Mechanize-Cached
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6831">[ date ]</a>
              <a href="thread.html#6831">[ thread ]</a>
              <a href="subject.html#6831">[ subject ]</a>
              <a href="author.html#6831">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: dag
Date: 2009-11-24 01:46:30 +0000 (Tue, 24 Nov 2009)
New Revision: 8036

Added:
   trunk/tools/dstat/docs/counter-rollovers.html
   trunk/tools/dstat/docs/cplugins.html
   trunk/tools/dstat/docs/dstat-paper.html
   trunk/tools/dstat/docs/dstat.1.html
   trunk/tools/dstat/docs/examples.html
   trunk/tools/dstat/docs/screen.html
   trunk/tools/dstat/plugins/dstat_disk_util.py
   trunk/tools/dstat/plugins/dstat_gpfs_ops.py
   trunk/tools/dstat/plugins/dstat_nfs3_ops.py
   trunk/tools/dstat/plugins/dstat_nfsd3_ops.py
   trunk/tools/dstat/plugins/dstat_proc_count.py
   trunk/tools/dstat/plugins/dstat_top_bio.py
   trunk/tools/dstat/plugins/dstat_top_cpu.py
   trunk/tools/dstat/plugins/dstat_top_cputime.py
   trunk/tools/dstat/plugins/dstat_top_cputime_avg.py
   trunk/tools/dstat/plugins/dstat_top_io.py
   trunk/tools/dstat/plugins/dstat_top_latency.py
   trunk/tools/dstat/plugins/dstat_top_latency_avg.py
   trunk/tools/dstat/plugins/dstat_top_mem.py
   trunk/tools/dstat/plugins/dstat_top_oom.py
   trunk/tools/dstat/plugins/dstat_vm_memctl.py
   trunk/tools/dstat/plugins/dstat_vmk_hba.py
   trunk/tools/dstat/plugins/dstat_vmk_int.py
   trunk/tools/dstat/plugins/dstat_vmk_nic.py
   trunk/tools/dstat/plugins/dstat_vz_cpu.py
   trunk/tools/dstat/plugins/dstat_vz_io.py
   trunk/tools/dstat/plugins/dstat_vz_ubc.py
Removed:
   trunk/tools/dstat/docs/plugins.txt
   trunk/tools/dstat/plugins/dstat_diskutil.py
   trunk/tools/dstat/plugins/dstat_gpfsop.py
   trunk/tools/dstat/plugins/dstat_nfs3op.py
   trunk/tools/dstat/plugins/dstat_nfsd3op.py
   trunk/tools/dstat/plugins/dstat_proccount.py
   trunk/tools/dstat/plugins/dstat_topavgcputime.py
   trunk/tools/dstat/plugins/dstat_topavglatency.py
   trunk/tools/dstat/plugins/dstat_topbio.py
   trunk/tools/dstat/plugins/dstat_topcpu.py
   trunk/tools/dstat/plugins/dstat_topcputime.py
   trunk/tools/dstat/plugins/dstat_topio.py
   trunk/tools/dstat/plugins/dstat_toplatency.py
   trunk/tools/dstat/plugins/dstat_topmem.py
   trunk/tools/dstat/plugins/dstat_topoom.py
   trunk/tools/dstat/plugins/dstat_vmkhba.py
   trunk/tools/dstat/plugins/dstat_vmkint.py
   trunk/tools/dstat/plugins/dstat_vmknic.py
   trunk/tools/dstat/plugins/dstat_vmmemctl.py
   trunk/tools/dstat/plugins/dstat_vzcpu.py
   trunk/tools/dstat/plugins/dstat_vzio.py
   trunk/tools/dstat/plugins/dstat_vzubc.py
Modified:
   trunk/tools/dstat/ChangeLog
   trunk/tools/dstat/TODO
   trunk/tools/dstat/docs/Makefile
   trunk/tools/dstat/docs/dstat-paper.txt
   trunk/tools/dstat/docs/dstat.1
   trunk/tools/dstat/docs/dstat.1.txt
   trunk/tools/dstat/dstat
   trunk/tools/dstat/dstat.spec
   trunk/tools/dstat/plugins/dstat_battery.py
   trunk/tools/dstat/plugins/dstat_battery_remain.py
   trunk/tools/dstat/plugins/dstat_cpufreq.py
   trunk/tools/dstat/plugins/dstat_dbus.py
   trunk/tools/dstat/plugins/dstat_fan.py
   trunk/tools/dstat/plugins/dstat_freespace.py
   trunk/tools/dstat/plugins/dstat_gpfs.py
   trunk/tools/dstat/plugins/dstat_helloworld.py
   trunk/tools/dstat/plugins/dstat_innodb_buffer.py
   trunk/tools/dstat/plugins/dstat_innodb_io.py
   trunk/tools/dstat/plugins/dstat_innodb_ops.py
   trunk/tools/dstat/plugins/dstat_lustre.py
   trunk/tools/dstat/plugins/dstat_memcache_hits.py
   trunk/tools/dstat/plugins/dstat_mysql5_com.py
   trunk/tools/dstat/plugins/dstat_mysql5_conn.py
   trunk/tools/dstat/plugins/dstat_mysql5_io.py
   trunk/tools/dstat/plugins/dstat_mysql5_keys.py
   trunk/tools/dstat/plugins/dstat_mysql_io.py
   trunk/tools/dstat/plugins/dstat_mysql_keys.py
   trunk/tools/dstat/plugins/dstat_net_packets.py
   trunk/tools/dstat/plugins/dstat_nfs3.py
   trunk/tools/dstat/plugins/dstat_nfsd3.py
   trunk/tools/dstat/plugins/dstat_ntp.py
   trunk/tools/dstat/plugins/dstat_postfix.py
   trunk/tools/dstat/plugins/dstat_power.py
   trunk/tools/dstat/plugins/dstat_rpc.py
   trunk/tools/dstat/plugins/dstat_rpcd.py
   trunk/tools/dstat/plugins/dstat_sendmail.py
   trunk/tools/dstat/plugins/dstat_snooze.py
   trunk/tools/dstat/plugins/dstat_thermal.py
   trunk/tools/dstat/plugins/dstat_utmp.py
   trunk/tools/dstat/plugins/dstat_wifi.py
Log:
- Mass rename plugins to follow better convention (impacts existing options)

Modified: trunk/tools/dstat/ChangeLog
===================================================================
--- trunk/tools/dstat/ChangeLog	2009-11-21 14:08:12 UTC (rev 8035)
+++ trunk/tools/dstat/ChangeLog	2009-11-24 01:46:30 UTC (rev 8036)
@@ -1,4 +1,4 @@
-* 0.7.0 - Tokyo - release 31/10/2009
+* 0.7.0 - Tokyo - release 25/11/2009
 - Fixed dstat_disk plugin for total calculation on 2.6.25+ kernels (Noel J. Bergman)
 - Precompile regular expressions used as a disk filter (self.diskfilter)
 - Raise a warning when discovery returns empty
@@ -23,12 +23,13 @@
 - Added external dstat_battery_remain plugin to show how much battery time is remaining
 - Added getnamebypid() function to simplify finding best process name by process id
 - Added external dstat_toplatency plugin to show process with top wait time in milliseconds
-- Added external dstat_topavglatency plugin to show process with top average wait time in milliseconds
+- Added external dstat_toplatency_avg plugin to show process with top average wait time in milliseconds
 - Added external dstat_topcputime plugin to show process with top total cpu in milliseconds
-- Added external dstat_topavgcputime plugin to show process with top average timeslice in milliseconds
+- Added external dstat_topcputime_avg plugin to show process with top average timeslice in milliseconds
 - Improvements to timing when writing to screen so that it feels nicer
-- Added external dstat_diskutil to show per disk utilization rates in percentage
+- Added external dstat_disk_util to show per disk utilization rates in percentage
 - Added new --float option to force float values on screen
+- Mass rename plugins to follow better convention (impacts existing options)
 - This release was 'sponsored' by the Linux Foundation during the Japan Linux Symposium
 
 * 0.6.9 - Locarno - release 02/12/2008

Modified: trunk/tools/dstat/TODO
===================================================================
--- trunk/tools/dstat/TODO	2009-11-21 14:08:12 UTC (rev 8035)
+++ trunk/tools/dstat/TODO	2009-11-24 01:46:30 UTC (rev 8036)
@@ -33,6 +33,7 @@
 ### Export/Graph
 + Interface with rrdtool (python-rrd ?)
 + Allow for different types of export modules (only CSV now)
+  - ODS could include graphs for plugins !
 + Allow to write out to syslog (or remote syslog)
 + Allow to write unbuffered to disk
 + Write out user input to CSV
@@ -48,8 +49,10 @@
 + Add icmp plugin ?
 + Add application plugin (-a or -A pid,cmd)
 + Add user plugin (number of users logged on, utmp is not that useful, /proc/key-users)
-+ Look into interfacing with apps (bind, sendmail, postfix, squid, amavisd, laus, samba)
++ Look into interfacing with apps
+  - amavisd, apache, bind, cifs, dhcpd, dnsmasq, gfs, samba, squid
 + Look into interfacing with specific HW counters in /proc
+  - qla2300
 + Look at /proc/meminfo, /proc/mdstat, /proc/net/netstat, /proc/net/snmp, /proc/vmstat
 + Look at /proc/fs/cifs/stats
 + Add i2c plugin (see /sys/class/i2c-adapter/i2c-*/*/*/*/*/*)
@@ -60,9 +63,9 @@
 + Add 'most iowaiting app' plugin
 
 ### Plugin issues
-+ plugins that use /proc/pid are reasonably slow (implement in C and cache file-content between plugins)
++ plugins that use /proc/pid are reasonably slow (implement in C and cache file-content between plugins might help)
 + disk plugin: /proc/partitions can have negative numbers, seen on systems with long uptime. dstat handles this except for calculating the very first stat, no work-around possible?
-+ proc plugin: (run and blk) does not work on 2.4.24+, to be confirmed
++ proc plugin: (run and blk) does not work on 2.4.24+ (to be confirmed ?)
 + swap plugin: (new one) is slower than swapold
 + tcp plugin: is very slow and generates lots of softirqs (on busy systems), to be confirmed
 

Modified: trunk/tools/dstat/docs/Makefile
===================================================================
--- trunk/tools/dstat/docs/Makefile	2009-11-21 14:08:12 UTC (rev 8035)
+++ trunk/tools/dstat/docs/Makefile	2009-11-24 01:46:30 UTC (rev 8036)
@@ -20,11 +20,12 @@
 %.1.html: %.1.txt
 	asciidoc -d manpage $&lt;
 
-%.1: %.1.xml
-	xmlto man $&lt;
-
 %.html: %.txt
 	asciidoc $&lt;
 
 %.1.xml: %.1.txt
 	asciidoc -b docbook -d manpage $&lt;
+
+%.1: %.1.xml
+	@xmlto man $&lt;
+

Added: trunk/tools/dstat/docs/counter-rollovers.html
===================================================================
--- trunk/tools/dstat/docs/counter-rollovers.html	                        (rev 0)
+++ trunk/tools/dstat/docs/counter-rollovers.html	2009-11-24 01:46:30 UTC (rev 8036)
@@ -0,0 +1,610 @@
+&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.1//EN&quot;
+    &quot;<A HREF="http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd</A>&quot;&gt;
+&lt;html xmlns=&quot;<A HREF="http://www.w3.org/1999/xhtml">http://www.w3.org/1999/xhtml</A>&quot; xml:lang=&quot;en&quot;&gt;
+&lt;head&gt;
+&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;
+&lt;meta name=&quot;generator&quot; content=&quot;AsciiDoc 8.5.1&quot; /&gt;
+&lt;title&gt;All you ever wanted to know about counter-rollovers and dstat&lt;/title&gt;
+&lt;style type=&quot;text/css&quot;&gt;
+/* Debug borders */
+p, li, dt, dd, div, pre, h1, h2, h3, h4, h5, h6 {
+/*
+  border: 1px solid red;
+*/
+}
+
+body {
+  margin: 1em 5% 1em 5%;
+}
+
+a {
+  color: blue;
+  text-decoration: underline;
+}
+a:visited {
+  color: fuchsia;
+}
+
+em {
+  font-style: italic;
+  color: navy;
+}
+
+strong {
+  font-weight: bold;
+  color: #083194;
+}
+
+tt {
+  color: navy;
+}
+
+h1, h2, h3, h4, h5, h6 {
+  color: #527bbd;
+  font-family: sans-serif;
+  margin-top: 1.2em;
+  margin-bottom: 0.5em;
+  line-height: 1.3;
+}
+
+h1, h2, h3 {
+  border-bottom: 2px solid silver;
+}
+h2 {
+  padding-top: 0.5em;
+}
+h3 {
+  float: left;
+}
+h3 + * {
+  clear: left;
+}
+
+div.sectionbody {
+  font-family: serif;
+  margin-left: 0;
+}
+
+hr {
+  border: 1px solid silver;
+}
+
+p {
+  margin-top: 0.5em;
+  margin-bottom: 0.5em;
+}
+
+ul, ol, li &gt; p {
+  margin-top: 0;
+}
+
+pre {
+  padding: 0;
+  margin: 0;
+}
+
+span#author {
+  color: #527bbd;
+  font-family: sans-serif;
+  font-weight: bold;
+  font-size: 1.1em;
+}
+span#email {
+}
+span#revnumber, span#revdate, span#revremark {
+  font-family: sans-serif;
+}
+
+div#footer {
+  font-family: sans-serif;
+  font-size: small;
+  border-top: 2px solid silver;
+  padding-top: 0.5em;
+  margin-top: 4.0em;
+}
+div#footer-text {
+  float: left;
+  padding-bottom: 0.5em;
+}
+div#footer-badges {
+  float: right;
+  padding-bottom: 0.5em;
+}
+
+div#preamble {
+  margin-top: 1.5em;
+  margin-bottom: 1.5em;
+}
+div.tableblock, div.imageblock, div.exampleblock, div.verseblock,
+div.quoteblock, div.literalblock, div.listingblock, div.sidebarblock,
+div.admonitionblock {
+  margin-top: 0.25em;
+  margin-bottom: 1.5em;
+}
+div.admonitionblock {
+  margin-top: 2.5em;
+  margin-bottom: 2.5em;
+}
+
+div.content { /* Block element content. */
+  padding: 0;
+}
+
+/* Block element titles. */
+div.title, caption.title {
+  color: #527bbd;
+  font-family: sans-serif;
+  font-weight: bold;
+  text-align: left;
+  margin-top: 1.0em;
+  margin-bottom: 0.5em;
+}
+div.title + * {
+  margin-top: 0;
+}
+
+td div.title:first-child {
+  margin-top: 0.0em;
+}
+div.content div.title:first-child {
+  margin-top: 0.0em;
+}
+div.content + div.title {
+  margin-top: 0.0em;
+}
+
+div.sidebarblock &gt; div.content {
+  background: #ffffee;
+  border: 1px solid silver;
+  padding: 0.5em;
+}
+
+div.listingblock &gt; div.content {
+  border: 1px solid silver;
+  background: #f4f4f4;
+  padding: 0.5em;
+}
+
+div.quoteblock {
+  padding-left: 2.0em;
+  margin-right: 10%;
+}
+div.quoteblock &gt; div.attribution {
+  padding-top: 0.5em;
+  text-align: right;
+}
+
+div.verseblock {
+  padding-left: 2.0em;
+  margin-right: 10%;
+}
+div.verseblock &gt; div.content {
+  white-space: pre;
+}
+div.verseblock &gt; div.attribution {
+  padding-top: 0.75em;
+  text-align: left;
+}
+/* DEPRECATED: Pre version 8.2.7 verse style literal block. */
+div.verseblock + div.attribution {
+  text-align: left;
+}
+
+div.admonitionblock .icon {
+  vertical-align: top;
+  font-size: 1.1em;
+  font-weight: bold;
+  text-decoration: underline;
+  color: #527bbd;
+  padding-right: 0.5em;
+}
+div.admonitionblock td.content {
+  padding-left: 0.5em;
+  border-left: 2px solid silver;
+}
+
+div.exampleblock &gt; div.content {
+  border-left: 2px solid silver;
+  padding: 0.5em;
+}
+
+div.imageblock div.content { padding-left: 0; }
+span.image img { border-style: none; }
+a.image:visited { color: white; }
+
+dl {
+  margin-top: 0.8em;
+  margin-bottom: 0.8em;
+}
+dt {
+  margin-top: 0.5em;
+  margin-bottom: 0;
+  font-style: normal;
+  color: navy;
+}
+dd &gt; *:first-child {
+  margin-top: 0.1em;
+}
+
+ul, ol {
+    list-style-position: outside;
+}
+ol.arabic {
+  list-style-type: decimal;
+}
+ol.loweralpha {
+  list-style-type: lower-alpha;
+}
+ol.upperalpha {
+  list-style-type: upper-alpha;
+}
+ol.lowerroman {
+  list-style-type: lower-roman;
+}
+ol.upperroman {
+  list-style-type: upper-roman;
+}
+
+div.compact ul, div.compact ol,
+div.compact p, div.compact p,
+div.compact div, div.compact div {
+  margin-top: 0.1em;
+  margin-bottom: 0.1em;
+}
+
+div.tableblock &gt; table {
+  border: 3px solid #527bbd;
+}
+thead {
+  font-family: sans-serif;
+  font-weight: bold;
+}
+tfoot {
+  font-weight: bold;
+}
+td &gt; div.verse {
+  white-space: pre;
+}
+p.table {
+  margin-top: 0;
+}
+/* Because the table frame attribute is overriden by CSS in most browsers. */
+div.tableblock &gt; table[frame=&quot;void&quot;] {
+  border-style: none;
+}
+div.tableblock &gt; table[frame=&quot;hsides&quot;] {
+  border-left-style: none;
+  border-right-style: none;
+}
+div.tableblock &gt; table[frame=&quot;vsides&quot;] {
+  border-top-style: none;
+  border-bottom-style: none;
+}
+
+
+div.hdlist {
+  margin-top: 0.8em;
+  margin-bottom: 0.8em;
+}
+div.hdlist tr {
+  padding-bottom: 15px;
+}
+dt.hdlist1.strong, td.hdlist1.strong {
+  font-weight: bold;
+}
+td.hdlist1 {
+  vertical-align: top;
+  font-style: normal;
+  padding-right: 0.8em;
+  color: navy;
+}
+td.hdlist2 {
+  vertical-align: top;
+}
+div.hdlist.compact tr {
+  margin: 0;
+  padding-bottom: 0;
+}
+
+.comment {
+  background: yellow;
+}
+
+.footnote, .footnoteref {
+  font-size: 0.8em;
+}
+
+span.footnote, span.footnoteref {
+  vertical-align: super;
+}
+
+#footnotes {
+  margin: 20px 0 20px 0;
+  padding: 7px 0 0 0;
+}
+
+#footnotes div.footnote {
+  margin: 0 0 5px 0;
+}
+
+#footnotes hr {
+  border: none;
+  border-top: 1px solid silver;
+  height: 1px;
+  text-align: left;
+  margin-left: 0;
+  width: 20%;
+  min-width: 100px;
+}
+
+
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">+ at media</A> print {
+  div#footer-badges { display: none; }
+}
+
+div#toctitle {
+  color: #527bbd;
+  font-family: sans-serif;
+  font-size: 1.1em;
+  font-weight: bold;
+  margin-top: 1.0em;
+  margin-bottom: 0.1em;
+}
+
+div.toclevel1, div.toclevel2, div.toclevel3, div.toclevel4 {
+  margin-top: 0;
+  margin-bottom: 0;
+}
+div.toclevel2 {
+  margin-left: 2em;
+  font-size: 0.9em;
+}
+div.toclevel3 {
+  margin-left: 4em;
+  font-size: 0.9em;
+}
+div.toclevel4 {
+  margin-left: 6em;
+  font-size: 0.9em;
+}
+/* Workarounds for IE6's broken and incomplete CSS2. */
+
+div.sidebar-content {
+  background: #ffffee;
+  border: 1px solid silver;
+  padding: 0.5em;
+}
+div.sidebar-title, div.image-title {
+  color: #527bbd;
+  font-family: sans-serif;
+  font-weight: bold;
+  margin-top: 0.0em;
+  margin-bottom: 0.5em;
+}
+
+div.listingblock div.content {
+  border: 1px solid silver;
+  background: #f4f4f4;
+  padding: 0.5em;
+}
+
+div.quoteblock-attribution {
+  padding-top: 0.5em;
+  text-align: right;
+}
+
+div.verseblock-content {
+  white-space: pre;
+}
+div.verseblock-attribution {
+  padding-top: 0.75em;
+  text-align: left;
+}
+
+div.exampleblock-content {
+  border-left: 2px solid silver;
+  padding-left: 0.5em;
+}
+
+/* IE6 sets dynamically generated links as visited. */
+div#toc a:visited { color: blue; }
+&lt;/style&gt;
+&lt;script type=&quot;text/javascript&quot;&gt;
+/*&lt;![CDATA[*/
+window.onload = function(){asciidoc.footnotes();}
+var asciidoc = {  // Namespace.
+
+/////////////////////////////////////////////////////////////////////
+// Table Of Contents generator
+/////////////////////////////////////////////////////////////////////
+
+/* Author: Mihai Bazon, September 2002
+ * <A HREF="http://students.infoiasi.ro/~mishoo">http://students.infoiasi.ro/~mishoo</A>
+ *
+ * Table Of Content generator
+ * Version: 0.4
+ *
+ * Feel free to use this script under the terms of the GNU General Public
+ * License, as long as you do not remove or alter this notice.
+ */
+
+ /* modified by Troy D. Hanson, September 2006. License: GPL */
+ /* modified by Stuart Rackham, 2006, 2009. License: GPL */
+
+// toclevels = 1..4.
+toc: function (toclevels) {
+
+  function getText(el) {
+    var text = &quot;&quot;;
+    for (var i = el.firstChild; i != null; i = i.nextSibling) {
+      if (i.nodeType == 3 /* Node.TEXT_NODE */) // IE doesn't speak constants.
+        text += i.data;
+      else if (i.firstChild != null)
+        text += getText(i);
+    }
+    return text;
+  }
+
+  function TocEntry(el, text, toclevel) {
+    this.element = el;
+    this.text = text;
+    this.toclevel = toclevel;
+  }
+
+  function tocEntries(el, toclevels) {
+    var result = new Array;
+    var re = new RegExp('[hH]([2-'+(toclevels+1)+'])');
+    // Function that scans the DOM tree for header elements (the DOM2
+    // nodeIterator API would be a better technique but not supported by all
+    // browsers).
+    var iterate = function (el) {
+      for (var i = el.firstChild; i != null; i = i.nextSibling) {
+        if (i.nodeType == 1 /* Node.ELEMENT_NODE */) {
+          var mo = re.exec(i.tagName);
+          if (mo)
+            result[result.length] = new TocEntry(i, getText(i), mo[1]-1);
+          iterate(i);
+        }
+      }
+    }
+    iterate(el);
+    return result;
+  }
+
+  var toc = document.getElementById(&quot;toc&quot;);
+  var entries = tocEntries(document.getElementById(&quot;content&quot;), toclevels);
+  for (var i = 0; i &lt; entries.length; ++i) {
+    var entry = entries[i];
+    if (entry.element.id == &quot;&quot;)
+      entry.element.id = &quot;_toc_&quot; + i;
+    var a = document.createElement(&quot;a&quot;);
+    a.href = &quot;#&quot; + entry.element.id;
+    a.appendChild(document.createTextNode(entry.text));
+    var div = document.createElement(&quot;div&quot;);
+    div.appendChild(a);
+    div.className = &quot;toclevel&quot; + entry.toclevel;
+    toc.appendChild(div);
+  }
+  if (entries.length == 0)
+    toc.parentNode.removeChild(toc);
+},
+
+
+/////////////////////////////////////////////////////////////////////
+// Footnotes generator
+/////////////////////////////////////////////////////////////////////
+
+/* Based on footnote generation code from:
+ * <A HREF="http://www.brandspankingnew.net/archive/2005/07/format_footnote.html">http://www.brandspankingnew.net/archive/2005/07/format_footnote.html</A>
+ */
+
+footnotes: function () {
+  var cont = document.getElementById(&quot;content&quot;);
+  var noteholder = document.getElementById(&quot;footnotes&quot;);
+  var spans = cont.getElementsByTagName(&quot;span&quot;);
+  var refs = {};
+  var n = 0;
+  for (i=0; i&lt;spans.length; i++) {
+    if (spans[i].className == &quot;footnote&quot;) {
+      n++;
+      // Use [\s\S] in place of . so multi-line matches work.
+      // Because JavaScript has no s (dotall) regex flag.
+      note = spans[i].innerHTML.match(/\s*\[([\s\S]*)]\s*/)[1];
+      noteholder.innerHTML +=
+        &quot;&lt;div class='footnote' id='_footnote_&quot; + n + &quot;'&gt;&quot; +
+        &quot;&lt;a href='#_footnoteref_&quot; + n + &quot;' title='Return to text'&gt;&quot; +
+        n + &quot;&lt;/a&gt;. &quot; + note + &quot;&lt;/div&gt;&quot;;
+      spans[i].innerHTML =
+        &quot;[&lt;a id='_footnoteref_&quot; + n + &quot;' href='#_footnote_&quot; + n +
+        &quot;' title='View footnote' class='footnote'&gt;&quot; + n + &quot;&lt;/a&gt;]&quot;;
+      var id =spans[i].getAttribute(&quot;id&quot;);
+      if (id != null) refs[&quot;#&quot;+id] = n;
+    }
+  }
+  if (n == 0)
+    noteholder.parentNode.removeChild(noteholder);
+  else {
+    // Process footnoterefs.
+    for (i=0; i&lt;spans.length; i++) {
+      if (spans[i].className == &quot;footnoteref&quot;) {
+        var href = spans[i].getElementsByTagName(&quot;a&quot;)[0].getAttribute(&quot;href&quot;);
+        href = href.match(/#.*/)[0];  // Because IE return full URL.
+        n = refs[href];
+        spans[i].innerHTML =
+          &quot;[&lt;a href='#_footnote_&quot; + n +
+          &quot;' title='View footnote' class='footnote'&gt;&quot; + n + &quot;&lt;/a&gt;]&quot;;
+      }
+    }
+  }
+}
+
+}
+/*]]&gt;*/
+&lt;/script&gt;
+&lt;/head&gt;
+&lt;body&gt;
+&lt;div id=&quot;header&quot;&gt;
+&lt;h1&gt;All you ever wanted to know about counter-rollovers and dstat&lt;/h1&gt;
+&lt;/div&gt;
+&lt;div id=&quot;content&quot;&gt;
+&lt;h2 id=&quot;_what_you_need_to_know_about_counter_rollovers&quot;&gt;What you need to know about counter rollovers&lt;/h2&gt;
+&lt;div class=&quot;sectionbody&quot;&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Unfortunately, dstat is susceptible for counter rollovers, which may give
+you bogus performance output. Linux currently implements counters as 32bit
+values (not sure on 64bit platforms). This means a counter can go up to
+2^32 (= 4294967296 = 4G) values.&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Especially for network devices (which are calculated in bytes) this is too
+much as it means every 4GB, the counter is reset to 0. On a 1Gbps interface
+that is fully used, this happens every 32 seconds. On 2 bonded 10Gbps
+interfaces, this happens after 1.6 seconds.&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Since /proc is updated every second, this becomes almost impossible to catch.&lt;/p&gt;&lt;/div&gt;
+&lt;/div&gt;
+&lt;h2 id=&quot;_how_does_this_impact_dstat&quot;&gt;How does this impact dstat ?&lt;/h2&gt;
+&lt;div class=&quot;sectionbody&quot;&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Currently dstat has a problem if you specify delays that are too big. I.e.
+using 60 or 120 seconds delay in dstat will make dstat check these counters
+only once per minute or every two minutes. In the case the value is reset,
+it might be lower than the previous value (which causes negative values) or
+worse, the value is actually higher (which will go unnoticed and you get
+bogus information and dstat won&amp;#8217;t know).&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;This is very problematic, and it&amp;#8217;s important you are aware of this.&lt;/p&gt;&lt;/div&gt;
+&lt;/div&gt;
+&lt;h2 id=&quot;_what_are_the_solutions&quot;&gt;What are the solutions ?&lt;/h2&gt;
+&lt;div class=&quot;sectionbody&quot;&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;The only fix for dstat is to check more often than the specified delay.
+Unfortunately, this requires a re-design (or an ugly hack).&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;There are plans to use 64bit counters on Linux and/or changing the output from
+using bytes to kbytes. None of this is sure. (add pointers to threads)&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;To work-around this problem, you could always use a delay of 1 second, and
+re-calculate averages in Excel. This will work fine as long as you also
+re-calculate the negative values (by adding 2^32 to them).&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;If the rollovers happen only sporadically, you can just ignore those values.&lt;/p&gt;&lt;/div&gt;
+&lt;/div&gt;
+&lt;h2 id=&quot;_what_can_i_do&quot;&gt;What can I do ?&lt;/h2&gt;
+&lt;div class=&quot;sectionbody&quot;&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Since this is Open Source, you are free to fix this and send me the fix. Or
+help with a redesign of dstat to overcome this problem. Also look at the
+TODO file to see what other changes are expected in a redesign of dstat.&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Since I have a lot of other responsibilities and am currently not using dstat
+for something where this problem matters much, I will have no time to look at
+it closely (unless the fix or the redesign is made fairly simple). It all
+depends on how quick I think I can fix/redesign it and how much time I have.&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Your help could be to reduce the time it takes for me to fix it :)&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;admonitionblock&quot;&gt;
+&lt;table&gt;&lt;tr&gt;
+&lt;td class=&quot;icon&quot;&gt;
+&lt;div class=&quot;title&quot;&gt;Note&lt;/div&gt;
+&lt;/td&gt;
+&lt;td class=&quot;content&quot;&gt;Please send me improvements to this document.&lt;/td&gt;
+&lt;/tr&gt;&lt;/table&gt;
+&lt;/div&gt;
+&lt;/div&gt;
+&lt;/div&gt;
+&lt;div id=&quot;footnotes&quot;&gt;&lt;hr /&gt;&lt;/div&gt;
+&lt;div id=&quot;footer&quot;&gt;
+&lt;div id=&quot;footer-text&quot;&gt;
+Last updated 2006-12-12 16:38:30 CEST
+&lt;/div&gt;
+&lt;/div&gt;
+&lt;/body&gt;
+&lt;/html&gt;

Added: trunk/tools/dstat/docs/cplugins.html
===================================================================
--- trunk/tools/dstat/docs/cplugins.html	                        (rev 0)
+++ trunk/tools/dstat/docs/cplugins.html	2009-11-24 01:46:30 UTC (rev 8036)
@@ -0,0 +1,563 @@
+&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.1//EN&quot;
+    &quot;<A HREF="http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd</A>&quot;&gt;
+&lt;html xmlns=&quot;<A HREF="http://www.w3.org/1999/xhtml">http://www.w3.org/1999/xhtml</A>&quot; xml:lang=&quot;en&quot;&gt;
+&lt;head&gt;
+&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;
+&lt;meta name=&quot;generator&quot; content=&quot;AsciiDoc 8.5.1&quot; /&gt;
+&lt;title&gt;&lt;/title&gt;
+&lt;style type=&quot;text/css&quot;&gt;
+/* Debug borders */
+p, li, dt, dd, div, pre, h1, h2, h3, h4, h5, h6 {
+/*
+  border: 1px solid red;
+*/
+}
+
+body {
+  margin: 1em 5% 1em 5%;
+}
+
+a {
+  color: blue;
+  text-decoration: underline;
+}
+a:visited {
+  color: fuchsia;
+}
+
+em {
+  font-style: italic;
+  color: navy;
+}
+
+strong {
+  font-weight: bold;
+  color: #083194;
+}
+
+tt {
+  color: navy;
+}
+
+h1, h2, h3, h4, h5, h6 {
+  color: #527bbd;
+  font-family: sans-serif;
+  margin-top: 1.2em;
+  margin-bottom: 0.5em;
+  line-height: 1.3;
+}
+
+h1, h2, h3 {
+  border-bottom: 2px solid silver;
+}
+h2 {
+  padding-top: 0.5em;
+}
+h3 {
+  float: left;
+}
+h3 + * {
+  clear: left;
+}
+
+div.sectionbody {
+  font-family: serif;
+  margin-left: 0;
+}
+
+hr {
+  border: 1px solid silver;
+}
+
+p {
+  margin-top: 0.5em;
+  margin-bottom: 0.5em;
+}
+
+ul, ol, li &gt; p {
+  margin-top: 0;
+}
+
+pre {
+  padding: 0;
+  margin: 0;
+}
+
+span#author {
+  color: #527bbd;
+  font-family: sans-serif;
+  font-weight: bold;
+  font-size: 1.1em;
+}
+span#email {
+}
+span#revnumber, span#revdate, span#revremark {
+  font-family: sans-serif;
+}
+
+div#footer {
+  font-family: sans-serif;
+  font-size: small;
+  border-top: 2px solid silver;
+  padding-top: 0.5em;
+  margin-top: 4.0em;
+}
+div#footer-text {
+  float: left;
+  padding-bottom: 0.5em;
+}
+div#footer-badges {
+  float: right;
+  padding-bottom: 0.5em;
+}
+
+div#preamble {
+  margin-top: 1.5em;
+  margin-bottom: 1.5em;
+}
+div.tableblock, div.imageblock, div.exampleblock, div.verseblock,
+div.quoteblock, div.literalblock, div.listingblock, div.sidebarblock,
+div.admonitionblock {
+  margin-top: 0.25em;
+  margin-bottom: 1.5em;
+}
+div.admonitionblock {
+  margin-top: 2.5em;
+  margin-bottom: 2.5em;
+}
+
+div.content { /* Block element content. */
+  padding: 0;
+}
+
+/* Block element titles. */
+div.title, caption.title {
+  color: #527bbd;
+  font-family: sans-serif;
+  font-weight: bold;
+  text-align: left;
+  margin-top: 1.0em;
+  margin-bottom: 0.5em;
+}
+div.title + * {
+  margin-top: 0;
+}
+
+td div.title:first-child {
+  margin-top: 0.0em;
+}
+div.content div.title:first-child {
+  margin-top: 0.0em;
+}
+div.content + div.title {
+  margin-top: 0.0em;
+}
+
+div.sidebarblock &gt; div.content {
+  background: #ffffee;
+  border: 1px solid silver;
+  padding: 0.5em;
+}
+
+div.listingblock &gt; div.content {
+  border: 1px solid silver;
+  background: #f4f4f4;
+  padding: 0.5em;
+}
+
+div.quoteblock {
+  padding-left: 2.0em;
+  margin-right: 10%;
+}
+div.quoteblock &gt; div.attribution {
+  padding-top: 0.5em;
+  text-align: right;
+}
+
+div.verseblock {
+  padding-left: 2.0em;
+  margin-right: 10%;
+}
+div.verseblock &gt; div.content {
+  white-space: pre;
+}
+div.verseblock &gt; div.attribution {
+  padding-top: 0.75em;
+  text-align: left;
+}
+/* DEPRECATED: Pre version 8.2.7 verse style literal block. */
+div.verseblock + div.attribution {
+  text-align: left;
+}
+
+div.admonitionblock .icon {
+  vertical-align: top;
+  font-size: 1.1em;
+  font-weight: bold;
+  text-decoration: underline;
+  color: #527bbd;
+  padding-right: 0.5em;
+}
+div.admonitionblock td.content {
+  padding-left: 0.5em;
+  border-left: 2px solid silver;
+}
+
+div.exampleblock &gt; div.content {
+  border-left: 2px solid silver;
+  padding: 0.5em;
+}
+
+div.imageblock div.content { padding-left: 0; }
+span.image img { border-style: none; }
+a.image:visited { color: white; }
+
+dl {
+  margin-top: 0.8em;
+  margin-bottom: 0.8em;
+}
+dt {
+  margin-top: 0.5em;
+  margin-bottom: 0;
+  font-style: normal;
+  color: navy;
+}
+dd &gt; *:first-child {
+  margin-top: 0.1em;
+}
+
+ul, ol {
+    list-style-position: outside;
+}
+ol.arabic {
+  list-style-type: decimal;
+}
+ol.loweralpha {
+  list-style-type: lower-alpha;
+}
+ol.upperalpha {
+  list-style-type: upper-alpha;
+}
+ol.lowerroman {
+  list-style-type: lower-roman;
+}
+ol.upperroman {
+  list-style-type: upper-roman;
+}
+
+div.compact ul, div.compact ol,
+div.compact p, div.compact p,
+div.compact div, div.compact div {
+  margin-top: 0.1em;
+  margin-bottom: 0.1em;
+}
+
+div.tableblock &gt; table {
+  border: 3px solid #527bbd;
+}
+thead {
+  font-family: sans-serif;
+  font-weight: bold;
+}
+tfoot {
+  font-weight: bold;
+}
+td &gt; div.verse {
+  white-space: pre;
+}
+p.table {
+  margin-top: 0;
+}
+/* Because the table frame attribute is overriden by CSS in most browsers. */
+div.tableblock &gt; table[frame=&quot;void&quot;] {
+  border-style: none;
+}
+div.tableblock &gt; table[frame=&quot;hsides&quot;] {
+  border-left-style: none;
+  border-right-style: none;
+}
+div.tableblock &gt; table[frame=&quot;vsides&quot;] {
+  border-top-style: none;
+  border-bottom-style: none;
+}
+
+
+div.hdlist {
+  margin-top: 0.8em;
+  margin-bottom: 0.8em;
+}
+div.hdlist tr {
+  padding-bottom: 15px;
+}
+dt.hdlist1.strong, td.hdlist1.strong {
+  font-weight: bold;
+}
+td.hdlist1 {
+  vertical-align: top;
+  font-style: normal;
+  padding-right: 0.8em;
+  color: navy;
+}
+td.hdlist2 {
+  vertical-align: top;
+}
+div.hdlist.compact tr {
+  margin: 0;
+  padding-bottom: 0;
+}
+
+.comment {
+  background: yellow;
+}
+
+.footnote, .footnoteref {
+  font-size: 0.8em;
+}
+
+span.footnote, span.footnoteref {
+  vertical-align: super;
+}
+
+#footnotes {
+  margin: 20px 0 20px 0;
+  padding: 7px 0 0 0;
+}
+
+#footnotes div.footnote {
+  margin: 0 0 5px 0;
+}
+
+#footnotes hr {
+  border: none;
+  border-top: 1px solid silver;
+  height: 1px;
+  text-align: left;
+  margin-left: 0;
+  width: 20%;
+  min-width: 100px;
+}
+
+
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">+ at media</A> print {
+  div#footer-badges { display: none; }
+}
+
+div#toctitle {
+  color: #527bbd;
+  font-family: sans-serif;
+  font-size: 1.1em;
+  font-weight: bold;
+  margin-top: 1.0em;
+  margin-bottom: 0.1em;
+}
+
+div.toclevel1, div.toclevel2, div.toclevel3, div.toclevel4 {
+  margin-top: 0;
+  margin-bottom: 0;
+}
+div.toclevel2 {
+  margin-left: 2em;
+  font-size: 0.9em;
+}
+div.toclevel3 {
+  margin-left: 4em;
+  font-size: 0.9em;
+}
+div.toclevel4 {
+  margin-left: 6em;
+  font-size: 0.9em;
+}
+/* Workarounds for IE6's broken and incomplete CSS2. */
+
+div.sidebar-content {
+  background: #ffffee;
+  border: 1px solid silver;
+  padding: 0.5em;
+}
+div.sidebar-title, div.image-title {
+  color: #527bbd;
+  font-family: sans-serif;
+  font-weight: bold;
+  margin-top: 0.0em;
+  margin-bottom: 0.5em;
+}
+
+div.listingblock div.content {
+  border: 1px solid silver;
+  background: #f4f4f4;
+  padding: 0.5em;
+}
+
+div.quoteblock-attribution {
+  padding-top: 0.5em;
+  text-align: right;
+}
+
+div.verseblock-content {
+  white-space: pre;
+}
+div.verseblock-attribution {
+  padding-top: 0.75em;
+  text-align: left;
+}
+
+div.exampleblock-content {
+  border-left: 2px solid silver;
+  padding-left: 0.5em;
+}
+
+/* IE6 sets dynamically generated links as visited. */
+div#toc a:visited { color: blue; }
+&lt;/style&gt;
+&lt;script type=&quot;text/javascript&quot;&gt;
+/*&lt;![CDATA[*/
+window.onload = function(){asciidoc.footnotes();}
+var asciidoc = {  // Namespace.
+
+/////////////////////////////////////////////////////////////////////
+// Table Of Contents generator
+/////////////////////////////////////////////////////////////////////
+
+/* Author: Mihai Bazon, September 2002
+ * <A HREF="http://students.infoiasi.ro/~mishoo">http://students.infoiasi.ro/~mishoo</A>
+ *
+ * Table Of Content generator
+ * Version: 0.4
+ *
+ * Feel free to use this script under the terms of the GNU General Public
+ * License, as long as you do not remove or alter this notice.
+ */
+
+ /* modified by Troy D. Hanson, September 2006. License: GPL */
+ /* modified by Stuart Rackham, 2006, 2009. License: GPL */
+
+// toclevels = 1..4.
+toc: function (toclevels) {
+
+  function getText(el) {
+    var text = &quot;&quot;;
+    for (var i = el.firstChild; i != null; i = i.nextSibling) {
+      if (i.nodeType == 3 /* Node.TEXT_NODE */) // IE doesn't speak constants.
+        text += i.data;
+      else if (i.firstChild != null)
+        text += getText(i);
+    }
+    return text;
+  }
+
+  function TocEntry(el, text, toclevel) {
+    this.element = el;
+    this.text = text;
+    this.toclevel = toclevel;
+  }
+
+  function tocEntries(el, toclevels) {
+    var result = new Array;
+    var re = new RegExp('[hH]([2-'+(toclevels+1)+'])');
+    // Function that scans the DOM tree for header elements (the DOM2
+    // nodeIterator API would be a better technique but not supported by all
+    // browsers).
+    var iterate = function (el) {
+      for (var i = el.firstChild; i != null; i = i.nextSibling) {
+        if (i.nodeType == 1 /* Node.ELEMENT_NODE */) {
+          var mo = re.exec(i.tagName);
+          if (mo)
+            result[result.length] = new TocEntry(i, getText(i), mo[1]-1);
+          iterate(i);
+        }
+      }
+    }
+    iterate(el);
+    return result;
+  }
+
+  var toc = document.getElementById(&quot;toc&quot;);
+  var entries = tocEntries(document.getElementById(&quot;content&quot;), toclevels);
+  for (var i = 0; i &lt; entries.length; ++i) {
+    var entry = entries[i];
+    if (entry.element.id == &quot;&quot;)
+      entry.element.id = &quot;_toc_&quot; + i;
+    var a = document.createElement(&quot;a&quot;);
+    a.href = &quot;#&quot; + entry.element.id;
+    a.appendChild(document.createTextNode(entry.text));
+    var div = document.createElement(&quot;div&quot;);
+    div.appendChild(a);
+    div.className = &quot;toclevel&quot; + entry.toclevel;
+    toc.appendChild(div);
+  }
+  if (entries.length == 0)
+    toc.parentNode.removeChild(toc);
+},
+
+
+/////////////////////////////////////////////////////////////////////
+// Footnotes generator
+/////////////////////////////////////////////////////////////////////
+
+/* Based on footnote generation code from:
+ * <A HREF="http://www.brandspankingnew.net/archive/2005/07/format_footnote.html">http://www.brandspankingnew.net/archive/2005/07/format_footnote.html</A>
+ */
+
+footnotes: function () {
+  var cont = document.getElementById(&quot;content&quot;);
+  var noteholder = document.getElementById(&quot;footnotes&quot;);
+  var spans = cont.getElementsByTagName(&quot;span&quot;);
+  var refs = {};
+  var n = 0;
+  for (i=0; i&lt;spans.length; i++) {
+    if (spans[i].className == &quot;footnote&quot;) {
+      n++;
+      // Use [\s\S] in place of . so multi-line matches work.
+      // Because JavaScript has no s (dotall) regex flag.
+      note = spans[i].innerHTML.match(/\s*\[([\s\S]*)]\s*/)[1];
+      noteholder.innerHTML +=
+        &quot;&lt;div class='footnote' id='_footnote_&quot; + n + &quot;'&gt;&quot; +
+        &quot;&lt;a href='#_footnoteref_&quot; + n + &quot;' title='Return to text'&gt;&quot; +
+        n + &quot;&lt;/a&gt;. &quot; + note + &quot;&lt;/div&gt;&quot;;
+      spans[i].innerHTML =
+        &quot;[&lt;a id='_footnoteref_&quot; + n + &quot;' href='#_footnote_&quot; + n +
+        &quot;' title='View footnote' class='footnote'&gt;&quot; + n + &quot;&lt;/a&gt;]&quot;;
+      var id =spans[i].getAttribute(&quot;id&quot;);
+      if (id != null) refs[&quot;#&quot;+id] = n;
+    }
+  }
+  if (n == 0)
+    noteholder.parentNode.removeChild(noteholder);
+  else {
+    // Process footnoterefs.
+    for (i=0; i&lt;spans.length; i++) {
+      if (spans[i].className == &quot;footnoteref&quot;) {
+        var href = spans[i].getElementsByTagName(&quot;a&quot;)[0].getAttribute(&quot;href&quot;);
+        href = href.match(/#.*/)[0];  // Because IE return full URL.
+        n = refs[href];
+        spans[i].innerHTML =
+          &quot;[&lt;a href='#_footnote_&quot; + n +
+          &quot;' title='View footnote' class='footnote'&gt;&quot; + n + &quot;&lt;/a&gt;]&quot;;
+      }
+    }
+  }
+}
+
+}
+/*]]&gt;*/
+&lt;/script&gt;
+&lt;/head&gt;
+&lt;body&gt;
+&lt;div id=&quot;header&quot;&gt;
+&lt;/div&gt;
+&lt;div id=&quot;content&quot;&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Defining Python class methods in C
+&lt;a href=&quot;<A HREF="http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/54352">http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/54352</A>&quot;&gt;<A HREF="http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/54352&lt;/a">http://aspn.activestate.com/ASPN/Cookbook/Python/Recipe/54352&lt;/a</A>&gt;&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;python class in c / global calls
+&lt;a href=&quot;<A HREF="http://mail.python.org/pipermail/python-list/2002-August/160784.html">http://mail.python.org/pipermail/python-list/2002-August/160784.html</A>&quot;&gt;<A HREF="http://mail.python.org/pipermail/python-list/2002-August/160784.html&lt;/a">http://mail.python.org/pipermail/python-list/2002-August/160784.html&lt;/a</A>&gt;&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;How to create a python class in C
+&lt;a href=&quot;<A HREF="http://mail.python.org/pipermail/python-list/2000-August/047158.html">http://mail.python.org/pipermail/python-list/2000-August/047158.html</A>&quot;&gt;<A HREF="http://mail.python.org/pipermail/python-list/2000-August/047158.html&lt;/a">http://mail.python.org/pipermail/python-list/2000-August/047158.html&lt;/a</A>&gt;&lt;/p&gt;&lt;/div&gt;
+&lt;/div&gt;
+&lt;div id=&quot;footnotes&quot;&gt;&lt;hr /&gt;&lt;/div&gt;
+&lt;div id=&quot;footer&quot;&gt;
+&lt;div id=&quot;footer-text&quot;&gt;
+Last updated 2007-06-05 02:10:27 CEST
+&lt;/div&gt;
+&lt;/div&gt;
+&lt;/body&gt;
+&lt;/html&gt;

Added: trunk/tools/dstat/docs/dstat-paper.html
===================================================================
--- trunk/tools/dstat/docs/dstat-paper.html	                        (rev 0)
+++ trunk/tools/dstat/docs/dstat-paper.html	2009-11-24 01:46:30 UTC (rev 8036)
@@ -0,0 +1,1747 @@
+&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.1//EN&quot;
+    &quot;<A HREF="http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd</A>&quot;&gt;
+&lt;html xmlns=&quot;<A HREF="http://www.w3.org/1999/xhtml">http://www.w3.org/1999/xhtml</A>&quot; xml:lang=&quot;en&quot;&gt;
+&lt;head&gt;
+&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;
+&lt;meta name=&quot;generator&quot; content=&quot;AsciiDoc 8.5.1&quot; /&gt;
+&lt;title&gt;Dstat: plugin-based real-time monitoring&lt;/title&gt;
+&lt;style type=&quot;text/css&quot;&gt;
+/* Debug borders */
+p, li, dt, dd, div, pre, h1, h2, h3, h4, h5, h6 {
+/*
+  border: 1px solid red;
+*/
+}
+
+body {
+  margin: 1em 5% 1em 5%;
+}
+
+a {
+  color: blue;
+  text-decoration: underline;
+}
+a:visited {
+  color: fuchsia;
+}
+
+em {
+  font-style: italic;
+  color: navy;
+}
+
+strong {
+  font-weight: bold;
+  color: #083194;
+}
+
+tt {
+  color: navy;
+}
+
+h1, h2, h3, h4, h5, h6 {
+  color: #527bbd;
+  font-family: sans-serif;
+  margin-top: 1.2em;
+  margin-bottom: 0.5em;
+  line-height: 1.3;
+}
+
+h1, h2, h3 {
+  border-bottom: 2px solid silver;
+}
+h2 {
+  padding-top: 0.5em;
+}
+h3 {
+  float: left;
+}
+h3 + * {
+  clear: left;
+}
+
+div.sectionbody {
+  font-family: serif;
+  margin-left: 0;
+}
+
+hr {
+  border: 1px solid silver;
+}
+
+p {
+  margin-top: 0.5em;
+  margin-bottom: 0.5em;
+}
+
+ul, ol, li &gt; p {
+  margin-top: 0;
+}
+
+pre {
+  padding: 0;
+  margin: 0;
+}
+
+span#author {
+  color: #527bbd;
+  font-family: sans-serif;
+  font-weight: bold;
+  font-size: 1.1em;
+}
+span#email {
+}
+span#revnumber, span#revdate, span#revremark {
+  font-family: sans-serif;
+}
+
+div#footer {
+  font-family: sans-serif;
+  font-size: small;
+  border-top: 2px solid silver;
+  padding-top: 0.5em;
+  margin-top: 4.0em;
+}
+div#footer-text {
+  float: left;
+  padding-bottom: 0.5em;
+}
+div#footer-badges {
+  float: right;
+  padding-bottom: 0.5em;
+}
+
+div#preamble {
+  margin-top: 1.5em;
+  margin-bottom: 1.5em;
+}
+div.tableblock, div.imageblock, div.exampleblock, div.verseblock,
+div.quoteblock, div.literalblock, div.listingblock, div.sidebarblock,
+div.admonitionblock {
+  margin-top: 0.25em;
+  margin-bottom: 1.5em;
+}
+div.admonitionblock {
+  margin-top: 2.5em;
+  margin-bottom: 2.5em;
+}
+
+div.content { /* Block element content. */
+  padding: 0;
+}
+
+/* Block element titles. */
+div.title, caption.title {
+  color: #527bbd;
+  font-family: sans-serif;
+  font-weight: bold;
+  text-align: left;
+  margin-top: 1.0em;
+  margin-bottom: 0.5em;
+}
+div.title + * {
+  margin-top: 0;
+}
+
+td div.title:first-child {
+  margin-top: 0.0em;
+}
+div.content div.title:first-child {
+  margin-top: 0.0em;
+}
+div.content + div.title {
+  margin-top: 0.0em;
+}
+
+div.sidebarblock &gt; div.content {
+  background: #ffffee;
+  border: 1px solid silver;
+  padding: 0.5em;
+}
+
+div.listingblock &gt; div.content {
+  border: 1px solid silver;
+  background: #f4f4f4;
+  padding: 0.5em;
+}
+
+div.quoteblock {
+  padding-left: 2.0em;
+  margin-right: 10%;
+}
+div.quoteblock &gt; div.attribution {
+  padding-top: 0.5em;
+  text-align: right;
+}
+
+div.verseblock {
+  padding-left: 2.0em;
+  margin-right: 10%;
+}
+div.verseblock &gt; div.content {
+  white-space: pre;
+}
+div.verseblock &gt; div.attribution {
+  padding-top: 0.75em;
+  text-align: left;
+}
+/* DEPRECATED: Pre version 8.2.7 verse style literal block. */
+div.verseblock + div.attribution {
+  text-align: left;
+}
+
+div.admonitionblock .icon {
+  vertical-align: top;
+  font-size: 1.1em;
+  font-weight: bold;
+  text-decoration: underline;
+  color: #527bbd;
+  padding-right: 0.5em;
+}
+div.admonitionblock td.content {
+  padding-left: 0.5em;
+  border-left: 2px solid silver;
+}
+
+div.exampleblock &gt; div.content {
+  border-left: 2px solid silver;
+  padding: 0.5em;
+}
+
+div.imageblock div.content { padding-left: 0; }
+span.image img { border-style: none; }
+a.image:visited { color: white; }
+
+dl {
+  margin-top: 0.8em;
+  margin-bottom: 0.8em;
+}
+dt {
+  margin-top: 0.5em;
+  margin-bottom: 0;
+  font-style: normal;
+  color: navy;
+}
+dd &gt; *:first-child {
+  margin-top: 0.1em;
+}
+
+ul, ol {
+    list-style-position: outside;
+}
+ol.arabic {
+  list-style-type: decimal;
+}
+ol.loweralpha {
+  list-style-type: lower-alpha;
+}
+ol.upperalpha {
+  list-style-type: upper-alpha;
+}
+ol.lowerroman {
+  list-style-type: lower-roman;
+}
+ol.upperroman {
+  list-style-type: upper-roman;
+}
+
+div.compact ul, div.compact ol,
+div.compact p, div.compact p,
+div.compact div, div.compact div {
+  margin-top: 0.1em;
+  margin-bottom: 0.1em;
+}
+
+div.tableblock &gt; table {
+  border: 3px solid #527bbd;
+}
+thead {
+  font-family: sans-serif;
+  font-weight: bold;
+}
+tfoot {
+  font-weight: bold;
+}
+td &gt; div.verse {
+  white-space: pre;
+}
+p.table {
+  margin-top: 0;
+}
+/* Because the table frame attribute is overriden by CSS in most browsers. */
+div.tableblock &gt; table[frame=&quot;void&quot;] {
+  border-style: none;
+}
+div.tableblock &gt; table[frame=&quot;hsides&quot;] {
+  border-left-style: none;
+  border-right-style: none;
+}
+div.tableblock &gt; table[frame=&quot;vsides&quot;] {
+  border-top-style: none;
+  border-bottom-style: none;
+}
+
+
+div.hdlist {
+  margin-top: 0.8em;
+  margin-bottom: 0.8em;
+}
+div.hdlist tr {
+  padding-bottom: 15px;
+}
+dt.hdlist1.strong, td.hdlist1.strong {
+  font-weight: bold;
+}
+td.hdlist1 {
+  vertical-align: top;
+  font-style: normal;
+  padding-right: 0.8em;
+  color: navy;
+}
+td.hdlist2 {
+  vertical-align: top;
+}
+div.hdlist.compact tr {
+  margin: 0;
+  padding-bottom: 0;
+}
+
+.comment {
+  background: yellow;
+}
+
+.footnote, .footnoteref {
+  font-size: 0.8em;
+}
+
+span.footnote, span.footnoteref {
+  vertical-align: super;
+}
+
+#footnotes {
+  margin: 20px 0 20px 0;
+  padding: 7px 0 0 0;
+}
+
+#footnotes div.footnote {
+  margin: 0 0 5px 0;
+}
+
+#footnotes hr {
+  border: none;
+  border-top: 1px solid silver;
+  height: 1px;
+  text-align: left;
+  margin-left: 0;
+  width: 20%;
+  min-width: 100px;
+}
+
+
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">+ at media</A> print {
+  div#footer-badges { display: none; }
+}
+
+div#toctitle {
+  color: #527bbd;
+  font-family: sans-serif;
+  font-size: 1.1em;
+  font-weight: bold;
+  margin-top: 1.0em;
+  margin-bottom: 0.1em;
+}
+
+div.toclevel1, div.toclevel2, div.toclevel3, div.toclevel4 {
+  margin-top: 0;
+  margin-bottom: 0;
+}
+div.toclevel2 {
+  margin-left: 2em;
+  font-size: 0.9em;
+}
+div.toclevel3 {
+  margin-left: 4em;
+  font-size: 0.9em;
+}
+div.toclevel4 {
+  margin-left: 6em;
+  font-size: 0.9em;
+}
+/* Workarounds for IE6's broken and incomplete CSS2. */
+
+div.sidebar-content {
+  background: #ffffee;
+  border: 1px solid silver;
+  padding: 0.5em;
+}
+div.sidebar-title, div.image-title {
+  color: #527bbd;
+  font-family: sans-serif;
+  font-weight: bold;
+  margin-top: 0.0em;
+  margin-bottom: 0.5em;
+}
+
+div.listingblock div.content {
+  border: 1px solid silver;
+  background: #f4f4f4;
+  padding: 0.5em;
+}
+
+div.quoteblock-attribution {
+  padding-top: 0.5em;
+  text-align: right;
+}
+
+div.verseblock-content {
+  white-space: pre;
+}
+div.verseblock-attribution {
+  padding-top: 0.75em;
+  text-align: left;
+}
+
+div.exampleblock-content {
+  border-left: 2px solid silver;
+  padding-left: 0.5em;
+}
+
+/* IE6 sets dynamically generated links as visited. */
+div#toc a:visited { color: blue; }
+&lt;/style&gt;
+&lt;script type=&quot;text/javascript&quot;&gt;
+/*&lt;![CDATA[*/
+window.onload = function(){asciidoc.footnotes();}
+var asciidoc = {  // Namespace.
+
+/////////////////////////////////////////////////////////////////////
+// Table Of Contents generator
+/////////////////////////////////////////////////////////////////////
+
+/* Author: Mihai Bazon, September 2002
+ * <A HREF="http://students.infoiasi.ro/~mishoo">http://students.infoiasi.ro/~mishoo</A>
+ *
+ * Table Of Content generator
+ * Version: 0.4
+ *
+ * Feel free to use this script under the terms of the GNU General Public
+ * License, as long as you do not remove or alter this notice.
+ */
+
+ /* modified by Troy D. Hanson, September 2006. License: GPL */
+ /* modified by Stuart Rackham, 2006, 2009. License: GPL */
+
+// toclevels = 1..4.
+toc: function (toclevels) {
+
+  function getText(el) {
+    var text = &quot;&quot;;
+    for (var i = el.firstChild; i != null; i = i.nextSibling) {
+      if (i.nodeType == 3 /* Node.TEXT_NODE */) // IE doesn't speak constants.
+        text += i.data;
+      else if (i.firstChild != null)
+        text += getText(i);
+    }
+    return text;
+  }
+
+  function TocEntry(el, text, toclevel) {
+    this.element = el;
+    this.text = text;
+    this.toclevel = toclevel;
+  }
+
+  function tocEntries(el, toclevels) {
+    var result = new Array;
+    var re = new RegExp('[hH]([2-'+(toclevels+1)+'])');
+    // Function that scans the DOM tree for header elements (the DOM2
+    // nodeIterator API would be a better technique but not supported by all
+    // browsers).
+    var iterate = function (el) {
+      for (var i = el.firstChild; i != null; i = i.nextSibling) {
+        if (i.nodeType == 1 /* Node.ELEMENT_NODE */) {
+          var mo = re.exec(i.tagName);
+          if (mo)
+            result[result.length] = new TocEntry(i, getText(i), mo[1]-1);
+          iterate(i);
+        }
+      }
+    }
+    iterate(el);
+    return result;
+  }
+
+  var toc = document.getElementById(&quot;toc&quot;);
+  var entries = tocEntries(document.getElementById(&quot;content&quot;), toclevels);
+  for (var i = 0; i &lt; entries.length; ++i) {
+    var entry = entries[i];
+    if (entry.element.id == &quot;&quot;)
+      entry.element.id = &quot;_toc_&quot; + i;
+    var a = document.createElement(&quot;a&quot;);
+    a.href = &quot;#&quot; + entry.element.id;
+    a.appendChild(document.createTextNode(entry.text));
+    var div = document.createElement(&quot;div&quot;);
+    div.appendChild(a);
+    div.className = &quot;toclevel&quot; + entry.toclevel;
+    toc.appendChild(div);
+  }
+  if (entries.length == 0)
+    toc.parentNode.removeChild(toc);
+},
+
+
+/////////////////////////////////////////////////////////////////////
+// Footnotes generator
+/////////////////////////////////////////////////////////////////////
+
+/* Based on footnote generation code from:
+ * <A HREF="http://www.brandspankingnew.net/archive/2005/07/format_footnote.html">http://www.brandspankingnew.net/archive/2005/07/format_footnote.html</A>
+ */
+
+footnotes: function () {
+  var cont = document.getElementById(&quot;content&quot;);
+  var noteholder = document.getElementById(&quot;footnotes&quot;);
+  var spans = cont.getElementsByTagName(&quot;span&quot;);
+  var refs = {};
+  var n = 0;
+  for (i=0; i&lt;spans.length; i++) {
+    if (spans[i].className == &quot;footnote&quot;) {
+      n++;
+      // Use [\s\S] in place of . so multi-line matches work.
+      // Because JavaScript has no s (dotall) regex flag.
+      note = spans[i].innerHTML.match(/\s*\[([\s\S]*)]\s*/)[1];
+      noteholder.innerHTML +=
+        &quot;&lt;div class='footnote' id='_footnote_&quot; + n + &quot;'&gt;&quot; +
+        &quot;&lt;a href='#_footnoteref_&quot; + n + &quot;' title='Return to text'&gt;&quot; +
+        n + &quot;&lt;/a&gt;. &quot; + note + &quot;&lt;/div&gt;&quot;;
+      spans[i].innerHTML =
+        &quot;[&lt;a id='_footnoteref_&quot; + n + &quot;' href='#_footnote_&quot; + n +
+        &quot;' title='View footnote' class='footnote'&gt;&quot; + n + &quot;&lt;/a&gt;]&quot;;
+      var id =spans[i].getAttribute(&quot;id&quot;);
+      if (id != null) refs[&quot;#&quot;+id] = n;
+    }
+  }
+  if (n == 0)
+    noteholder.parentNode.removeChild(noteholder);
+  else {
+    // Process footnoterefs.
+    for (i=0; i&lt;spans.length; i++) {
+      if (spans[i].className == &quot;footnoteref&quot;) {
+        var href = spans[i].getElementsByTagName(&quot;a&quot;)[0].getAttribute(&quot;href&quot;);
+        href = href.match(/#.*/)[0];  // Because IE return full URL.
+        n = refs[href];
+        spans[i].innerHTML =
+          &quot;[&lt;a href='#_footnote_&quot; + n +
+          &quot;' title='View footnote' class='footnote'&gt;&quot; + n + &quot;&lt;/a&gt;]&quot;;
+      }
+    }
+  }
+}
+
+}
+/*]]&gt;*/
+&lt;/script&gt;
+&lt;/head&gt;
+&lt;body&gt;
+&lt;div id=&quot;header&quot;&gt;
+&lt;h1&gt;Dstat: plugin-based real-time monitoring&lt;/h1&gt;
+&lt;span id=&quot;author&quot;&gt;Dag Wieers&lt;/span&gt;&lt;br /&gt;
+&lt;span id=&quot;email&quot;&gt;&lt;tt&gt;&amp;lt;&lt;a href=&quot;mailto:<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>&quot;&gt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>&lt;/a&gt;&amp;gt;&lt;/tt&gt;&lt;/span&gt;&lt;br /&gt;
+&lt;span id=&quot;revdate&quot;&gt;$Id$&lt;/span&gt;
+&lt;/div&gt;
+&lt;div id=&quot;content&quot;&gt;
+&lt;h2 id=&quot;_introduction&quot;&gt;Introduction&lt;/h2&gt;
+&lt;div class=&quot;sectionbody&quot;&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Many tools exist to monitor hardware resources and software behaviour, but few
+tools exist that allow you to easily monitor any conceivable counter.&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Dstat was designed with the idea that it should be simple to plug in a piece
+of code that extracts one or more counters, and make it visible in a way that
+visually pleases the eye and helps you extract information in real-time.&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;By being able to select those counters that you want (and likely those
+counters that matter to you in the job you&amp;#8217;re doing) you make it easier to
+correlate raw numbers and see a pattern that may otherwise not be visible.&lt;/p&gt;&lt;/div&gt;
+&lt;/div&gt;
+&lt;h2 id=&quot;_a_case_for_dstat&quot;&gt;A case for Dstat&lt;/h2&gt;
+&lt;div class=&quot;sectionbody&quot;&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;A few years ago I was involved in a project that was testing a storage cluster
+with a SAN back-end using GPFS and Samba for a broadcasting company. The
+performance tests that were scheduled together with the customer took a few
+weeks to measure the different behaviour under different stresses.&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;During these tests there was a need to see how each of the components behaved
+and to find problematic behaviour during testing. Also, because it involved 5
+GPFS nodes, we needed to make sure that the load was spread evenly during the
+test. If everything went well repeatedly, the results were validated and the
+next batch of tests could be prepared and run.&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;We started off using different tools at first, but the more counters we were
+trying to capture the harder it was to post-process the information we had
+collected. What&amp;#8217;s more, we often saw only after performing the tests that the
+data was not representative because the numbers didn&amp;#8217;t add up. Sometimes it
+was caused by the massive setup of clients that were autonomously stressing the
+cluster. On other occasions we noticed that the network was the culprit. All in
+all, we lost time because we could only validate the results by relating
+numbers after the tests were complete and not during the tests.&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Complicating the matter was the fact that 5 different nodes were involved
+and using the normal command line tools like vmstat, iostat or ifstat (which
+only showed us a small part of what was happening) was problematic as each
+needed a different terminal. Besides, not all information was interesting.&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Eventually Dstat was born, to make a dull task more enjoyable.&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;After the project was finished I was able to correlate system resources with
+network throughput, TCP information, Samba sessions, GPFS throughput,
+accumulated block device throughput, HBA throughput, all within a single
+interval.&lt;/p&gt;&lt;/div&gt;
+&lt;/div&gt;
+&lt;h2 id=&quot;_dstat_characteristics&quot;&gt;Dstat characteristics&lt;/h2&gt;
+&lt;div class=&quot;sectionbody&quot;&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;There are many ideas incorporated into Dstat by design, and this section
+serves to list all of them. Not all of them may appeal to the task you&amp;#8217;re
+doing, but the combination may make it an appealing proposition nevertheless.&lt;/p&gt;&lt;/div&gt;
+&lt;h3 id=&quot;_history_of_counters&quot;&gt;History of counters&lt;/h3&gt;&lt;div style=&quot;clear:left&quot;&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;An important characteristic in tools like vmstat, iostat or ifstat is the fact
+that you can compare historical collected data with new data. This allows you
+to have a good feeling of how something is evolving.&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Compare this to tools like top or nmon, where data is often being refreshed
+and you loose historical information.&lt;/p&gt;&lt;/div&gt;
+&lt;h3 id=&quot;_adding_unit_indication&quot;&gt;Adding unit indication&lt;/h3&gt;&lt;div style=&quot;clear:left&quot;&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;It was very important that when numbers were compared, they were in the same
+unit, and not eg. a different power exponent. The human mind sometimes works
+in mysterious ways and more so when working with numbers for hours and hours.
+Adding the unit is something very convenient and may reduce the human error
+factor.&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Additionally, indicating the unit also makes sure that the columns have a
+fixed width. Often when using vmstat or other tools, the columns tend to shift
+depending on the width of the counter. This makes it very inconvenient to find
+counters in the shifted output.&lt;/p&gt;&lt;/div&gt;
+&lt;h3 id=&quot;_colour_highlighting_units&quot;&gt;Colour highlighting units&lt;/h3&gt;&lt;div style=&quot;clear:left&quot;&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;After I added colours to help improve indicating units, I noticed that the
+colours also helped to show patterns. This of course is very limited,
+nevertheless it instantly shows when numbers are flat or changes are taking
+place.&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;admonitionblock&quot;&gt;
+&lt;table&gt;&lt;tr&gt;
+&lt;td class=&quot;icon&quot;&gt;
+&lt;div class=&quot;title&quot;&gt;Important&lt;/div&gt;
+&lt;/td&gt;
+&lt;td class=&quot;content&quot;&gt;The colours are arbitrarily chosen. Do not make the mistake to
+assume that green means good and red means bad. There is no real meaning to
+the colour itself, however a change of colour does mean that a value has gone
+over some pre-defined limit.&lt;/td&gt;
+&lt;/tr&gt;&lt;/table&gt;
+&lt;/div&gt;
+&lt;h3 id=&quot;_intermediate_updates&quot;&gt;Intermediate updates&lt;/h3&gt;&lt;div style=&quot;clear:left&quot;&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;During tests, when you choose to see average values over a given time, it can
+be useful to see how the averages evolve. Dstat, by default, displays
+intermediate updates. This means that if you select to see 10 second averages,
+after each second you see the accumulated average over the timespan. &lt;strong&gt;This
+means that after 4 seconds with intermediate updates, you see an average
+taken over the 4 second timeframe.&lt;/strong&gt;&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;admonitionblock&quot;&gt;
+&lt;table&gt;&lt;tr&gt;
+&lt;td class=&quot;icon&quot;&gt;
+&lt;div class=&quot;title&quot;&gt;Note&lt;/div&gt;
+&lt;/td&gt;
+&lt;td class=&quot;content&quot;&gt;This means that the closer you get to the given timeframe (eg. 10 seconds)
+the more likely that it nears its final average over that period.&lt;/td&gt;
+&lt;/tr&gt;&lt;/table&gt;
+&lt;/div&gt;
+&lt;h3 id=&quot;_adding_custom_counters&quot;&gt;Adding custom counters&lt;/h3&gt;&lt;div style=&quot;clear:left&quot;&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Dstat was specifically designed to enable anyone to add their own counters in a
+matter of minutes. The plugin-based system takes care of displaying, colouring
+and adding units to the counters. As a plugin-writer, you only have to focus
+on extracting the counters from the kernel (procfs or sysfs), logfiles or
+daemons.&lt;/p&gt;&lt;/div&gt;
+&lt;h3 id=&quot;_selecting_plugins_and_counters&quot;&gt;Selecting plugins and counters&lt;/h3&gt;&lt;div style=&quot;clear:left&quot;&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Being able to add custom counters is important, but selecting those counters
+that you really need is even more important if you want to correlate counters
+and see patterns. Less is more.&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;admonitionblock&quot;&gt;
+&lt;table&gt;&lt;tr&gt;
+&lt;td class=&quot;icon&quot;&gt;
+&lt;div class=&quot;title&quot;&gt;Note&lt;/div&gt;
+&lt;/td&gt;
+&lt;td class=&quot;content&quot;&gt;In fact, Dstat currently does not allow you to select just counters, it
+only allows you to select plugins. However, since you can modify or fork a
+plugin, you still have the ability to select just those counters you prefer.&lt;/td&gt;
+&lt;/tr&gt;&lt;/table&gt;
+&lt;/div&gt;
+&lt;h3 id=&quot;_exporting_to_csv&quot;&gt;Exporting to CSV&lt;/h3&gt;&lt;div style=&quot;clear:left&quot;&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Having information on screen is one thing, you most likely need some hard
+evidence later to make your case. (Why else do all the work?)&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Dstat allows to write out all counters in the greatest detail possible to CSV.
+By default it also adds the command-line used for generating the output, as
+well as a date and time stamp. Since Dstat in the first place is meant for
+human-readable real-time statistics, it will by default also display the
+counters to screen (unless you &lt;em&gt;/dev/null&lt;/em&gt; it).&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;admonitionblock&quot;&gt;
+&lt;table&gt;&lt;tr&gt;
+&lt;td class=&quot;icon&quot;&gt;
+&lt;div class=&quot;title&quot;&gt;Tip&lt;/div&gt;
+&lt;/td&gt;
+&lt;td class=&quot;content&quot;&gt;Dstat appends to the output file so that you can add tests-results of
+different tests to a single file. However, make sure that you tag each test
+properly (eg. by using distinct filenames for each different test).&lt;/td&gt;
+&lt;/tr&gt;&lt;/table&gt;
+&lt;/div&gt;
+&lt;h3 id=&quot;_time_plugin_included&quot;&gt;Time-plugin included&lt;/h3&gt;&lt;div style=&quot;clear:left&quot;&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;It may seem a small thing, but having exact time (and date) information for
+your counters allows for a completely different usage as well. By adding
+simple date and time information, Dstat can be used as a background process in
+a screen to monitor the behaviour of your system during the night.&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;This proves to be very valuable for example, to find offending processes during
+nightly tasks or to pinpoint their behaviour to certain events that you cannot
+monitor during working hours.&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;It is also important when you have multiple Dstats running (eg. for nodes in a
+cluster) to correlate counters between the outputs.&lt;/p&gt;&lt;/div&gt;
+&lt;h3 id=&quot;_terminal_capabilities&quot;&gt;Terminal capabilities&lt;/h3&gt;&lt;div style=&quot;clear:left&quot;&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Dstat also takes into account the width and height of your terminal window and
+modifies output to fit into your terminal. This, of course, has no effect on
+what ends up in the CSV output.&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Another (debatable) useful feature is that Dstat will modify the terminal
+title to indicate on what system it was run and what options were used.
+Especially when monitoring nodes in a cluster, this can be useful, but even in
+Gnome finding your Dstat window is handy.&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;admonitionblock&quot;&gt;
+&lt;table&gt;&lt;tr&gt;
+&lt;td class=&quot;icon&quot;&gt;
+&lt;div class=&quot;title&quot;&gt;Warning&lt;/div&gt;
+&lt;/td&gt;
+&lt;td class=&quot;content&quot;&gt;Some people however are annoyed by the fact that their distribution
+does not reset the terminal title and Dstat therefor messes it up. There is no
+way for Dstat to fix this.&lt;/td&gt;
+&lt;/tr&gt;&lt;/table&gt;
+&lt;/div&gt;
+&lt;/div&gt;
+&lt;h2 id=&quot;_plugins_and_counters&quot;&gt;Plugins and counters&lt;/h2&gt;
+&lt;div class=&quot;sectionbody&quot;&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;When we talk about plugins, we make a distinction between those plugins that
+are included within the Dstat tool itself, and those that ship with it
+externally.  In essence there is no real difference, as the internal plugins
+could easily have been created as an external plugin. The basic difference is
+that the internal plugins have no dependencies except on procfs.&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Having the basic plugins as part of Dstat, makes sure that Dstat can be moved
+as a self-contained file to other systems.&lt;/p&gt;&lt;/div&gt;
+&lt;h3 id=&quot;_internal_plugins&quot;&gt;Internal plugins&lt;/h3&gt;&lt;div style=&quot;clear:left&quot;&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;The plugins that have been selected to be part of the Dstat tool itself, and
+therefor have no dependencies other than procfs, are:&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;ulist&quot;&gt;&lt;ul&gt;
+&lt;li&gt;
+&lt;p&gt;
+aio: asynchronous I/O counters
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+cpu, cpu24: CPU counters (&lt;tt&gt;-c&lt;/tt&gt; and &lt;tt&gt;-C&lt;/tt&gt;)
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+disk, disk24, disk24old: disk counters (&lt;tt&gt;-d&lt;/tt&gt; and &lt;tt&gt;-D&lt;/tt&gt;)
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+epoch: seconds since Epoch (&lt;tt&gt;-T&lt;/tt&gt;)
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+fs: file system counters
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+int, int24: interrupts per IRQ (&lt;tt&gt;-i&lt;/tt&gt; and &lt;tt&gt;-I&lt;/tt&gt;)
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+io: I/O requests completed (&lt;tt&gt;-r&lt;/tt&gt;)
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+ipc: IPC counters
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+load: load counters (&lt;tt&gt;-l&lt;/tt&gt;)
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+lock: locking counters
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+mem: memory usage (&lt;tt&gt;-m&lt;/tt&gt;)
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+net: network usage (&lt;tt&gt;-n&lt;/tt&gt; and &lt;tt&gt;-N&lt;/tt&gt;)
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+page, page24: paging counters (&lt;tt&gt;-g&lt;/tt&gt;)
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+proc: process counters (&lt;tt&gt;-p&lt;/tt&gt;)
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+raw: raw socket counters
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+swap, swapold: swap usage (&lt;tt&gt;-s&lt;/tt&gt; and &lt;tt&gt;-S&lt;/tt&gt;)
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+socket: socket counters
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+sys: system (kernel) countersA (&lt;tt&gt;-y&lt;/tt&gt;)
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+tcp: TCP socket counters
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+time: date and time (&lt;tt&gt;-t&lt;/tt&gt;)
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+udp: UDP socket counters
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+unix: unix socket counters
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+vm: virtual memory counters
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;/ul&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;For backward compatibility with older kernels there is a cascading system that
+selects the most appropriate internal plugin for your kernel. (eg. the
+&lt;tt&gt;dstat_disk&lt;/tt&gt; plugin falls back to &lt;tt&gt;dstat_disk24&lt;/tt&gt; and &lt;tt&gt;dstat_disk24old&lt;/tt&gt;) At this
+moment there is no such system for external plugins.&lt;/p&gt;&lt;/div&gt;
+&lt;h3 id=&quot;_external_plugins&quot;&gt;External plugins&lt;/h3&gt;&lt;div style=&quot;clear:left&quot;&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;This basic functionality is easily extended by writing your own plugins
+(subclasses of the python Dstat class) which are then inserted at runtime
+into Dstat. A set of &lt;em&gt;external&lt;/em&gt; modules exist for:&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;ulist&quot;&gt;&lt;ul&gt;
+&lt;li&gt;
+&lt;p&gt;
+battery: battery usage
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+cpufreq: CPU frequency
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+dbus: DBUS connections
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+fan: Fan speed
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+freespace: free space on filesystems
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+gpfsop: GPFS operations counters
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+gpfs: GPFS IO counters
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+helloworld: Hello world dispenser
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+innodb_buffer: innodb buffer counters
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+innodb_io: innodb I/O counters
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+innodb_keys: innodb key operation counters
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+innodb_ops: innodb operations counters
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+lustre: lustre throughput counters
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+memcache_hits: Memcache hit counters
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+mysql5_com: MySQL communication counters
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+mysql5_conn: MySQL connection counters
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+mysql5_io: MySQL I/O counters
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+mysql5_keys: MySQL keys counters
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+mysql_io: MySQL I/O counters
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+mysql_ops: MySQL operations counters
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+nfs3op: NFS3 client operations counters
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+nfs3: NFS3 client counters
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+nfsd3op: NFS3 server operations counters
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+nfsd3: NFS3 server counters
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+ntp: NTP time counters
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+postfix: postfix queue counters
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+power: Power usage counters
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+rpcd: RPC server counters
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+rpc: RPC client counters
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+sendmail: sendmail queue counters
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+snooze: Dstat time delay counters
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+thermal: Thermal counters
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+topbio: most expensive block I/O process
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+topcpu: most expensive cpu process
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+topio: most expensive I/O process
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+topmem: most expensive memory process
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+topoom: process first shot by OOM killer
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+utmp: utmp counters
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+vmkhba: VMware kernel HBA counters
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+vmkint: VMware kernel interrupt counters
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+vmknic: VMware kernel NIC counters
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+vmmemctl: VMware guest memory counters
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+vzcpu: OpenVZ CPU counters
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+vzubc: OpenVZ user beancounters
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+wifi: WIFI quality information
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;/ul&gt;&lt;/div&gt;
+&lt;h3 id=&quot;_most_wanted_plugins&quot;&gt;Most-wanted plugins&lt;/h3&gt;&lt;div style=&quot;clear:left&quot;&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Hoping someone interested reads this document, I added a few plugins that
+would be &amp;#8220;very nice&amp;#8221; to have but are currently lacking:&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;ulist&quot;&gt;&lt;ul&gt;
+&lt;li&gt;
+&lt;p&gt;
+slab: needs a VM expert to make sense out of the vast amount of data
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+xorg: need information on how to get X resources, would be nice
+      to see evolution of X resources over time
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+samba: lacking information to get counters from Samba without
+      forking smbstatus every second
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+snmp: could be useful to relate counters from different systems
+      in a single Dstat
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+topx: display the most expensive X application(s)
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+systemtap: connecting Dstat to systemtap counters
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;/ul&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Creative souls with other ideas are welcome as well !&lt;/p&gt;&lt;/div&gt;
+&lt;/div&gt;
+&lt;h2 id=&quot;_using_dstat&quot;&gt;Using Dstat&lt;/h2&gt;
+&lt;div class=&quot;sectionbody&quot;&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Central to the Dstat command line interface is the selection of plugins. The
+selection and order of options influence the Dstat output directly.&lt;/p&gt;&lt;/div&gt;
+&lt;h3 id=&quot;_enabling_plugins&quot;&gt;Enabling plugins&lt;/h3&gt;&lt;div style=&quot;clear:left&quot;&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;The internal plugins have short and/or long options within Dstat, eg. &lt;tt&gt;-c&lt;/tt&gt; or
+&lt;tt&gt;--cpu&lt;/tt&gt; will enable the cpu counters.&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;The external plugins are enable by a long option including their name,
+eg. --topcpu&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;The following examples will enable the time, cpu and disk plugins, and are
+equal.&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;listingblock&quot;&gt;
+&lt;div class=&quot;content&quot;&gt;
+&lt;pre&gt;&lt;tt&gt;dstat -tcd
+dstat --time --cpu --disk&lt;/tt&gt;&lt;/pre&gt;
+&lt;/div&gt;&lt;/div&gt;
+&lt;h3 id=&quot;_total_or_individual_counters&quot;&gt;Total or individual counters&lt;/h3&gt;&lt;div style=&quot;clear:left&quot;&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Some of the plugins can show both total values or individual values and
+therefor have an extra option to influence this decision.&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;listingblock&quot;&gt;
+&lt;div class=&quot;content&quot;&gt;
+&lt;pre&gt;&lt;tt&gt;dstat -d -D sda,sdb
+dstat -n -N eth0,eth1
+dstat -c -C total,0,1&lt;/tt&gt;&lt;/pre&gt;
+&lt;/div&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;You can show both the individual values and total values as follows:&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;listingblock&quot;&gt;
+&lt;div class=&quot;content&quot;&gt;
+&lt;pre&gt;&lt;tt&gt;[<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at horsea</A> ~]$ dstat -d -D total,hda,hdc
+-dsk/total----dsk/hda-----dsk/hdc--
+ read  writ: read  writ: read  writ
+1384k 1502k: 114k 1332k:  81k  359B
+   0    44k:   0    44k:   0     0
+   0     0 :   0     0 :   0     0&lt;/tt&gt;&lt;/pre&gt;
+&lt;/div&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;The special &lt;tt&gt;-f&lt;/tt&gt; or &lt;tt&gt;--full&lt;/tt&gt; option allows to select individual counters by
+default, and can be overruled by &lt;tt&gt;-C&lt;/tt&gt;, &lt;tt&gt;-D&lt;/tt&gt;, &lt;tt&gt;-I&lt;/tt&gt;, &lt;tt&gt;-N&lt;/tt&gt; or &lt;tt&gt;-S&lt;/tt&gt;.&lt;/p&gt;&lt;/div&gt;
+&lt;h3 id=&quot;_influencing_output&quot;&gt;Influencing output&lt;/h3&gt;&lt;div style=&quot;clear:left&quot;&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Dstat has a few more options to influence its output. With the &lt;tt&gt;--nocolor&lt;/tt&gt;
+one can disable colours. The &lt;tt&gt;--noheaders&lt;/tt&gt; option disables repeating headers.
+The &lt;tt&gt;--noupdate&lt;/tt&gt; option disables intermediate updates. The &lt;tt&gt;--output&lt;/tt&gt; option
+is used for writing out to a CSV file.&lt;/p&gt;&lt;/div&gt;
+&lt;h3 id=&quot;_plugin_search_path&quot;&gt;Plugin search path&lt;/h3&gt;&lt;div style=&quot;clear:left&quot;&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Dstat looks in the following places for plugins. This allows a user without
+root privileges to use some extra plugins.&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;ulist&quot;&gt;&lt;ul&gt;
+&lt;li&gt;
+&lt;p&gt;
+~/.dstat/
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+&amp;lt;binarypath&amp;gt;/plugins/
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+/usr/share/dstat/
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+/usr/local/share/dstat/
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;/ul&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;The option &lt;tt&gt;--list&lt;/tt&gt; shows the available plugins and their location in the
+order that the plugin search path is used.&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;admonitionblock&quot;&gt;
+&lt;table&gt;&lt;tr&gt;
+&lt;td class=&quot;icon&quot;&gt;
+&lt;div class=&quot;title&quot;&gt;Note&lt;/div&gt;
+&lt;/td&gt;
+&lt;td class=&quot;content&quot;&gt;Plugins are named &lt;tt&gt;dstat_&amp;lt;name&amp;gt;.py&lt;/tt&gt;.&lt;/td&gt;
+&lt;/tr&gt;&lt;/table&gt;
+&lt;/div&gt;
+&lt;/div&gt;
+&lt;h2 id=&quot;_use_cases&quot;&gt;Use-cases&lt;/h2&gt;
+&lt;div class=&quot;sectionbody&quot;&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Below are some use-cases to demonstrate the usage of Dstat.&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;admonitionblock&quot;&gt;
+&lt;table&gt;&lt;tr&gt;
+&lt;td class=&quot;icon&quot;&gt;
+&lt;div class=&quot;title&quot;&gt;Warning&lt;/div&gt;
+&lt;/td&gt;
+&lt;td class=&quot;content&quot;&gt;The following examples do not look as nice as they do on screen
+because this document is not printed in colour (and I did not prepare it in
+colour :-)).&lt;/td&gt;
+&lt;/tr&gt;&lt;/table&gt;
+&lt;/div&gt;
+&lt;h3 id=&quot;_simple_system_check&quot;&gt;Simple system check&lt;/h3&gt;&lt;div style=&quot;clear:left&quot;&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Let&amp;#8217;s say you quickly want to see if the system is doing alright. In the past
+this probably was a &lt;tt&gt;vmstat 1&lt;/tt&gt;, as of now you would do:&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;listingblock&quot;&gt;
+&lt;div class=&quot;content&quot;&gt;
+&lt;pre&gt;&lt;tt&gt;dstat -taf&lt;/tt&gt;&lt;/pre&gt;
+&lt;/div&gt;&lt;/div&gt;
+&lt;div class=&quot;listingblock&quot;&gt;
+&lt;div class=&quot;title&quot;&gt;Sample output&lt;/div&gt;
+&lt;div class=&quot;content&quot;&gt;
+&lt;pre&gt;&lt;tt&gt;[<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at rhun</A> dag]$ dstat -taf
+-----time----- -------cpu0-usage------ --dsk/sda-----dsk/sr0-- --net/eth1- ---paging-- ---system--
+  date/time   |usr sys idl wai hiq siq| read  writ: read  writ| recv  send|  in   out | int   csw
+02-08 02:42:48| 10   2  85   2   0   0|  22k   23k: 1.8B    0 |   0     0 |2588B 2952B| 558   580
+02-08 02:42:49|  4   3  93   0   0   0|   0     0 :   0     0 |   0     0 |   0     0 |1116   962
+02-08 02:42:50|  5   2  90   0   2   1|   0    28k:   0     0 |   0     0 |   0     0 |1380  1136
+02-08 02:42:51| 11   6  82   0   1   0|   0     0 :   0     0 |   0     0 |   0     0 |1277  1340
+02-08 02:42:52|  3   3  93   0   1   0|   0    84k:   0     0 |   0     0 |   0     0 |1311  1034&lt;/tt&gt;&lt;/pre&gt;
+&lt;/div&gt;&lt;/div&gt;
+&lt;div class=&quot;admonitionblock&quot;&gt;
+&lt;table&gt;&lt;tr&gt;
+&lt;td class=&quot;icon&quot;&gt;
+&lt;div class=&quot;title&quot;&gt;Note&lt;/div&gt;
+&lt;/td&gt;
+&lt;td class=&quot;content&quot;&gt;The &lt;tt&gt;-t&lt;/tt&gt; here is completely optional and generally wastes space. But
+often you are not monitoring for 10 seconds but rather measure in minutes or
+hours. Having a general idea on what timescale counters have been averaged is
+nevertheless interesting.&lt;/td&gt;
+&lt;/tr&gt;&lt;/table&gt;
+&lt;/div&gt;
+&lt;h3 id=&quot;_what_is_this_system_doing_now&quot;&gt;What is this system doing now ?&lt;/h3&gt;&lt;div style=&quot;clear:left&quot;&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;I often run both the &lt;tt&gt;dstat_topcpu&lt;/tt&gt; and &lt;tt&gt;dstat_topmem&lt;/tt&gt; programs on a system,
+just to see what a system is doing. Having a quick look at what application
+is using the most CPU over a few minutes and to see what the general usage
+of memory is of the top application gives away a lot about a system.&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;listingblock&quot;&gt;
+&lt;div class=&quot;title&quot;&gt;Sample output&lt;/div&gt;
+&lt;div class=&quot;content&quot;&gt;
+&lt;pre&gt;&lt;tt&gt;[<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at horsea</A> dag]$ dstat -c --topcpu -dng --topmem
+----total-cpu-usage---- -most-expensive- -dsk/total- -net/total- ---paging-- -most-expensive-
+usr sys idl wai hiq siq|  cpu process   | read  writ| recv  send|  in   out | memory process
+  9   2  80   9   0   0|kswapd         0| 123k  164k|   0     0 |9196B   18k|rsync        74M
+  2   3  95   0   0   0|sendmail       1|   0   168k|2584B   39k|   0     0 |rsync        74M
+ 18   3  79   0   0   0|httpd         17|   0    88k|5759B  118k|   0     0 |rsync        74M
+  3   2  94   1   0   0|sendmail       1|4096B    0 |2291B 4190B|   0     0 |rsync        74M
+  2   3  95   0   0   0|httpd          1|   0     0 |2871B 3201B|   0     0 |rsync        74M
+ 10   7  83   0   0   0|httpd         13|   0     0 |2216B   10k|   0     0 |rsync        74M
+  2   2  96   0   0   0|                |   0    52k| 724B 2674B|   0     0 |rsync        74M&lt;/tt&gt;&lt;/pre&gt;
+&lt;/div&gt;&lt;/div&gt;
+&lt;h3 id=&quot;_what_process_is_using_all_my_cpu_memory_or_i_o_at_4_20_am&quot;&gt;What process is using all my CPU, memory or I/O at 4:20 AM ?&lt;/h3&gt;&lt;div style=&quot;clear:left&quot;&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Imagine the monitoring team notices strange peaks, a system engineer got a
+worthless message, the system was swapping extensively, a process got killed.&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Something indicates the system is doing something unexpected but what is
+causing it and why ? As of now you can do:&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;listingblock&quot;&gt;
+&lt;div class=&quot;content&quot;&gt;
+&lt;pre&gt;&lt;tt&gt;screen dstat -tcy --topcpu 120
+screen dstat -tmgs --topmem 120
+screen dstat -tdi --topio 120&lt;/tt&gt;&lt;/pre&gt;
+&lt;/div&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;to see what process is using the most CPU, the most memory and the most I/O
+resources.&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;And hopefully one day we can do:&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;listingblock&quot;&gt;
+&lt;div class=&quot;content&quot;&gt;
+&lt;pre&gt;&lt;tt&gt;dstat -tn --topnet 120
+dstat -tn --topx 120&lt;/tt&gt;&lt;/pre&gt;
+&lt;/div&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Leave it running during the night and in the morning you can see the light.&lt;/p&gt;&lt;/div&gt;
+&lt;h3 id=&quot;_what_device_is_slowing_down_my_system&quot;&gt;What device is slowing down my system ?&lt;/h3&gt;&lt;div style=&quot;clear:left&quot;&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Many devices generate interrupts, especially when used at maximum capacity.
+Sometimes too many interrupts can slow down a system. If you want to correlate
+bad performance with hardware interrupts, you can run a command like:&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;listingblock&quot;&gt;
+&lt;div class=&quot;content&quot;&gt;
+&lt;pre&gt;&lt;tt&gt;dstat -tyif
+dstat -tyi -I 12,58,iwlagn -f 5&lt;/tt&gt;&lt;/pre&gt;
+&lt;/div&gt;&lt;/div&gt;
+&lt;h3 id=&quot;_how_much_ticks_per_second_on_my_kernel&quot;&gt;How much ticks per second on my kernel ?&lt;/h3&gt;&lt;div style=&quot;clear:left&quot;&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;In some cases it can be useful to see how many ticks (timer interrupts) your
+kernel is producing. With older kernels this is a fixed number (usually 100,
+250 or 1000) but on newer kernels the number can be dynamic.&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Also on VMware virtual machines, the number of ticks can cause clock issues,
+so in that case if you want to see what is happening, you can simply do:&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;listingblock&quot;&gt;
+&lt;div class=&quot;content&quot;&gt;
+&lt;pre&gt;&lt;tt&gt;dstat -ti -I0 --snooze --debug&lt;/tt&gt;&lt;/pre&gt;
+&lt;/div&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Dstat nowadays can also detect lost ticks (when the number of ticks do not
+match the time progress. This is useful to correlate VM issues with other
+problems.&lt;/p&gt;&lt;/div&gt;
+&lt;h3 id=&quot;_what_device_is_slowing_down_my_system_2&quot;&gt;What device is slowing down my system ?&lt;/h3&gt;&lt;div style=&quot;clear:left&quot;&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;A nice feature of Dstat is that it can show how many interrupts each of your
+devices is generating. The &lt;em&gt;cpu&lt;/em&gt; stats already show this in percentage as
+&lt;em&gt;hard interrupt&lt;/em&gt; and &lt;em&gt;soft interrupt&lt;/em&gt;, and the &lt;em&gt;sys&lt;/em&gt; stats shows the total
+number of interrupts, but the &lt;em&gt;int&lt;/em&gt; stats go into detail. And you can specify
+exactly what IRQs you want to watch.&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Much like &lt;tt&gt;watch -n1 -d cat /proc/interrupts&lt;/tt&gt; on steroids.&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;listingblock&quot;&gt;
+&lt;div class=&quot;content&quot;&gt;
+&lt;pre&gt;&lt;tt&gt;dstat -t -y -i -f&lt;/tt&gt;&lt;/pre&gt;
+&lt;/div&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;which then results in:&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;listingblock&quot;&gt;
+&lt;div class=&quot;title&quot;&gt;Sample output&lt;/div&gt;
+&lt;div class=&quot;content&quot;&gt;
+&lt;pre&gt;&lt;tt&gt;[<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at rhun</A> ~]$ dstat -t -y -i -f 5
+-----time----- ---system-- -------------------interrupts------------------
+  date/time   | int   csw |  1     9     12    14    15    58   177   185
+13-08 21:52:53| 740   923 |   1     0    18     5     1    17     4   131
+13-08 21:52:58|1491  2085 |   0     4   351     1     2    37     0    97
+13-08 21:53:03|1464  1981 |   0     0   332     1     3    31     0    96
+13-08 21:53:08|1343  1977 |   0     0   215     1     2    32     0    93
+13-08 21:53:13|1145  1918 |   0     0    12     0     3    33     0    95&lt;/tt&gt;&lt;/pre&gt;
+&lt;/div&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;When having the following hardware:&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;listingblock&quot;&gt;
+&lt;div class=&quot;content&quot;&gt;
+&lt;pre&gt;&lt;tt&gt;[<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at rhun</A> ~]$ cat /proc/interrupts
+           CPU0
+  0:  143766685    IO-APIC-edge  timer
+  1:     374043    IO-APIC-edge  i8042
+  9:     102564   IO-APIC-level  acpi
+ 12:    4481057    IO-APIC-edge  i8042
+ 14:    1192508    IO-APIC-edge  libata
+ 15:     358891    IO-APIC-edge  libata
+ 58:    4391819   IO-APIC-level  ipw2200
+177:     993740   IO-APIC-level  Intel ICH6
+185:   33542364   IO-APIC-level  yenta, uhci_hcd:usb1, eth0, <A HREF="http://lists.repoforge.org/mailman/listinfo/commits">i915 at pci</A>:0000:00:02.0
+NMI:          0
+LOC:  143766578
+ERR:          0
+MIS:          0&lt;/tt&gt;&lt;/pre&gt;
+&lt;/div&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Or select specific interrupts:&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;listingblock&quot;&gt;
+&lt;div class=&quot;content&quot;&gt;
+&lt;pre&gt;&lt;tt&gt;dstat -t -y -i -I 12,58,185 -f 5&lt;/tt&gt;&lt;/pre&gt;
+&lt;/div&gt;&lt;/div&gt;
+&lt;h3 id=&quot;_how_does_my_wifi_signal_evolve_when_i_move_my_laptop_or_ap_through_the_house&quot;&gt;How does my WIFI signal evolve when I move my laptop or AP through the house ?&lt;/h3&gt;&lt;div style=&quot;clear:left&quot;&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Something I was looking into when trying to find the optimal location for the
+WIFI access point. However I must say that another tool I wrote &lt;em&gt;Dwscan&lt;/em&gt; is
+currently more sophisticated.&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;listingblock&quot;&gt;
+&lt;div class=&quot;content&quot;&gt;
+&lt;pre&gt;&lt;tt&gt;dstat -t --wifi&lt;/tt&gt;&lt;/pre&gt;
+&lt;/div&gt;&lt;/div&gt;
+&lt;h3 id=&quot;_is_my_swraid_performing_as_it_claims&quot;&gt;Is my SWRAID performing as it claims ?&lt;/h3&gt;&lt;div style=&quot;clear:left&quot;&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;You can monitor I/O throughput for any block device. By default dstat limits
+itself to real block devices to prevent having the same I/O to be counted more
+than once, but if you want to monitor a SWRAID device, or a multipath device,
+you can simply do that by doing:&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;listingblock&quot;&gt;
+&lt;div class=&quot;content&quot;&gt;
+&lt;pre&gt;&lt;tt&gt;dstat -td -D md0,md1,sda,sdb,hda&lt;/tt&gt;&lt;/pre&gt;
+&lt;/div&gt;&lt;/div&gt;
+&lt;/div&gt;
+&lt;h2 id=&quot;_writing_your_own_dstat_plugin&quot;&gt;Writing your own Dstat plugin&lt;/h2&gt;
+&lt;div class=&quot;sectionbody&quot;&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Dstat is completely written in python and this makes it extremely convenient
+to write your own plugins. The many plugins that come with Dstat are an
+excellent source of information if you want to write your own.&lt;/p&gt;&lt;/div&gt;
+&lt;h3 id=&quot;_introducing_the_hello_world_plugin&quot;&gt;Introducing the hello world plugin&lt;/h3&gt;&lt;div style=&quot;clear:left&quot;&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;The following plugin does nothing more than write &quot;Hello world!&quot; to its
+output.&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;listingblock&quot;&gt;
+&lt;div class=&quot;title&quot;&gt;The dstat_helloworld plugin in its full glory.&lt;/div&gt;
+&lt;div class=&quot;content&quot;&gt;
+&lt;pre&gt;&lt;tt&gt;class dstat_helloworld(dstat):
+    def __init__(self):
+        self.name = 'plugin title'          &lt;b&gt;&amp;lt;1&amp;gt;&lt;/b&gt;
+        self.type = 's'                     &lt;b&gt;&amp;lt;2&amp;gt;&lt;/b&gt;
+        self.width = 12                     &lt;b&gt;&amp;lt;3&amp;gt;&lt;/b&gt;
+        self.scale = 100                    &lt;b&gt;&amp;lt;4&amp;gt;&lt;/b&gt;
+        self.nick = ('counter',)            &lt;b&gt;&amp;lt;5&amp;gt;&lt;/b&gt;
+        self.vars = ('text',)               &lt;b&gt;&amp;lt;6&amp;gt;&lt;/b&gt;
+        self.init(self.vars, 1)             &lt;b&gt;&amp;lt;7&amp;gt;&lt;/b&gt;
+
+    def extract(self):
+        self.val['text'] = 'Hello world!'   &lt;b&gt;&amp;lt;8&amp;gt;&lt;/b&gt;&lt;/tt&gt;&lt;/pre&gt;
+&lt;/div&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;In this example, there are several components:&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;olist arabic&quot;&gt;&lt;ol class=&quot;arabic&quot;&gt;
+&lt;li&gt;
+&lt;p&gt;
+&lt;tt&gt;self.name&lt;/tt&gt; contains the plugin&amp;#8217;s visible title.
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+&lt;tt&gt;self.type&lt;/tt&gt; defines the counter type: string, percentage, integer, float
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+&lt;tt&gt;self.width&lt;/tt&gt; defines the column width
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+&lt;tt&gt;self.scale&lt;/tt&gt; influences the coloring and unit type
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+&lt;tt&gt;self.nick&lt;/tt&gt; is a list of the counter names
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+&lt;tt&gt;self.vars&lt;/tt&gt; is a list of the variable names for each counter
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+&lt;tt&gt;self.init()&lt;/tt&gt; is a function that initialises the counter structures
+   (&lt;tt&gt;self.cn1&lt;/tt&gt;, &lt;tt&gt;self.cn2&lt;/tt&gt; and &lt;tt&gt;self.val&lt;/tt&gt;)
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+&lt;tt&gt;self.val&lt;/tt&gt; contains the counter values that are being displayed
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;/ol&gt;&lt;/div&gt;
+&lt;h3 id=&quot;_parsing_counters&quot;&gt;Parsing counters&lt;/h3&gt;&lt;div style=&quot;clear:left&quot;&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;The following example shows how information is collected and counters are
+processed. It also includes a &lt;tt&gt;check()&lt;/tt&gt; method to properly bail out when the
+system fails to meet some plugin criteria.&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;listingblock&quot;&gt;
+&lt;div class=&quot;title&quot;&gt;The dstat_postfix plugin&lt;/div&gt;
+&lt;div class=&quot;content&quot;&gt;
+&lt;pre&gt;&lt;tt&gt;global glob                                                                &lt;b&gt;&amp;lt;1&amp;gt;&lt;/b&gt;
+import glob
+
+class dstat_postfix(dstat):
+    def __init__(self):
+        self.name = 'postfix'
+        self.type = 'd'                                                    &lt;b&gt;&amp;lt;2&amp;gt;&lt;/b&gt;
+        self.width = 4
+        self.scale = 100
+        self.vars = ('incoming', 'active', 'deferred', 'bounce', 'defer')
+        self.nick = ('inco', 'actv', 'dfrd', 'bnce', 'defr')
+        self.init(self.vars, 1)
+
+    def check(self):                                                       &lt;b&gt;&amp;lt;3&amp;gt;&lt;/b&gt;
+        if not os.access('/var/spool/postfix/active', os.R_OK):
+            raise Exception, 'Cannot access postfix queues'
+        return True
+
+    def extract(self):
+        for item in self.vars:                                             &lt;b&gt;&amp;lt;4&amp;gt;&lt;/b&gt;
+            self.val[item] = len(glob.glob('/var/spool/postfix/'+item+'/*/*')&lt;/tt&gt;&lt;/pre&gt;
+&lt;/div&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;This example shows the following items:&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;olist arabic&quot;&gt;&lt;ol class=&quot;arabic&quot;&gt;
+&lt;li&gt;
+&lt;p&gt;
+Since the plugin is imported at runtime, it is important that these are
+   are included in the global scope to reuse them
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+type, width and scale specify decimal, column width a,d coloring based on
+   multiplication of 100
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+The &lt;tt&gt;check()&lt;/tt&gt; method tests conditions and bails out of they are not met
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+To make processing easier we have opted to use as value names (&lt;tt&gt;self.vars&lt;/tt&gt;)
+   the name of the postfix queues and store counts in &lt;tt&gt;self.val&lt;/tt&gt;
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;/ol&gt;&lt;/div&gt;
+&lt;h3 id=&quot;_opening_files&quot;&gt;Opening files&lt;/h3&gt;&lt;div style=&quot;clear:left&quot;&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Dstat provides its own &lt;tt&gt;dopen()&lt;/tt&gt; function to plugins. Using &lt;tt&gt;dopen()&lt;/tt&gt; instead
+of &lt;tt&gt;open()&lt;/tt&gt; plugins do not need to reopen files to update their counters. But
+this is only useful when plugins open a few files. For eg. opening &lt;em&gt;/proc/pid&lt;/em&gt;
+files the number of open files would only be increasing as the number of
+processes increases.&lt;/p&gt;&lt;/div&gt;
+&lt;h3 id=&quot;_piping_to_an_application&quot;&gt;Piping to an application&lt;/h3&gt;&lt;div style=&quot;clear:left&quot;&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Dstat provides its own &lt;tt&gt;dpopen()&lt;/tt&gt; function to plugins. This function allows
+the plugin to open stdin, stdout and stderr pipes for 2-way communication with
+processes.  To see this in action, take a look at the &lt;tt&gt;dstat_gpfs&lt;/tt&gt; plugins or
+the &lt;tt&gt;dstat_mysql&lt;/tt&gt; plugins.&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Piping to an application is more expensive than getting kernel counters from
+&lt;em&gt;/proc&lt;/em&gt;, but it beats having to run a program and capturing the output.&lt;/p&gt;&lt;/div&gt;
+&lt;/div&gt;
+&lt;h2 id=&quot;_known_issues&quot;&gt;Known issues&lt;/h2&gt;
+&lt;div class=&quot;sectionbody&quot;&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;There are some known issues that are important to understand when using Dstat.&lt;/p&gt;&lt;/div&gt;
+&lt;h3 id=&quot;_counter_rollovers&quot;&gt;Counter rollovers&lt;/h3&gt;&lt;div style=&quot;clear:left&quot;&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Unfortunately Dstat is susceptible for counters that &amp;#8220;rollover&amp;#8221;. This means
+that a counter gets bigger than its maximum value the data-structure is capable
+of storing. As a result the counter is reset.&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;For some architectures and some counters, Linux implements 32bit values, this
+means that such counter can go up to 2^32 (= 4294967296B = 4G) values.&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;For example the network counters are calculated in absolute bytes. Every 4GB
+that is being transferred over the network will cause a counter reset. For
+example on a bonded 2x10Gbps interfaces that is using its theoretical transfer
+limit, this would happen every 1.6 seconds.&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Since &lt;em&gt;/proc&lt;/em&gt; is updated every second, this would be impossible for Dstat to
+catch. Currently if Dstat encounters a negative difference for an interval it
+displays a dash.&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Obviously, if Dstat were know what the counter&amp;#8217;s maximum value is, it could
+recalculate the difference. However that is currently not implemented and does
+not guarantee a correct result either, since a negative value could be the
+result of 2 or more rollovers.&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;If you suspect that the behaviour of your system is susceptible of counter
+rollovers, make sure you take this into account when using Dstat (or any other
+tool that uses these counters for that matter)&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;admonitionblock&quot;&gt;
+&lt;table&gt;&lt;tr&gt;
+&lt;td class=&quot;icon&quot;&gt;
+&lt;div class=&quot;title&quot;&gt;Tip&lt;/div&gt;
+&lt;/td&gt;
+&lt;td class=&quot;content&quot;&gt;Shipped with the Dstat documentation there is a document
+(&lt;em&gt;counter-rollovers.txt&lt;/em&gt;) that goes deeper into counter rollovers. If this
+affects you, read that document and contact me for possible implementation
+changes to improve handling them.&lt;/td&gt;
+&lt;/tr&gt;&lt;/table&gt;
+&lt;/div&gt;
+&lt;h3 id=&quot;_dstat_performance&quot;&gt;Dstat performance&lt;/h3&gt;&lt;div style=&quot;clear:left&quot;&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;As mentioned several times now, Dstat is written in python. There are various
+reasons that Python was chosen and the most important reason is that it
+simplifies writing plugins, processing counters and lowers the bar for
+people to contribute changes.&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;The downside of choosing a scripting language is that it is slower than if it
+would be written in C, obviously. &lt;strong&gt;Dstat is not optimised for performance.&lt;/strong&gt;&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;admonitionblock&quot;&gt;
+&lt;table&gt;&lt;tr&gt;
+&lt;td class=&quot;icon&quot;&gt;
+&lt;div class=&quot;title&quot;&gt;Note&lt;/div&gt;
+&lt;/td&gt;
+&lt;td class=&quot;content&quot;&gt;This may seem ironic: a performance monitoring tool that is not
+optimised for performance, but rather for flexibility. However the ease of
+writing plugins and prototyping gets precedence over performance at this time.&lt;/td&gt;
+&lt;/tr&gt;&lt;/table&gt;
+&lt;/div&gt;
+&lt;h4 id=&quot;_plugin_performance&quot;&gt;Plugin performance&lt;/h4&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;If we look at the basic plugins, there are no real performance issues with
+Dstat. Loading Dstat takes longer than eg. vmstat, but once running, Dstat&amp;#8217;s
+performance for the same functionality is up to par with vmstat, ifstat and
+other similar tools.&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;However there are plugins that are much more resource intensive than others
+and the selection of plugins determines Dstat&amp;#8217;s performance in a major way.&lt;/p&gt;&lt;/div&gt;
+&lt;h4 id=&quot;_debugging_dstat&quot;&gt;Debugging Dstat&lt;/h4&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Dstat comes with a &lt;tt&gt;--debug&lt;/tt&gt; option that helps to find the cost of running
+plugins. The &lt;tt&gt;--debug&lt;/tt&gt; option show how long it takes Dstat to process the
+selected plugins.&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;You can see the cost of Dstat itself by simply using the &lt;tt&gt;dstat_time&lt;/tt&gt; plugin
+together with the &lt;tt&gt;--debug&lt;/tt&gt; option.&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;listingblock&quot;&gt;
+&lt;div class=&quot;title&quot;&gt;The cost of running the timer plugin&lt;/div&gt;
+&lt;div class=&quot;content&quot;&gt;
+&lt;pre&gt;&lt;tt&gt;[<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at rhun</A> dag]$ dstat -t --debug
+Module dstat_time
+-----time-----
+  date/time
+19-08 20:34:21  5.90ms
+19-08 20:34:22  0.17ms
+19-08 20:34:23  0.18ms
+19-08 20:34:24  0.18ms&lt;/tt&gt;&lt;/pre&gt;
+&lt;/div&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Compare this with other plugins to see what the cost is of an individual
+plugin.&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;listingblock&quot;&gt;
+&lt;div class=&quot;title&quot;&gt;The cost of running the &lt;tt&gt;dstat_cpu&lt;/tt&gt; plugin&lt;/div&gt;
+&lt;div class=&quot;content&quot;&gt;
+&lt;pre&gt;&lt;tt&gt;[<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at rhun</A> dstat]$ dstat -c --debug
+Module dstat_cpu requires ['/proc/stat']
+----total-cpu-usage----
+usr sys idl wai hiq siq
+ 15   3  77   4   0   1 11.07ms
+  5   3  92   0   0   0  0.66ms
+  5   4  91   0   0   0  0.65ms
+  5   3  92   0   0   0  0.66ms&lt;/tt&gt;&lt;/pre&gt;
+&lt;/div&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;As you can see, getting the CPU counters and calculating the CPU usage takes
+up 0.5 milliseconds on this particular system. But if we look at the usage of
+the &lt;tt&gt;dstat_topcpu&lt;/tt&gt; plugin:&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;listingblock&quot;&gt;
+&lt;div class=&quot;title&quot;&gt;The cost of running the &lt;tt&gt;dstat_topcpu&lt;/tt&gt; plugin&lt;/div&gt;
+&lt;div class=&quot;content&quot;&gt;
+&lt;pre&gt;&lt;tt&gt;[<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at rhun</A> dstat]$ dstat --topcpu --debug
+Module dstat_topcpu
+-most-expensive-
+  cpu process
+Xorg           2 43.82ms
+Xorg           1 33.23ms
+firefox-bin    2 33.54ms
+Xorg           1 33.24ms&lt;/tt&gt;&lt;/pre&gt;
+&lt;/div&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;we see that processing the &lt;em&gt;/proc/pid&lt;/em&gt; files causes the topcpu plugin to use
+an additional 33ms.&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;admonitionblock&quot;&gt;
+&lt;table&gt;&lt;tr&gt;
+&lt;td class=&quot;icon&quot;&gt;
+&lt;div class=&quot;title&quot;&gt;Warning&lt;/div&gt;
+&lt;/td&gt;
+&lt;td class=&quot;content&quot;&gt;These values show the time it takes to process the plugins and does
+not indicate the amount of CPU usage Dstat consumes. This obviously means that
+the process time of plugins depends on how much the system is being stressed
+as well as on what the plugin exactly is doing.&lt;/td&gt;
+&lt;/tr&gt;&lt;/table&gt;
+&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Plugins that communicate with other processes or those that process lots of
+information (eg. communicating with the mysql client, or processing the mail
+queue) may not actually use any local resources, but the latency causes
+Dstat to slow down processing other counters.&lt;/p&gt;&lt;/div&gt;
+&lt;h4 id=&quot;_writing_dstat_and_plugins_in_c&quot;&gt;Writing Dstat and plugins in C&lt;/h4&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;It makes sense to reimplement Dstat or some of its plugins in C and still
+allow the writing of Python (or even Perl) plugins. Tests have shown that for
+example processing &lt;em&gt;/proc/pid&lt;/em&gt; in C makes the plugin 3 times faster. And this
+did not take into account the processing of the results and displaying the
+output.&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;So rewriting in C makes a lot of sense, but it is also much more complicated.&lt;/p&gt;&lt;/div&gt;
+&lt;h3 id=&quot;_python_1_5&quot;&gt;Python 1.5&lt;/h3&gt;&lt;div style=&quot;clear:left&quot;&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Dstat works with python 2.0, however there is also a Dstat15 version that
+still works on python 1.5. The downside of having Dstat work on python 1.5 is
+that the external plugins cannot use the newer and more flexible python 2.0
+syntax and the differences between python 1.5 and 2.0 are considerable.&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;admonitionblock&quot;&gt;
+&lt;table&gt;&lt;tr&gt;
+&lt;td class=&quot;icon&quot;&gt;
+&lt;div class=&quot;title&quot;&gt;Note&lt;/div&gt;
+&lt;/td&gt;
+&lt;td class=&quot;content&quot;&gt;Not all plugins work properly on Python 1.5.&lt;/td&gt;
+&lt;/tr&gt;&lt;/table&gt;
+&lt;/div&gt;
+&lt;/div&gt;
+&lt;h2 id=&quot;_future_development&quot;&gt;Future development&lt;/h2&gt;
+&lt;div class=&quot;sectionbody&quot;&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;The Dstat release contains a &lt;em&gt;TODO&lt;/em&gt; file highlighting all the items and
+ideas that have been played with. Here is a list of the most important ones:&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;ulist&quot;&gt;&lt;ul&gt;
+&lt;li&gt;
+&lt;p&gt;
+Output
+&lt;/p&gt;
+&lt;div class=&quot;ulist&quot;&gt;&lt;ul&gt;
+&lt;li&gt;
+&lt;p&gt;
+Changes in how Dstat colours digits within a value (the 6 in 6134B)
+   *
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;/ul&gt;&lt;/div&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+Exporting information
+&lt;/p&gt;
+&lt;div class=&quot;ulist&quot;&gt;&lt;ul&gt;
+&lt;li&gt;
+&lt;p&gt;
+Connecting Dstat with rrdtool
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+Exporting to syslog or remote syslog (a way to transport counters ?)
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;/ul&gt;&lt;/div&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+Plugins
+&lt;/p&gt;
+&lt;div class=&quot;ulist&quot;&gt;&lt;ul&gt;
+&lt;li&gt;
+&lt;p&gt;
+Be smart when plugins are loaded more than once (some plugins could
+     benefit)
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+Add more plugins
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;/ul&gt;&lt;/div&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+Redesign Dstat
+&lt;/p&gt;
+&lt;div class=&quot;ulist&quot;&gt;&lt;ul&gt;
+&lt;li&gt;
+&lt;p&gt;
+Work on the plugin infrastructure, make the API more simple and
+     straightforward
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+Create an object-model and namespace for plugins and counters so that
+     other tools can be based on Dstat
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;/ul&gt;&lt;/div&gt;
+&lt;/li&gt;
+&lt;/ul&gt;&lt;/div&gt;
+&lt;/div&gt;
+&lt;h2 id=&quot;_links&quot;&gt;Links&lt;/h2&gt;
+&lt;div class=&quot;sectionbody&quot;&gt;
+&lt;div class=&quot;ulist&quot;&gt;&lt;ul&gt;
+&lt;li&gt;
+&lt;p&gt;
+&lt;a href=&quot;<A HREF="http://dag.wieers.com/home-made/dstat/">http://dag.wieers.com/home-made/dstat/</A>&quot;&gt;Dstat homepage&lt;/a&gt;
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+&lt;a href=&quot;<A HREF="http://svn.rpmforge.net/svn/trunk/tools/dstat/">http://svn.rpmforge.net/svn/trunk/tools/dstat/</A>&quot;&gt;Dstat subversion&lt;/a&gt;
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;li&gt;
+&lt;p&gt;
+&lt;a href=&quot;<A HREF="http://lists.rpmforge.net/mailman/listinfo/tools">http://lists.rpmforge.net/mailman/listinfo/tools</A>&quot;&gt;Dstat mailinglist&lt;/a&gt;
+&lt;/p&gt;
+&lt;/li&gt;
+&lt;/ul&gt;&lt;/div&gt;
+&lt;/div&gt;
+&lt;/div&gt;
+&lt;div id=&quot;footnotes&quot;&gt;&lt;hr /&gt;&lt;/div&gt;
+&lt;div id=&quot;footer&quot;&gt;
+&lt;div id=&quot;footer-text&quot;&gt;
+Last updated 2009-11-23 01:38:45 CEST
+&lt;/div&gt;
+&lt;/div&gt;
+&lt;/body&gt;
+&lt;/html&gt;

Modified: trunk/tools/dstat/docs/dstat-paper.txt
===================================================================
--- trunk/tools/dstat/docs/dstat-paper.txt	2009-11-21 14:08:12 UTC (rev 8035)
+++ trunk/tools/dstat/docs/dstat-paper.txt	2009-11-24 01:46:30 UTC (rev 8036)
@@ -286,8 +286,8 @@
 The internal plugins have short and/or long options within Dstat, eg. +-c+ or
 +--cpu+ will enable the cpu counters.
 
-The external plugins are enable by a single +-M+ option followed by one or
-more plugin-names. (This also works for internal plugins)
+The external plugins are enable by a long option including their name,
+eg. --topcpu
 
 The following examples will enable the time, cpu and disk plugins, and are
 equal.
@@ -295,8 +295,6 @@
 ----
 dstat -tcd
 dstat --time --cpu --disk
-dstat -M time,cpu,disk
-dstat -M time -M cpu -M disk
 ----
 
 === Total or individual counters
@@ -336,15 +334,14 @@
 root privileges to use some extra plugins.
 
     - ~/.dstat/
-    - ./plugins/
-    - .
+    - &lt;binarypath&gt;/plugins/
     - /usr/share/dstat/
     - /usr/local/share/dstat/
 
-The option +-M list+ shows the available plugins and their location in the
+The option +--list+ shows the available plugins and their location in the
 order that the plugin search path is used.
 
-NOTE: Plugins are name +dstat_&lt;name&gt;.py+.
+NOTE: Plugins are named +dstat_&lt;name&gt;.py+.
 
 
 == Use-cases
@@ -389,7 +386,7 @@
 
 .Sample output
 ----
-[<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at horsea</A> dag]$ dstat -c -M topcpu -dng -M topmem
+[<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at horsea</A> dag]$ dstat -c --topcpu -dng --topmem
 ----total-cpu-usage---- -most-expensive- -dsk/total- -net/total- ---paging-- -most-expensive-
 usr sys idl wai hiq siq|  cpu process   | read  writ| recv  send|  in   out | memory process 
   9   2  80   9   0   0|kswapd         0| 123k  164k|   0     0 |9196B   18k|rsync        74M
@@ -409,9 +406,9 @@
 causing it and why ? As of now you can do:
 
 ----
-screen dstat -tcy -M topcpu 120
-screen dstat -tmgs -M topmem 120
-screen dstat -tdi -M topio 120
+screen dstat -tcy --topcpu 120
+screen dstat -tmgs --topmem 120
+screen dstat -tdi --topio 120
 ----
 
 to see what process is using the most CPU, the most memory and the most I/O
@@ -420,8 +417,8 @@
 And hopefully one day we can do:
 
 ----
-dstat -tn -M topnet 120
-dstat -tn -M topx 120
+dstat -tn --topnet 120
+dstat -tn --topx 120
 ----
 
 Leave it running during the night and in the morning you can see the light.
@@ -445,7 +442,7 @@
 so in that case if you want to see what is happening, you can simply do:
 
 ----
-dstat -ti -I0 -M snooze --debug
+dstat -ti -I0 --snooze --debug
 ----
 
 Dstat nowadays can also detect lost ticks (when the number of ticks do not
@@ -527,7 +524,7 @@
 currently more sophisticated.
 
 ----
-dstat -t -M wifi
+dstat -t --wifi
 ----
 
 === Is my SWRAID performing as it claims ?
@@ -738,7 +735,7 @@
 
 .The cost of running the +dstat_topcpu+ plugin
 ----
-[<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at rhun</A> dstat]$ dstat -M topcpu --debug
+[<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at rhun</A> dstat]$ dstat --topcpu --debug
 Module dstat_topcpu
 -most-expensive-
   cpu process

Modified: trunk/tools/dstat/docs/dstat.1
===================================================================
--- trunk/tools/dstat/docs/dstat.1	2009-11-21 14:08:12 UTC (rev 8035)
+++ trunk/tools/dstat/docs/dstat.1	2009-11-24 01:46:30 UTC (rev 8036)
@@ -2,7 +2,7 @@
 .\&quot; It was generated using the DocBook XSL Stylesheets (version 1.69.1).
 .\&quot; Instead of manually editing it, you probably should edit the DocBook XML
 .\&quot; source for it and then use the DocBook XSL Stylesheets to regenerate it.
-.TH &quot;DSTAT&quot; &quot;1&quot; &quot;11/01/2009&quot; &quot;0.6.9&quot; &quot;&quot;
+.TH &quot;DSTAT&quot; &quot;1&quot; &quot;11/24/2009&quot; &quot;\  0.7.0&quot; &quot;\ &quot;
 .\&quot; disable hyphenation
 .nh
 .\&quot; disable justification (adjust text to left margin only)
@@ -115,19 +115,18 @@
 enable unix stats (datagram, stream, listen, active)
 .TP
 \-\-vm
-enable vm stats (hard pagefaults, soft pagefaults, allocated, free))
+enable vm stats (hard pagefaults, soft pagefaults, allocated, free)
 .TP
 \-\-stat1 \-\-stat2
-enable internal and external plugin stats by plugin name
+enable (external) plugins by plugin name, see
+\fBPLUGINS\fR
+for options
 .TP
-\-M stat1,stat2
-enable internal and external plugin stats by plugin name
-.TP
 Possible internal stats are
 aio, cpu, cpu24, disk, disk24, disk24old, epoch, fs, int, int24, io, ipc, load, lock, mem, net, page, page24, proc, raw, socket, swap, swapold, sys, tcp, time, udp, unix, vm
 .TP
-Possible plugin stats can be listed using
-dstat \-\-list
+\-\-list
+list the internal and external plugin names
 .TP
 \-a, \-\-all
 equals \-cdngy (default)
@@ -138,14 +137,20 @@
 \-v, \-\-vmstat
 equals \-pmgdsc \-D total
 .TP
-\-\-list
-list the internal and external plugin names
+\-\-bw, \-\-blackonwhite
+change colors for white background terminal
 .TP
+\-\-float
+force float values on screen (mutual exclusive with
+\fB\-\-integer\fR)
+.TP
 \-\-integer
-show integer values
+force integer values on screen (mutual exclusive with
+\fB\-\-float\fR)
 .TP
 \-\-nocolor
-disable colors (implies \-\-noupdate)
+disable colors (implies
+\fB\-\-noupdate\fR)
 .TP
 \-\-noheaders
 disable repetitive headers
@@ -155,6 +160,168 @@
 .TP
 \-\-output file
 write CSV output to file
+.SH &quot;PLUGINS&quot;
+While anyone can create their own dstat plugins (and contribute them) dstat ships with a number of plugins already that extend its capabilities greatly. Here is an overview of the plugins dstat ships with:
+.sp
+.TP
+\-\-battery
+battery in percentage (needs ACPI)
+.TP
+\-\-battery\-remain
+battery remaining in hours, minutes (needs ACPI)
+.TP
+\-\-cpufreq
+CPU frequency in percentage (needs ACPI)
+.TP
+\-\-dbus
+number of dbus connections (needs python\-dbus)
+.TP
+\-\-disk\-util
+per disk utilization in percentage
+.TP
+\-\-fan
+fan speed (needs ACPI)
+.TP
+\-\-freespace
+per filesystem disk usage
+.TP
+\-\-gpfs
+GPFS read/write I/O (needs mmpmon)
+.TP
+\-\-gpfs\-ops
+GPFS filesystem operations (needs mmpmon)
+.TP
+\-\-helloworld
+Hello world example dstat plugin
+.TP
+\-\-innodb\-buffer
+TBD
+.TP
+\-\-innodb\-io
+TBD
+.TP
+\-\-innodb\-ops
+TBD
+.TP
+\-\-lustre
+TBD
+.TP
+\-\-memcache\-hits
+TBD
+.TP
+\-\-mysql5\-com
+TBD
+.TP
+\-\-mysql5\-conn
+TBD
+.TP
+\-\-mysql5\-io
+TBD
+.TP
+\-\-mysql5\-keys
+TBD
+.TP
+\-\-mysql\-io
+TBD
+.TP
+\-\-mysql\-keys
+TBD
+.TP
+\-\-net\-packets
+TBD
+.TP
+\-\-nfs3
+NFS v3 client operations
+.TP
+\-\-nfs3\-ops
+Extended NFS v3 client operations
+.TP
+\-\-nfsd3
+NFS v3 server operations
+.TP
+\-\-nfsd3\-ops
+Extended NFS v3 server operations
+.TP
+\-\-ntp
+TBD
+.TP
+\-\-postfix
+postfix queue size (needs postfix)
+.TP
+\-\-power
+TBD
+.TP
+\-\-proc\-count
+TBD
+.TP
+\-\-rpc
+RPC client calls
+.TP
+\-\-rpcd
+RPC server calls
+.TP
+\-\-sendmail
+sendmail queue size (needs sendmail)
+.TP
+\-\-snooze
+number of ticks per second
+.TP
+\-\-test
+TBD
+.TP
+\-\-thermal
+system temperature sensors
+.TP
+\-\-top\-bio
+TBD
+.TP
+\-\-top\-cpu
+TBD
+.TP
+\-\-top\-cputime
+TBD
+.TP
+\-\-top\-cputime\-avg
+TBD
+.TP
+\-\-top\-io
+TBD
+.TP
+\-\-top\-latency
+TBD
+.TP
+\-\-top\-latency\-avg
+TBD
+.TP
+\-\-top\-mem
+TBD
+.TP
+\-\-top\-oom
+TBD
+.TP
+\-\-utmp
+Number of utmp connections (needs python\-utmp)
+.TP
+\-\-vmk\-hba
+TBD
+.TP
+\-\-vmk\-int
+TBD
+.TP
+\-\-vmk\-nic
+TBD
+.TP
+\-\-vm\-memctl
+TBD
+.TP
+\-\-vz\-io
+TBD
+.TP
+\-\-vz\-ubc
+TBD
+.TP
+\-\-wifi
+wireless link quality and signal to noise ratio
 .SH &quot;ARGUMENTS&quot;
 \fBdelay\fR is the delay in seconds between each update
 .sp
@@ -167,14 +334,14 @@
 .sp
 So in case you specified a delay of 10, \fBthe 9 intermediate updates are NOT snapshots\fR, they are averages over the time that passed since the last final update. The end result is that you get a 10 second average on a new line, just like with vmstat.
 .sp
-.SH &quot;USAGE&quot;
+.SH &quot;EXAMPLES&quot;
 Using dstat to relate disk\-throughput with network\-usage (eth0), total CPU\-usage and system counters:
 .sp
 .sp
 .nf
 dstat \-dnyc \-N eth0 \-C total \-f 5
 .fi
-Checking dstat\(cqs behaviour and the system\(cqs impact on dstat:
+Checking dstat\(cqs behaviour and the system impact of dstat:
 .sp
 .sp
 .nf
@@ -184,13 +351,13 @@
 .sp
 .sp
 .nf
-dstat \-tcndylp \-M topcpu
+dstat \-tcndylp \-\-topcpu
 .fi
 this is identical to
 .sp
 .sp
 .nf
-dstat \-M time,cpu,net,disk,sys,load,proc,topcpu
+dstat \-\-time \-\-cpu \-\-net \-\-disk \-\-sys \-\-load \-\-proc \-\-topcpu
 .fi
 Using dstat to relate cpu stats with interrupts per device:
 .sp

Added: trunk/tools/dstat/docs/dstat.1.html
===================================================================
--- trunk/tools/dstat/docs/dstat.1.html	                        (rev 0)
+++ trunk/tools/dstat/docs/dstat.1.html	2009-11-24 01:46:30 UTC (rev 8036)
@@ -0,0 +1,1519 @@
+&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.1//EN&quot;
+    &quot;<A HREF="http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd</A>&quot;&gt;
+&lt;html xmlns=&quot;<A HREF="http://www.w3.org/1999/xhtml">http://www.w3.org/1999/xhtml</A>&quot; xml:lang=&quot;en&quot;&gt;
+&lt;head&gt;
+&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;
+&lt;meta name=&quot;generator&quot; content=&quot;AsciiDoc 8.5.1&quot; /&gt;
+&lt;title&gt;dstat(1)&lt;/title&gt;
+&lt;style type=&quot;text/css&quot;&gt;
+/* Debug borders */
+p, li, dt, dd, div, pre, h1, h2, h3, h4, h5, h6 {
+/*
+  border: 1px solid red;
+*/
+}
+
+body {
+  margin: 1em 5% 1em 5%;
+}
+
+a {
+  color: blue;
+  text-decoration: underline;
+}
+a:visited {
+  color: fuchsia;
+}
+
+em {
+  font-style: italic;
+  color: navy;
+}
+
+strong {
+  font-weight: bold;
+  color: #083194;
+}
+
+tt {
+  color: navy;
+}
+
+h1, h2, h3, h4, h5, h6 {
+  color: #527bbd;
+  font-family: sans-serif;
+  margin-top: 1.2em;
+  margin-bottom: 0.5em;
+  line-height: 1.3;
+}
+
+h1, h2, h3 {
+  border-bottom: 2px solid silver;
+}
+h2 {
+  padding-top: 0.5em;
+}
+h3 {
+  float: left;
+}
+h3 + * {
+  clear: left;
+}
+
+div.sectionbody {
+  font-family: serif;
+  margin-left: 0;
+}
+
+hr {
+  border: 1px solid silver;
+}
+
+p {
+  margin-top: 0.5em;
+  margin-bottom: 0.5em;
+}
+
+ul, ol, li &gt; p {
+  margin-top: 0;
+}
+
+pre {
+  padding: 0;
+  margin: 0;
+}
+
+span#author {
+  color: #527bbd;
+  font-family: sans-serif;
+  font-weight: bold;
+  font-size: 1.1em;
+}
+span#email {
+}
+span#revnumber, span#revdate, span#revremark {
+  font-family: sans-serif;
+}
+
+div#footer {
+  font-family: sans-serif;
+  font-size: small;
+  border-top: 2px solid silver;
+  padding-top: 0.5em;
+  margin-top: 4.0em;
+}
+div#footer-text {
+  float: left;
+  padding-bottom: 0.5em;
+}
+div#footer-badges {
+  float: right;
+  padding-bottom: 0.5em;
+}
+
+div#preamble {
+  margin-top: 1.5em;
+  margin-bottom: 1.5em;
+}
+div.tableblock, div.imageblock, div.exampleblock, div.verseblock,
+div.quoteblock, div.literalblock, div.listingblock, div.sidebarblock,
+div.admonitionblock {
+  margin-top: 0.25em;
+  margin-bottom: 1.5em;
+}
+div.admonitionblock {
+  margin-top: 2.5em;
+  margin-bottom: 2.5em;
+}
+
+div.content { /* Block element content. */
+  padding: 0;
+}
+
+/* Block element titles. */
+div.title, caption.title {
+  color: #527bbd;
+  font-family: sans-serif;
+  font-weight: bold;
+  text-align: left;
+  margin-top: 1.0em;
+  margin-bottom: 0.5em;
+}
+div.title + * {
+  margin-top: 0;
+}
+
+td div.title:first-child {
+  margin-top: 0.0em;
+}
+div.content div.title:first-child {
+  margin-top: 0.0em;
+}
+div.content + div.title {
+  margin-top: 0.0em;
+}
+
+div.sidebarblock &gt; div.content {
+  background: #ffffee;
+  border: 1px solid silver;
+  padding: 0.5em;
+}
+
+div.listingblock &gt; div.content {
+  border: 1px solid silver;
+  background: #f4f4f4;
+  padding: 0.5em;
+}
+
+div.quoteblock {
+  padding-left: 2.0em;
+  margin-right: 10%;
+}
+div.quoteblock &gt; div.attribution {
+  padding-top: 0.5em;
+  text-align: right;
+}
+
+div.verseblock {
+  padding-left: 2.0em;
+  margin-right: 10%;
+}
+div.verseblock &gt; div.content {
+  white-space: pre;
+}
+div.verseblock &gt; div.attribution {
+  padding-top: 0.75em;
+  text-align: left;
+}
+/* DEPRECATED: Pre version 8.2.7 verse style literal block. */
+div.verseblock + div.attribution {
+  text-align: left;
+}
+
+div.admonitionblock .icon {
+  vertical-align: top;
+  font-size: 1.1em;
+  font-weight: bold;
+  text-decoration: underline;
+  color: #527bbd;
+  padding-right: 0.5em;
+}
+div.admonitionblock td.content {
+  padding-left: 0.5em;
+  border-left: 2px solid silver;
+}
+
+div.exampleblock &gt; div.content {
+  border-left: 2px solid silver;
+  padding: 0.5em;
+}
+
+div.imageblock div.content { padding-left: 0; }
+span.image img { border-style: none; }
+a.image:visited { color: white; }
+
+dl {
+  margin-top: 0.8em;
+  margin-bottom: 0.8em;
+}
+dt {
+  margin-top: 0.5em;
+  margin-bottom: 0;
+  font-style: normal;
+  color: navy;
+}
+dd &gt; *:first-child {
+  margin-top: 0.1em;
+}
+
+ul, ol {
+    list-style-position: outside;
+}
+ol.arabic {
+  list-style-type: decimal;
+}
+ol.loweralpha {
+  list-style-type: lower-alpha;
+}
+ol.upperalpha {
+  list-style-type: upper-alpha;
+}
+ol.lowerroman {
+  list-style-type: lower-roman;
+}
+ol.upperroman {
+  list-style-type: upper-roman;
+}
+
+div.compact ul, div.compact ol,
+div.compact p, div.compact p,
+div.compact div, div.compact div {
+  margin-top: 0.1em;
+  margin-bottom: 0.1em;
+}
+
+div.tableblock &gt; table {
+  border: 3px solid #527bbd;
+}
+thead {
+  font-family: sans-serif;
+  font-weight: bold;
+}
+tfoot {
+  font-weight: bold;
+}
+td &gt; div.verse {
+  white-space: pre;
+}
+p.table {
+  margin-top: 0;
+}
+/* Because the table frame attribute is overriden by CSS in most browsers. */
+div.tableblock &gt; table[frame=&quot;void&quot;] {
+  border-style: none;
+}
+div.tableblock &gt; table[frame=&quot;hsides&quot;] {
+  border-left-style: none;
+  border-right-style: none;
+}
+div.tableblock &gt; table[frame=&quot;vsides&quot;] {
+  border-top-style: none;
+  border-bottom-style: none;
+}
+
+
+div.hdlist {
+  margin-top: 0.8em;
+  margin-bottom: 0.8em;
+}
+div.hdlist tr {
+  padding-bottom: 15px;
+}
+dt.hdlist1.strong, td.hdlist1.strong {
+  font-weight: bold;
+}
+td.hdlist1 {
+  vertical-align: top;
+  font-style: normal;
+  padding-right: 0.8em;
+  color: navy;
+}
+td.hdlist2 {
+  vertical-align: top;
+}
+div.hdlist.compact tr {
+  margin: 0;
+  padding-bottom: 0;
+}
+
+.comment {
+  background: yellow;
+}
+
+.footnote, .footnoteref {
+  font-size: 0.8em;
+}
+
+span.footnote, span.footnoteref {
+  vertical-align: super;
+}
+
+#footnotes {
+  margin: 20px 0 20px 0;
+  padding: 7px 0 0 0;
+}
+
+#footnotes div.footnote {
+  margin: 0 0 5px 0;
+}
+
+#footnotes hr {
+  border: none;
+  border-top: 1px solid silver;
+  height: 1px;
+  text-align: left;
+  margin-left: 0;
+  width: 20%;
+  min-width: 100px;
+}
+
+
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">+ at media</A> print {
+  div#footer-badges { display: none; }
+}
+
+div#toctitle {
+  color: #527bbd;
+  font-family: sans-serif;
+  font-size: 1.1em;
+  font-weight: bold;
+  margin-top: 1.0em;
+  margin-bottom: 0.1em;
+}
+
+div.toclevel1, div.toclevel2, div.toclevel3, div.toclevel4 {
+  margin-top: 0;
+  margin-bottom: 0;
+}
+div.toclevel2 {
+  margin-left: 2em;
+  font-size: 0.9em;
+}
+div.toclevel3 {
+  margin-left: 4em;
+  font-size: 0.9em;
+}
+div.toclevel4 {
+  margin-left: 6em;
+  font-size: 0.9em;
+}
+/* Overrides for manpage documents */
+h1 {
+  padding-top: 0.5em;
+  padding-bottom: 0.5em;
+  border-top: 2px solid silver;
+  border-bottom: 2px solid silver;
+}
+h2 {
+  border-style: none;
+}
+div.sectionbody {
+  margin-left: 5%;
+}
+
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">+ at media</A> print {
+  div#toc { display: none; }
+}
+
+/* Workarounds for IE6's broken and incomplete CSS2. */
+
+div.sidebar-content {
+  background: #ffffee;
+  border: 1px solid silver;
+  padding: 0.5em;
+}
+div.sidebar-title, div.image-title {
+  color: #527bbd;
+  font-family: sans-serif;
+  font-weight: bold;
+  margin-top: 0.0em;
+  margin-bottom: 0.5em;
+}
+
+div.listingblock div.content {
+  border: 1px solid silver;
+  background: #f4f4f4;
+  padding: 0.5em;
+}
+
+div.quoteblock-attribution {
+  padding-top: 0.5em;
+  text-align: right;
+}
+
+div.verseblock-content {
+  white-space: pre;
+}
+div.verseblock-attribution {
+  padding-top: 0.75em;
+  text-align: left;
+}
+
+div.exampleblock-content {
+  border-left: 2px solid silver;
+  padding-left: 0.5em;
+}
+
+/* IE6 sets dynamically generated links as visited. */
+div#toc a:visited { color: blue; }
+&lt;/style&gt;
+&lt;script type=&quot;text/javascript&quot;&gt;
+/*&lt;![CDATA[*/
+window.onload = function(){asciidoc.footnotes();}
+var asciidoc = {  // Namespace.
+
+/////////////////////////////////////////////////////////////////////
+// Table Of Contents generator
+/////////////////////////////////////////////////////////////////////
+
+/* Author: Mihai Bazon, September 2002
+ * <A HREF="http://students.infoiasi.ro/~mishoo">http://students.infoiasi.ro/~mishoo</A>
+ *
+ * Table Of Content generator
+ * Version: 0.4
+ *
+ * Feel free to use this script under the terms of the GNU General Public
+ * License, as long as you do not remove or alter this notice.
+ */
+
+ /* modified by Troy D. Hanson, September 2006. License: GPL */
+ /* modified by Stuart Rackham, 2006, 2009. License: GPL */
+
+// toclevels = 1..4.
+toc: function (toclevels) {
+
+  function getText(el) {
+    var text = &quot;&quot;;
+    for (var i = el.firstChild; i != null; i = i.nextSibling) {
+      if (i.nodeType == 3 /* Node.TEXT_NODE */) // IE doesn't speak constants.
+        text += i.data;
+      else if (i.firstChild != null)
+        text += getText(i);
+    }
+    return text;
+  }
+
+  function TocEntry(el, text, toclevel) {
+    this.element = el;
+    this.text = text;
+    this.toclevel = toclevel;
+  }
+
+  function tocEntries(el, toclevels) {
+    var result = new Array;
+    var re = new RegExp('[hH]([2-'+(toclevels+1)+'])');
+    // Function that scans the DOM tree for header elements (the DOM2
+    // nodeIterator API would be a better technique but not supported by all
+    // browsers).
+    var iterate = function (el) {
+      for (var i = el.firstChild; i != null; i = i.nextSibling) {
+        if (i.nodeType == 1 /* Node.ELEMENT_NODE */) {
+          var mo = re.exec(i.tagName);
+          if (mo)
+            result[result.length] = new TocEntry(i, getText(i), mo[1]-1);
+          iterate(i);
+        }
+      }
+    }
+    iterate(el);
+    return result;
+  }
+
+  var toc = document.getElementById(&quot;toc&quot;);
+  var entries = tocEntries(document.getElementById(&quot;content&quot;), toclevels);
+  for (var i = 0; i &lt; entries.length; ++i) {
+    var entry = entries[i];
+    if (entry.element.id == &quot;&quot;)
+      entry.element.id = &quot;_toc_&quot; + i;
+    var a = document.createElement(&quot;a&quot;);
+    a.href = &quot;#&quot; + entry.element.id;
+    a.appendChild(document.createTextNode(entry.text));
+    var div = document.createElement(&quot;div&quot;);
+    div.appendChild(a);
+    div.className = &quot;toclevel&quot; + entry.toclevel;
+    toc.appendChild(div);
+  }
+  if (entries.length == 0)
+    toc.parentNode.removeChild(toc);
+},
+
+
+/////////////////////////////////////////////////////////////////////
+// Footnotes generator
+/////////////////////////////////////////////////////////////////////
+
+/* Based on footnote generation code from:
+ * <A HREF="http://www.brandspankingnew.net/archive/2005/07/format_footnote.html">http://www.brandspankingnew.net/archive/2005/07/format_footnote.html</A>
+ */
+
+footnotes: function () {
+  var cont = document.getElementById(&quot;content&quot;);
+  var noteholder = document.getElementById(&quot;footnotes&quot;);
+  var spans = cont.getElementsByTagName(&quot;span&quot;);
+  var refs = {};
+  var n = 0;
+  for (i=0; i&lt;spans.length; i++) {
+    if (spans[i].className == &quot;footnote&quot;) {
+      n++;
+      // Use [\s\S] in place of . so multi-line matches work.
+      // Because JavaScript has no s (dotall) regex flag.
+      note = spans[i].innerHTML.match(/\s*\[([\s\S]*)]\s*/)[1];
+      noteholder.innerHTML +=
+        &quot;&lt;div class='footnote' id='_footnote_&quot; + n + &quot;'&gt;&quot; +
+        &quot;&lt;a href='#_footnoteref_&quot; + n + &quot;' title='Return to text'&gt;&quot; +
+        n + &quot;&lt;/a&gt;. &quot; + note + &quot;&lt;/div&gt;&quot;;
+      spans[i].innerHTML =
+        &quot;[&lt;a id='_footnoteref_&quot; + n + &quot;' href='#_footnote_&quot; + n +
+        &quot;' title='View footnote' class='footnote'&gt;&quot; + n + &quot;&lt;/a&gt;]&quot;;
+      var id =spans[i].getAttribute(&quot;id&quot;);
+      if (id != null) refs[&quot;#&quot;+id] = n;
+    }
+  }
+  if (n == 0)
+    noteholder.parentNode.removeChild(noteholder);
+  else {
+    // Process footnoterefs.
+    for (i=0; i&lt;spans.length; i++) {
+      if (spans[i].className == &quot;footnoteref&quot;) {
+        var href = spans[i].getElementsByTagName(&quot;a&quot;)[0].getAttribute(&quot;href&quot;);
+        href = href.match(/#.*/)[0];  // Because IE return full URL.
+        n = refs[href];
+        spans[i].innerHTML =
+          &quot;[&lt;a href='#_footnote_&quot; + n +
+          &quot;' title='View footnote' class='footnote'&gt;&quot; + n + &quot;&lt;/a&gt;]&quot;;
+      }
+    }
+  }
+}
+
+}
+/*]]&gt;*/
+&lt;/script&gt;
+&lt;/head&gt;
+&lt;body&gt;
+&lt;div id=&quot;header&quot;&gt;
+&lt;h1&gt;
+dstat(1) Manual Page
+&lt;/h1&gt;
+&lt;h2&gt;NAME&lt;/h2&gt;
+&lt;div class=&quot;sectionbody&quot;&gt;
+&lt;p&gt;dstat -
+   versatile tool for generating system resource statistics
+&lt;/p&gt;
+&lt;/div&gt;
+&lt;/div&gt;
+&lt;div id=&quot;content&quot;&gt;
+&lt;h2 id=&quot;_synopsis&quot;&gt;SYNOPSIS&lt;/h2&gt;
+&lt;div class=&quot;sectionbody&quot;&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;dstat [-afv] [options..] [delay [count]]&lt;/p&gt;&lt;/div&gt;
+&lt;/div&gt;
+&lt;h2 id=&quot;_description&quot;&gt;DESCRIPTION&lt;/h2&gt;
+&lt;div class=&quot;sectionbody&quot;&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Dstat is a versatile replacement for vmstat, iostat and ifstat. Dstat
+overcomes some of the limitations and adds some extra features.&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Dstat allows you to view all of your system resources instantly, you
+can eg. compare disk usage in combination with interrupts from your
+IDE controller, or compare the network bandwidth numbers directly with
+the disk throughput (in the same interval).&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Dstat also cleverly gives you the most detailed information in columns
+and clearly indicates in what magnitude and unit the output is displayed.
+Less confusion, less mistakes, more efficient.&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Dstat is unique in letting you aggregate block device throughput for a
+certain diskset or network bandwidth for a group of interfaces, ie.
+you can see the throughput for all the block devices that make up a
+single filesystem or storage system.&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Dstat allows its data to be directly written to a CSV file to be
+imported and used by OpenOffice, Gnumeric or Excel to create graphs.&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;admonitionblock&quot;&gt;
+&lt;table&gt;&lt;tr&gt;
+&lt;td class=&quot;icon&quot;&gt;
+&lt;div class=&quot;title&quot;&gt;Note&lt;/div&gt;
+&lt;/td&gt;
+&lt;td class=&quot;content&quot;&gt;Users of Sleuthkit might find Sleuthkit&amp;#8217;s dstat being renamed to
+datastat to avoid a name conflict. See Debian bug #283709 for more
+information.&lt;/td&gt;
+&lt;/tr&gt;&lt;/table&gt;
+&lt;/div&gt;
+&lt;/div&gt;
+&lt;h2 id=&quot;_options&quot;&gt;OPTIONS&lt;/h2&gt;
+&lt;div class=&quot;sectionbody&quot;&gt;
+&lt;div class=&quot;dlist&quot;&gt;&lt;dl&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+-c, --cpu
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    enable cpu stats (system, user, idle, wait, hardware interrupt, software
+    interrupt)
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+-C 0,3,total
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    include cpu0, cpu3 and total
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+-d, --disk
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    enable disk stats (read, write)
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+-D total,hda
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    include hda and total
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+-g, --page
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    enable page stats (page in, page out)
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+-i, --int
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    enable interrupt stats
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+-I 5,10
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    include interrupt 5 and 10
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+-l, --load
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    enable load average stats (1 min, 5 mins, 15mins)
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+-m, --mem
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    enable memory stats (used, buffers, cache, free)
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+-n, --net
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    enable network stats (receive, send)
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+-N eth1,total
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    include eth1 and total
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+-p, --proc
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    enable process stats (runnable, uninterruptible, new)
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+-r, --io
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    enable I/O request stats (read, write requests)
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+-s, --swap
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    enable swap stats (used, free)
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+-S swap1,total
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    include swap1 and total
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+-t, --time
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    enable time/date output
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+-T, --epoch
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    enable time counter (seconds since epoch)
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+-y, --sys
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    enable system stats (interrupts, context switches)
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--aio
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    enable aio stats (asynchronous I/O)
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--fs
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    enable filesystem stats (open files, inodes)
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--ipc
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    enable ipc stats (message queue, semaphores, shared memory)
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--lock
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    enable file lock stats (posix, flock, read, write)
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--raw
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    enable raw stats (raw sockets)
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--socket
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    enable socket stats (total, tcp, udp, raw, ip-fragments)
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--tcp
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    enable tcp stats (listen, established, syn, time_wait, close)
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--udp
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    enable udp stats (listen, active)
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--unix
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    enable unix stats (datagram, stream, listen, active)
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--vm
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    enable vm stats (hard pagefaults, soft pagefaults, allocated, free)
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--stat1 --stat2
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    enable (external) plugins by plugin name, see &lt;strong&gt;PLUGINS&lt;/strong&gt; for options
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+Possible internal stats are
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    aio, cpu, cpu24, disk, disk24, disk24old, epoch, fs, int, int24, io, ipc,
+    load, lock, mem, net, page, page24, proc, raw, socket, swap, swapold,
+    sys, tcp, time, udp, unix, vm
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--list
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    list the internal and external plugin names
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+-a, --all
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    equals -cdngy (default)
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+-f, --full
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    expand -C, -D, -I, -N and -S discovery lists
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+-v, --vmstat
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    equals -pmgdsc -D total
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--bw, --blackonwhite
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    change colors for white background terminal
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--float
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    force float values on screen (mutual exclusive with &lt;strong&gt;--integer&lt;/strong&gt;)
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--integer
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    force integer values on screen (mutual exclusive with &lt;strong&gt;--float&lt;/strong&gt;)
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--nocolor
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    disable colors (implies &lt;strong&gt;--noupdate&lt;/strong&gt;)
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--noheaders
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    disable repetitive headers
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--noupdate
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    disable intermediate updates when delay &amp;gt; 1
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--output file
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    write CSV output to file
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;/dl&gt;&lt;/div&gt;
+&lt;/div&gt;
+&lt;h2 id=&quot;_plugins&quot;&gt;PLUGINS&lt;/h2&gt;
+&lt;div class=&quot;sectionbody&quot;&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;While anyone can create their own dstat plugins (and contribute them) dstat
+ships with a number of plugins already that extend its capabilities greatly.
+Here is an overview of the plugins dstat ships with:&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;dlist&quot;&gt;&lt;dl&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--battery
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    battery in percentage (needs ACPI)
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--battery-remain
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    battery remaining in hours, minutes (needs ACPI)
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--cpufreq
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    CPU frequency in percentage (needs ACPI)
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--dbus
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    number of dbus connections (needs python-dbus)
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--disk-util
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    per disk utilization in percentage
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--fan
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    fan speed (needs ACPI)
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--freespace
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    per filesystem disk usage
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--gpfs
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    GPFS read/write I/O (needs mmpmon)
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--gpfs-ops
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    GPFS filesystem operations (needs mmpmon)
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--helloworld
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    Hello world example dstat plugin
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--innodb-buffer
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    TBD
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--innodb-io
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    TBD
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--innodb-ops
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    TBD
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--lustre
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    TBD
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--memcache-hits
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    TBD
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--mysql5-com
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    TBD
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--mysql5-conn
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    TBD
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--mysql5-io
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    TBD
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--mysql5-keys
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    TBD
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--mysql-io
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    TBD
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--mysql-keys
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    TBD
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--net-packets
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    TBD
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--nfs3
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    NFS v3 client operations
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--nfs3-ops
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    Extended NFS v3 client operations
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--nfsd3
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    NFS v3 server operations
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--nfsd3-ops
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    Extended NFS v3 server operations
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--ntp
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    TBD
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--postfix
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    postfix queue size (needs postfix)
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--power
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    TBD
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--proc-count
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    TBD
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--rpc
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    RPC client calls
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--rpcd
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    RPC server calls
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--sendmail
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    sendmail queue size (needs sendmail)
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--snooze
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    number of ticks per second
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--test
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    TBD
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--thermal
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    system temperature sensors
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--top-bio
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    TBD
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--top-cpu
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    TBD
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--top-cputime
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    TBD
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--top-cputime-avg
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    TBD
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--top-io
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    TBD
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--top-latency
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    TBD
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--top-latency-avg
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    TBD
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--top-mem
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    TBD
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--top-oom
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    TBD
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--utmp
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    Number of utmp connections (needs python-utmp)
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--vmk-hba
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    TBD
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--vmk-int
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    TBD
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--vmk-nic
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    TBD
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--vm-memctl
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    TBD
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--vz-io
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    TBD
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--vz-ubc
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    TBD
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;dt class=&quot;hdlist1&quot;&gt;
+--wifi
+&lt;/dt&gt;
+&lt;dd&gt;
+&lt;p&gt;
+    wireless link quality and signal to noise ratio
+&lt;/p&gt;
+&lt;/dd&gt;
+&lt;/dl&gt;&lt;/div&gt;
+&lt;/div&gt;
+&lt;h2 id=&quot;_arguments&quot;&gt;ARGUMENTS&lt;/h2&gt;
+&lt;div class=&quot;sectionbody&quot;&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;&lt;strong&gt;delay&lt;/strong&gt; is the delay in seconds between each update&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;&lt;strong&gt;count&lt;/strong&gt; is the number of updates to display before exiting&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;The default delay is 1 and count is unspecified (unlimited)&lt;/p&gt;&lt;/div&gt;
+&lt;/div&gt;
+&lt;h2 id=&quot;_intermediate_updates&quot;&gt;INTERMEDIATE UPDATES&lt;/h2&gt;
+&lt;div class=&quot;sectionbody&quot;&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;When invoking dstat with a &lt;strong&gt;delay&lt;/strong&gt; greater than 1 and without the
+&lt;strong&gt;--noupdate&lt;/strong&gt; option, it will show intermediate updates, ie. the first
+time a 1 sec average, the second update a 2 second average, etc. until
+the delay has been reached.&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;So in case you specified a delay of 10, &lt;strong&gt;the 9 intermediate updates
+are NOT snapshots&lt;/strong&gt;, they are averages over the time that passed since
+the last final update. The end result is that you get a 10 second
+average on a new line, just like with vmstat.&lt;/p&gt;&lt;/div&gt;
+&lt;/div&gt;
+&lt;h2 id=&quot;_examples&quot;&gt;EXAMPLES&lt;/h2&gt;
+&lt;div class=&quot;sectionbody&quot;&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Using dstat to relate disk-throughput with network-usage (eth0), total CPU-usage and system counters:&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;listingblock&quot;&gt;
+&lt;div class=&quot;content&quot;&gt;
+&lt;pre&gt;&lt;tt&gt;dstat -dnyc -N eth0 -C total -f 5&lt;/tt&gt;&lt;/pre&gt;
+&lt;/div&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Checking dstat&amp;#8217;s behaviour and the system impact of dstat:&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;listingblock&quot;&gt;
+&lt;div class=&quot;content&quot;&gt;
+&lt;pre&gt;&lt;tt&gt;dstat -taf --debug&lt;/tt&gt;&lt;/pre&gt;
+&lt;/div&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Using the time plugin together with cpu, net, disk, system, load, proc and topcpu plugins:&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;listingblock&quot;&gt;
+&lt;div class=&quot;content&quot;&gt;
+&lt;pre&gt;&lt;tt&gt;dstat -tcndylp --topcpu&lt;/tt&gt;&lt;/pre&gt;
+&lt;/div&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;this is identical to&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;listingblock&quot;&gt;
+&lt;div class=&quot;content&quot;&gt;
+&lt;pre&gt;&lt;tt&gt;dstat --time --cpu --net --disk --sys --load --proc --topcpu&lt;/tt&gt;&lt;/pre&gt;
+&lt;/div&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Using dstat to relate cpu stats with interrupts per device:&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;listingblock&quot;&gt;
+&lt;div class=&quot;content&quot;&gt;
+&lt;pre&gt;&lt;tt&gt;dstat -tcyif&lt;/tt&gt;&lt;/pre&gt;
+&lt;/div&gt;&lt;/div&gt;
+&lt;/div&gt;
+&lt;h2 id=&quot;_bugs&quot;&gt;BUGS&lt;/h2&gt;
+&lt;div class=&quot;sectionbody&quot;&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Since it is practically impossible to test dstat on every possible
+permutation of kernel, python or distribution version, I need your
+help and your feedback to fix the remaining problems. If you have
+improvements or bugreports, please send them to:
+&lt;a href=&quot;mailto:<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>&quot;&gt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;admonitionblock&quot;&gt;
+&lt;table&gt;&lt;tr&gt;
+&lt;td class=&quot;icon&quot;&gt;
+&lt;div class=&quot;title&quot;&gt;Note&lt;/div&gt;
+&lt;/td&gt;
+&lt;td class=&quot;content&quot;&gt;Please see the TODO file for known bugs and future plans.&lt;/td&gt;
+&lt;/tr&gt;&lt;/table&gt;
+&lt;/div&gt;
+&lt;/div&gt;
+&lt;h2 id=&quot;_files&quot;&gt;FILES&lt;/h2&gt;
+&lt;div class=&quot;sectionbody&quot;&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Paths that may contain external dstat_*.py plugins:&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;literalblock&quot;&gt;
+&lt;div class=&quot;content&quot;&gt;
+&lt;pre&gt;&lt;tt&gt;~/.dstat/
+./
+./plugins/
+(path of binary)/plugins/
+/usr/share/dstat/
+/usr/local/share/dstat/&lt;/tt&gt;&lt;/pre&gt;
+&lt;/div&gt;&lt;/div&gt;
+&lt;/div&gt;
+&lt;h2 id=&quot;_see_also&quot;&gt;SEE ALSO&lt;/h2&gt;
+&lt;div class=&quot;sectionbody&quot;&gt;
+&lt;h3 id=&quot;_performance_tools&quot;&gt;Performance tools&lt;/h3&gt;&lt;div style=&quot;clear:left&quot;&gt;&lt;/div&gt;
+&lt;div class=&quot;literalblock&quot;&gt;
+&lt;div class=&quot;content&quot;&gt;
+&lt;pre&gt;&lt;tt&gt;ifstat(1), iftop(8), iostat(1), mpstat(1), netstat(1), nfsstat(1), nstat, vmstat(1), xosview(1)&lt;/tt&gt;&lt;/pre&gt;
+&lt;/div&gt;&lt;/div&gt;
+&lt;h3 id=&quot;_debugging_tools&quot;&gt;Debugging tools&lt;/h3&gt;&lt;div style=&quot;clear:left&quot;&gt;&lt;/div&gt;
+&lt;div class=&quot;literalblock&quot;&gt;
+&lt;div class=&quot;content&quot;&gt;
+&lt;pre&gt;&lt;tt&gt;htop(1), lslk(1), lsof(8), top(1)&lt;/tt&gt;&lt;/pre&gt;
+&lt;/div&gt;&lt;/div&gt;
+&lt;h3 id=&quot;_process_tracing&quot;&gt;Process tracing&lt;/h3&gt;&lt;div style=&quot;clear:left&quot;&gt;&lt;/div&gt;
+&lt;div class=&quot;literalblock&quot;&gt;
+&lt;div class=&quot;content&quot;&gt;
+&lt;pre&gt;&lt;tt&gt;ltrace(1), pmap(1), ps(1), pstack(1), strace(1)&lt;/tt&gt;&lt;/pre&gt;
+&lt;/div&gt;&lt;/div&gt;
+&lt;h3 id=&quot;_binary_debugging&quot;&gt;Binary debugging&lt;/h3&gt;&lt;div style=&quot;clear:left&quot;&gt;&lt;/div&gt;
+&lt;div class=&quot;literalblock&quot;&gt;
+&lt;div class=&quot;content&quot;&gt;
+&lt;pre&gt;&lt;tt&gt;ldd(1), file(1), nm(1), objdump(1), readelf(1)&lt;/tt&gt;&lt;/pre&gt;
+&lt;/div&gt;&lt;/div&gt;
+&lt;h3 id=&quot;_memory_usage_tools&quot;&gt;Memory usage tools&lt;/h3&gt;&lt;div style=&quot;clear:left&quot;&gt;&lt;/div&gt;
+&lt;div class=&quot;literalblock&quot;&gt;
+&lt;div class=&quot;content&quot;&gt;
+&lt;pre&gt;&lt;tt&gt;free(1), memusage, memusagestat, slabtop(1)&lt;/tt&gt;&lt;/pre&gt;
+&lt;/div&gt;&lt;/div&gt;
+&lt;h3 id=&quot;_accounting_tools&quot;&gt;Accounting tools&lt;/h3&gt;&lt;div style=&quot;clear:left&quot;&gt;&lt;/div&gt;
+&lt;div class=&quot;literalblock&quot;&gt;
+&lt;div class=&quot;content&quot;&gt;
+&lt;pre&gt;&lt;tt&gt;dump-acct, dump-utmp, sa(8)&lt;/tt&gt;&lt;/pre&gt;
+&lt;/div&gt;&lt;/div&gt;
+&lt;h3 id=&quot;_hardware_debugging_tools&quot;&gt;Hardware debugging tools&lt;/h3&gt;&lt;div style=&quot;clear:left&quot;&gt;&lt;/div&gt;
+&lt;div class=&quot;literalblock&quot;&gt;
+&lt;div class=&quot;content&quot;&gt;
+&lt;pre&gt;&lt;tt&gt;dmidecode, ifinfo(1), lsdev(1), lshal(1), lshw(1), lsmod(8), lspci(8), lsusb(8), smartctl(8), x86info(1)&lt;/tt&gt;&lt;/pre&gt;
+&lt;/div&gt;&lt;/div&gt;
+&lt;h3 id=&quot;_application_debugging&quot;&gt;Application debugging&lt;/h3&gt;&lt;div style=&quot;clear:left&quot;&gt;&lt;/div&gt;
+&lt;div class=&quot;literalblock&quot;&gt;
+&lt;div class=&quot;content&quot;&gt;
+&lt;pre&gt;&lt;tt&gt;mailstats(8), qshape(1)&lt;/tt&gt;&lt;/pre&gt;
+&lt;/div&gt;&lt;/div&gt;
+&lt;h3 id=&quot;_xorg_related_tools&quot;&gt;Xorg related tools&lt;/h3&gt;&lt;div style=&quot;clear:left&quot;&gt;&lt;/div&gt;
+&lt;div class=&quot;literalblock&quot;&gt;
+&lt;div class=&quot;content&quot;&gt;
+&lt;pre&gt;&lt;tt&gt;xdpyinfo(1), xrestop(1)&lt;/tt&gt;&lt;/pre&gt;
+&lt;/div&gt;&lt;/div&gt;
+&lt;h3 id=&quot;_other_useful_info&quot;&gt;Other useful info&lt;/h3&gt;&lt;div style=&quot;clear:left&quot;&gt;&lt;/div&gt;
+&lt;div class=&quot;literalblock&quot;&gt;
+&lt;div class=&quot;content&quot;&gt;
+&lt;pre&gt;&lt;tt&gt;collectl(1), proc(5), procinfo(8)&lt;/tt&gt;&lt;/pre&gt;
+&lt;/div&gt;&lt;/div&gt;
+&lt;/div&gt;
+&lt;h2 id=&quot;_author&quot;&gt;AUTHOR&lt;/h2&gt;
+&lt;div class=&quot;sectionbody&quot;&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Written by Dag Wieers &lt;a href=&quot;mailto:<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>&quot;&gt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Homepage at &lt;a href=&quot;<A HREF="http://dag.wieers.com/home-made/dstat/">http://dag.wieers.com/home-made/dstat/</A>&quot;&gt;<A HREF="http://dag.wieers.com/home-made/dstat/&lt;/a">http://dag.wieers.com/home-made/dstat/&lt;/a</A>&gt;&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;This manpage was initially written by Andrew Pollock
+&lt;a href=&quot;mailto:<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">apollock at debian.org</A>&quot;&gt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">apollock at debian.org</A>&lt;/a&gt; for the Debian GNU/Linux system.&lt;/p&gt;&lt;/div&gt;
+&lt;/div&gt;
+&lt;/div&gt;
+&lt;div id=&quot;footnotes&quot;&gt;&lt;hr /&gt;&lt;/div&gt;
+&lt;div id=&quot;footer&quot;&gt;
+&lt;div id=&quot;footer-text&quot;&gt;
+Version 0.7.0&lt;br /&gt;
+Last updated 2009-11-24 02:39:47 CEST
+&lt;/div&gt;
+&lt;/div&gt;
+&lt;/body&gt;
+&lt;/html&gt;

Modified: trunk/tools/dstat/docs/dstat.1.txt
===================================================================
--- trunk/tools/dstat/docs/dstat.1.txt	2009-11-21 14:08:12 UTC (rev 8035)
+++ trunk/tools/dstat/docs/dstat.1.txt	2009-11-24 01:46:30 UTC (rev 8036)
@@ -122,14 +122,11 @@
     enable unix stats (datagram, stream, listen, active)
 
 --vm::
-    enable vm stats (hard pagefaults, soft pagefaults, allocated, free))
+    enable vm stats (hard pagefaults, soft pagefaults, allocated, free)
 
 --stat1 --stat2::
-    enable internal and external plugin stats by plugin name
+    enable (external) plugins by plugin name, see *PLUGINS* for options
 
--M stat1,stat2::
-    enable internal and external plugin stats by plugin name
-
 Possible internal stats are::
     aio, cpu, cpu24, disk, disk24, disk24old, epoch, fs, int, int24, io, ipc,
     load, lock, mem, net, page, page24, proc, raw, socket, swap, swapold,
@@ -151,13 +148,13 @@
     change colors for white background terminal
 
 --float::
-    force float values on screen
+    force float values on screen (mutual exclusive with *--integer*)
 
 --integer::
-    force integer values on screen
+    force integer values on screen (mutual exclusive with *--float*)
 
 --nocolor::
-    disable colors (implies --noupdate)
+    disable colors (implies *--noupdate*)
 
 --noheaders::
     disable repetitive headers
@@ -169,6 +166,171 @@
     write CSV output to file
 
 
+== PLUGINS
+While anyone can create their own dstat plugins (and contribute them) dstat
+ships with a number of plugins already that extend its capabilities greatly.
+Here is an overview of the plugins dstat ships with:
+
+--battery::
+    battery in percentage (needs ACPI)
+
+--battery-remain::
+    battery remaining in hours, minutes (needs ACPI)
+
+--cpufreq::
+    CPU frequency in percentage (needs ACPI)
+
+--dbus::
+    number of dbus connections (needs python-dbus)
+
+--disk-util::
+    per disk utilization in percentage
+
+--fan::
+    fan speed (needs ACPI)
+
+--freespace::
+    per filesystem disk usage
+
+--gpfs::
+    GPFS read/write I/O (needs mmpmon)
+
+--gpfs-ops::
+    GPFS filesystem operations (needs mmpmon)
+
+--helloworld::
+    Hello world example dstat plugin
+
+--innodb-buffer::
+    TBD
+
+--innodb-io::
+    TBD
+
+--innodb-ops::
+    TBD
+
+--lustre::
+    TBD
+
+--memcache-hits::
+    TBD
+
+--mysql5-com::
+    TBD
+
+--mysql5-conn::
+    TBD
+
+--mysql5-io::
+    TBD
+
+--mysql5-keys::
+    TBD
+
+--mysql-io::
+    TBD
+
+--mysql-keys::
+    TBD
+
+--net-packets::
+    TBD
+
+--nfs3::
+    NFS v3 client operations
+
+--nfs3-ops::
+    Extended NFS v3 client operations
+
+--nfsd3::
+    NFS v3 server operations
+
+--nfsd3-ops::
+    Extended NFS v3 server operations
+
+--ntp::
+    TBD
+
+--postfix::
+    postfix queue size (needs postfix)
+
+--power::
+    TBD
+
+--proc-count::
+    TBD
+
+--rpc::
+    RPC client calls
+
+--rpcd::
+    RPC server calls
+
+--sendmail::
+    sendmail queue size (needs sendmail)
+
+--snooze::
+    number of ticks per second
+
+--test::
+    TBD
+
+--thermal::
+    system temperature sensors
+
+--top-bio::
+    TBD
+
+--top-cpu::
+    TBD
+
+--top-cputime::
+    TBD
+
+--top-cputime-avg::
+    TBD
+
+--top-io::
+    TBD
+
+--top-latency::
+    TBD
+
+--top-latency-avg::
+    TBD
+
+--top-mem::
+    TBD
+
+--top-oom::
+    TBD
+
+--utmp::
+    Number of utmp connections (needs python-utmp)
+
+--vmk-hba::
+    TBD
+
+--vmk-int::
+    TBD
+
+--vmk-nic::
+    TBD
+
+--vm-memctl::
+    TBD
+
+--vz-io::
+    TBD
+
+--vz-ubc::
+    TBD
+
+--wifi::
+    wireless link quality and signal to noise ratio
+
+
 == ARGUMENTS
 *delay* is the delay in seconds between each update
 
@@ -189,7 +351,7 @@
 average on a new line, just like with vmstat.
 
 
-== USAGE
+== EXAMPLES
 Using dstat to relate disk-throughput with network-usage (eth0), total CPU-usage and system counters:
 ----
 dstat -dnyc -N eth0 -C total -f 5
@@ -208,10 +370,6 @@
 ----
 dstat --time --cpu --net --disk --sys --load --proc --topcpu
 ----
-and identical to
-----
-dstat -M time,cpu,net,disk,sys,load,proc,topcpu
-----
 
 Using dstat to relate cpu stats with interrupts per device:
 ----

Added: trunk/tools/dstat/docs/examples.html
===================================================================
--- trunk/tools/dstat/docs/examples.html	                        (rev 0)
+++ trunk/tools/dstat/docs/examples.html	2009-11-24 01:46:30 UTC (rev 8036)
@@ -0,0 +1,582 @@
+&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.1//EN&quot;
+    &quot;<A HREF="http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd</A>&quot;&gt;
+&lt;html xmlns=&quot;<A HREF="http://www.w3.org/1999/xhtml">http://www.w3.org/1999/xhtml</A>&quot; xml:lang=&quot;en&quot;&gt;
+&lt;head&gt;
+&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;
+&lt;meta name=&quot;generator&quot; content=&quot;AsciiDoc 8.5.1&quot; /&gt;
+&lt;title&gt;Dstat examples&lt;/title&gt;
+&lt;style type=&quot;text/css&quot;&gt;
+/* Debug borders */
+p, li, dt, dd, div, pre, h1, h2, h3, h4, h5, h6 {
+/*
+  border: 1px solid red;
+*/
+}
+
+body {
+  margin: 1em 5% 1em 5%;
+}
+
+a {
+  color: blue;
+  text-decoration: underline;
+}
+a:visited {
+  color: fuchsia;
+}
+
+em {
+  font-style: italic;
+  color: navy;
+}
+
+strong {
+  font-weight: bold;
+  color: #083194;
+}
+
+tt {
+  color: navy;
+}
+
+h1, h2, h3, h4, h5, h6 {
+  color: #527bbd;
+  font-family: sans-serif;
+  margin-top: 1.2em;
+  margin-bottom: 0.5em;
+  line-height: 1.3;
+}
+
+h1, h2, h3 {
+  border-bottom: 2px solid silver;
+}
+h2 {
+  padding-top: 0.5em;
+}
+h3 {
+  float: left;
+}
+h3 + * {
+  clear: left;
+}
+
+div.sectionbody {
+  font-family: serif;
+  margin-left: 0;
+}
+
+hr {
+  border: 1px solid silver;
+}
+
+p {
+  margin-top: 0.5em;
+  margin-bottom: 0.5em;
+}
+
+ul, ol, li &gt; p {
+  margin-top: 0;
+}
+
+pre {
+  padding: 0;
+  margin: 0;
+}
+
+span#author {
+  color: #527bbd;
+  font-family: sans-serif;
+  font-weight: bold;
+  font-size: 1.1em;
+}
+span#email {
+}
+span#revnumber, span#revdate, span#revremark {
+  font-family: sans-serif;
+}
+
+div#footer {
+  font-family: sans-serif;
+  font-size: small;
+  border-top: 2px solid silver;
+  padding-top: 0.5em;
+  margin-top: 4.0em;
+}
+div#footer-text {
+  float: left;
+  padding-bottom: 0.5em;
+}
+div#footer-badges {
+  float: right;
+  padding-bottom: 0.5em;
+}
+
+div#preamble {
+  margin-top: 1.5em;
+  margin-bottom: 1.5em;
+}
+div.tableblock, div.imageblock, div.exampleblock, div.verseblock,
+div.quoteblock, div.literalblock, div.listingblock, div.sidebarblock,
+div.admonitionblock {
+  margin-top: 0.25em;
+  margin-bottom: 1.5em;
+}
+div.admonitionblock {
+  margin-top: 2.5em;
+  margin-bottom: 2.5em;
+}
+
+div.content { /* Block element content. */
+  padding: 0;
+}
+
+/* Block element titles. */
+div.title, caption.title {
+  color: #527bbd;
+  font-family: sans-serif;
+  font-weight: bold;
+  text-align: left;
+  margin-top: 1.0em;
+  margin-bottom: 0.5em;
+}
+div.title + * {
+  margin-top: 0;
+}
+
+td div.title:first-child {
+  margin-top: 0.0em;
+}
+div.content div.title:first-child {
+  margin-top: 0.0em;
+}
+div.content + div.title {
+  margin-top: 0.0em;
+}
+
+div.sidebarblock &gt; div.content {
+  background: #ffffee;
+  border: 1px solid silver;
+  padding: 0.5em;
+}
+
+div.listingblock &gt; div.content {
+  border: 1px solid silver;
+  background: #f4f4f4;
+  padding: 0.5em;
+}
+
+div.quoteblock {
+  padding-left: 2.0em;
+  margin-right: 10%;
+}
+div.quoteblock &gt; div.attribution {
+  padding-top: 0.5em;
+  text-align: right;
+}
+
+div.verseblock {
+  padding-left: 2.0em;
+  margin-right: 10%;
+}
+div.verseblock &gt; div.content {
+  white-space: pre;
+}
+div.verseblock &gt; div.attribution {
+  padding-top: 0.75em;
+  text-align: left;
+}
+/* DEPRECATED: Pre version 8.2.7 verse style literal block. */
+div.verseblock + div.attribution {
+  text-align: left;
+}
+
+div.admonitionblock .icon {
+  vertical-align: top;
+  font-size: 1.1em;
+  font-weight: bold;
+  text-decoration: underline;
+  color: #527bbd;
+  padding-right: 0.5em;
+}
+div.admonitionblock td.content {
+  padding-left: 0.5em;
+  border-left: 2px solid silver;
+}
+
+div.exampleblock &gt; div.content {
+  border-left: 2px solid silver;
+  padding: 0.5em;
+}
+
+div.imageblock div.content { padding-left: 0; }
+span.image img { border-style: none; }
+a.image:visited { color: white; }
+
+dl {
+  margin-top: 0.8em;
+  margin-bottom: 0.8em;
+}
+dt {
+  margin-top: 0.5em;
+  margin-bottom: 0;
+  font-style: normal;
+  color: navy;
+}
+dd &gt; *:first-child {
+  margin-top: 0.1em;
+}
+
+ul, ol {
+    list-style-position: outside;
+}
+ol.arabic {
+  list-style-type: decimal;
+}
+ol.loweralpha {
+  list-style-type: lower-alpha;
+}
+ol.upperalpha {
+  list-style-type: upper-alpha;
+}
+ol.lowerroman {
+  list-style-type: lower-roman;
+}
+ol.upperroman {
+  list-style-type: upper-roman;
+}
+
+div.compact ul, div.compact ol,
+div.compact p, div.compact p,
+div.compact div, div.compact div {
+  margin-top: 0.1em;
+  margin-bottom: 0.1em;
+}
+
+div.tableblock &gt; table {
+  border: 3px solid #527bbd;
+}
+thead {
+  font-family: sans-serif;
+  font-weight: bold;
+}
+tfoot {
+  font-weight: bold;
+}
+td &gt; div.verse {
+  white-space: pre;
+}
+p.table {
+  margin-top: 0;
+}
+/* Because the table frame attribute is overriden by CSS in most browsers. */
+div.tableblock &gt; table[frame=&quot;void&quot;] {
+  border-style: none;
+}
+div.tableblock &gt; table[frame=&quot;hsides&quot;] {
+  border-left-style: none;
+  border-right-style: none;
+}
+div.tableblock &gt; table[frame=&quot;vsides&quot;] {
+  border-top-style: none;
+  border-bottom-style: none;
+}
+
+
+div.hdlist {
+  margin-top: 0.8em;
+  margin-bottom: 0.8em;
+}
+div.hdlist tr {
+  padding-bottom: 15px;
+}
+dt.hdlist1.strong, td.hdlist1.strong {
+  font-weight: bold;
+}
+td.hdlist1 {
+  vertical-align: top;
+  font-style: normal;
+  padding-right: 0.8em;
+  color: navy;
+}
+td.hdlist2 {
+  vertical-align: top;
+}
+div.hdlist.compact tr {
+  margin: 0;
+  padding-bottom: 0;
+}
+
+.comment {
+  background: yellow;
+}
+
+.footnote, .footnoteref {
+  font-size: 0.8em;
+}
+
+span.footnote, span.footnoteref {
+  vertical-align: super;
+}
+
+#footnotes {
+  margin: 20px 0 20px 0;
+  padding: 7px 0 0 0;
+}
+
+#footnotes div.footnote {
+  margin: 0 0 5px 0;
+}
+
+#footnotes hr {
+  border: none;
+  border-top: 1px solid silver;
+  height: 1px;
+  text-align: left;
+  margin-left: 0;
+  width: 20%;
+  min-width: 100px;
+}
+
+
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">+ at media</A> print {
+  div#footer-badges { display: none; }
+}
+
+div#toctitle {
+  color: #527bbd;
+  font-family: sans-serif;
+  font-size: 1.1em;
+  font-weight: bold;
+  margin-top: 1.0em;
+  margin-bottom: 0.1em;
+}
+
+div.toclevel1, div.toclevel2, div.toclevel3, div.toclevel4 {
+  margin-top: 0;
+  margin-bottom: 0;
+}
+div.toclevel2 {
+  margin-left: 2em;
+  font-size: 0.9em;
+}
+div.toclevel3 {
+  margin-left: 4em;
+  font-size: 0.9em;
+}
+div.toclevel4 {
+  margin-left: 6em;
+  font-size: 0.9em;
+}
+/* Workarounds for IE6's broken and incomplete CSS2. */
+
+div.sidebar-content {
+  background: #ffffee;
+  border: 1px solid silver;
+  padding: 0.5em;
+}
+div.sidebar-title, div.image-title {
+  color: #527bbd;
+  font-family: sans-serif;
+  font-weight: bold;
+  margin-top: 0.0em;
+  margin-bottom: 0.5em;
+}
+
+div.listingblock div.content {
+  border: 1px solid silver;
+  background: #f4f4f4;
+  padding: 0.5em;
+}
+
+div.quoteblock-attribution {
+  padding-top: 0.5em;
+  text-align: right;
+}
+
+div.verseblock-content {
+  white-space: pre;
+}
+div.verseblock-attribution {
+  padding-top: 0.75em;
+  text-align: left;
+}
+
+div.exampleblock-content {
+  border-left: 2px solid silver;
+  padding-left: 0.5em;
+}
+
+/* IE6 sets dynamically generated links as visited. */
+div#toc a:visited { color: blue; }
+&lt;/style&gt;
+&lt;script type=&quot;text/javascript&quot;&gt;
+/*&lt;![CDATA[*/
+window.onload = function(){asciidoc.footnotes();}
+var asciidoc = {  // Namespace.
+
+/////////////////////////////////////////////////////////////////////
+// Table Of Contents generator
+/////////////////////////////////////////////////////////////////////
+
+/* Author: Mihai Bazon, September 2002
+ * <A HREF="http://students.infoiasi.ro/~mishoo">http://students.infoiasi.ro/~mishoo</A>
+ *
+ * Table Of Content generator
+ * Version: 0.4
+ *
+ * Feel free to use this script under the terms of the GNU General Public
+ * License, as long as you do not remove or alter this notice.
+ */
+
+ /* modified by Troy D. Hanson, September 2006. License: GPL */
+ /* modified by Stuart Rackham, 2006, 2009. License: GPL */
+
+// toclevels = 1..4.
+toc: function (toclevels) {
+
+  function getText(el) {
+    var text = &quot;&quot;;
+    for (var i = el.firstChild; i != null; i = i.nextSibling) {
+      if (i.nodeType == 3 /* Node.TEXT_NODE */) // IE doesn't speak constants.
+        text += i.data;
+      else if (i.firstChild != null)
+        text += getText(i);
+    }
+    return text;
+  }
+
+  function TocEntry(el, text, toclevel) {
+    this.element = el;
+    this.text = text;
+    this.toclevel = toclevel;
+  }
+
+  function tocEntries(el, toclevels) {
+    var result = new Array;
+    var re = new RegExp('[hH]([2-'+(toclevels+1)+'])');
+    // Function that scans the DOM tree for header elements (the DOM2
+    // nodeIterator API would be a better technique but not supported by all
+    // browsers).
+    var iterate = function (el) {
+      for (var i = el.firstChild; i != null; i = i.nextSibling) {
+        if (i.nodeType == 1 /* Node.ELEMENT_NODE */) {
+          var mo = re.exec(i.tagName);
+          if (mo)
+            result[result.length] = new TocEntry(i, getText(i), mo[1]-1);
+          iterate(i);
+        }
+      }
+    }
+    iterate(el);
+    return result;
+  }
+
+  var toc = document.getElementById(&quot;toc&quot;);
+  var entries = tocEntries(document.getElementById(&quot;content&quot;), toclevels);
+  for (var i = 0; i &lt; entries.length; ++i) {
+    var entry = entries[i];
+    if (entry.element.id == &quot;&quot;)
+      entry.element.id = &quot;_toc_&quot; + i;
+    var a = document.createElement(&quot;a&quot;);
+    a.href = &quot;#&quot; + entry.element.id;
+    a.appendChild(document.createTextNode(entry.text));
+    var div = document.createElement(&quot;div&quot;);
+    div.appendChild(a);
+    div.className = &quot;toclevel&quot; + entry.toclevel;
+    toc.appendChild(div);
+  }
+  if (entries.length == 0)
+    toc.parentNode.removeChild(toc);
+},
+
+
+/////////////////////////////////////////////////////////////////////
+// Footnotes generator
+/////////////////////////////////////////////////////////////////////
+
+/* Based on footnote generation code from:
+ * <A HREF="http://www.brandspankingnew.net/archive/2005/07/format_footnote.html">http://www.brandspankingnew.net/archive/2005/07/format_footnote.html</A>
+ */
+
+footnotes: function () {
+  var cont = document.getElementById(&quot;content&quot;);
+  var noteholder = document.getElementById(&quot;footnotes&quot;);
+  var spans = cont.getElementsByTagName(&quot;span&quot;);
+  var refs = {};
+  var n = 0;
+  for (i=0; i&lt;spans.length; i++) {
+    if (spans[i].className == &quot;footnote&quot;) {
+      n++;
+      // Use [\s\S] in place of . so multi-line matches work.
+      // Because JavaScript has no s (dotall) regex flag.
+      note = spans[i].innerHTML.match(/\s*\[([\s\S]*)]\s*/)[1];
+      noteholder.innerHTML +=
+        &quot;&lt;div class='footnote' id='_footnote_&quot; + n + &quot;'&gt;&quot; +
+        &quot;&lt;a href='#_footnoteref_&quot; + n + &quot;' title='Return to text'&gt;&quot; +
+        n + &quot;&lt;/a&gt;. &quot; + note + &quot;&lt;/div&gt;&quot;;
+      spans[i].innerHTML =
+        &quot;[&lt;a id='_footnoteref_&quot; + n + &quot;' href='#_footnote_&quot; + n +
+        &quot;' title='View footnote' class='footnote'&gt;&quot; + n + &quot;&lt;/a&gt;]&quot;;
+      var id =spans[i].getAttribute(&quot;id&quot;);
+      if (id != null) refs[&quot;#&quot;+id] = n;
+    }
+  }
+  if (n == 0)
+    noteholder.parentNode.removeChild(noteholder);
+  else {
+    // Process footnoterefs.
+    for (i=0; i&lt;spans.length; i++) {
+      if (spans[i].className == &quot;footnoteref&quot;) {
+        var href = spans[i].getElementsByTagName(&quot;a&quot;)[0].getAttribute(&quot;href&quot;);
+        href = href.match(/#.*/)[0];  // Because IE return full URL.
+        n = refs[href];
+        spans[i].innerHTML =
+          &quot;[&lt;a href='#_footnote_&quot; + n +
+          &quot;' title='View footnote' class='footnote'&gt;&quot; + n + &quot;&lt;/a&gt;]&quot;;
+      }
+    }
+  }
+}
+
+}
+/*]]&gt;*/
+&lt;/script&gt;
+&lt;/head&gt;
+&lt;body&gt;
+&lt;div id=&quot;header&quot;&gt;
+&lt;h1&gt;Dstat examples&lt;/h1&gt;
+&lt;/div&gt;
+&lt;div id=&quot;content&quot;&gt;
+&lt;div id=&quot;preamble&quot;&gt;
+&lt;div class=&quot;sectionbody&quot;&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;I&amp;#8217;ve written a few examples that make use of the dstat classes.&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;The following examples currently exist:&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;literalblock&quot;&gt;
+&lt;div class=&quot;content&quot;&gt;
+&lt;pre&gt;&lt;tt&gt;read.py - shows how to access dstat data
+mstat.py - small sub-second ministat tool&lt;/tt&gt;&lt;/pre&gt;
+&lt;/div&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Please send other examples or tools that make use of dstat classes
+or changes to extend the current infrastructure.&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;I&amp;#8217;m not particularly happy with the current interface to dstat,
+so any hints on how to improve it are welcome. Also look at the
+TODO for future changes.&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;admonitionblock&quot;&gt;
+&lt;table&gt;&lt;tr&gt;
+&lt;td class=&quot;icon&quot;&gt;
+&lt;div class=&quot;title&quot;&gt;Note&lt;/div&gt;
+&lt;/td&gt;
+&lt;td class=&quot;content&quot;&gt;Please send me improvements to this document.&lt;/td&gt;
+&lt;/tr&gt;&lt;/table&gt;
+&lt;/div&gt;
+&lt;/div&gt;
+&lt;/div&gt;
+&lt;/div&gt;
+&lt;div id=&quot;footnotes&quot;&gt;&lt;hr /&gt;&lt;/div&gt;
+&lt;div id=&quot;footer&quot;&gt;
+&lt;div id=&quot;footer-text&quot;&gt;
+Last updated 2006-06-16 09:01:03 CEST
+&lt;/div&gt;
+&lt;/div&gt;
+&lt;/body&gt;
+&lt;/html&gt;

Deleted: trunk/tools/dstat/docs/plugins.txt
===================================================================
--- trunk/tools/dstat/docs/plugins.txt	2009-11-21 14:08:12 UTC (rev 8035)
+++ trunk/tools/dstat/docs/plugins.txt	2009-11-24 01:46:30 UTC (rev 8036)
@@ -1,52 +0,0 @@
-External dstat plugins
-======================
-
-The core functionality of dstat is self-contained inside the dstat script,
-but it is possible to add your own dstat plugins. Currently the following
-external plugins exist:
-
-	dstat_app		- most expensive process
-	dstat_battery		- battery in percentage (needs ACPI)
-	dstat_cpufreq		- CPU frequency in percentage (needs ACPI)
-	dstat_dbus		- dbus connections (needs python-dbus)
-	dstat_freespace		- disk usage on per filesystems
-	dstat_gpfs		- GPFS read/write I/O (needs mmpmon)
-	dstat_gpfsop		- GPFS filesystem operations (needs mmpmon)
-	dstat_nfs3		- NFS v3 client operations
-	dstat_nfs3op		- Extended NFS v3 client operations
-	dstat_nfsd3		- NFS v3 server operations
-	dstat_nfsd3op		- Extended NFS v3 server operations
-	dstat_postfix		- postfix queue size (needs postfix)
-	dstat_rpc		- RPC client calls
-	dstat_rpcd		- RPC server calls
-	dstat_sendmail		- sendmail queue size (needs sendmail)
-	dstat_thermal		- system temperature sensors
-	dstat_utmp		- utmp connections (needs python-utmp)
-	dstat_wifi		- wireless link quality and signal to noise ratio
-
-You can enable any of these stats by using the -M options:
-
-----
-dstat -a -M dbus,utmp
-----
-
-Currently I foresee that all stats that depend on something else than
-just the kernel or the stock python modules are implemented as external
-plugins. Also experimental plugins or plugins that are expensive should
-be external.
-
-Future possible external plugins:
-
-	dstat_amavisd
-	dstat_apache
-	dstat_bind
-	dstat_cifs
-	dstat_dhcpd
-	dstat_dnsmasq
-	dstat_gfs
-	dstat_qla2300
-	dstat_samba (needs a python tdb implementation ?)
-	dstat_squid
-
-
-NOTE: Please send me improvements to this document.

Added: trunk/tools/dstat/docs/screen.html
===================================================================
--- trunk/tools/dstat/docs/screen.html	                        (rev 0)
+++ trunk/tools/dstat/docs/screen.html	2009-11-24 01:46:30 UTC (rev 8036)
@@ -0,0 +1,610 @@
+&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.1//EN&quot;
+    &quot;<A HREF="http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd</A>&quot;&gt;
+&lt;html xmlns=&quot;<A HREF="http://www.w3.org/1999/xhtml">http://www.w3.org/1999/xhtml</A>&quot; xml:lang=&quot;en&quot;&gt;
+&lt;head&gt;
+&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;
+&lt;meta name=&quot;generator&quot; content=&quot;AsciiDoc 8.5.1&quot; /&gt;
+&lt;title&gt;Configuring screen to display multiple dstat for different systems&lt;/title&gt;
+&lt;style type=&quot;text/css&quot;&gt;
+/* Debug borders */
+p, li, dt, dd, div, pre, h1, h2, h3, h4, h5, h6 {
+/*
+  border: 1px solid red;
+*/
+}
+
+body {
+  margin: 1em 5% 1em 5%;
+}
+
+a {
+  color: blue;
+  text-decoration: underline;
+}
+a:visited {
+  color: fuchsia;
+}
+
+em {
+  font-style: italic;
+  color: navy;
+}
+
+strong {
+  font-weight: bold;
+  color: #083194;
+}
+
+tt {
+  color: navy;
+}
+
+h1, h2, h3, h4, h5, h6 {
+  color: #527bbd;
+  font-family: sans-serif;
+  margin-top: 1.2em;
+  margin-bottom: 0.5em;
+  line-height: 1.3;
+}
+
+h1, h2, h3 {
+  border-bottom: 2px solid silver;
+}
+h2 {
+  padding-top: 0.5em;
+}
+h3 {
+  float: left;
+}
+h3 + * {
+  clear: left;
+}
+
+div.sectionbody {
+  font-family: serif;
+  margin-left: 0;
+}
+
+hr {
+  border: 1px solid silver;
+}
+
+p {
+  margin-top: 0.5em;
+  margin-bottom: 0.5em;
+}
+
+ul, ol, li &gt; p {
+  margin-top: 0;
+}
+
+pre {
+  padding: 0;
+  margin: 0;
+}
+
+span#author {
+  color: #527bbd;
+  font-family: sans-serif;
+  font-weight: bold;
+  font-size: 1.1em;
+}
+span#email {
+}
+span#revnumber, span#revdate, span#revremark {
+  font-family: sans-serif;
+}
+
+div#footer {
+  font-family: sans-serif;
+  font-size: small;
+  border-top: 2px solid silver;
+  padding-top: 0.5em;
+  margin-top: 4.0em;
+}
+div#footer-text {
+  float: left;
+  padding-bottom: 0.5em;
+}
+div#footer-badges {
+  float: right;
+  padding-bottom: 0.5em;
+}
+
+div#preamble {
+  margin-top: 1.5em;
+  margin-bottom: 1.5em;
+}
+div.tableblock, div.imageblock, div.exampleblock, div.verseblock,
+div.quoteblock, div.literalblock, div.listingblock, div.sidebarblock,
+div.admonitionblock {
+  margin-top: 0.25em;
+  margin-bottom: 1.5em;
+}
+div.admonitionblock {
+  margin-top: 2.5em;
+  margin-bottom: 2.5em;
+}
+
+div.content { /* Block element content. */
+  padding: 0;
+}
+
+/* Block element titles. */
+div.title, caption.title {
+  color: #527bbd;
+  font-family: sans-serif;
+  font-weight: bold;
+  text-align: left;
+  margin-top: 1.0em;
+  margin-bottom: 0.5em;
+}
+div.title + * {
+  margin-top: 0;
+}
+
+td div.title:first-child {
+  margin-top: 0.0em;
+}
+div.content div.title:first-child {
+  margin-top: 0.0em;
+}
+div.content + div.title {
+  margin-top: 0.0em;
+}
+
+div.sidebarblock &gt; div.content {
+  background: #ffffee;
+  border: 1px solid silver;
+  padding: 0.5em;
+}
+
+div.listingblock &gt; div.content {
+  border: 1px solid silver;
+  background: #f4f4f4;
+  padding: 0.5em;
+}
+
+div.quoteblock {
+  padding-left: 2.0em;
+  margin-right: 10%;
+}
+div.quoteblock &gt; div.attribution {
+  padding-top: 0.5em;
+  text-align: right;
+}
+
+div.verseblock {
+  padding-left: 2.0em;
+  margin-right: 10%;
+}
+div.verseblock &gt; div.content {
+  white-space: pre;
+}
+div.verseblock &gt; div.attribution {
+  padding-top: 0.75em;
+  text-align: left;
+}
+/* DEPRECATED: Pre version 8.2.7 verse style literal block. */
+div.verseblock + div.attribution {
+  text-align: left;
+}
+
+div.admonitionblock .icon {
+  vertical-align: top;
+  font-size: 1.1em;
+  font-weight: bold;
+  text-decoration: underline;
+  color: #527bbd;
+  padding-right: 0.5em;
+}
+div.admonitionblock td.content {
+  padding-left: 0.5em;
+  border-left: 2px solid silver;
+}
+
+div.exampleblock &gt; div.content {
+  border-left: 2px solid silver;
+  padding: 0.5em;
+}
+
+div.imageblock div.content { padding-left: 0; }
+span.image img { border-style: none; }
+a.image:visited { color: white; }
+
+dl {
+  margin-top: 0.8em;
+  margin-bottom: 0.8em;
+}
+dt {
+  margin-top: 0.5em;
+  margin-bottom: 0;
+  font-style: normal;
+  color: navy;
+}
+dd &gt; *:first-child {
+  margin-top: 0.1em;
+}
+
+ul, ol {
+    list-style-position: outside;
+}
+ol.arabic {
+  list-style-type: decimal;
+}
+ol.loweralpha {
+  list-style-type: lower-alpha;
+}
+ol.upperalpha {
+  list-style-type: upper-alpha;
+}
+ol.lowerroman {
+  list-style-type: lower-roman;
+}
+ol.upperroman {
+  list-style-type: upper-roman;
+}
+
+div.compact ul, div.compact ol,
+div.compact p, div.compact p,
+div.compact div, div.compact div {
+  margin-top: 0.1em;
+  margin-bottom: 0.1em;
+}
+
+div.tableblock &gt; table {
+  border: 3px solid #527bbd;
+}
+thead {
+  font-family: sans-serif;
+  font-weight: bold;
+}
+tfoot {
+  font-weight: bold;
+}
+td &gt; div.verse {
+  white-space: pre;
+}
+p.table {
+  margin-top: 0;
+}
+/* Because the table frame attribute is overriden by CSS in most browsers. */
+div.tableblock &gt; table[frame=&quot;void&quot;] {
+  border-style: none;
+}
+div.tableblock &gt; table[frame=&quot;hsides&quot;] {
+  border-left-style: none;
+  border-right-style: none;
+}
+div.tableblock &gt; table[frame=&quot;vsides&quot;] {
+  border-top-style: none;
+  border-bottom-style: none;
+}
+
+
+div.hdlist {
+  margin-top: 0.8em;
+  margin-bottom: 0.8em;
+}
+div.hdlist tr {
+  padding-bottom: 15px;
+}
+dt.hdlist1.strong, td.hdlist1.strong {
+  font-weight: bold;
+}
+td.hdlist1 {
+  vertical-align: top;
+  font-style: normal;
+  padding-right: 0.8em;
+  color: navy;
+}
+td.hdlist2 {
+  vertical-align: top;
+}
+div.hdlist.compact tr {
+  margin: 0;
+  padding-bottom: 0;
+}
+
+.comment {
+  background: yellow;
+}
+
+.footnote, .footnoteref {
+  font-size: 0.8em;
+}
+
+span.footnote, span.footnoteref {
+  vertical-align: super;
+}
+
+#footnotes {
+  margin: 20px 0 20px 0;
+  padding: 7px 0 0 0;
+}
+
+#footnotes div.footnote {
+  margin: 0 0 5px 0;
+}
+
+#footnotes hr {
+  border: none;
+  border-top: 1px solid silver;
+  height: 1px;
+  text-align: left;
+  margin-left: 0;
+  width: 20%;
+  min-width: 100px;
+}
+
+
<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">+ at media</A> print {
+  div#footer-badges { display: none; }
+}
+
+div#toctitle {
+  color: #527bbd;
+  font-family: sans-serif;
+  font-size: 1.1em;
+  font-weight: bold;
+  margin-top: 1.0em;
+  margin-bottom: 0.1em;
+}
+
+div.toclevel1, div.toclevel2, div.toclevel3, div.toclevel4 {
+  margin-top: 0;
+  margin-bottom: 0;
+}
+div.toclevel2 {
+  margin-left: 2em;
+  font-size: 0.9em;
+}
+div.toclevel3 {
+  margin-left: 4em;
+  font-size: 0.9em;
+}
+div.toclevel4 {
+  margin-left: 6em;
+  font-size: 0.9em;
+}
+/* Workarounds for IE6's broken and incomplete CSS2. */
+
+div.sidebar-content {
+  background: #ffffee;
+  border: 1px solid silver;
+  padding: 0.5em;
+}
+div.sidebar-title, div.image-title {
+  color: #527bbd;
+  font-family: sans-serif;
+  font-weight: bold;
+  margin-top: 0.0em;
+  margin-bottom: 0.5em;
+}
+
+div.listingblock div.content {
+  border: 1px solid silver;
+  background: #f4f4f4;
+  padding: 0.5em;
+}
+
+div.quoteblock-attribution {
+  padding-top: 0.5em;
+  text-align: right;
+}
+
+div.verseblock-content {
+  white-space: pre;
+}
+div.verseblock-attribution {
+  padding-top: 0.75em;
+  text-align: left;
+}
+
+div.exampleblock-content {
+  border-left: 2px solid silver;
+  padding-left: 0.5em;
+}
+
+/* IE6 sets dynamically generated links as visited. */
+div#toc a:visited { color: blue; }
+&lt;/style&gt;
+&lt;script type=&quot;text/javascript&quot;&gt;
+/*&lt;![CDATA[*/
+window.onload = function(){asciidoc.footnotes();}
+var asciidoc = {  // Namespace.
+
+/////////////////////////////////////////////////////////////////////
+// Table Of Contents generator
+/////////////////////////////////////////////////////////////////////
+
+/* Author: Mihai Bazon, September 2002
+ * <A HREF="http://students.infoiasi.ro/~mishoo">http://students.infoiasi.ro/~mishoo</A>
+ *
+ * Table Of Content generator
+ * Version: 0.4
+ *
+ * Feel free to use this script under the terms of the GNU General Public
+ * License, as long as you do not remove or alter this notice.
+ */
+
+ /* modified by Troy D. Hanson, September 2006. License: GPL */
+ /* modified by Stuart Rackham, 2006, 2009. License: GPL */
+
+// toclevels = 1..4.
+toc: function (toclevels) {
+
+  function getText(el) {
+    var text = &quot;&quot;;
+    for (var i = el.firstChild; i != null; i = i.nextSibling) {
+      if (i.nodeType == 3 /* Node.TEXT_NODE */) // IE doesn't speak constants.
+        text += i.data;
+      else if (i.firstChild != null)
+        text += getText(i);
+    }
+    return text;
+  }
+
+  function TocEntry(el, text, toclevel) {
+    this.element = el;
+    this.text = text;
+    this.toclevel = toclevel;
+  }
+
+  function tocEntries(el, toclevels) {
+    var result = new Array;
+    var re = new RegExp('[hH]([2-'+(toclevels+1)+'])');
+    // Function that scans the DOM tree for header elements (the DOM2
+    // nodeIterator API would be a better technique but not supported by all
+    // browsers).
+    var iterate = function (el) {
+      for (var i = el.firstChild; i != null; i = i.nextSibling) {
+        if (i.nodeType == 1 /* Node.ELEMENT_NODE */) {
+          var mo = re.exec(i.tagName);
+          if (mo)
+            result[result.length] = new TocEntry(i, getText(i), mo[1]-1);
+          iterate(i);
+        }
+      }
+    }
+    iterate(el);
+    return result;
+  }
+
+  var toc = document.getElementById(&quot;toc&quot;);
+  var entries = tocEntries(document.getElementById(&quot;content&quot;), toclevels);
+  for (var i = 0; i &lt; entries.length; ++i) {
+    var entry = entries[i];
+    if (entry.element.id == &quot;&quot;)
+      entry.element.id = &quot;_toc_&quot; + i;
+    var a = document.createElement(&quot;a&quot;);
+    a.href = &quot;#&quot; + entry.element.id;
+    a.appendChild(document.createTextNode(entry.text));
+    var div = document.createElement(&quot;div&quot;);
+    div.appendChild(a);
+    div.className = &quot;toclevel&quot; + entry.toclevel;
+    toc.appendChild(div);
+  }
+  if (entries.length == 0)
+    toc.parentNode.removeChild(toc);
+},
+
+
+/////////////////////////////////////////////////////////////////////
+// Footnotes generator
+/////////////////////////////////////////////////////////////////////
+
+/* Based on footnote generation code from:
+ * <A HREF="http://www.brandspankingnew.net/archive/2005/07/format_footnote.html">http://www.brandspankingnew.net/archive/2005/07/format_footnote.html</A>
+ */
+
+footnotes: function () {
+  var cont = document.getElementById(&quot;content&quot;);
+  var noteholder = document.getElementById(&quot;footnotes&quot;);
+  var spans = cont.getElementsByTagName(&quot;span&quot;);
+  var refs = {};
+  var n = 0;
+  for (i=0; i&lt;spans.length; i++) {
+    if (spans[i].className == &quot;footnote&quot;) {
+      n++;
+      // Use [\s\S] in place of . so multi-line matches work.
+      // Because JavaScript has no s (dotall) regex flag.
+      note = spans[i].innerHTML.match(/\s*\[([\s\S]*)]\s*/)[1];
+      noteholder.innerHTML +=
+        &quot;&lt;div class='footnote' id='_footnote_&quot; + n + &quot;'&gt;&quot; +
+        &quot;&lt;a href='#_footnoteref_&quot; + n + &quot;' title='Return to text'&gt;&quot; +
+        n + &quot;&lt;/a&gt;. &quot; + note + &quot;&lt;/div&gt;&quot;;
+      spans[i].innerHTML =
+        &quot;[&lt;a id='_footnoteref_&quot; + n + &quot;' href='#_footnote_&quot; + n +
+        &quot;' title='View footnote' class='footnote'&gt;&quot; + n + &quot;&lt;/a&gt;]&quot;;
+      var id =spans[i].getAttribute(&quot;id&quot;);
+      if (id != null) refs[&quot;#&quot;+id] = n;
+    }
+  }
+  if (n == 0)
+    noteholder.parentNode.removeChild(noteholder);
+  else {
+    // Process footnoterefs.
+    for (i=0; i&lt;spans.length; i++) {
+      if (spans[i].className == &quot;footnoteref&quot;) {
+        var href = spans[i].getElementsByTagName(&quot;a&quot;)[0].getAttribute(&quot;href&quot;);
+        href = href.match(/#.*/)[0];  // Because IE return full URL.
+        n = refs[href];
+        spans[i].innerHTML =
+          &quot;[&lt;a href='#_footnote_&quot; + n +
+          &quot;' title='View footnote' class='footnote'&gt;&quot; + n + &quot;&lt;/a&gt;]&quot;;
+      }
+    }
+  }
+}
+
+}
+/*]]&gt;*/
+&lt;/script&gt;
+&lt;/head&gt;
+&lt;body&gt;
+&lt;div id=&quot;header&quot;&gt;
+&lt;h1&gt;Configuring screen to display multiple dstat for different systems&lt;/h1&gt;
+&lt;/div&gt;
+&lt;div id=&quot;content&quot;&gt;
+&lt;div id=&quot;preamble&quot;&gt;
+&lt;div class=&quot;sectionbody&quot;&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Here is an example of how I monitor 5 nodes in a cluster with a minimum
+of effort using screen:&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Put the following content in a file called screenrc-5nodes:&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;listingblock&quot;&gt;
+&lt;div class=&quot;content&quot;&gt;
+&lt;pre&gt;&lt;tt&gt;startup_message off
+defwrap off
+split
+split
+split
+split
+screen -t node01 1 ssh -t 172.17.0.211 'dstat -cdnyp --tcp --udp -l -D lores,hires -N bond0,eth0,eth2,eth3 10'
+focus down
+screen -t node02 2 ssh -t 172.17.0.212 'dstat -cdnyp --tcp --udp -l -D lores,hires -N bond0,eth0,eth2,eth3 10'
+focus down
+screen -t node03 3 ssh -t 172.17.0.213 'dstat -cdnyp --tcp --udp -l -D lores,hires -N bond0,eth0,eth2,eth3 10'
+focus down
+screen -t node04 4 ssh -t 172.17.0.214 'dstat -cdnyp --tcp --udp -l -D lores,hires -N bond0,eth0,eth2,eth3 10'
+focus down
+screen -t node05 5 ssh -t 172.17.0.215 'dstat -cdnyp --tcp --udp -l -D lores,hires -N bond0,eth0,eth2,eth3 10'&lt;/tt&gt;&lt;/pre&gt;
+&lt;/div&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Then set the environment variable to tell screen to use this config-file
+for the next screen.&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;listingblock&quot;&gt;
+&lt;div class=&quot;content&quot;&gt;
+&lt;pre&gt;&lt;tt&gt;SCREENRC='screenrc-5nodes' screen&lt;/tt&gt;&lt;/pre&gt;
+&lt;/div&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;If you want to get out of this screen and end all dstats, the easiest way
+is to kill first all regions and then end each dstat. You can do this by:&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;listingblock&quot;&gt;
+&lt;div class=&quot;content&quot;&gt;
+&lt;pre&gt;&lt;tt&gt;ctrl-a X&lt;/tt&gt;&lt;/pre&gt;
+&lt;/div&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;Do that 5 times, and then quit each dstat by pressing:&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;listingblock&quot;&gt;
+&lt;div class=&quot;content&quot;&gt;
+&lt;pre&gt;&lt;tt&gt;ctrl-c&lt;/tt&gt;&lt;/pre&gt;
+&lt;/div&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;5 times.&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;paragraph&quot;&gt;&lt;p&gt;If you have other tips or hints, please send them to: &amp;lt;&lt;a href=&quot;mailto:<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>&quot;&gt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>&lt;/a&gt;&amp;gt;&lt;/p&gt;&lt;/div&gt;
+&lt;div class=&quot;admonitionblock&quot;&gt;
+&lt;table&gt;&lt;tr&gt;
+&lt;td class=&quot;icon&quot;&gt;
+&lt;div class=&quot;title&quot;&gt;Note&lt;/div&gt;
+&lt;/td&gt;
+&lt;td class=&quot;content&quot;&gt;Please send me improvements to this document.&lt;/td&gt;
+&lt;/tr&gt;&lt;/table&gt;
+&lt;/div&gt;
+&lt;/div&gt;
+&lt;/div&gt;
+&lt;/div&gt;
+&lt;div id=&quot;footnotes&quot;&gt;&lt;hr /&gt;&lt;/div&gt;
+&lt;div id=&quot;footer&quot;&gt;
+&lt;div id=&quot;footer-text&quot;&gt;
+Last updated 2006-12-12 16:39:55 CEST
+&lt;/div&gt;
+&lt;/div&gt;
+&lt;/body&gt;
+&lt;/html&gt;

Modified: trunk/tools/dstat/dstat
===================================================================
--- trunk/tools/dstat/dstat	2009-11-21 14:08:12 UTC (rev 8035)
+++ trunk/tools/dstat/dstat	2009-11-24 01:46:30 UTC (rev 8036)
@@ -37,7 +37,7 @@
     pass
 
 if sys.version_info &lt; (2, 2):
-    sys.exit('error: Python 2.2 or later required, try dstat15 instead')
+    sys.exit('error: Python 2.2 or later required')
 
 ### Workaround for python &lt;= 2.2.1
 try:
@@ -93,11 +93,11 @@
         self.output = False
         self.pidfile = False
 
-        ### List of available modules
-        self.modules = listmodules()
+        ### List of available plugins
+        allplugins = listplugins()
 
-        ### List of modules to show
-        self.modlist = []
+        ### List of plugins to show
+        self.plugins = []
 
         ### Implicit if no terminal is used
         if not sys.stdout.isatty():
@@ -115,60 +115,61 @@
         try:
             import getopt
             opts, args = getopt.getopt(args, 'acdfghilmno:prstTvyC:D:I:M:N:S:V',
-                ['all', 'bw', 'blackonwhite', 'debug', 'filesystem', 'float',
-                 'full', 'gonuts', 'help', 'integer', 'list', 'mods', 'modules',
-                 'nocolor', 'noheaders', 'noupdate', 'output=', 'pidfile=',
-                 'version', 'vmstat'] + self.modules)
+                ['all', 'all-plugins', 'bw', 'blackonwhite', 'debug',
+                 'filesystem', 'float', 'full', 'gonuts', 'help', 'integer',
+                 'list', 'mods', 'modules', 'nocolor', 'noheaders', 'noupdate',
+                 'output=', 'pidfile=', 'version', 'vmstat'] + allplugins)
         except getopt.error, exc:
             print 'dstat: %s, try dstat -h for a list of all the options' % str(exc)
             sys.exit(1)
 
         for opt, arg in opts:
             if opt in ['-c']:
-                self.modlist.append('cpu')
+                self.plugins.append('cpu')
             elif opt in ['-C']:
                 self.cpulist = arg.split(',')
             elif opt in ['-d']:
-                self.modlist.append('disk')
+                self.plugins.append('disk')
             elif opt in ['-D']:
                 self.disklist = arg.split(',')
             elif opt in ['--filesystem']:
-                self.modlist.append('fs')
+                self.plugins.append('fs')
             elif opt in ['-g']:
-                self.modlist.append('page')
+                self.plugins.append('page')
             elif opt in ['-i']:
-                self.modlist.append('int')
+                self.plugins.append('int')
             elif opt in ['-I']:
                 self.intlist = arg.split(',')
             elif opt in ['-l']:
-                self.modlist.append('load')
+                self.plugins.append('load')
             elif opt in ['-m']:
-                self.modlist.append('mem')
+                self.plugins.append('mem')
             elif opt in ['-M', '--mods', '--modules']:
-                self.modlist = self.modlist + arg.split(',')
+                print &gt;&gt;sys.stderr, 'WARNING: Option %s is deprecated, please use --%s instead' % (opt, ' --'.join(arg.split(',')))
+                self.plugins += arg.split(',')
             elif opt in ['-n']:
-                self.modlist.append('net')
+                self.plugins.append('net')
             elif opt in ['-N']:
                 self.netlist = arg.split(',')
             elif opt in ['-p']:
-                self.modlist.append('proc')
+                self.plugins.append('proc')
             elif opt in ['-r']:
-                self.modlist.append('io')
+                self.plugins.append('io')
             elif opt in ['-s']:
-                self.modlist.append('swap')
+                self.plugins.append('swap')
             elif opt in ['-S']:
                 self.swaplist = arg.split(',')
             elif opt in ['-t']:
-                self.modlist.append('time')
+                self.plugins.append('time')
             elif opt in ['-T']:
-                self.modlist.append('epoch')
+                self.plugins.append('epoch')
             elif opt in ['-y']:
-                self.modlist.append('sys')
+                self.plugins.append('sys')
 
             elif opt in ['-a', '--all']:
-                self.modlist = self.modlist + [ 'cpu', 'disk', 'net', 'page', 'sys' ]
+                self.plugins += [ 'cpu', 'disk', 'net', 'page', 'sys' ]
             elif opt in ['-v', '--vmstat']:
-                self.modlist = self.modlist + [ 'proc', 'mem', 'page', 'disk', 'sys', 'cpu' ]
+                self.plugins += [ 'proc', 'mem', 'page', 'disk', 'sys', 'cpu' ]
             elif opt in ['-f', '--full']:
                 self.full = True
 
@@ -176,15 +177,17 @@
                 self.blackonwhite = True
             elif opt in ['--debug']:
                 self.debug = self.debug + 1
-            elif opt in ['--gonuts']:
+            elif opt in ['--all-plugins']:
                 ### Make list unique in a fancy fast way
-                self.modlist = {}.fromkeys(self.modules).keys()
+                plugins = {}.fromkeys(allplugins).keys()
+                plugins.sort()
+                self.plugins += plugins
             elif opt in ['--float']:
                 self.float = True
             elif opt in ['--integer']:
                 self.integer = True
             elif opt in ['--list']:
-                showmodules()
+                showplugins()
                 sys.exit(0)
             elif opt in ['--nocolor']:
                 self.color = False
@@ -205,7 +208,7 @@
                 self.version()
                 sys.exit(0)
             elif opt.startswith('--'):
-                self.modlist.append(opt[2:])
+                self.plugins.append(opt[2:])
             else:
                 print 'dstat: option %s unknown to getopt, try dstat -h for a list of all the options' % opt
                 sys.exit(1)
@@ -214,8 +217,8 @@
             print 'dstat: option --float and --integer are mutual exlusive, you can only force one'
             sys.exit(1)
 
-        if not self.modlist:
-            self.modlist = [ 'cpu', 'disk', 'net', 'page', 'sys' ]
+        if not self.plugins:
+            self.plugins = [ 'cpu', 'disk', 'net', 'page', 'sys' ]
 
         try:
             if len(args) &gt; 0: self.delay = int(args[0])
@@ -252,7 +255,7 @@
 
         global op
         op = self
-        showmodules()
+        showplugins()
 
     def usage(self):
         print 'Usage: dstat [-afv] [options..] [delay [count]]'
@@ -281,7 +284,7 @@
   -y, --sys              enable system stats
 
   --aio                  enable aio stats
-  --fs                   enable fs stats
+  --fs, --filesystem     enable fs stats
   --ipc                  enable ipc stats
   --lock                 enable lock stats
   --raw                  enable raw stats
@@ -291,13 +294,11 @@
   --unix                 enable unix stats
   --vm                   enable vm stats
 
-  -M stat1,stat2         enable external plugins
-     --mods stat1,stat2
+  --plugin-name          enable plugins by plugin name (see manual)
+  --list                 list all available plugins
 
-  --list                 list all internal and external plugins
-
   -a, --all              equals -cdngy (default)
-  -f, --full             expand -C, -D, -I, -N and -S discovery lists
+  -f, --full             automatically expand -C, -D, -I, -N and -S lists
   -v, --vmstat           equals -pmgdsc -D total
 
   --bw, --blackonwhite   change colors for white background terminal
@@ -308,9 +309,8 @@
   --noupdate             disable intermediate updates
   --output file          write CSV output to file
 
-  delay is the delay in seconds between each update
-  count is the number of updates to display before exiting
-  The default delay is 1 and count is unspecified (unlimited)
+delay is the delay in seconds between each update (default: 1)
+count is the number of updates to display before exiting (default: unlimited)
 '''
 
 ### START STATS DEFINITIONS ###
@@ -870,8 +870,7 @@
         if op.debug:
             self.width = 13
         self.scale = 0
-        self.nick = ('epoch',)
-        self.vars = self.nick
+        self.vars = ('epoch',)
 
     ### We are now using the starttime instead of the execution time of this plugin
     def extract(self):
@@ -884,8 +883,7 @@
         self.type = 'd'
         self.width = 6
         self.scale = 1000
-        self.nick = ('files', 'inodes')
-        self.vars = self.nick
+        self.vars = ('files', 'inodes')
 
     def extract(self):
         for line in dopen('/proc/sys/fs/file-nr'):
@@ -1109,7 +1107,6 @@
         self.width = 3
         self.scale = 10
         self.vars = ('msg', 'sem', 'shm')
-        self.nick = self.vars
 
     def extract(self):
         for name in self.vars:
@@ -2064,52 +2061,52 @@
     sys.stdout.write(ansi['reset'])
     sys.exit(ret)
 
-def listmodules():
-    modules = []
+def listplugins():
+    plugins = []
     remod = re.compile('dstat_(.+)$')
     for filename in globals():
         if filename.startswith('dstat_'):
-            modules.append(remod.match(filename).groups()[0])
+            plugins.append(remod.match(filename).groups()[0])
     remod = re.compile('.+/dstat_(.+).py$')
     for path in sys.path:
         for filename in glob.glob(path + '/dstat_*.py'):
-            modules.append(remod.match(filename).groups()[0])
-    modules.sort()
-    return modules
+            plugins.append(remod.match(filename).groups()[0].replace('_', '-'))
+    plugins.sort()
+    return plugins
 
-def showmodules():
+def showplugins():
     rows, cols = gettermsize()
     print 'internal:\n\t',
     remod = re.compile('dstat_(.+)$')
-    modlist = []
+    plugins = []
     for filename in globals():
         if filename.startswith('dstat_'):
-            modlist.append(remod.match(filename).groups()[0])
-    modlist.sort()
+            plugins.append(remod.match(filename).groups()[0].replace('_', '-'))
+    plugins.sort()
     cols2 = cols - 8
-    for mod in modlist:
+    for mod in plugins:
         cols2 = cols2 - len(mod) - 2
         if cols2 &lt;= 0:
             print '\n\t',
             cols2 = cols - len(mod) - 10
-        if mod != modlist[-1]:
+        if mod != plugins[-1]:
             print mod+',',
     print mod
     remod = re.compile('.+/dstat_(.+).py$')
     for path in sys.path:
-        modlist = []
+        plugins = []
         for filename in glob.glob(path + '/dstat_*.py'):
-            modlist.append(remod.match(filename).groups()[0])
-        if not modlist: continue
-        modlist.sort()
+            plugins.append(remod.match(filename).groups()[0].replace('_', '-'))
+        if not plugins: continue
+        plugins.sort()
         cols2 = cols - 8
         print '%s:\n\t' % os.path.abspath(path),
-        for mod in modlist:
+        for mod in plugins:
             cols2 = cols2 - len(mod) - 2
             if cols2 &lt;= 0:
                 print '\n\t',
                 cols2 = cols - len(mod) - 10
-            if mod != modlist[-1]:
+            if mod != plugins[-1]:
                 print mod+',',
         print mod
 
@@ -2188,51 +2185,52 @@
     if not op.update:
         interval = op.delay
 
-    ### Build list of requested modules
+    ### Build list of requested plugins
     linewidth = 0
     totlist = []
-    for module in op.modlist:
-        if module in ('list', 'help'):
-            showmodules()
+    for plugin in op.plugins:
+        if plugin in ('list', 'help'):
+            showplugins()
             exit(0)
-        elif module == 'cpu':  mods = ( 'cpu', 'cpu24' )
-        elif module == 'disk': mods = ( 'disk', 'disk24', 'disk24old' )
-        elif module == 'int':  mods = ( 'int', 'int24' )
-        elif module == 'page': mods = ( 'page', 'page24' )
-        elif module == 'swap': mods = ( 'swap', 'swapold' )
-        else: mods = ( module, )
+        elif plugin == 'cpu':  mods = ( 'cpu', 'cpu24' )
+        elif plugin == 'disk': mods = ( 'disk', 'disk24', 'disk24old' )
+        elif plugin == 'int':  mods = ( 'int', 'int24' )
+        elif plugin == 'page': mods = ( 'page', 'page24' )
+        elif plugin == 'swap': mods = ( 'swap', 'swapold' )
+        else: mods = ( plugin, )
 
         for mod in mods:
+            pluginfile = 'dstat_' + mod.replace('-', '_')
             try:
-                if 'dstat_'+mod not in globals().keys():
+                if pluginfile not in globals().keys():
                     import imp
-                    filename, pathname, description = imp.find_module('dstat_'+mod)
+                    filename, pathname, description = imp.find_module(pluginfile)
 
                     ### TODO: Would using .pyc help with anything ?
                     ### Try loading python plugin
                     if description[0] in ('.py'):
-                            execfile(pathname)
-                            exec 'o = dstat_%s(); o.check(); o.prepare();' % mod
+                        execfile(pathname)
+                        exec 'o = dstat_plugin(); o.filename = &quot;%s&quot;; o.check(); o.prepare(); del(dstat_plugin);' % pluginfile
 
                     ### Try loading C plugin
                     elif description[0] == '.so':
-                        exec 'import dstat_%s' % mod
-                        exec 'o = dstat_%s.new(); o.check(); o.prepare();' % mod
-#                        exec 'o = dstat_%s.init(dstat)' % mod
+                        exec 'import %s' % pluginfile
+                        exec 'o = %s.new(); o.check(); o.prepare();' % pluginfile
+#                        exec 'o = %s.init(dstat)' % pluginfile
 #                        print dir(o)
 #                        print o.__module__
 #                        print o.name
                     else:
-                        print &gt;&gt;sys.stderr, 'Module %s is of unknown type.' % mod
+                        print &gt;&gt;sys.stderr, 'Module %s is of unknown type.' % pluginfile
 
                 else:
-                    exec 'o = dstat_%s(); o.check(); o.prepare();' % mod
+                    exec 'o = %s(); o.check(); o.prepare();' % pluginfile
 #                print o.__module__
             except Exception, e:
                 if mod == mods[-1]:
-                    print &gt;&gt;sys.stderr, 'Module %s failed to load. (%s)' % (mod, e)
+                    print &gt;&gt;sys.stderr, 'Module %s failed to load. (%s)' % (pluginfile, e)
                 elif op.debug:
-                    print &gt;&gt;sys.stderr, 'Module %s failed to load, trying another. (%s)' % (mod, e)
+                    print &gt;&gt;sys.stderr, 'Module %s failed to load, trying another. (%s)' % (pluginfile, e)
                 if op.debug &gt;= 3:
                     raise
 #                tb = sys.exc_info()[2]
@@ -2247,8 +2245,13 @@
 
     if op.debug:
         for o in totlist:
-            print 'Module', str(o.__class__).split('.')[1],
-            if hasattr(o, 'file'): print 'requires', o.file,
+            print 'Module',
+            if hasattr(o, 'filename'):
+                print o.filename,
+            else:
+                print str(o.__class__).split('.')[1],
+            if hasattr(o, 'file'):
+                print 'requires', o.file,
             print
 
     if op.output:

Modified: trunk/tools/dstat/dstat.spec
===================================================================
--- trunk/tools/dstat/dstat.spec	2009-11-21 14:08:12 UTC (rev 8035)
+++ trunk/tools/dstat/dstat.spec	2009-11-24 01:46:30 UTC (rev 8036)
@@ -2,11 +2,6 @@
 # Authority: dag
 # Upstream: Dag Wieers &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>&gt;
 
-%{?dist: %{expand: %%define %dist 1}}
-
-%{?rh7:%define _with_python15 1}
-%{?el2:%define _with_python15 1}
-
 Summary: Versatile resource statistics tool
 Name: dstat
 Version: 0.7.0
@@ -46,8 +41,6 @@
 %{__rm} -rf %{buildroot}
 %{__make} install DESTDIR=&quot;%{buildroot}&quot;
 
-%{?_with_python15:%{__install} -D -m0755 dstat15 %{buildroot}%{_bindir}/dstat}
-
 %clean
 %{__rm} -rf %{buildroot}
 
@@ -59,15 +52,12 @@
 %{_datadir}/dstat/
 
 %changelog
-* Mon Dec 15 2008 Dag Wieers &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>&gt; - 0.6.9svn-1
-- Updated to release 0.6.9svn.
+* Wed Nov 25 2009 Dag Wieers &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>&gt; - 0.7.0-1
+- Updated to release 0.7.0.
 
 * Tue Dec 02 2008 Dag Wieers &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>&gt; - 0.6.9-1
 - Updated to release 0.6.9.
 
-* Sun Aug 17 2008 Dag Wieers &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>&gt; - 0.6.8svn-1
-- Updated to release 0.6.8svn.
-
 * Sun Aug 17 2008 Dag Wieers &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>&gt; - 0.6.8-1
 - Updated to release 0.6.8.
 

Modified: trunk/tools/dstat/plugins/dstat_battery.py
===================================================================
--- trunk/tools/dstat/plugins/dstat_battery.py	2009-11-21 14:08:12 UTC (rev 8035)
+++ trunk/tools/dstat/plugins/dstat_battery.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -3,8 +3,9 @@
 ###
 ### Authority: <A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>
 
-class dstat_battery(dstat):
+class dstat_plugin(dstat):
     def __init__(self):
+        self.file = file
         self.name = 'battery'
         self.type = 'p'
         self.width = 4

Modified: trunk/tools/dstat/plugins/dstat_battery_remain.py
===================================================================
--- trunk/tools/dstat/plugins/dstat_battery_remain.py	2009-11-21 14:08:12 UTC (rev 8035)
+++ trunk/tools/dstat/plugins/dstat_battery_remain.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -1,9 +1,9 @@
 ### Dstat battery plugin
 ### Displays battery information from ACPI
-###
+##
 ### Authority: <A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>
 
-class dstat_battery_remain(dstat):
+class dstat_plugin(dstat):
     def __init__(self):
         self.name = 'remain'
         self.type = 't'

Modified: trunk/tools/dstat/plugins/dstat_cpufreq.py
===================================================================
--- trunk/tools/dstat/plugins/dstat_cpufreq.py	2009-11-21 14:08:12 UTC (rev 8035)
+++ trunk/tools/dstat/plugins/dstat_cpufreq.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -6,7 +6,7 @@
 global glob
 import glob
 
-class dstat_cpufreq(dstat):
+class dstat_plugin(dstat):
     def __init__(self):
         self.name = 'frequency'
         self.type = 'p'

Modified: trunk/tools/dstat/plugins/dstat_dbus.py
===================================================================
--- trunk/tools/dstat/plugins/dstat_dbus.py	2009-11-21 14:08:12 UTC (rev 8035)
+++ trunk/tools/dstat/plugins/dstat_dbus.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -3,7 +3,7 @@
 ###
 ### Authority: <A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>
 
-class dstat_dbus(dstat):
+class dstat_plugin(dstat):
     def __init__(self):
         self.name = 'dbus'
         self.type = 'd'
@@ -12,7 +12,7 @@
         self.nick = ('sys', 'ses')
         self.vars = ('system', 'session')
 
-    def check(self): 
+    def check(self):
 #       dstat.info(1, 'The dbus module is an EXPERIMENTAL module.')
         try:
             global dbus

Copied: trunk/tools/dstat/plugins/dstat_disk_util.py (from rev 8032, trunk/tools/dstat/plugins/dstat_diskutil.py)
===================================================================
--- trunk/tools/dstat/plugins/dstat_disk_util.py	                        (rev 0)
+++ trunk/tools/dstat/plugins/dstat_disk_util.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -0,0 +1,64 @@
+class dstat_plugin(dstat):
+    &quot;&quot;&quot;
+    Percentage of CPU time during which I/O requests were issued to the device
+    (bandwidth utilization for the device). Device saturation occurs when
+    this value is close to 100%.
+    &quot;&quot;&quot;
+
+    def __init__(self):
+        self.type = 'f'
+        self.width = 4
+        self.scale = 34
+        self.diskfilter = re.compile('^(dm-[0-9]+|md[0-9]+|[hs]d[a-z]+[0-9]+)$')
+        self.open('/proc/diskstats')
+        self.nick = ('util', )
+        self.cols = 1
+
+    def discover(self, *objlist):
+        ret = []
+        for l in self.splitlines():
+            if len(l) &lt; 13: continue
+            if l[3:] == ['0',] * 11: continue
+            name = l[2]
+            ret.append(name)
+        for item in objlist: ret.append(item)
+        if not ret: 
+            raise Exception, &quot;No suitable block devices found to monitor&quot;
+        return ret
+
+    def vars(self):
+        ret = []
+        if op.disklist:
+            varlist = op.disklist
+        else:
+            varlist = []
+            blockdevices = [os.path.basename(filename) for filename in glob.glob('/sys/block/*')]
+            for name in self.discover:
+                if self.diskfilter.match(name): continue
+                if name not in blockdevices: continue
+                varlist.append(name)
+#           if len(varlist) &gt; 2: varlist = varlist[0:2]
+            varlist.sort()
+        for name in varlist:
+            if name in self.discover:
+                ret.append(name)
+        return ret
+
+    def name(self):
+        return self.vars
+
+    def extract(self):
+        for name in self.vars: self.set2[name] = (0, )
+        for l in self.splitlines():
+            if len(l) &lt; 13: continue
+            if l[5] == '0' and l[9] == '0': continue
+            name = l[2]
+            if l[3:] == ['0',] * 11: continue
+            if name in self.vars:
+                self.set2[name] = ( self.set2[name][0] + long(l[12]), )
+        for name in self.set2.keys():
+            self.val[name] = (
+                (self.set2[name][0] - self.set1[name][0]) * 1.0 * hz / elapsed / 1000,
+            )
+        if step == op.delay:
+            self.set1.update(self.set2)

Deleted: trunk/tools/dstat/plugins/dstat_diskutil.py
===================================================================
--- trunk/tools/dstat/plugins/dstat_diskutil.py	2009-11-21 14:08:12 UTC (rev 8035)
+++ trunk/tools/dstat/plugins/dstat_diskutil.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -1,64 +0,0 @@
-class dstat_diskutil(dstat):
-    &quot;&quot;&quot;
-    Percentage of CPU time during which I/O requests were issued to the device
-    (bandwidth utilization for the device). Device saturation occurs when
-    this value is close to 100%.
-    &quot;&quot;&quot;
-
-    def __init__(self):
-        self.type = 'f'
-        self.width = 4
-        self.scale = 34
-        self.diskfilter = re.compile('^(dm-[0-9]+|md[0-9]+|[hs]d[a-z]+[0-9]+)$')
-        self.open('/proc/diskstats')
-        self.nick = ('util', )
-        self.cols = 1
-
-    def discover(self, *objlist):
-        ret = []
-        for l in self.splitlines():
-            if len(l) &lt; 13: continue
-            if l[3:] == ['0',] * 11: continue
-            name = l[2]
-            ret.append(name)
-        for item in objlist: ret.append(item)
-        if not ret: 
-            raise Exception, &quot;No suitable block devices found to monitor&quot;
-        return ret
-
-    def vars(self):
-        ret = []
-        if op.disklist:
-            varlist = op.disklist
-        else:
-            varlist = []
-            blockdevices = [os.path.basename(filename) for filename in glob.glob('/sys/block/*')]
-            for name in self.discover:
-                if self.diskfilter.match(name): continue
-                if name not in blockdevices: continue
-                varlist.append(name)
-#           if len(varlist) &gt; 2: varlist = varlist[0:2]
-            varlist.sort()
-        for name in varlist:
-            if name in self.discover:
-                ret.append(name)
-        return ret
-
-    def name(self):
-        return self.vars
-
-    def extract(self):
-        for name in self.vars: self.set2[name] = (0, )
-        for l in self.splitlines():
-            if len(l) &lt; 13: continue
-            if l[5] == '0' and l[9] == '0': continue
-            name = l[2]
-            if l[3:] == ['0',] * 11: continue
-            if name in self.vars:
-                self.set2[name] = ( self.set2[name][0] + long(l[12]), )
-        for name in self.set2.keys():
-            self.val[name] = (
-                (self.set2[name][0] - self.set1[name][0]) * 1.0 * hz / elapsed / 1000,
-            )
-        if step == op.delay:
-            self.set1.update(self.set2)

Modified: trunk/tools/dstat/plugins/dstat_fan.py
===================================================================
--- trunk/tools/dstat/plugins/dstat_fan.py	2009-11-21 14:08:12 UTC (rev 8035)
+++ trunk/tools/dstat/plugins/dstat_fan.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -1,4 +1,4 @@
-class dstat_fan(dstat):
+class dstat_plugin(dstat):
     def __init__(self):
         self.name = 'fan'
         self.type = 'd'

Modified: trunk/tools/dstat/plugins/dstat_freespace.py
===================================================================
--- trunk/tools/dstat/plugins/dstat_freespace.py	2009-11-21 14:08:12 UTC (rev 8035)
+++ trunk/tools/dstat/plugins/dstat_freespace.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -3,7 +3,7 @@
 
 ### FIXME: Apparently needs python 2.0, possibly python 2.2
 
-class dstat_freespace(dstat):
+class dstat_plugin(dstat):
     def __init__(self):
         self.open('/etc/mtab')
         self.nick = ('used', 'free')

Modified: trunk/tools/dstat/plugins/dstat_gpfs.py
===================================================================
--- trunk/tools/dstat/plugins/dstat_gpfs.py	2009-11-21 14:08:12 UTC (rev 8035)
+++ trunk/tools/dstat/plugins/dstat_gpfs.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -1,4 +1,4 @@
-class dstat_gpfs(dstat):
+class dstat_plugin(dstat):
     def __init__(self):
         self.name = 'gpfs i/o'
         self.vars = ('_br_', '_bw_')
@@ -27,11 +27,11 @@
             for name in self.vars:
                 self.val[name] = (self.set2[name] - self.set1[name]) * 1.0 / elapsed
         except IOError, e:
+            if op.debug &gt; 1: print '%s: lost pipe to mmpmon, %s' % (self.filename, e)
             for name in self.vars: self.val[name] = -1
-#           print 'dstat_gpfs: lost pipe to mmpmon,', e
         except Exception, e:
+            if op.debug &gt; 1: print '%s: exception %s' % (self.filename, e)
             for name in self.vars: self.val[name] = -1
-#           print 'dstat_gpfs: exception', e
 
         if step == op.delay:
             self.set1.update(self.set2)

Copied: trunk/tools/dstat/plugins/dstat_gpfs_ops.py (from rev 8032, trunk/tools/dstat/plugins/dstat_gpfsop.py)
===================================================================
--- trunk/tools/dstat/plugins/dstat_gpfs_ops.py	                        (rev 0)
+++ trunk/tools/dstat/plugins/dstat_gpfs_ops.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -0,0 +1,42 @@
+class dstat_plugin(dstat):
+    def __init__(self):
+        self.name = 'gpfs file operations'
+        self.type = 'd'
+        self.width = 5
+        self.scale = 1000
+        self.vars = ('_oc_', '_cc_', '_rdc_', '_wc_', '_dir_', '_iu_')
+        self.nick = ('open', 'clos', 'read', 'writ', 'rdir', 'inod')
+
+    def check(self): 
+        if os.access('/usr/lpp/mmfs/bin/mmpmon', os.X_OK):
+            try:
+                self.stdin, self.stdout, self.stderr = dpopen('/usr/lpp/mmfs/bin/mmpmon -p -s')
+                self.stdin.write('reset\n')
+                readpipe(self.stdout)
+            except IOError:
+                raise Exception, 'Cannot interface with gpfs mmpmon binary'
+            return True
+        raise Exception, 'Needs GPFS mmpmon binary'
+
+    def extract(self):
+        try:
+            self.stdin.write('io_s\n')
+#           readpipe(self.stderr)
+            for line in readpipe(self.stdout):
+                if not line: continue
+                l = line.split()
+                for name in self.vars:
+                    self.set2[name] = long(l[l.index(name)+1])
+            for name in self.vars:
+                self.val[name] = (self.set2[name] - self.set1[name]) * 1.0 / elapsed
+        except IOError, e:
+            for name in self.vars: self.val[name] = -1
+#           print self.filename + ': lost pipe to mmpmon,', e
+        except Exception, e:
+            for name in self.vars: self.val[name] = -1
+#           print 'dstat_gpfs: exception', e
+
+        if step == op.delay:
+            self.set1.update(self.set2)
+
+# vim:ts=4:sw=4:et

Deleted: trunk/tools/dstat/plugins/dstat_gpfsop.py
===================================================================
--- trunk/tools/dstat/plugins/dstat_gpfsop.py	2009-11-21 14:08:12 UTC (rev 8035)
+++ trunk/tools/dstat/plugins/dstat_gpfsop.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -1,42 +0,0 @@
-class dstat_gpfsop(dstat):
-    def __init__(self):
-        self.name = 'gpfs file operations'
-        self.type = 'd'
-        self.width = 5
-        self.scale = 1000
-        self.vars = ('_oc_', '_cc_', '_rdc_', '_wc_', '_dir_', '_iu_')
-        self.nick = ('open', 'clos', 'read', 'writ', 'rdir', 'inod')
-
-    def check(self): 
-        if os.access('/usr/lpp/mmfs/bin/mmpmon', os.X_OK):
-            try:
-                self.stdin, self.stdout, self.stderr = dpopen('/usr/lpp/mmfs/bin/mmpmon -p -s')
-                self.stdin.write('reset\n')
-                readpipe(self.stdout)
-            except IOError:
-                raise Exception, 'Cannot interface with gpfs mmpmon binary'
-            return True
-        raise Exception, 'Needs GPFS mmpmon binary'
-
-    def extract(self):
-        try:
-            self.stdin.write('io_s\n')
-#           readpipe(self.stderr)
-            for line in readpipe(self.stdout):
-                if not line: continue
-                l = line.split()
-                for name in self.vars:
-                    self.set2[name] = long(l[l.index(name)+1])
-            for name in self.vars:
-                self.val[name] = (self.set2[name] - self.set1[name]) * 1.0 / elapsed
-        except IOError, e:
-            for name in self.vars: self.val[name] = -1
-#           print 'dstat_gpfs: lost pipe to mmpmon,', e
-        except Exception, e:
-            for name in self.vars: self.val[name] = -1
-#           print 'dstat_gpfs: exception', e
-
-        if step == op.delay:
-            self.set1.update(self.set2)
-
-# vim:ts=4:sw=4:et

Modified: trunk/tools/dstat/plugins/dstat_helloworld.py
===================================================================
--- trunk/tools/dstat/plugins/dstat_helloworld.py	2009-11-21 14:08:12 UTC (rev 8035)
+++ trunk/tools/dstat/plugins/dstat_helloworld.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -3,7 +3,7 @@
 ###
 ### Authority: <A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>
 
-class dstat_helloworld(dstat):
+class dstat_plugin(dstat):
     def __init__(self):
         self.type = 's'
         self.width = 12

Modified: trunk/tools/dstat/plugins/dstat_innodb_buffer.py
===================================================================
--- trunk/tools/dstat/plugins/dstat_innodb_buffer.py	2009-11-21 14:08:12 UTC (rev 8035)
+++ trunk/tools/dstat/plugins/dstat_innodb_buffer.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -1,7 +1,7 @@
 global mysql_options
 mysql_options = os.getenv('DSTAT_MYSQL')
 
-class dstat_innodb_buffer(dstat):
+class dstat_plugin(dstat):
     def __init__(self):
         self.name = 'innodb pool'
         self.type = 'f'
@@ -36,13 +36,11 @@
                 self.set1.update(self.set2)
 
         except IOError, e:
-            if op.debug:
-                print 'dstat_innodb_buffer: lost pipe to mysql, ' + repr(e)
+            if op.debug &gt; 1: print '%s: lost pipe to mysql, %s' % (self.filename, e)
             for name in self.vars: self.val[name] = -1
 
         except Exception, e:
-            if op.debug:
-                print 'dstat_innodb_buffer: exception: ' + repr(e)
+            if op.debug &gt; 1: print '%s: exception: %s' % (self.filename, e)
             for name in self.vars: self.val[name] = -1
 
 # vim:ts=4:sw=4:et

Modified: trunk/tools/dstat/plugins/dstat_innodb_io.py
===================================================================
--- trunk/tools/dstat/plugins/dstat_innodb_io.py	2009-11-21 14:08:12 UTC (rev 8035)
+++ trunk/tools/dstat/plugins/dstat_innodb_io.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -1,7 +1,7 @@
 global mysql_options
 mysql_options = os.getenv('DSTAT_MYSQL')
 
-class dstat_innodb_io(dstat):
+class dstat_plugin(dstat):
     def __init__(self):
         self.name = 'innodb io ops '
         self.type = 'f'
@@ -37,11 +37,11 @@
                 self.set1.update(self.set2)
 
         except IOError, e:
-            if op.debug: print 'dstat_innodb_buffer: lost pipe to mysql,', e
+            if op.debug &gt; 1: print '%s: lost pipe to mysql, %s' % (self.filename, e)
             for name in self.vars: self.val[name] = -1
 
         except Exception, e:
-            if op.debug: print 'dstat_innodb_buffer: exception', e
+            if op.debug &gt; 1: print '%s: exception' % (self.filename, e)
             for name in self.vars: self.val[name] = -1
 
 # vim:ts=4:sw=4:et

Modified: trunk/tools/dstat/plugins/dstat_innodb_ops.py
===================================================================
--- trunk/tools/dstat/plugins/dstat_innodb_ops.py	2009-11-21 14:08:12 UTC (rev 8035)
+++ trunk/tools/dstat/plugins/dstat_innodb_ops.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -1,7 +1,7 @@
 global mysql_options
 mysql_options = os.getenv('DSTAT_MYSQL')
 
-class dstat_innodb_ops(dstat):
+class dstat_plugin(dstat):
     def __init__(self):
         self.name = 'innodb ops'
         self.type = 'f'
@@ -38,11 +38,11 @@
                 self.set1.update(self.set2)
 
         except IOError, e:
-            if op.debug: print 'dstat_innodb_buffer: lost pipe to mysql,', e
+            if op.debug &gt; 1: print '%s: lost pipe to mysql, %s' % (self.filename, e)
             for name in self.vars: self.val[name] = -1
 
         except Exception, e:
-            if op.debug: print 'dstat_innodb_buffer: exception', e
+            if op.debug &gt; 1: print '%s: exception' % (self.filename, e)
             for name in self.vars: self.val[name] = -1
 
 # vim:ts=4:sw=4:et

Modified: trunk/tools/dstat/plugins/dstat_lustre.py
===================================================================
--- trunk/tools/dstat/plugins/dstat_lustre.py	2009-11-21 14:08:12 UTC (rev 8035)
+++ trunk/tools/dstat/plugins/dstat_lustre.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -1,46 +1,35 @@
+# Authority: Brock Palen &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">brockp at mlds-networks.com</A>&gt;, Kilian Vavalotti &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">kilian at stanford.edu</A>&gt;
+
 global os
 import os
 
-class dstat_lustre(dstat):
+class dstat_plugin(dstat):
     def __init__(self):
         self.nick = ('read', 'write')
-        info(1, 'Module dstat_lustre is still experimental.')
 
-    def name(self):
-        ret = []
-        for mount in os.listdir('/proc/fs/lustre/llite'):
-            ret.append(mount[:mount.rfind('-')])
-        return ret
-
-    def vars(self):
-        ret = []
-        for mount in os.listdir('/proc/fs/lustre/llite'):
-            ret.append(mount)
-        return ret
-
     def check(self):
         if not os.path.exists('/proc/fs/lustre/llite'):
             raise Exception, 'Lustre filesystem not found'
+        info(1, 'Module %s is still experimental.' % self.filename)
 
+    def name(self):
+        return [mount for mount in os.listdir('/proc/fs/lustre/llite')]
+
+    def vars(self):
+        return [mount for mount in os.listdir('/proc/fs/lustre/llite')]
+
     def extract(self):
         for name in self.vars:
-            f = open('/'.join(['/proc/fs/lustre/llite',name,'stats']))
-            lines = f.readlines()
-            for line in lines:
-                l = line.split()
-                if not l or l[0] != 'read_bytes': continue
-                read = long(l[6])
-            for line in lines:
-                l = line.split()
-                if not l or l[0] != 'write_bytes': continue
-                write = long(l[6])
+            for l in open(os.path.join('/proc/fs/lustre/llite', name, 'stats')).splitlines():
+                if len(l) &lt; 6: continue
+                if l[0] == 'read_bytes':
+                    read = long(l[6])
+                elif l[0] == 'write_bytes':
+                    write = long(l[6])
             self.set2[name] = (read, write)
             self.val[name] = ( (self.set2[name][0] - self.set1[name][0]) * 1.0 / elapsed,
                                (self.set2[name][1] - self.set1[name][1]) * 1.0 / elapsed )
-            if step == op.delay:
-                self.set1.update(self.set2)
+        if step == op.delay:
+            self.set1.update(self.set2)
 
 # vim:ts=4:sw=4
-# Authors
-# Brock Palen <A HREF="http://lists.repoforge.org/mailman/listinfo/commits">brockp at mlds-networks.com</A>
-# Kilian Vavalotti <A HREF="http://lists.repoforge.org/mailman/listinfo/commits">kilian at stanford.edu</A>

Modified: trunk/tools/dstat/plugins/dstat_memcache_hits.py
===================================================================
--- trunk/tools/dstat/plugins/dstat_memcache_hits.py	2009-11-21 14:08:12 UTC (rev 8035)
+++ trunk/tools/dstat/plugins/dstat_memcache_hits.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -3,7 +3,7 @@
 ###
 ### Authority: <A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dean.wilson at gmail.com</A>
 
-class dstat_memcache_hits(dstat):
+class dstat_plugin(dstat):
     def __init__(self):
         self.name = 'Memcache Hits'
         self.type = 'd'
@@ -11,14 +11,14 @@
         self.scale = 50
         self.nick = ('Hit', 'Miss')
         self.vars = ('get_hits', 'get_misses')
-        self.mc = memcache.Client(['127.0.0.1:11211'], debug=0)
 
     def check(self):
         try:
             global memcache
             import memcache
+            self.mc = memcache.Client(['127.0.0.1:11211'], debug=0)
         except:
-            raise Exception, 'Plugin needs the memcache module.'
+            raise Exception, 'Plugin needs the memcache module'
 
     def extract(self):
         stats = self.mc.get_stats()

Modified: trunk/tools/dstat/plugins/dstat_mysql5_com.py
===================================================================
--- trunk/tools/dstat/plugins/dstat_mysql5_com.py	2009-11-21 14:08:12 UTC (rev 8035)
+++ trunk/tools/dstat/plugins/dstat_mysql5_com.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -8,7 +8,7 @@
 mysql_user = os.getenv('DSTAT_MYSQL_USER') or os.getenv('USER')
 mysql_pwd = os.getenv('DSTAT_MYSQL_PWD')
 
-class dstat_mysql5_com(dstat):
+class dstat_plugin(dstat):
     def __init__(self):
         self.name = 'mysql5 com'
         self.type = 'i'

Modified: trunk/tools/dstat/plugins/dstat_mysql5_conn.py
===================================================================
--- trunk/tools/dstat/plugins/dstat_mysql5_conn.py	2009-11-21 14:08:12 UTC (rev 8035)
+++ trunk/tools/dstat/plugins/dstat_mysql5_conn.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -8,7 +8,7 @@
 mysql_user = os.getenv('DSTAT_MYSQL_USER') or os.getenv('USER')
 mysql_pwd = os.getenv('DSTAT_MYSQL_PWD')
 
-class dstat_mysql5_conn(dstat):
+class dstat_plugin(dstat):
     def __init__(self):
         self.name = 'mysql5 conn'
         self.type = 'f'

Modified: trunk/tools/dstat/plugins/dstat_mysql5_io.py
===================================================================
--- trunk/tools/dstat/plugins/dstat_mysql5_io.py	2009-11-21 14:08:12 UTC (rev 8035)
+++ trunk/tools/dstat/plugins/dstat_mysql5_io.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -8,7 +8,7 @@
 mysql_user = os.getenv('DSTAT_MYSQL_USER') or os.getenv('USER')
 mysql_pwd = os.getenv('DSTAT_MYSQL_PWD')
 
-class dstat_mysql5_io(dstat):
+class dstat_plugin(dstat):
     def __init__(self):
         self.name = 'mysql5 io'
         self.vars = ('Bytes_received', 'Bytes_sent')

Modified: trunk/tools/dstat/plugins/dstat_mysql5_keys.py
===================================================================
--- trunk/tools/dstat/plugins/dstat_mysql5_keys.py	2009-11-21 14:08:12 UTC (rev 8035)
+++ trunk/tools/dstat/plugins/dstat_mysql5_keys.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -8,7 +8,7 @@
 mysql_user = os.getenv('DSTAT_MYSQL_USER') or os.getenv('USER')
 mysql_pwd = os.getenv('DSTAT_MYSQL_PWD') 
 
-class dstat_mysql5_keys(dstat):
+class dstat_plugin(dstat):
     def __init__(self):
         self.name = 'mysql5 key status'
         self.type = 'f'

Modified: trunk/tools/dstat/plugins/dstat_mysql_io.py
===================================================================
--- trunk/tools/dstat/plugins/dstat_mysql_io.py	2009-11-21 14:08:12 UTC (rev 8035)
+++ trunk/tools/dstat/plugins/dstat_mysql_io.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -1,7 +1,7 @@
 global mysql_options
 mysql_options = os.getenv('DSTAT_MYSQL')
 
-class dstat_mysql_io(dstat):
+class dstat_plugin(dstat):
     def __init__(self):
         self.name = 'mysql io'
         self.vars = ('Bytes_received', 'Bytes_sent')
@@ -31,11 +31,11 @@
                 self.set1.update(self.set2)
 
         except IOError, e:
-            if op.debug: print 'dstat_innodb_buffer: lost pipe to mysql,', e
+            if op.debug &gt; 1: print '%s: lost pipe to mysql, %s' % (self.filename, e)
             for name in self.vars: self.val[name] = -1
 
         except Exception, e:
-            if op.debug: print 'dstat_innodb_buffer: exception', e
+            if op.debug &gt; 1: print 'dstat_innodb_buffer: exception', e
             for name in self.vars: self.val[name] = -1
 
 # vim:ts=4:sw=4:et

Modified: trunk/tools/dstat/plugins/dstat_mysql_keys.py
===================================================================
--- trunk/tools/dstat/plugins/dstat_mysql_keys.py	2009-11-21 14:08:12 UTC (rev 8035)
+++ trunk/tools/dstat/plugins/dstat_mysql_keys.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -1,7 +1,7 @@
 global mysql_options
 mysql_options = os.getenv('DSTAT_MYSQL')
 
-class dstat_mysql_keys(dstat):
+class dstat_plugin(dstat):
     def __init__(self):
         self.name = 'mysql key status'
         self.type = 'f'
@@ -34,11 +34,11 @@
                 self.set1.update(self.set2)
 
         except IOError, e:
-            if op.debug: print 'dstat_innodb_buffer: lost pipe to mysql,', e
+            if op.debug &gt; 1: print '%s: lost pipe to mysql, %s' % (self.filename, e)
             for name in self.vars: self.val[name] = -1
 
         except Exception, e:
-            if op.debug: print 'dstat_innodb_buffer: exception', e
+            if op.debug &gt; 1: print '%s: exception' (self.filename, e)
             for name in self.vars: self.val[name] = -1
 
 # vim:ts=4:sw=4:et

Modified: trunk/tools/dstat/plugins/dstat_net_packets.py
===================================================================
--- trunk/tools/dstat/plugins/dstat_net_packets.py	2009-11-21 14:08:12 UTC (rev 8035)
+++ trunk/tools/dstat/plugins/dstat_net_packets.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -1,4 +1,4 @@
-class dstat_net_packets(dstat):
+class dstat_plugin(dstat):
     def __init__(self):
         self.type = 'f'
         self.width = 5

Modified: trunk/tools/dstat/plugins/dstat_nfs3.py
===================================================================
--- trunk/tools/dstat/plugins/dstat_nfs3.py	2009-11-21 14:08:12 UTC (rev 8035)
+++ trunk/tools/dstat/plugins/dstat_nfs3.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -1,4 +1,4 @@
-class dstat_nfs3(dstat):
+class dstat_plugin(dstat):
     def __init__(self):
         self.name = 'nfs3 client'
         self.type = 'd'
@@ -7,8 +7,10 @@
         self.open('/proc/net/rpc/nfs')
         self.vars = ('read', 'write', 'readdir', 'inode', 'filesystem', 'commit')
         self.nick = ('read', 'writ', 'rdir', 'inod', 'fs', 'cmmt')
-        info(1, 'Module dstat_nfs3 is still experimental.')
 
+    def check(self):
+        info(1, 'Module %s is still experimental.' % self.filename)
+
     def extract(self):
         for l in self.splitlines():
             if not l or l[0] != 'proc3': continue

Copied: trunk/tools/dstat/plugins/dstat_nfs3_ops.py (from rev 8032, trunk/tools/dstat/plugins/dstat_nfs3op.py)
===================================================================
--- trunk/tools/dstat/plugins/dstat_nfs3_ops.py	                        (rev 0)
+++ trunk/tools/dstat/plugins/dstat_nfs3_ops.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -0,0 +1,24 @@
+class dstat_plugin(dstat):
+    def __init__(self):
+        self.name = 'extended nfs3 client operations'
+        self.type = 'd'
+        self.width = 5
+        self.scale = 1000
+        self.open('/proc/net/rpc/nfs')
+        self.vars = ('null', 'getattr', 'setattr', 'lookup', 'access', 'readlink', 'read', 'write', 'create', 'mkdir', 'symlink', 'mknod', 'remove', 'rmdir', 'rename', 'link', 'readdir', 'readdirplus', 'fsstat', 'fsinfo', 'pathconf', 'commit')
+        self.nick = ('null', 'gatr', 'satr', 'look', 'aces', 'rdln', 'read', 'writ', 'crea', 'mkdr', 'syml', 'mknd', 'rm', 'rmdr', 'ren', 'link', 'rdir', 'rdr+', 'fstt', 'fsnf', 'path', 'cmmt')
+
+    def check(self):
+        info(1, 'Module %s is still experimental.') % self.filename
+
+    def extract(self):
+        for l in self.splitlines():
+            if not l or l[0] != 'proc3': continue
+            for i, name in enumerate(self.vars):
+                self.set2[name] = long(l[i+2])
+        for name in self.vars:
+            self.val[name] = (self.set2[name] - self.set1[name]) * 1.0 / elapsed
+        if step == op.delay:
+            self.set1.update(self.set2)
+
+# vim:ts=4:sw=4:et

Deleted: trunk/tools/dstat/plugins/dstat_nfs3op.py
===================================================================
--- trunk/tools/dstat/plugins/dstat_nfs3op.py	2009-11-21 14:08:12 UTC (rev 8035)
+++ trunk/tools/dstat/plugins/dstat_nfs3op.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -1,22 +0,0 @@
-class dstat_nfs3op(dstat):
-    def __init__(self):
-        self.name = 'extended nfs3 client operations'
-        self.type = 'd'
-        self.width = 5
-        self.scale = 1000
-        self.open('/proc/net/rpc/nfs')
-        self.vars = ('null', 'getattr', 'setattr', 'lookup', 'access', 'readlink', 'read', 'write', 'create', 'mkdir', 'symlink', 'mknod', 'remove', 'rmdir', 'rename', 'link', 'readdir', 'readdirplus', 'fsstat', 'fsinfo', 'pathconf', 'commit')
-        self.nick = ('null', 'gatr', 'satr', 'look', 'aces', 'rdln', 'read', 'writ', 'crea', 'mkdr', 'syml', 'mknd', 'rm', 'rmdr', 'ren', 'link', 'rdir', 'rdr+', 'fstt', 'fsnf', 'path', 'cmmt')
-        info(1, 'Module dstat_nfs3op is still experimental.')
-
-    def extract(self):
-        for l in self.splitlines():
-            if not l or l[0] != 'proc3': continue
-            for i, name in enumerate(self.vars):
-                self.set2[name] = long(l[i+2])
-        for name in self.vars:
-            self.val[name] = (self.set2[name] - self.set1[name]) * 1.0 / elapsed
-        if step == op.delay:
-            self.set1.update(self.set2)
-
-# vim:ts=4:sw=4:et

Modified: trunk/tools/dstat/plugins/dstat_nfsd3.py
===================================================================
--- trunk/tools/dstat/plugins/dstat_nfsd3.py	2009-11-21 14:08:12 UTC (rev 8035)
+++ trunk/tools/dstat/plugins/dstat_nfsd3.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -1,4 +1,4 @@
-class dstat_nfsd3(dstat):
+class dstat_plugin(dstat):
     def __init__(self):
         self.name = 'nfs3 server'
         self.type = 'd'
@@ -7,8 +7,10 @@
         self.open('/proc/net/rpc/nfsd')
         self.vars = ('read', 'write', 'readdir', 'inode', 'filesystem', 'commit')
         self.nick = ('read', 'writ', 'rdir', 'inod', 'fs', 'cmmt')
-        info(1, 'Module dstat_nfsd3 is still experimental.')
 
+    def check(self):
+        info(1, 'Module %s is still experimental.' % self.filename)
+
     def extract(self):
         for l in self.splitlines():
             if not l or l[0] != 'proc3': continue

Copied: trunk/tools/dstat/plugins/dstat_nfsd3_ops.py (from rev 8032, trunk/tools/dstat/plugins/dstat_nfsd3op.py)
===================================================================
--- trunk/tools/dstat/plugins/dstat_nfsd3_ops.py	                        (rev 0)
+++ trunk/tools/dstat/plugins/dstat_nfsd3_ops.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -0,0 +1,24 @@
+class dstat_plugin(dstat):
+    def __init__(self):
+        self.name = 'extended nfs3 server operations'
+        self.type = 'd'
+        self.width = 5
+        self.scale = 1000
+        self.open('/proc/net/rpc/nfsd')
+        self.vars = ('null', 'getattr', 'setattr', 'lookup', 'access', 'readlink', 'read', 'write', 'create', 'mkdir', 'symlink', 'mknod', 'remove', 'rmdir', 'rename', 'link', 'readdir', 'readdirplus', 'fsstat', 'fsinfo', 'pathconf', 'commit')
+        self.nick = ('null', 'gatr', 'satr', 'look', 'aces', 'rdln', 'read', 'writ', 'crea', 'mkdr', 'syml', 'mknd', 'rm', 'rmdr', 'ren', 'link', 'rdir', 'rdr+', 'fstt', 'fsnf', 'path', 'cmmt')
+
+    def check(self):
+        info(1, 'Module %s is still experimental.') % self.filename
+
+    def extract(self):
+        for l in self.splitlines():
+            if not l or l[0] != 'proc3': continue
+            for i, name in enumerate(self.vars):
+                self.set2[name] = long(l[i+2])
+        for name in self.vars:
+            self.val[name] = (self.set2[name] - self.set1[name]) * 1.0 / elapsed
+        if step == op.delay:
+            self.set1.update(self.set2)
+
+# vim:ts=4:sw=4:et

Deleted: trunk/tools/dstat/plugins/dstat_nfsd3op.py
===================================================================
--- trunk/tools/dstat/plugins/dstat_nfsd3op.py	2009-11-21 14:08:12 UTC (rev 8035)
+++ trunk/tools/dstat/plugins/dstat_nfsd3op.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -1,22 +0,0 @@
-class dstat_nfsd3op(dstat):
-    def __init__(self):
-        self.name = 'extended nfs3 server operations'
-        self.type = 'd'
-        self.width = 5
-        self.scale = 1000
-        self.open('/proc/net/rpc/nfsd')
-        self.vars = ('null', 'getattr', 'setattr', 'lookup', 'access', 'readlink', 'read', 'write', 'create', 'mkdir', 'symlink', 'mknod', 'remove', 'rmdir', 'rename', 'link', 'readdir', 'readdirplus', 'fsstat', 'fsinfo', 'pathconf', 'commit')
-        self.nick = ('null', 'gatr', 'satr', 'look', 'aces', 'rdln', 'read', 'writ', 'crea', 'mkdr', 'syml', 'mknd', 'rm', 'rmdr', 'ren', 'link', 'rdir', 'rdr+', 'fstt', 'fsnf', 'path', 'cmmt')
-        info(1, 'Module dstat_nfsd3op is still experimental.')
-
-    def extract(self):
-        for l in self.splitlines():
-            if not l or l[0] != 'proc3': continue
-            for i, name in enumerate(self.vars):
-                self.set2[name] = long(l[i+2])
-        for name in self.vars:
-            self.val[name] = (self.set2[name] - self.set1[name]) * 1.0 / elapsed
-        if step == op.delay:
-            self.set1.update(self.set2)
-
-# vim:ts=4:sw=4:et

Modified: trunk/tools/dstat/plugins/dstat_ntp.py
===================================================================
--- trunk/tools/dstat/plugins/dstat_ntp.py	2009-11-21 14:08:12 UTC (rev 8035)
+++ trunk/tools/dstat/plugins/dstat_ntp.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -17,7 +17,7 @@
 ### FIXME: Implement millisecond granularity as well
 ### FIXME: Interrupts socket if data is overdue (more than 250ms ?)
 
-class dstat_ntp(dstat):
+class dstat_plugin(dstat):
     def __init__(self):
         self.name = 'ntp'
         self.timefmt = os.getenv('DSTAT_TIMEFMT') or '%d-%m %H:%M:%S'

Modified: trunk/tools/dstat/plugins/dstat_postfix.py
===================================================================
--- trunk/tools/dstat/plugins/dstat_postfix.py	2009-11-21 14:08:12 UTC (rev 8035)
+++ trunk/tools/dstat/plugins/dstat_postfix.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -1,7 +1,7 @@
 global glob
 import glob
 
-class dstat_postfix(dstat):
+class dstat_plugin(dstat):
     def __init__(self):
         self.name = 'postfix'
         self.type = 'd'

Modified: trunk/tools/dstat/plugins/dstat_power.py
===================================================================
--- trunk/tools/dstat/plugins/dstat_power.py	2009-11-21 14:08:12 UTC (rev 8035)
+++ trunk/tools/dstat/plugins/dstat_power.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -3,7 +3,7 @@
 ###
 ### Authority: <A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>
 
-class dstat_power(dstat):
+class dstat_plugin(dstat):
     def __init__(self):
         self.name = 'power'
         self.type = 'f'

Copied: trunk/tools/dstat/plugins/dstat_proc_count.py (from rev 8028, trunk/tools/dstat/plugins/dstat_proccount.py)
===================================================================
--- trunk/tools/dstat/plugins/dstat_proc_count.py	                        (rev 0)
+++ trunk/tools/dstat/plugins/dstat_proc_count.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -0,0 +1,13 @@
+### Dstat Display Process Count plugin
+### Displays the number of processes on a machine
+
+class dstat_plugin(dstat):
+    def __init__(self):
+        self.name   = 'procs'
+        self.type = 'd'
+        self.width = 4
+        self.scale = 10
+        self.vars   = ('total',)
+
+    def extract(self):
+        self.val['total'] = len(glob.glob('/proc/[0-9]*'))

Deleted: trunk/tools/dstat/plugins/dstat_proccount.py
===================================================================
--- trunk/tools/dstat/plugins/dstat_proccount.py	2009-11-21 14:08:12 UTC (rev 8035)
+++ trunk/tools/dstat/plugins/dstat_proccount.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -1,13 +0,0 @@
-### Dstat Display Process Count plugin
-### Displays the number of processes on a machine
-
-class dstat_proccount(dstat):
-    def __init__(self):
-        self.name   = 'procs'
-        self.type = 'd'
-        self.width = 4
-        self.scale = 10
-        self.vars   = ('total',)
-
-    def extract(self):
-        self.val['total'] = len(glob.glob('/proc/[0-9]*'))

Modified: trunk/tools/dstat/plugins/dstat_rpc.py
===================================================================
--- trunk/tools/dstat/plugins/dstat_rpc.py	2009-11-21 14:08:12 UTC (rev 8035)
+++ trunk/tools/dstat/plugins/dstat_rpc.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -1,4 +1,4 @@
-class dstat_rpc(dstat):
+class dstat_plugin(dstat):
     def __init__(self):
         self.name = 'rpc client'
         self.type = 'd'

Modified: trunk/tools/dstat/plugins/dstat_rpcd.py
===================================================================
--- trunk/tools/dstat/plugins/dstat_rpcd.py	2009-11-21 14:08:12 UTC (rev 8035)
+++ trunk/tools/dstat/plugins/dstat_rpcd.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -1,4 +1,4 @@
-class dstat_rpcd(dstat):
+class dstat_plugin(dstat):
     def __init__(self):
         self.name = 'rpc server'
         self.type = 'd'

Modified: trunk/tools/dstat/plugins/dstat_sendmail.py
===================================================================
--- trunk/tools/dstat/plugins/dstat_sendmail.py	2009-11-21 14:08:12 UTC (rev 8035)
+++ trunk/tools/dstat/plugins/dstat_sendmail.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -2,7 +2,7 @@
 global glob
 import glob
 
-class dstat_sendmail(dstat):
+class dstat_plugin(dstat):
     def __init__(self):
         self.name = 'sendmail'
         self.type = 'd'

Modified: trunk/tools/dstat/plugins/dstat_snooze.py
===================================================================
--- trunk/tools/dstat/plugins/dstat_snooze.py	2009-11-21 14:08:12 UTC (rev 8035)
+++ trunk/tools/dstat/plugins/dstat_snooze.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -1,4 +1,4 @@
-class dstat_snooze(dstat):
+class dstat_plugin(dstat):
     def __init__(self):
         self.name = 'snooze'
         self.type = 's'

Modified: trunk/tools/dstat/plugins/dstat_thermal.py
===================================================================
--- trunk/tools/dstat/plugins/dstat_thermal.py	2009-11-21 14:08:12 UTC (rev 8035)
+++ trunk/tools/dstat/plugins/dstat_thermal.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -1,4 +1,4 @@
-class dstat_thermal(dstat):
+class dstat_plugin(dstat):
     def __init__(self):
         self.name = 'thermal'
         self.type = 'd'

Copied: trunk/tools/dstat/plugins/dstat_top_bio.py (from rev 8032, trunk/tools/dstat/plugins/dstat_topbio.py)
===================================================================
--- trunk/tools/dstat/plugins/dstat_top_bio.py	                        (rev 0)
+++ trunk/tools/dstat/plugins/dstat_top_bio.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -0,0 +1,77 @@
+### Dstat most expensive block I/O process plugin
+### Displays the name of the most expensive block I/O process
+###
+### Authority: <A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>
+
+class dstat_plugin(dstat):
+    def __init__(self):
+        self.name = 'most expensive'
+        self.type = 's'
+        self.width = 22
+        self.scale = 0
+        self.vars = ('block i/o process',)
+        self.pid = str(os.getpid())
+        self.pidset1 = {}; self.pidset2 = {}
+
+    def check(self):
+        if not os.access('/proc/self/io', os.R_OK):
+            raise Exception, 'Kernel has no I/O accounting, use at least 2.6.20'
+
+    def extract(self):
+        self.val['usage'] = 0.0
+        self.val['block i/o process'] = ''
+        for pid in os.listdir('/proc/'):
+            try:
+                ### Is it a pid ?
+                int(pid)
+
+                ### Filter out dstat
+                if pid == self.pid: continue
+
+                ### Reset values
+                if not self.pidset2.has_key(pid):
+                    self.pidset2[pid] = {'read_bytes:': 0, 'write_bytes:': 0}
+                if not self.pidset1.has_key(pid):
+                    self.pidset1[pid] = {'read_bytes:': 0, 'write_bytes:': 0}
+
+                ### Extract name
+                name = open('/proc/%s/stat' % pid).read().split()[1][1:-1]
+
+                ### Extract counters
+                for line in open('/proc/%s/io' % pid).readlines():
+                    l = line.split()
+                    if len(l) != 2: continue
+                    self.pidset2[pid][l[0]] = int(l[1])
+
+            except ValueError:
+                continue
+            except IOError:
+                continue
+
+            read_usage = (self.pidset2[pid]['read_bytes:'] - self.pidset1[pid]['read_bytes:']) * 1.0 / elapsed
+            write_usage = (self.pidset2[pid]['write_bytes:'] - self.pidset1[pid]['write_bytes:']) * 1.0 / elapsed
+            usage = read_usage + write_usage
+
+            ### Get the process that spends the most jiffies
+            if usage &gt; self.val['usage']:
+                self.val['usage'] = usage
+                self.val['read_usage'] = read_usage
+                self.val['write_usage'] = write_usage
+                self.val['pid'] = pid
+                self.val['name'] = getnamebypid(pid, name)
+#                st = os.stat(&quot;/proc/%s&quot; % pid)
+
+        if step == op.delay:
+            for pid in self.pidset2.keys():
+                self.pidset1[pid].update(self.pidset2[pid])
+
+        if self.val['usage'] != 0.0:
+            self.val['block i/o process'] = '%-*s%s:%s' % (self.width-11, self.val['name'][0:self.width-11], cprint(self.val['read_usage'], 'd', 5, 1024), cprint(self.val['write_usage'], 'd', 5, 1024))
+
+        ### Debug (show PID)
+#        self.val['block i/o process'] = '%*s %-*s' % (5, self.val['pid'], self.width-6, self.val['name'])
+
+    def showcsv(self):
+        return '%s / %d:%d' % (self.val['name'], self.val['read_usage'], self.val['write_usage'])
+
+# vim:ts=4:sw=4:et

Copied: trunk/tools/dstat/plugins/dstat_top_cpu.py (from rev 8032, trunk/tools/dstat/plugins/dstat_topcpu.py)
===================================================================
--- trunk/tools/dstat/plugins/dstat_top_cpu.py	                        (rev 0)
+++ trunk/tools/dstat/plugins/dstat_top_cpu.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -0,0 +1,67 @@
+### Dstat most expensive process plugin
+### Displays the name of the most expensive process
+###
+### Authority: <A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>
+
+global cpunr
+
+class dstat_plugin(dstat):
+    def __init__(self):
+        self.name = 'most expensive'
+        self.type = 's'
+        self.width = 16
+        self.scale = 0
+        self.vars = ('cpu process',)
+        self.pid = str(os.getpid())
+        self.pidset1 = {}; self.pidset2 = {}
+
+    def extract(self):
+        self.val['max'] = 0.0
+        self.val['cpu process'] = ''
+        for pid in os.listdir('/proc/'):
+            try:
+                ### Is it a pid ?
+                int(pid)
+
+                ### Filter out dstat
+                if pid == self.pid: continue
+
+                ### Using dopen() will cause too many open files
+                l = open('/proc/%s/stat' % pid).read().split()
+
+            except ValueError:
+                continue
+            except IOError:
+                continue
+
+            if len(l) &lt; 15: continue
+
+            ### Reset previous value if it doesn't exist
+            if not self.pidset1.has_key(pid):
+                self.pidset1[pid] = 0
+
+            self.pidset2[pid] = int(l[13]) + int(l[14])
+            usage = (self.pidset2[pid] - self.pidset1[pid]) * 1.0 / elapsed / cpunr
+
+            ### Is it a new topper ?
+            if usage &lt; self.val['max']: continue
+
+            name = l[1][1:-1]
+
+            self.val['max'] = usage
+            self.val['pid'] = pid
+            self.val['name'] = getnamebypid(pid, name)
+
+        if self.val['max'] != 0.0:
+            self.val['cpu process'] = '%-*s%s' % (self.width-3, self.val['name'][0:self.width-3], cprint(self.val['max'], 'f', 3, 34))
+
+        ### Debug (show PID)
+#        self.val['cpu process'] = '%*s %-*s' % (5, self.val['pid'], self.width-6, self.val['name'])
+
+        if step == op.delay:
+            self.pidset1.update(self.pidset2)
+
+    def showcsv(self):
+        return '%s / %d%%' % (self.val['name'], self.val['max'])
+
+# vim:ts=4:sw=4:et

Copied: trunk/tools/dstat/plugins/dstat_top_cputime.py (from rev 8033, trunk/tools/dstat/plugins/dstat_topcputime.py)
===================================================================
--- trunk/tools/dstat/plugins/dstat_top_cputime.py	                        (rev 0)
+++ trunk/tools/dstat/plugins/dstat_top_cputime.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -0,0 +1,76 @@
+### Authority: <A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>
+
+### For more information, see:
+###     <A HREF="http://eaglet.rain.com/rick/linux/schedstat/">http://eaglet.rain.com/rick/linux/schedstat/</A>
+
+class dstat_plugin(dstat):
+    &quot;&quot;&quot;
+    Name and total amount of CPU time consumed in milliseconds of the process
+    that has the highest total amount of cputime for the measured timeframe.
+    &quot;&quot;&quot;
+
+    def __init__(self):
+        self.name = 'highest total'
+        self.type = 's'
+        self.width = 17
+        self.scale = 0
+        self.vars = ('cputime process',)
+        self.pid = str(os.getpid())
+        self.pidset1 = {}; self.pidset2 = {}
+
+    def check(self):
+        if not os.access('/proc/self/schedstat', os.R_OK):
+            raise Exception, 'Kernel has no scheduler statistics, use at least 2.6.12'
+
+    def extract(self):
+        self.val['result'] = 0
+        self.val['process'] = ''
+        for pid in os.listdir('/proc/'):
+            try:
+                ### Is it a pid ?
+                int(pid)
+
+                ### Filter out dstat
+                if pid == self.pid: continue
+
+                ### Reset values
+                if not self.pidset1.has_key(pid):
+                    self.pidset1[pid] = {'run_ticks': 0}
+
+                ### Extract name
+                name = open('/proc/%s/stat' % pid).read().split()[1][1:-1]
+
+                ### Extract counters
+                l = open('/proc/%s/schedstat' % pid).read().split()
+
+            except ValueError:
+                continue
+            except IOError:
+                continue
+
+            if len(l) != 3: continue
+
+            self.pidset2[pid] = {'run_ticks': long(l[0])}
+
+            totrun = (self.pidset2[pid]['run_ticks'] - self.pidset1[pid]['run_ticks']) * 1.0 / elapsed
+
+            ### Get the process that spends the most jiffies
+            if totrun &gt; self.val['result']:
+                self.val['result'] = totrun
+                self.val['pid'] = pid
+                self.val['name'] = getnamebypid(pid, name)
+
+        if step == op.delay:
+            for pid in self.pidset2.keys():
+                self.pidset1[pid].update(self.pidset2[pid])
+
+        if self.val['result'] != 0.0:
+            self.val['cputime process'] = '%-*s%s' % (self.width-4, self.val['name'][0:self.width-4], cprint(self.val['result'], 'f', 4, 100))
+
+        ### Debug (show PID)
+#       self.val['cputime process'] = '%*s %-*s' % (5, self.val['pid'], self.width-6, self.val['name'])
+
+    def showcsv(self):
+        return '%s / %.4f' % (self.val['name'], self.val['result'])
+
+# vim:ts=4:sw=4:et

Copied: trunk/tools/dstat/plugins/dstat_top_cputime_avg.py (from rev 8033, trunk/tools/dstat/plugins/dstat_topavgcputime.py)
===================================================================
--- trunk/tools/dstat/plugins/dstat_top_cputime_avg.py	                        (rev 0)
+++ trunk/tools/dstat/plugins/dstat_top_cputime_avg.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -0,0 +1,77 @@
+### Dstat most expensive I/O process plugin
+### Displays the name of the most expensive I/O process
+###
+### Authority: <A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>
+
+### For more information, see:
+###     <A HREF="http://eaglet.rain.com/rick/linux/schedstat/">http://eaglet.rain.com/rick/linux/schedstat/</A>
+
+class dstat_plugin(dstat):
+    def __init__(self):
+        self.name = 'highest average'
+        self.type = 's'
+        self.width = 17
+        self.scale = 0
+        self.vars = ('cputime process',)
+        self.pid = str(os.getpid())
+        self.pidset1 = {}; self.pidset2 = {}
+
+    def check(self):
+        if not os.access('/proc/self/schedstat', os.R_OK):
+            raise Exception, 'Kernel has no scheduler statistics, use at least 2.6.12'
+
+    def extract(self):
+        self.val['result'] = 0
+        self.val['process'] = ''
+        for pid in os.listdir('/proc/'):
+            try:
+                ### Is it a pid ?
+                int(pid)
+
+                ### Filter out dstat
+                if pid == self.pid: continue
+
+                ### Reset values
+                if not self.pidset1.has_key(pid):
+                    self.pidset1[pid] = {'run_ticks': 0, 'ran': 0}
+
+                ### Extract name
+                name = open('/proc/%s/stat' % pid).read().split()[1][1:-1]
+
+                ### Extract counters
+                l = open('/proc/%s/schedstat' % pid).read().split()
+
+            except ValueError:
+                continue
+            except IOError:
+                continue
+
+            if len(l) != 3: continue
+
+            self.pidset2[pid] = {'run_ticks': long(l[0]), 'ran': long(l[2])}
+
+            if self.pidset2[pid]['ran'] - self.pidset1[pid]['ran'] &gt; 0:
+                avgrun = (self.pidset2[pid]['run_ticks'] - self.pidset1[pid]['run_ticks']) * 1.0 / (self.pidset2[pid]['ran'] - self.pidset1[pid]['ran']) / elapsed
+            else:
+                avgrun = 0
+
+            ### Get the process that spends the most jiffies
+            if avgrun &gt; self.val['result']:
+                self.val['result'] = avgrun
+                self.val['pid'] = pid
+                self.val['name'] = getnamebypid(pid, name)
+
+        if step == op.delay:
+            for pid in self.pidset2.keys():
+                self.pidset1[pid].update(self.pidset2[pid])
+
+        if self.val['result'] != 0.0:
+            self.val['cputime process'] = '%-*s%s' % (self.width-4, self.val['name'][0:self.width-4], cprint(self.val['result'], 'f', 4, 100))
+
+        ### Debug (show PID)
+#       self.val['cputime process'] = '%*s %-*s' % (5, self.val['pid'], self.width-6, self.val['name'])
+
+    def showcsv(self):
+        return '%s / %.4f' % (self.val['name'], self.val['result'])
+
+# vim:ts=4:sw=4:et

Copied: trunk/tools/dstat/plugins/dstat_top_io.py (from rev 8032, trunk/tools/dstat/plugins/dstat_topio.py)
===================================================================
--- trunk/tools/dstat/plugins/dstat_top_io.py	                        (rev 0)
+++ trunk/tools/dstat/plugins/dstat_top_io.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -0,0 +1,78 @@
+### Dstat most expensive I/O process plugin
+### Displays the name of the most expensive I/O process
+###
+### Authority: <A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>
+
+class dstat_plugin(dstat):
+    def __init__(self):
+        self.name = 'most expensive'
+        self.type = 's'
+        self.width = 22
+        self.scale = 0
+        self.vars = ('i/o process',)
+        self.pid = str(os.getpid())
+        self.pidset1 = {}; self.pidset2 = {}
+
+    def check(self):
+        if not os.access('/proc/self/io', os.R_OK):
+            raise Exception, 'Kernel has no I/O accounting, use at least 2.6.20'
+
+    def extract(self):
+        self.val['usage'] = 0.0
+        self.val['i/o process'] = ''
+        for pid in os.listdir('/proc/'):
+            try:
+                ### Is it a pid ?
+                int(pid)
+
+                ### Filter out dstat
+                if pid == self.pid: continue
+
+                ### Reset values
+                if not self.pidset2.has_key(pid):
+                    self.pidset2[pid] = {'rchar:': 0, 'wchar:': 0}
+                if not self.pidset1.has_key(pid):
+                    self.pidset1[pid] = {'rchar:': 0, 'wchar:': 0}
+
+                ### Extract name
+                name = open('/proc/%s/stat' % pid).read().split()[1][1:-1]
+
+                ### Extract counters
+                for line in open('/proc/%s/io' % pid).readlines():
+                    l = line.split()
+                    if len(l) != 2: continue
+                    self.pidset2[pid][l[0]] = int(l[1])
+
+            except ValueError:
+                continue
+            except IOError:
+                continue
+
+            read_usage = (self.pidset2[pid]['rchar:'] - self.pidset1[pid]['rchar:']) * 1.0 / elapsed
+            write_usage = (self.pidset2[pid]['wchar:'] - self.pidset1[pid]['wchar:']) * 1.0 / elapsed
+            usage = read_usage + write_usage
+#            if usage &gt; 0.0:
+#                print '%s %s:%s' % (pid, read_usage, write_usage)
+
+            ### Get the process that spends the most jiffies
+            if usage &gt; self.val['usage']:
+                self.val['usage'] = usage
+                self.val['read_usage'] = read_usage
+                self.val['write_usage'] = write_usage
+                self.val['pid'] = pid
+                self.val['name'] = getnamebypid(pid, name)
+
+        if step == op.delay:
+            for pid in self.pidset2.keys():
+                self.pidset1[pid].update(self.pidset2[pid])
+
+        if self.val['usage'] != 0.0:
+            self.val['i/o process'] = '%-*s%s:%s' % (self.width-11, self.val['name'][0:self.width-11], cprint(self.val['read_usage'], 'd', 5, 1024), cprint(self.val['write_usage'], 'd', 5, 1024))
+
+        ### Debug (show PID)
+#       self.val['i/o process'] = '%*s %-*s' % (5, self.val['pid'], self.width-6, self.val['name'])
+
+    def showcsv(self):
+        return '%s / %d:%d' % (self.val['name'], self.val['read_usage'], self.val['write_usage'])
+
+# vim:ts=4:sw=4:et

Copied: trunk/tools/dstat/plugins/dstat_top_latency.py (from rev 8033, trunk/tools/dstat/plugins/dstat_toplatency.py)
===================================================================
--- trunk/tools/dstat/plugins/dstat_top_latency.py	                        (rev 0)
+++ trunk/tools/dstat/plugins/dstat_top_latency.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -0,0 +1,76 @@
+### Authority: <A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>
+
+### For more information, see:
+###     <A HREF="http://eaglet.rain.com/rick/linux/schedstat/">http://eaglet.rain.com/rick/linux/schedstat/</A>
+
+class dstat_plugin(dstat):
+    &quot;&quot;&quot;
+    Name and total amount of CPU time waited in milliseconds of the process
+    that has the highest total amount waited for the measured timeframe.
+    &quot;&quot;&quot;
+
+    def __init__(self):
+        self.name = 'highest total'
+        self.type = 's'
+        self.width = 17
+        self.scale = 0
+        self.vars = ('latency process',)
+        self.pid = str(os.getpid())
+        self.pidset1 = {}; self.pidset2 = {}
+
+    def check(self):
+        if not os.access('/proc/self/schedstat', os.R_OK):
+            raise Exception, 'Kernel has no scheduler statistics, use at least 2.6.12'
+
+    def extract(self):
+        self.val['result'] = 0
+        self.val['process'] = ''
+        for pid in os.listdir('/proc/'):
+            try:
+                ### Is it a pid ?
+                int(pid)
+
+                ### Filter out dstat
+                if pid == self.pid: continue
+
+                ### Reset values
+                if not self.pidset1.has_key(pid):
+                    self.pidset1[pid] = {'wait_ticks': 0}
+
+                ### Extract name
+                name = open('/proc/%s/stat' % pid).read().split()[1][1:-1]
+
+                ### Extract counters
+                l = open('/proc/%s/schedstat' % pid).read().split()
+
+            except ValueError:
+                continue
+            except IOError:
+                continue
+
+            if len(l) != 3: continue
+
+            self.pidset2[pid] = {'wait_ticks': long(l[1])}
+
+            totwait = (self.pidset2[pid]['wait_ticks'] - self.pidset1[pid]['wait_ticks']) * 1.0 / elapsed
+
+            ### Get the process that spends the most jiffies
+            if totwait &gt; self.val['result']:
+                self.val['result'] = totwait
+                self.val['pid'] = pid
+                self.val['name'] = getnamebypid(pid, name)
+
+        if step == op.delay:
+            for pid in self.pidset2.keys():
+                self.pidset1[pid].update(self.pidset2[pid])
+
+        if self.val['result'] != 0.0:
+            self.val['latency process'] = '%-*s%s' % (self.width-4, self.val['name'][0:self.width-4], cprint(self.val['result'], 'f', 4, 100))
+
+        ### Debug (show PID)
+#       self.val['latency process'] = '%*s %-*s' % (5, self.val['pid'], self.width-6, self.val['name'])
+
+    def showcsv(self):
+        return '%s / %.4f' % (self.val['name'], self.val['result'])
+
+# vim:ts=4:sw=4:et

Copied: trunk/tools/dstat/plugins/dstat_top_latency_avg.py (from rev 8033, trunk/tools/dstat/plugins/dstat_topavglatency.py)
===================================================================
--- trunk/tools/dstat/plugins/dstat_top_latency_avg.py	                        (rev 0)
+++ trunk/tools/dstat/plugins/dstat_top_latency_avg.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -0,0 +1,77 @@
+### Dstat most expensive I/O process plugin
+### Displays the name of the most expensive I/O process
+###
+### Authority: <A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>
+
+### For more information, see:
+###     <A HREF="http://eaglet.rain.com/rick/linux/schedstat/">http://eaglet.rain.com/rick/linux/schedstat/</A>
+
+class dstat_plugin(dstat):
+    def __init__(self):
+        self.name = 'highest average'
+        self.type = 's'
+        self.width = 17
+        self.scale = 0
+        self.vars = ('latency process',)
+        self.pid = str(os.getpid())
+        self.pidset1 = {}; self.pidset2 = {}
+
+    def check(self):
+        if not os.access('/proc/self/schedstat', os.R_OK):
+            raise Exception, 'Kernel has no scheduler statistics, use at least 2.6.12'
+
+    def extract(self):
+        self.val['result'] = 0
+        self.val['process'] = ''
+        for pid in os.listdir('/proc/'):
+            try:
+                ### Is it a pid ?
+                int(pid)
+
+                ### Filter out dstat
+                if pid == self.pid: continue
+
+                ### Reset values
+                if not self.pidset1.has_key(pid):
+                    self.pidset1[pid] = {'wait_ticks': 0, 'ran': 0}
+
+                ### Extract name
+                name = open('/proc/%s/stat' % pid).read().split()[1][1:-1]
+
+                ### Extract counters
+                l = open('/proc/%s/schedstat' % pid).read().split()
+
+            except ValueError:
+                continue
+            except IOError:
+                continue
+
+            if len(l) != 3: continue
+
+            self.pidset2[pid] = {'wait_ticks': long(l[1]), 'ran': long(l[2])}
+
+            if self.pidset2[pid]['ran'] - self.pidset1[pid]['ran'] &gt; 0:
+                avgwait = (self.pidset2[pid]['wait_ticks'] - self.pidset1[pid]['wait_ticks']) * 1.0 / (self.pidset2[pid]['ran'] - self.pidset1[pid]['ran']) / elapsed
+            else:
+                avgwait = 0
+
+            ### Get the process that spends the most jiffies
+            if avgwait &gt; self.val['result']:
+                self.val['result'] = avgwait
+                self.val['pid'] = pid
+                self.val['name'] = getnamebypid(pid, name)
+
+        if step == op.delay:
+            for pid in self.pidset2.keys():
+                self.pidset1[pid].update(self.pidset2[pid])
+
+        if self.val['result'] != 0.0:
+            self.val['latency process'] = '%-*s%s' % (self.width-4, self.val['name'][0:self.width-4], cprint(self.val['result'], 'f', 4, 100))
+
+        ### Debug (show PID)
+#       self.val['latency process'] = '%*s %-*s' % (5, self.val['pid'], self.width-6, self.val['name'])
+
+    def showcsv(self):
+        return '%s / %.4f' % (self.val['name'], self.val['result'])
+
+# vim:ts=4:sw=4:et

Copied: trunk/tools/dstat/plugins/dstat_top_mem.py (from rev 8028, trunk/tools/dstat/plugins/dstat_topmem.py)
===================================================================
--- trunk/tools/dstat/plugins/dstat_top_mem.py	                        (rev 0)
+++ trunk/tools/dstat/plugins/dstat_top_mem.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -0,0 +1,51 @@
+### Dstat most expensive process plugin
+### Displays the name of the most expensive process
+###
+### Authority: <A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>
+
+class dstat_plugin(dstat):
+    def __init__(self):
+        self.name = 'most expensive'
+        self.type = 's'
+        self.width = 17
+        self.scale = 0
+        self.vars = ('memory process',)
+        self.pid = str(os.getpid())
+
+    def extract(self):
+        self.val['max'] = 0.0
+        for pid in os.listdir('/proc/'):
+            try:
+                ### Is it a pid ?
+                int(pid)
+
+                ### Filter out dstat
+                if pid == self.pid: continue
+
+                ### Using dopen() will cause too many open files
+                l = open('/proc/%s/stat' % pid).read().split()
+
+            except ValueError:
+                continue
+            except IOError:
+                continue
+
+            if len(l) &lt; 23: continue
+            usage = int(l[23]) * pagesize
+
+            ### Is it a new topper ?
+            if usage &lt;= self.val['max']: continue
+
+            self.val['max'] = usage
+            self.val['name'] = getnamebypid(pid, l[1][1:-1])
+            self.val['pid'] = pid
+
+        self.val['memory process'] = '%-*s%s' % (self.width-5, self.val['name'][0:self.width-5], cprint(self.val['max'], 'f', 5, 1024))
+
+        ### Debug (show PID)
+#       self.val['memory process'] = '%*s %-*s' % (5, self.val['pid'], self.width-6, self.val['name'])
+
+    def showcsv(self):
+        return '%s / %d%%' % (self.val['name'], self.val['max'])
+
+# vim:ts=4:sw=4:et

Copied: trunk/tools/dstat/plugins/dstat_top_oom.py (from rev 8028, trunk/tools/dstat/plugins/dstat_topoom.py)
===================================================================
--- trunk/tools/dstat/plugins/dstat_top_oom.py	                        (rev 0)
+++ trunk/tools/dstat/plugins/dstat_top_oom.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -0,0 +1,60 @@
+### Dstat most expensive process plugin
+### Displays the name of the most expensive process
+###
+### Authority: <A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>
+
+class dstat_plugin(dstat):
+    def __init__(self):
+        self.name = 'out of memory'
+        self.type = 's'
+        self.width = 18
+        self.scale = 0
+        self.vars = ('kill score',)
+        self.pid = str(os.getpid())
+
+    def check(self):
+        if not os.access('/proc/self/oom_score', os.R_OK):
+            raise Exception, 'Kernel does not support /proc/pid/oom_score, use at least 2.6.11.'
+
+    def extract(self):
+        self.val['max'] = 0.0
+        self.val['kill score'] = ''
+        for pid in os.listdir('/proc/'):
+            try:
+                ### Is it a pid ?
+                int(pid)
+
+                ### Filter out dstat
+                if pid == self.pid: continue
+
+                ### Extract name
+                name = open('/proc/%s/stat' % pid).read().split()[1][1:-1]
+
+                ### Using dopen() will cause too many open files
+                l = open('/proc/%s/oom_score' % pid).read().split()
+
+            except ValueError:
+                continue
+            except IOError:
+                continue
+
+            if len(l) &lt; 1: continue
+            oom_score = int(l[0])
+
+            ### Is it a new topper ?
+            if oom_score &lt;= self.val['max']: continue
+
+            self.val['max'] = oom_score
+            self.val['name'] = getnamebypid(pid, name)
+            self.val['pid'] = pid
+
+        if self.val['max'] != 0.0:
+            self.val['kill score'] = '%-*s%s' % (self.width-4, self.val['name'][0:self.width-4], cprint(self.val['max'], 'f', 4, 1000))
+
+        ### Debug (show PID)
+#       self.val['kill score'] = '%*s %-*s' % (5, self.val['pid'], self.width-6, self.val['name'])
+
+    def showcsv(self):
+        return '%s / %d%%' % (self.val['name'], self.val['max'])
+
+# vim:ts=4:sw=4:et

Deleted: trunk/tools/dstat/plugins/dstat_topavgcputime.py
===================================================================
--- trunk/tools/dstat/plugins/dstat_topavgcputime.py	2009-11-21 14:08:12 UTC (rev 8035)
+++ trunk/tools/dstat/plugins/dstat_topavgcputime.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -1,78 +0,0 @@
-### Dstat most expensive I/O process plugin
-### Displays the name of the most expensive I/O process
-###
-### Authority: <A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>
-
-### For more information, see:
-###     <A HREF="http://eaglet.rain.com/rick/linux/schedstat/">http://eaglet.rain.com/rick/linux/schedstat/</A>
-
-class dstat_topavgcputime(dstat):
-    def __init__(self):
-        self.name = 'highest average'
-        self.type = 's'
-        self.width = 17
-        self.scale = 0
-        self.vars = ('cputime process',)
-        self.pid = str(os.getpid())
-        self.pidset1 = {}; self.pidset2 = {}
-        info(1, 'Module dstat_toptimeslice is still experimental.')
-
-    def check(self):
-        if not os.access('/proc/self/schedstat', os.R_OK):
-            raise Exception, 'Kernel has no scheduler statistics, use at least 2.6.12'
-
-    def extract(self):
-        self.val['result'] = 0
-        self.val['process'] = ''
-        for pid in os.listdir('/proc/'):
-            try:
-                ### Is it a pid ?
-                int(pid)
-
-                ### Filter out dstat
-                if pid == self.pid: continue
-
-                ### Reset values
-                if not self.pidset1.has_key(pid):
-                    self.pidset1[pid] = {'run_ticks': 0, 'ran': 0}
-
-                ### Extract name
-                name = open('/proc/%s/stat' % pid).read().split()[1][1:-1]
-
-                ### Extract counters
-                l = open('/proc/%s/schedstat' % pid).read().split()
-
-            except ValueError:
-                continue
-            except IOError:
-                continue
-
-            if len(l) != 3: continue
-
-            self.pidset2[pid] = {'run_ticks': long(l[0]), 'ran': long(l[2])}
-
-            if self.pidset2[pid]['ran'] - self.pidset1[pid]['ran'] &gt; 0:
-                avgrun = (self.pidset2[pid]['run_ticks'] - self.pidset1[pid]['run_ticks']) * 1.0 / (self.pidset2[pid]['ran'] - self.pidset1[pid]['ran']) / elapsed
-            else:
-                avgrun = 0
-
-            ### Get the process that spends the most jiffies
-            if avgrun &gt; self.val['result']:
-                self.val['result'] = avgrun
-                self.val['pid'] = pid
-                self.val['name'] = getnamebypid(pid, name)
-
-        if step == op.delay:
-            for pid in self.pidset2.keys():
-                self.pidset1[pid].update(self.pidset2[pid])
-
-        if self.val['result'] != 0.0:
-            self.val['cputime process'] = '%-*s%s' % (self.width-4, self.val['name'][0:self.width-4], cprint(self.val['result'], 'f', 4, 100))
-
-        ### Debug (show PID)
-#       self.val['cputime process'] = '%*s %-*s' % (5, self.val['pid'], self.width-6, self.val['name'])
-
-    def showcsv(self):
-        return '%s / %.4f' % (self.val['name'], self.val['result'])
-
-# vim:ts=4:sw=4:et

Deleted: trunk/tools/dstat/plugins/dstat_topavglatency.py
===================================================================
--- trunk/tools/dstat/plugins/dstat_topavglatency.py	2009-11-21 14:08:12 UTC (rev 8035)
+++ trunk/tools/dstat/plugins/dstat_topavglatency.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -1,78 +0,0 @@
-### Dstat most expensive I/O process plugin
-### Displays the name of the most expensive I/O process
-###
-### Authority: <A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>
-
-### For more information, see:
-###     <A HREF="http://eaglet.rain.com/rick/linux/schedstat/">http://eaglet.rain.com/rick/linux/schedstat/</A>
-
-class dstat_topavglatency(dstat):
-    def __init__(self):
-        self.name = 'highest average'
-        self.type = 's'
-        self.width = 17
-        self.scale = 0
-        self.vars = ('latency process',)
-        self.pid = str(os.getpid())
-        self.pidset1 = {}; self.pidset2 = {}
-        info(1, 'Module dstat_topavglatency is still experimental.')
-
-    def check(self):
-        if not os.access('/proc/self/schedstat', os.R_OK):
-            raise Exception, 'Kernel has no scheduler statistics, use at least 2.6.12'
-
-    def extract(self):
-        self.val['result'] = 0
-        self.val['process'] = ''
-        for pid in os.listdir('/proc/'):
-            try:
-                ### Is it a pid ?
-                int(pid)
-
-                ### Filter out dstat
-                if pid == self.pid: continue
-
-                ### Reset values
-                if not self.pidset1.has_key(pid):
-                    self.pidset1[pid] = {'wait_ticks': 0, 'ran': 0}
-
-                ### Extract name
-                name = open('/proc/%s/stat' % pid).read().split()[1][1:-1]
-
-                ### Extract counters
-                l = open('/proc/%s/schedstat' % pid).read().split()
-
-            except ValueError:
-                continue
-            except IOError:
-                continue
-
-            if len(l) != 3: continue
-
-            self.pidset2[pid] = {'wait_ticks': long(l[1]), 'ran': long(l[2])}
-
-            if self.pidset2[pid]['ran'] - self.pidset1[pid]['ran'] &gt; 0:
-                avgwait = (self.pidset2[pid]['wait_ticks'] - self.pidset1[pid]['wait_ticks']) * 1.0 / (self.pidset2[pid]['ran'] - self.pidset1[pid]['ran']) / elapsed
-            else:
-                avgwait = 0
-
-            ### Get the process that spends the most jiffies
-            if avgwait &gt; self.val['result']:
-                self.val['result'] = avgwait
-                self.val['pid'] = pid
-                self.val['name'] = getnamebypid(pid, name)
-
-        if step == op.delay:
-            for pid in self.pidset2.keys():
-                self.pidset1[pid].update(self.pidset2[pid])
-
-        if self.val['result'] != 0.0:
-            self.val['latency process'] = '%-*s%s' % (self.width-4, self.val['name'][0:self.width-4], cprint(self.val['result'], 'f', 4, 100))
-
-        ### Debug (show PID)
-#       self.val['latency process'] = '%*s %-*s' % (5, self.val['pid'], self.width-6, self.val['name'])
-
-    def showcsv(self):
-        return '%s / %.4f' % (self.val['name'], self.val['result'])
-
-# vim:ts=4:sw=4:et

Deleted: trunk/tools/dstat/plugins/dstat_topbio.py
===================================================================
--- trunk/tools/dstat/plugins/dstat_topbio.py	2009-11-21 14:08:12 UTC (rev 8035)
+++ trunk/tools/dstat/plugins/dstat_topbio.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -1,78 +0,0 @@
-### Dstat most expensive block I/O process plugin
-### Displays the name of the most expensive block I/O process
-###
-### Authority: <A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>
-
-class dstat_topbio(dstat):
-    def __init__(self):
-        self.name = 'most expensive'
-        self.type = 's'
-        self.width = 22
-        self.scale = 0
-        self.nick = ('block i/o process',)
-        self.vars = self.nick
-        self.pid = str(os.getpid())
-        self.pidset1 = {}; self.pidset2 = {}
-
-    def check(self):
-        if not os.access('/proc/self/io', os.R_OK):
-            raise Exception, 'Kernel has no I/O accounting, use at least 2.6.20'
-
-    def extract(self):
-        self.val['usage'] = 0.0
-        self.val['block i/o process'] = ''
-        for pid in os.listdir('/proc/'):
-            try:
-                ### Is it a pid ?
-                int(pid)
-
-                ### Filter out dstat
-                if pid == self.pid: continue
-
-                ### Reset values
-                if not self.pidset2.has_key(pid):
-                    self.pidset2[pid] = {'read_bytes:': 0, 'write_bytes:': 0}
-                if not self.pidset1.has_key(pid):
-                    self.pidset1[pid] = {'read_bytes:': 0, 'write_bytes:': 0}
-
-                ### Extract name
-                name = open('/proc/%s/stat' % pid).read().split()[1][1:-1]
-
-                ### Extract counters
-                for line in open('/proc/%s/io' % pid).readlines():
-                    l = line.split()
-                    if len(l) != 2: continue
-                    self.pidset2[pid][l[0]] = int(l[1])
-
-            except ValueError:
-                continue
-            except IOError:
-                continue
-
-            read_usage = (self.pidset2[pid]['read_bytes:'] - self.pidset1[pid]['read_bytes:']) * 1.0 / elapsed
-            write_usage = (self.pidset2[pid]['write_bytes:'] - self.pidset1[pid]['write_bytes:']) * 1.0 / elapsed
-            usage = read_usage + write_usage
-
-            ### Get the process that spends the most jiffies
-            if usage &gt; self.val['usage']:
-                self.val['usage'] = usage
-                self.val['read_usage'] = read_usage
-                self.val['write_usage'] = write_usage
-                self.val['pid'] = pid
-                self.val['name'] = getnamebypid(pid, name)
-#                st = os.stat(&quot;/proc/%s&quot; % pid)
-
-        if step == op.delay:
-            for pid in self.pidset2.keys():
-                self.pidset1[pid].update(self.pidset2[pid])
-
-        if self.val['usage'] != 0.0:
-            self.val['block i/o process'] = '%-*s%s:%s' % (self.width-11, self.val['name'][0:self.width-11], cprint(self.val['read_usage'], 'd', 5, 1024), cprint(self.val['write_usage'], 'd', 5, 1024))
-
-        ### Debug (show PID)
-#        self.val['block i/o process'] = '%*s %-*s' % (5, self.val['pid'], self.width-6, self.val['name'])
-
-    def showcsv(self):
-        return '%s / %d:%d' % (self.val['name'], self.val['read_usage'], self.val['write_usage'])
-
-# vim:ts=4:sw=4:et

Deleted: trunk/tools/dstat/plugins/dstat_topcpu.py
===================================================================
--- trunk/tools/dstat/plugins/dstat_topcpu.py	2009-11-21 14:08:12 UTC (rev 8035)
+++ trunk/tools/dstat/plugins/dstat_topcpu.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -1,67 +0,0 @@
-### Dstat most expensive process plugin
-### Displays the name of the most expensive process
-###
-### Authority: <A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>
-
-global cpunr
-
-class dstat_topcpu(dstat):
-    def __init__(self):
-        self.name = 'most expensive'
-        self.type = 's'
-        self.width = 16
-        self.scale = 0
-        self.vars = ('cpu process',)
-        self.pid = str(os.getpid())
-        self.pidset1 = {}; self.pidset2 = {}
-
-    def extract(self):
-        self.val['max'] = 0.0
-        self.val['cpu process'] = ''
-        for pid in os.listdir('/proc/'):
-            try:
-                ### Is it a pid ?
-                int(pid)
-
-                ### Filter out dstat
-                if pid == self.pid: continue
-
-                ### Using dopen() will cause too many open files
-                l = open('/proc/%s/stat' % pid).read().split()
-
-            except ValueError:
-                continue
-            except IOError:
-                continue
-
-            if len(l) &lt; 15: continue
-
-            ### Reset previous value if it doesn't exist
-            if not self.pidset1.has_key(pid):
-                self.pidset1[pid] = 0
-
-            self.pidset2[pid] = int(l[13]) + int(l[14])
-            usage = (self.pidset2[pid] - self.pidset1[pid]) * 1.0 / elapsed / cpunr
-
-            ### Is it a new topper ?
-            if usage &lt; self.val['max']: continue
-
-            name = l[1][1:-1]
-
-            self.val['max'] = usage
-            self.val['pid'] = pid
-            self.val['name'] = getnamebypid(pid, name)
-
-        if self.val['max'] != 0.0:
-            self.val['cpu process'] = '%-*s%s' % (self.width-3, self.val['name'][0:self.width-3], cprint(self.val['max'], 'f', 3, 34))
-
-        ### Debug (show PID)
-#        self.val['cpu process'] = '%*s %-*s' % (5, self.val['pid'], self.width-6, self.val['name'])
-
-        if step == op.delay:
-            self.pidset1.update(self.pidset2)
-
-    def showcsv(self):
-        return '%s / %d%%' % (self.val['name'], self.val['max'])
-
-# vim:ts=4:sw=4:et

Deleted: trunk/tools/dstat/plugins/dstat_topcputime.py
===================================================================
--- trunk/tools/dstat/plugins/dstat_topcputime.py	2009-11-21 14:08:12 UTC (rev 8035)
+++ trunk/tools/dstat/plugins/dstat_topcputime.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -1,77 +0,0 @@
-### Authority: <A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>
-
-### For more information, see:
-###     <A HREF="http://eaglet.rain.com/rick/linux/schedstat/">http://eaglet.rain.com/rick/linux/schedstat/</A>
-
-class dstat_topcputime(dstat):
-    &quot;&quot;&quot;
-    Name and total amount of CPU time consumed in milliseconds of the process
-    that has the highest total amount of cputime for the measured timeframe.
-    &quot;&quot;&quot;
-
-    def __init__(self):
-        self.name = 'highest total'
-        self.type = 's'
-        self.width = 17
-        self.scale = 0
-        self.vars = ('cputime process',)
-        self.pid = str(os.getpid())
-        self.pidset1 = {}; self.pidset2 = {}
-        info(1, 'Module dstat_topcputime is still experimental.')
-
-    def check(self):
-        if not os.access('/proc/self/schedstat', os.R_OK):
-            raise Exception, 'Kernel has no scheduler statistics, use at least 2.6.12'
-
-    def extract(self):
-        self.val['result'] = 0
-        self.val['process'] = ''
-        for pid in os.listdir('/proc/'):
-            try:
-                ### Is it a pid ?
-                int(pid)
-
-                ### Filter out dstat
-                if pid == self.pid: continue
-
-                ### Reset values
-                if not self.pidset1.has_key(pid):
-                    self.pidset1[pid] = {'run_ticks': 0}
-
-                ### Extract name
-                name = open('/proc/%s/stat' % pid).read().split()[1][1:-1]
-
-                ### Extract counters
-                l = open('/proc/%s/schedstat' % pid).read().split()
-
-            except ValueError:
-                continue
-            except IOError:
-                continue
-
-            if len(l) != 3: continue
-
-            self.pidset2[pid] = {'run_ticks': long(l[0])}
-
-            totrun = (self.pidset2[pid]['run_ticks'] - self.pidset1[pid]['run_ticks']) * 1.0 / elapsed
-
-            ### Get the process that spends the most jiffies
-            if totrun &gt; self.val['result']:
-                self.val['result'] = totrun
-                self.val['pid'] = pid
-                self.val['name'] = getnamebypid(pid, name)
-
-        if step == op.delay:
-            for pid in self.pidset2.keys():
-                self.pidset1[pid].update(self.pidset2[pid])
-
-        if self.val['result'] != 0.0:
-            self.val['cputime process'] = '%-*s%s' % (self.width-4, self.val['name'][0:self.width-4], cprint(self.val['result'], 'f', 4, 100))
-
-        ### Debug (show PID)
-#       self.val['cputime process'] = '%*s %-*s' % (5, self.val['pid'], self.width-6, self.val['name'])
-
-    def showcsv(self):
-        return '%s / %.4f' % (self.val['name'], self.val['result'])
-
-# vim:ts=4:sw=4:et

Deleted: trunk/tools/dstat/plugins/dstat_topio.py
===================================================================
--- trunk/tools/dstat/plugins/dstat_topio.py	2009-11-21 14:08:12 UTC (rev 8035)
+++ trunk/tools/dstat/plugins/dstat_topio.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -1,78 +0,0 @@
-### Dstat most expensive I/O process plugin
-### Displays the name of the most expensive I/O process
-###
-### Authority: <A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>
-
-class dstat_topio(dstat):
-    def __init__(self):
-        self.name = 'most expensive'
-        self.type = 's'
-        self.width = 22
-        self.scale = 0
-        self.vars = ('i/o process',)
-        self.pid = str(os.getpid())
-        self.pidset1 = {}; self.pidset2 = {}
-
-    def check(self):
-        if not os.access('/proc/self/io', os.R_OK):
-            raise Exception, 'Kernel has no I/O accounting, use at least 2.6.20'
-
-    def extract(self):
-        self.val['usage'] = 0.0
-        self.val['i/o process'] = ''
-        for pid in os.listdir('/proc/'):
-            try:
-                ### Is it a pid ?
-                int(pid)
-
-                ### Filter out dstat
-                if pid == self.pid: continue
-
-                ### Reset values
-                if not self.pidset2.has_key(pid):
-                    self.pidset2[pid] = {'rchar:': 0, 'wchar:': 0}
-                if not self.pidset1.has_key(pid):
-                    self.pidset1[pid] = {'rchar:': 0, 'wchar:': 0}
-
-                ### Extract name
-                name = open('/proc/%s/stat' % pid).read().split()[1][1:-1]
-
-                ### Extract counters
-                for line in open('/proc/%s/io' % pid).readlines():
-                    l = line.split()
-                    if len(l) != 2: continue
-                    self.pidset2[pid][l[0]] = int(l[1])
-
-            except ValueError:
-                continue
-            except IOError:
-                continue
-
-            read_usage = (self.pidset2[pid]['rchar:'] - self.pidset1[pid]['rchar:']) * 1.0 / elapsed
-            write_usage = (self.pidset2[pid]['wchar:'] - self.pidset1[pid]['wchar:']) * 1.0 / elapsed
-            usage = read_usage + write_usage
-#            if usage &gt; 0.0:
-#                print '%s %s:%s' % (pid, read_usage, write_usage)
-
-            ### Get the process that spends the most jiffies
-            if usage &gt; self.val['usage']:
-                self.val['usage'] = usage
-                self.val['read_usage'] = read_usage
-                self.val['write_usage'] = write_usage
-                self.val['pid'] = pid
-                self.val['name'] = getnamebypid(pid, name)
-
-        if step == op.delay:
-            for pid in self.pidset2.keys():
-                self.pidset1[pid].update(self.pidset2[pid])
-
-        if self.val['usage'] != 0.0:
-            self.val['i/o process'] = '%-*s%s:%s' % (self.width-11, self.val['name'][0:self.width-11], cprint(self.val['read_usage'], 'd', 5, 1024), cprint(self.val['write_usage'], 'd', 5, 1024))
-
-        ### Debug (show PID)
-#       self.val['i/o process'] = '%*s %-*s' % (5, self.val['pid'], self.width-6, self.val['name'])
-
-    def showcsv(self):
-        return '%s / %d:%d' % (self.val['name'], self.val['read_usage'], self.val['write_usage'])
-
-# vim:ts=4:sw=4:et

Deleted: trunk/tools/dstat/plugins/dstat_toplatency.py
===================================================================
--- trunk/tools/dstat/plugins/dstat_toplatency.py	2009-11-21 14:08:12 UTC (rev 8035)
+++ trunk/tools/dstat/plugins/dstat_toplatency.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -1,77 +0,0 @@
-### Authority: <A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>
-
-### For more information, see:
-###     <A HREF="http://eaglet.rain.com/rick/linux/schedstat/">http://eaglet.rain.com/rick/linux/schedstat/</A>
-
-class dstat_toplatency(dstat):
-    &quot;&quot;&quot;
-    Name and total amount of CPU time waited in milliseconds of the process
-    that has the highest total amount waited for the measured timeframe.
-    &quot;&quot;&quot;
-
-    def __init__(self):
-        self.name = 'highest total'
-        self.type = 's'
-        self.width = 17
-        self.scale = 0
-        self.vars = ('latency process',)
-        self.pid = str(os.getpid())
-        self.pidset1 = {}; self.pidset2 = {}
-        info(1, 'Module dstat_toplatency is still experimental.')
-
-    def check(self):
-        if not os.access('/proc/self/schedstat', os.R_OK):
-            raise Exception, 'Kernel has no scheduler statistics, use at least 2.6.12'
-
-    def extract(self):
-        self.val['result'] = 0
-        self.val['process'] = ''
-        for pid in os.listdir('/proc/'):
-            try:
-                ### Is it a pid ?
-                int(pid)
-
-                ### Filter out dstat
-                if pid == self.pid: continue
-
-                ### Reset values
-                if not self.pidset1.has_key(pid):
-                    self.pidset1[pid] = {'wait_ticks': 0}
-
-                ### Extract name
-                name = open('/proc/%s/stat' % pid).read().split()[1][1:-1]
-
-                ### Extract counters
-                l = open('/proc/%s/schedstat' % pid).read().split()
-
-            except ValueError:
-                continue
-            except IOError:
-                continue
-
-            if len(l) != 3: continue
-
-            self.pidset2[pid] = {'wait_ticks': long(l[1])}
-
-            totwait = (self.pidset2[pid]['wait_ticks'] - self.pidset1[pid]['wait_ticks']) * 1.0 / elapsed
-
-            ### Get the process that spends the most jiffies
-            if totwait &gt; self.val['result']:
-                self.val['result'] = totwait
-                self.val['pid'] = pid
-                self.val['name'] = getnamebypid(pid, name)
-
-        if step == op.delay:
-            for pid in self.pidset2.keys():
-                self.pidset1[pid].update(self.pidset2[pid])
-
-        if self.val['result'] != 0.0:
-            self.val['latency process'] = '%-*s%s' % (self.width-4, self.val['name'][0:self.width-4], cprint(self.val['result'], 'f', 4, 100))
-
-        ### Debug (show PID)
-#       self.val['latency process'] = '%*s %-*s' % (5, self.val['pid'], self.width-6, self.val['name'])
-
-    def showcsv(self):
-        return '%s / %.4f' % (self.val['name'], self.val['result'])
-
-# vim:ts=4:sw=4:et

Deleted: trunk/tools/dstat/plugins/dstat_topmem.py
===================================================================
--- trunk/tools/dstat/plugins/dstat_topmem.py	2009-11-21 14:08:12 UTC (rev 8035)
+++ trunk/tools/dstat/plugins/dstat_topmem.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -1,51 +0,0 @@
-### Dstat most expensive process plugin
-### Displays the name of the most expensive process
-###
-### Authority: <A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>
-
-class dstat_topmem(dstat):
-    def __init__(self):
-        self.name = 'most expensive'
-        self.type = 's'
-        self.width = 17
-        self.scale = 0
-        self.vars = ('memory process',)
-        self.pid = str(os.getpid())
-
-    def extract(self):
-        self.val['max'] = 0.0
-        for pid in os.listdir('/proc/'):
-            try:
-                ### Is it a pid ?
-                int(pid)
-
-                ### Filter out dstat
-                if pid == self.pid: continue
-
-                ### Using dopen() will cause too many open files
-                l = open('/proc/%s/stat' % pid).read().split()
-
-            except ValueError:
-                continue
-            except IOError:
-                continue
-
-            if len(l) &lt; 23: continue
-            usage = int(l[23]) * pagesize
-
-            ### Is it a new topper ?
-            if usage &lt;= self.val['max']: continue
-
-            self.val['max'] = usage
-            self.val['name'] = getnamebypid(pid, l[1][1:-1])
-            self.val['pid'] = pid
-
-        self.val['memory process'] = '%-*s%s' % (self.width-5, self.val['name'][0:self.width-5], cprint(self.val['max'], 'f', 5, 1024))
-
-        ### Debug (show PID)
-#       self.val['memory process'] = '%*s %-*s' % (5, self.val['pid'], self.width-6, self.val['name'])
-
-    def showcsv(self):
-        return '%s / %d%%' % (self.val['name'], self.val['max'])
-
-# vim:ts=4:sw=4:et

Deleted: trunk/tools/dstat/plugins/dstat_topoom.py
===================================================================
--- trunk/tools/dstat/plugins/dstat_topoom.py	2009-11-21 14:08:12 UTC (rev 8035)
+++ trunk/tools/dstat/plugins/dstat_topoom.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -1,60 +0,0 @@
-### Dstat most expensive process plugin
-### Displays the name of the most expensive process
-###
-### Authority: <A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>
-
-class dstat_topoom(dstat):
-    def __init__(self):
-        self.name = 'out of memory'
-        self.type = 's'
-        self.width = 18
-        self.scale = 0
-        self.vars = ('kill score',)
-        self.pid = str(os.getpid())
-
-    def check(self):
-        if not os.access('/proc/self/oom_score', os.R_OK):
-            raise Exception, 'Kernel does not support /proc/pid/oom_score, use at least 2.6.11.'
-
-    def extract(self):
-        self.val['max'] = 0.0
-        self.val['kill score'] = ''
-        for pid in os.listdir('/proc/'):
-            try:
-                ### Is it a pid ?
-                int(pid)
-
-                ### Filter out dstat
-                if pid == self.pid: continue
-
-                ### Extract name
-                name = open('/proc/%s/stat' % pid).read().split()[1][1:-1]
-
-                ### Using dopen() will cause too many open files
-                l = open('/proc/%s/oom_score' % pid).read().split()
-
-            except ValueError:
-                continue
-            except IOError:
-                continue
-
-            if len(l) &lt; 1: continue
-            oom_score = int(l[0])
-
-            ### Is it a new topper ?
-            if oom_score &lt;= self.val['max']: continue
-
-            self.val['max'] = oom_score
-            self.val['name'] = getnamebypid(pid, name)
-            self.val['pid'] = pid
-
-        if self.val['max'] != 0.0:
-            self.val['kill score'] = '%-*s%s' % (self.width-4, self.val['name'][0:self.width-4], cprint(self.val['max'], 'f', 4, 1000))
-
-        ### Debug (show PID)
-#       self.val['kill score'] = '%*s %-*s' % (5, self.val['pid'], self.width-6, self.val['name'])
-
-    def showcsv(self):
-        return '%s / %d%%' % (self.val['name'], self.val['max'])
-
-# vim:ts=4:sw=4:et

Modified: trunk/tools/dstat/plugins/dstat_utmp.py
===================================================================
--- trunk/tools/dstat/plugins/dstat_utmp.py	2009-11-21 14:08:12 UTC (rev 8035)
+++ trunk/tools/dstat/plugins/dstat_utmp.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -1,4 +1,4 @@
-class dstat_utmp(dstat):
+class dstat_plugin(dstat):
     def __init__(self):
         self.name = 'utmp'
         self.type = 'd'

Copied: trunk/tools/dstat/plugins/dstat_vm_memctl.py (from rev 8028, trunk/tools/dstat/plugins/dstat_vmmemctl.py)
===================================================================
--- trunk/tools/dstat/plugins/dstat_vm_memctl.py	                        (rev 0)
+++ trunk/tools/dstat/plugins/dstat_vm_memctl.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -0,0 +1,33 @@
+### VMware vmmemctl stats
+### Displays ballooning status inside VMware VMs. 
+### The vmmemctl from the VMware Tools needs to be loaded.
+### This plugin has been tested on a VM running CentOS5 with the open-vm-tools, on ESX3.5
+###
+### Authority: <A HREF="http://lists.repoforge.org/mailman/listinfo/commits">bert+dstat at debruijn.be</A>
+
+# NB Data comes from /proc/vmmemctl
+
+class dstat_plugin(dstat):
+    def __init__(self):
+        self.name = 'memctl'
+        self.type = 'f'
+        self.width = 6
+        self.scale = 1024
+        self.open('/proc/vmmemctl')
+        self.nick = ('size',)
+        self.vars = ('balloon',)
+
+    def check(self): 
+        try:
+            os.stat('/proc/vmmemctl')
+        except:
+            raise Exception, 'Needs VMware Tools (modprobe vmmemctl)'
+
+    def extract(self):
+        for l in self.splitlines():
+            if len(l) &lt; 3: continue
+            if l[0] != 'current:': continue
+            if l[2] != 'pages': continue
+            self.val['balloon'] = int(l[1]) * 4096.0
+            break
+# vim:ts=4:sw=4

Copied: trunk/tools/dstat/plugins/dstat_vmk_hba.py (from rev 8032, trunk/tools/dstat/plugins/dstat_vmkhba.py)
===================================================================
--- trunk/tools/dstat/plugins/dstat_vmk_hba.py	                        (rev 0)
+++ trunk/tools/dstat/plugins/dstat_vmk_hba.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -0,0 +1,81 @@
+### VMware ESX kernel vmhba stats
+### Displays kernel vmhba statistics on VMware ESX servers
+###
+### Authority: <A HREF="http://lists.repoforge.org/mailman/listinfo/commits">bert+dstat at debruijn.be</A>
+
+# NOTE TO USERS: command-line plugin configuration is not yet possible, so I've
+# &quot;borrowed&quot; the -D argument. 
+# EXAMPLES:
+# # dstat --vmkhba -D vmhba1,vmhba2,total
+# # dstat --vmkhba -D vmhba0
+# You can even combine the Linux and VMkernel diskstats (but the &quot;total&quot; argument
+# will be used by both).
+# # dstat --vmkhba -d -D sda,vmhba1
+
+class dstat_plugin(dstat):
+    def __init__(self):
+        self.name = 'vmkhba'
+        self.discover = self.discover()
+        self.nick = ('read', 'writ')
+        self.cols = 2
+
+    def discover(self, *list):
+    # discover will list all vmhba's found.
+    # we might want to filter out the unused vmhba's (read stats, compare with ['0', ] * 13)
+        ret = []
+        try:
+            list = os.listdir('/proc/vmware/scsi/')
+        except:
+            raise Exception, 'Needs VMware ESX'
+        for name in list:
+            for line in dopen('/proc/vmware/scsi/%s/stats' % name).readlines():
+                l = line.split()
+                if len(l) &lt; 13: continue
+                if l[0] == 'cmds': continue
+                if l == ['0', ] * 13: continue
+                ret.append(name)
+        return ret
+
+    def vars(self):
+    # vars will take the argument list - when implemented - , use total, or will use discover + total
+        ret = []
+        if op.disklist:
+            list = op.disklist
+        #elif not op.full:
+        #   list = ('total', )
+        else:
+            list = self.discover
+            list.sort()
+        for name in list:
+            if name in self.discover + ['total']:
+                ret.append(name)
+        return ret
+
+    def check(self): 
+        try:
+            os.listdir('/proc/vmware')
+        except:
+            raise Exception, 'Needs VMware ESX'
+        info(1, 'The vmkhba module is an EXPERIMENTAL module.')
+
+    def extract(self):
+        self.set2['total'] = (0, 0)
+        for name in self.vars:
+            self.set2[name] = (0, 0)
+        for name in os.listdir('/proc/vmware/scsi/'):
+            for line in dopen('/proc/vmware/scsi/%s/stats' % name).readlines():
+                l = line.split()
+                if len(l) &lt; 13: continue
+                if l[0] == 'cmds': continue
+                if l[2] == '0' and l[4] == '0': continue
+                if l == ['0', ] * 13: continue
+                self.set2['total'] = ( self.set2['total'][0] + long(l[2]), self.set2['total'][1] + long(l[4]) )
+                if name in self.vars and name != 'total':
+                    self.set2[name] = ( long(l[2]), long(l[4]) )
+            for name in self.set2.keys():
+                self.val[name] = (
+                    (self.set2[name][0] - self.set1[name][0]) * 1024.0 / elapsed,
+                    (self.set2[name][1] - self.set1[name][1]) * 1024.0 / elapsed,
+                )
+        if step == op.delay:
+            self.set1.update(self.set2)

Copied: trunk/tools/dstat/plugins/dstat_vmk_int.py (from rev 8032, trunk/tools/dstat/plugins/dstat_vmkint.py)
===================================================================
--- trunk/tools/dstat/plugins/dstat_vmk_int.py	                        (rev 0)
+++ trunk/tools/dstat/plugins/dstat_vmk_int.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -0,0 +1,97 @@
+### VMware ESX kernel interrupt stats
+### Displays kernel interrupt statistics on VMware ESX servers
+###
+### Authority: <A HREF="http://lists.repoforge.org/mailman/listinfo/commits">bert+dstat at debruijn.be</A>
+
+# NOTE TO USERS: command-line plugin configuration is not yet possible, so I've
+# &quot;borrowed&quot; the -I argument. 
+# EXAMPLES:
+# # dstat --vmkint -I 0x46,0x5a
+# You can even combine the Linux and VMkernel interrupt stats
+# # dstat --vmkint -i -I 14,0x5a
+# Look at /proc/vmware/interrupts to see which interrupt is linked to which function
+
+class dstat_plugin(dstat):
+    def __init__(self):
+        self.name = 'vmkint'
+        self.open('/proc/vmware/interrupts')
+        self.discover = self.discover()
+        self.type = 'd'
+        self.width = 4
+        self.scale = 1000
+#       self.intmap = self.intmap()
+
+#   def intmap(self):
+#       ret = {}
+#       for line in dopen('/proc/vmware/interrupts').readlines():
+#           l = line.split()
+#           if len(l) &lt;= self.vmkcpunr: continue
+#           l1 = l[0].split(':')[0]
+#           l2 = ' '.join(l[vmkcpunr()+1:]).split(',')
+#           ret[l1] = l1
+#           for name in l2:
+#               ret[name.strip().lower()] = l1
+#           return ret
+
+    def vmkcpunr(self):
+        #the service console sees only one CPU, so cpunr == 1, only the vmkernel sees all CPUs
+        ret = []
+        # default cpu number is 2
+        ret = 2
+        for l in self.fd[0].splitlines():
+            if l[0] == 'Vector': 
+                ret = int( int( l[-1] ) + 1 )
+        return ret
+
+    def discover(self):
+        #interrupt names are not decimal numbers, but rather hexadecimal numbers like 0x7e
+        ret = []
+        self.fd[0].seek(0)
+        for line in self.fd[0].readlines():
+            l = line.split()
+            if l[0] == 'Vector': continue
+            if len(l) &lt; self.vmkcpunr()+1: continue
+            name = l[0].split(':')[0]
+            amount = 0
+            for i in l[1:1+self.vmkcpunr()]:
+                amount = amount + long(i)
+            if amount &gt; 20: ret.append(str(name))
+        return ret
+
+    def vars(self):
+        ret = []
+        if op.intlist:
+            list = op.intlist
+        else:
+            list = self.discover
+#           len(list) &gt; 5: list = list[-5:]
+        for name in list:
+            if name in self.discover:
+                ret.append(name)
+#           elif name.lower() in self.intmap.keys():
+#               ret.append(self.intmap[name.lower()])
+        return ret
+
+    def check(self): 
+        try:
+            os.listdir('/proc/vmware')
+        except:
+            raise Exception, 'Needs VMware ESX'
+        info(1, 'The vmkint module is an EXPERIMENTAL module.')
+
+    def extract(self):
+        self.fd[0].seek(0)
+        for line in self.fd[0].readlines():
+            l = line.split()
+            if len(l) &lt; self.vmkcpunr()+1: continue
+            name = l[0].split(':')[0]
+            if name in self.vars:
+                self.set2[name] = 0
+                for i in l[1:1+self.vmkcpunr()]:
+                    self.set2[name] = self.set2[name] + long(i)
+        for name in self.set2.keys():
+            self.val[name] = (self.set2[name] - self.set1[name]) * 1.0 / elapsed
+        if step == op.delay:
+            self.set1.update(self.set2)
+
+# vim:ts=4:sw=4

Copied: trunk/tools/dstat/plugins/dstat_vmk_nic.py (from rev 8032, trunk/tools/dstat/plugins/dstat_vmknic.py)
===================================================================
--- trunk/tools/dstat/plugins/dstat_vmk_nic.py	                        (rev 0)
+++ trunk/tools/dstat/plugins/dstat_vmk_nic.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -0,0 +1,78 @@
+### VMware ESX kernel vmknic stats
+### Displays VMkernel port statistics on VMware ESX servers
+###
+### Authority: <A HREF="http://lists.repoforge.org/mailman/listinfo/commits">bert+dstat at debruijn.be</A>
+
+# NOTE TO USERS: command-line plugin configuration is not yet possible, so I've
+# &quot;borrowed&quot; the -N argument.
+# EXAMPLES:
+# # dstat --vmknic -N vmk1
+# You can even combine the Linux and VMkernel network stats (just don't just &quot;total&quot;).
+# # dstat --vmknic -n -N vmk0,vswif0
+# NB Data comes from /proc/vmware/net/tcpip/ifconfig
+
+class dstat_plugin(dstat):
+    def __init__(self):
+        self.name = 'vmknic'
+        self.open('/proc/vmware/net/tcpip/ifconfig')
+        self.nick = ('recv', 'send')
+        self.cols = 2
+
+    def check(self):
+        try:
+            os.listdir('/proc/vmware')
+        except:
+            raise Exception, 'Needs VMware ESX'
+        info(1, 'The vmknic module is an EXPERIMENTAL module.')
+
+    def discover(self, *list):
+        ret = []
+        for l in self.fd[0].splitlines(replace=' /', delim='/'):
+            if len(l) != 12: continue
+            if l[2][:5] == '&lt;Link': continue
+            if ','.join(l) == 'Name,Mtu/TSO,Network,Address,Ipkts,Ierrs,Ibytes,Opkts,Oerrs,Obytes,Coll,Time': continue
+            if l[0] == 'lo0': continue
+            if l[0] == 'Usage:': continue
+            ret.append(l[0])
+        ret.sort()
+        for item in list: ret.append(item)
+        return ret
+
+    def vars(self):
+        ret = []
+        if op.netlist:
+            list = op.netlist
+        else:
+            list = self.discover
+            list.sort()
+        for name in list:
+            if name in self.discover + ['total']:
+                ret.append(name)
+        return ret
+
+    def name(self):
+        return ['net/'+name for name in self.vars]
+
+    def extract(self):
+        self.set2['total'] = [0, 0]
+        for line in self.readlines():
+            l = line.replace(' /','/').split()
+            if len(l) != 12: continue
+            if l[2][:5] == '&lt;Link': continue
+            if ','.join(l) == 'Name,Mtu/TSO,Network,Address,Ipkts,Ierrs,Ibytes,Opkts,Oerrs,Obytes,Coll,Time': continue
+            if l[0] == 'Usage:': continue
+            name = l[0]
+            if name in self.vars:
+                self.set2[name] = ( long(l[6]), long(l[9]) )
+            if name != 'lo0':
+                self.set2['total'] = ( self.set2['total'][0] + long(l[6]), self.set2['total'][1] + long(l[9]) )
+        if update:
+            for name in self.set2.keys():
+                self.val[name] = (
+                    (self.set2[name][0] - self.set1[name][0]) * 1.0 / elapsed,
+                    (self.set2[name][1] - self.set1[name][1]) * 1.0 / elapsed,
+                )
+        if step == op.delay:
+            self.set1.update(self.set2)
+
+# vim:ts=4:sw=4

Deleted: trunk/tools/dstat/plugins/dstat_vmkhba.py
===================================================================
--- trunk/tools/dstat/plugins/dstat_vmkhba.py	2009-11-21 14:08:12 UTC (rev 8035)
+++ trunk/tools/dstat/plugins/dstat_vmkhba.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -1,81 +0,0 @@
-### VMware ESX kernel vmhba stats
-### Displays kernel vmhba statistics on VMware ESX servers
-###
-### Authority: <A HREF="http://lists.repoforge.org/mailman/listinfo/commits">bert+dstat at debruijn.be</A>
-
-# NOTE TO USERS: command-line plugin configuration is not yet possible, so I've
-# &quot;borrowed&quot; the -D argument. 
-# EXAMPLES:
-# # dstat -M vmkhba -D vmhba1,vmhba2,total
-# # dstat -M vmkhba -D vmhba0
-# You can even combine the Linux and VMkernel diskstats (but the &quot;total&quot; argument
-# will be used by both).
-# # dstat -M vmkhba -d -D sda,vmhba1
-
-class dstat_vmkhba(dstat):
-    def __init__(self):
-        self.name = 'vmkhba'
-        self.discover = self.discover()
-        self.nick = ('read', 'writ')
-        self.cols = 2
-        info(1, 'The vmkhba module is an EXPERIMENTAL module.')
-
-    def discover(self, *list):
-    # discover will list all vmhba's found.
-    # we might want to filter out the unused vmhba's (read stats, compare with ['0', ] * 13)
-        ret = []
-        try:
-            list = os.listdir('/proc/vmware/scsi/')
-        except:
-            raise Exception, 'Needs VMware ESX'
-        for name in list:
-            for line in dopen('/proc/vmware/scsi/%s/stats' % name).readlines():
-                l = line.split()
-                if len(l) &lt; 13: continue
-                if l[0] == 'cmds': continue
-                if l == ['0', ] * 13: continue
-                ret.append(name)
-        return ret
-
-    def vars(self):
-    # vars will take the argument list - when implemented - , use total, or will use discover + total
-        ret = []
-        if op.disklist:
-            list = op.disklist
-        #elif not op.full:
-        #   list = ('total', )
-        else:
-            list = self.discover
-            list.sort()
-        for name in list:
-            if name in self.discover + ['total']:
-                ret.append(name)
-        return ret
-
-    def check(self): 
-        try:
-            os.listdir('/proc/vmware')
-        except:
-            raise Exception, 'Needs VMware ESX'
-
-    def extract(self):
-        self.set2['total'] = (0, 0)
-        for name in self.vars:
-            self.set2[name] = (0, 0)
-        for name in os.listdir('/proc/vmware/scsi/'):
-            for line in dopen('/proc/vmware/scsi/%s/stats' % name).readlines():
-                l = line.split()
-                if len(l) &lt; 13: continue
-                if l[0] == 'cmds': continue
-                if l[2] == '0' and l[4] == '0': continue
-                if l == ['0', ] * 13: continue
-                self.set2['total'] = ( self.set2['total'][0] + long(l[2]), self.set2['total'][1] + long(l[4]) )
-                if name in self.vars and name != 'total':
-                    self.set2[name] = ( long(l[2]), long(l[4]) )
-            for name in self.set2.keys():
-                self.val[name] = (
-                    (self.set2[name][0] - self.set1[name][0]) * 1024.0 / elapsed,
-                    (self.set2[name][1] - self.set1[name][1]) * 1024.0 / elapsed,
-                )
-        if step == op.delay:
-            self.set1.update(self.set2)

Deleted: trunk/tools/dstat/plugins/dstat_vmkint.py
===================================================================
--- trunk/tools/dstat/plugins/dstat_vmkint.py	2009-11-21 14:08:12 UTC (rev 8035)
+++ trunk/tools/dstat/plugins/dstat_vmkint.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -1,97 +0,0 @@
-### VMware ESX kernel interrupt stats
-### Displays kernel interrupt statistics on VMware ESX servers
-###
-### Authority: <A HREF="http://lists.repoforge.org/mailman/listinfo/commits">bert+dstat at debruijn.be</A>
-
-# NOTE TO USERS: command-line plugin configuration is not yet possible, so I've
-# &quot;borrowed&quot; the -I argument. 
-# EXAMPLES:
-# # dstat -M vmkint -I 0x46,0x5a
-# You can even combine the Linux and VMkernel interrupt stats
-# # dstat -M vmkint -i -I 14,0x5a
-# Look at /proc/vmware/interrupts to see which interrupt is linked to which function
-
-class dstat_vmkint(dstat):
-    def __init__(self):
-        self.name = 'vmkint'
-        self.open('/proc/vmware/interrupts')
-        self.discover = self.discover()
-        self.type = 'd'
-        self.width = 4
-        self.scale = 1000
-#       self.intmap = self.intmap()
-        info(1, 'The vmkint module is an EXPERIMENTAL module.')
-
-#   def intmap(self):
-#       ret = {}
-#       for line in dopen('/proc/vmware/interrupts').readlines():
-#           l = line.split()
-#           if len(l) &lt;= self.vmkcpunr: continue
-#           l1 = l[0].split(':')[0]
-#           l2 = ' '.join(l[vmkcpunr()+1:]).split(',')
-#           ret[l1] = l1
-#           for name in l2:
-#               ret[name.strip().lower()] = l1
-#           return ret
-
-    def vmkcpunr(self):
-        #the service console sees only one CPU, so cpunr == 1, only the vmkernel sees all CPUs
-        ret = []
-        # default cpu number is 2
-        ret = 2
-        for l in self.fd[0].splitlines():
-            if l[0] == 'Vector': 
-                ret = int( int( l[-1] ) + 1 )
-        return ret
-
-    def discover(self):
-        #interrupt names are not decimal numbers, but rather hexadecimal numbers like 0x7e
-        ret = []
-        self.fd[0].seek(0)
-        for line in self.fd[0].readlines():
-            l = line.split()
-            if l[0] == 'Vector': continue
-            if len(l) &lt; self.vmkcpunr()+1: continue
-            name = l[0].split(':')[0]
-            amount = 0
-            for i in l[1:1+self.vmkcpunr()]:
-                amount = amount + long(i)
-            if amount &gt; 20: ret.append(str(name))
-        return ret
-
-    def vars(self):
-        ret = []
-        if op.intlist:
-            list = op.intlist
-        else:
-            list = self.discover
-#           len(list) &gt; 5: list = list[-5:]
-        for name in list:
-            if name in self.discover:
-                ret.append(name)
-#           elif name.lower() in self.intmap.keys():
-#               ret.append(self.intmap[name.lower()])
-        return ret
-
-    def check(self): 
-        try:
-            os.listdir('/proc/vmware')
-        except:
-            raise Exception, 'Needs VMware ESX'
-
-    def extract(self):
-        self.fd[0].seek(0)
-        for line in self.fd[0].readlines():
-            l = line.split()
-            if len(l) &lt; self.vmkcpunr()+1: continue
-            name = l[0].split(':')[0]
-            if name in self.vars:
-                self.set2[name] = 0
-                for i in l[1:1+self.vmkcpunr()]:
-                    self.set2[name] = self.set2[name] + long(i)
-        for name in self.set2.keys():
-            self.val[name] = (self.set2[name] - self.set1[name]) * 1.0 / elapsed
-        if step == op.delay:
-            self.set1.update(self.set2)
-
-# vim:ts=4:sw=4

Deleted: trunk/tools/dstat/plugins/dstat_vmknic.py
===================================================================
--- trunk/tools/dstat/plugins/dstat_vmknic.py	2009-11-21 14:08:12 UTC (rev 8035)
+++ trunk/tools/dstat/plugins/dstat_vmknic.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -1,78 +0,0 @@
-### VMware ESX kernel vmknic stats
-### Displays VMkernel port statistics on VMware ESX servers
-###
-### Authority: <A HREF="http://lists.repoforge.org/mailman/listinfo/commits">bert+dstat at debruijn.be</A>
-
-# NOTE TO USERS: command-line plugin configuration is not yet possible, so I've
-# &quot;borrowed&quot; the -N argument.
-# EXAMPLES:
-# # dstat -M vmknic -N vmk1
-# You can even combine the Linux and VMkernel network stats (just don't just &quot;total&quot;).
-# # dstat -M vmknic -n -N vmk0,vswif0
-# NB Data comes from /proc/vmware/net/tcpip/ifconfig
-
-class dstat_vmknic(dstat):
-    def __init__(self):
-        self.name = 'vmknic'
-        self.open('/proc/vmware/net/tcpip/ifconfig')
-        self.nick = ('recv', 'send')
-        self.cols = 2
-        info(1, 'The vmknic module is an EXPERIMENTAL module.')
-
-    def discover(self, *list):
-        ret = []
-        for l in self.fd[0].splitlines(replace=' /', delim='/'):
-            if len(l) != 12: continue
-            if l[2][:5] == '&lt;Link': continue
-            if ','.join(l) == 'Name,Mtu/TSO,Network,Address,Ipkts,Ierrs,Ibytes,Opkts,Oerrs,Obytes,Coll,Time': continue
-            if l[0] == 'lo0': continue
-            if l[0] == 'Usage:': continue
-            ret.append(l[0])
-        ret.sort()
-        for item in list: ret.append(item)
-        return ret
-
-    def vars(self):
-        ret = []
-        if op.netlist:
-            list = op.netlist
-        else:
-            list = self.discover
-            list.sort()
-        for name in list:
-            if name in self.discover + ['total']:
-                ret.append(name)
-        return ret
-
-    def name(self):
-        return ['net/'+name for name in self.vars]
-
-    def check(self): 
-        try:
-            os.listdir('/proc/vmware')
-        except:
-            raise Exception, 'Needs VMware ESX'
-
-    def extract(self):
-        self.set2['total'] = [0, 0]
-        for line in self.readlines():
-            l = line.replace(' /','/').split()
-            if len(l) != 12: continue
-            if l[2][:5] == '&lt;Link': continue
-            if ','.join(l) == 'Name,Mtu/TSO,Network,Address,Ipkts,Ierrs,Ibytes,Opkts,Oerrs,Obytes,Coll,Time': continue
-            if l[0] == 'Usage:': continue
-            name = l[0]
-            if name in self.vars:
-                self.set2[name] = ( long(l[6]), long(l[9]) )
-            if name != 'lo0':
-                self.set2['total'] = ( self.set2['total'][0] + long(l[6]), self.set2['total'][1] + long(l[9]) )
-        if update:
-            for name in self.set2.keys():
-                self.val[name] = (
-                    (self.set2[name][0] - self.set1[name][0]) * 1.0 / elapsed,
-                    (self.set2[name][1] - self.set1[name][1]) * 1.0 / elapsed,
-                )
-        if step == op.delay:
-            self.set1.update(self.set2)
-
-# vim:ts=4:sw=4

Deleted: trunk/tools/dstat/plugins/dstat_vmmemctl.py
===================================================================
--- trunk/tools/dstat/plugins/dstat_vmmemctl.py	2009-11-21 14:08:12 UTC (rev 8035)
+++ trunk/tools/dstat/plugins/dstat_vmmemctl.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -1,33 +0,0 @@
-### VMware vmmemctl stats
-### Displays ballooning status inside VMware VMs. 
-### The vmmemctl from the VMware Tools needs to be loaded.
-### This plugin has been tested on a VM running CentOS5 with the open-vm-tools, on ESX3.5
-###
-### Authority: <A HREF="http://lists.repoforge.org/mailman/listinfo/commits">bert+dstat at debruijn.be</A>
-
-# NB Data comes from /proc/vmmemctl
-
-class dstat_vmmemctl(dstat):
-    def __init__(self):
-        self.name = 'memctl'
-        self.type = 'f'
-        self.width = 6
-        self.scale = 1024
-        self.open('/proc/vmmemctl')
-        self.nick = ('size',)
-        self.vars = ('balloon',)
-
-    def check(self): 
-        try:
-            os.stat('/proc/vmmemctl')
-        except:
-            raise Exception, 'Needs VMware Tools (modprobe vmmemctl)'
-
-    def extract(self):
-        for l in self.splitlines():
-            if len(l) &lt; 3: continue
-            if l[0] != 'current:': continue
-            if l[2] != 'pages': continue
-            self.val['balloon'] = int(l[1]) * 4096.0
-            break
-# vim:ts=4:sw=4

Copied: trunk/tools/dstat/plugins/dstat_vz_cpu.py (from rev 8028, trunk/tools/dstat/plugins/dstat_vzcpu.py)
===================================================================
--- trunk/tools/dstat/plugins/dstat_vz_cpu.py	                        (rev 0)
+++ trunk/tools/dstat/plugins/dstat_vz_cpu.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -0,0 +1,61 @@
+
+#Version: 2.2
+#VEID   user    nice    system   uptime     idle             strv   uptime          used           maxlat  totlat  numsched
+#302    142926  0       10252    152896388  852779112954062  0      427034187248480 1048603937010  0       0       0
+#301    27188   0       7896     152899846  853267000490282  0      427043845492614 701812592320   0       0       0
+
+class dstat_plugin(dstat):
+    def __init__(self):
+        self.type = 'p'
+        self.width = 3
+        self.scale = 34
+        self.open('/proc/vz/vestat')
+        self.nick = ('usr', 'sys', 'idl', 'nic')
+        self.cols = 4
+
+    def check(self):
+        info(1, 'Module %s is still experimental.' % self.filename)
+
+    def discover(self, *list):
+        ret = []
+        for l in self.splitlines():
+            if len(l) &lt; 6 or l[0] == 'VEID': continue
+            ret.append(l[0])
+        ret.sort()
+        for item in list: ret.append(item)
+        return ret
+
+    def name(self):
+        ret = []
+        for name in self.vars:
+            if name == 'total':
+                ret.append('total ve usage')
+            else:
+                ret.append('ve ' + name + ' usage')
+        return ret
+
+    def vars(self):
+        ret = []
+        if not op.full:
+            list = ('total', )
+        else: 
+            list = self.discover
+        for name in list: 
+            if name in self.discover + ['total']:
+                ret.append(name)
+        return ret
+
+    def extract(self):
+        self.set2['total'] = [0, 0, 0, 0]
+        for line in self.splitlines():
+            if len(l) &lt; 6 or l[0] == 'VEID': continue
+            name = l[0]
+            self.set2[name] = ( long(l[1]), long(l[3]), long(l[4]) - long(l[1]) - long(l[2]) - long(l[3]), long(l[2]) )
+            self.set2['total'] = ( self.set2['total'][0] + long(l[1]), self.set2['total'][1] + long(l[3]), self.set2['total'][2] + long(l[4]) - long(l[1]) - long(l[2]) - long(l[3]), self.set2['total'][3] + long(l[2]) )
+        for name in self.vars:
+            for i in range(4):
+                self.val[name][i] = 100.0 * (self.set2[name][i] - self.set1[name][i]) / (sum(self.set2[name]) - sum(self.set1[name]))
+        if step == op.delay:
+            self.set1.update(self.set2)
+
+# vim:ts=4:sw=4:et

Copied: trunk/tools/dstat/plugins/dstat_vz_io.py (from rev 8032, trunk/tools/dstat/plugins/dstat_vzio.py)
===================================================================
--- trunk/tools/dstat/plugins/dstat_vz_io.py	                        (rev 0)
+++ trunk/tools/dstat/plugins/dstat_vz_io.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -0,0 +1,66 @@
+### Example content for /proc/bc/&lt;veid&gt;/ioacct
+#       read                         2773011640320
+#       write                        2095707136000
+#       dirty                        4500342390784
+#       cancel                       4080624041984
+#       missed                                   0
+#       syncs_total                              2
+#       fsyncs_total                       1730732
+#       fdatasyncs_total                      3266
+#       range_syncs_total                        0
+#       syncs_active                             0
+#       fsyncs_active                            0
+#       fdatasyncs_active                        0
+#       range_syncs_active                       0
+#       vfs_reads                       3717331387
+#       vfs_read_chars         3559144863185798078
+#       vfs_writes                       901216138
+#       vfs_write_chars          23864660931174682
+#       io_pbs                                  16
+
+class dstat_plugin(dstat):
+    def __init__(self):
+        self.nick = ['read', 'write', 'dirty', 'cancel', 'missed']
+        self.cols = len(self.nick)
+
+    def check(self):
+        if not os.path.exists('/proc/vz'):
+            raise Exception, 'System does not have OpenVZ support'
+        elif not os.path.exists('/proc/bc'):
+            raise Exception, 'System does not have (new) OpenVZ beancounter support'
+        elif not glob.glob('/proc/bc/*/ioacct'):
+            raise Exception, 'System does not have any OpenVZ containers'
+        info(1, 'Module %s is still experimental.' % self.filename)
+
+    def name(self):
+        return ['ve/'+name for name in self.vars]
+
+    def vars(self):
+        ret = []
+        if not op.full:
+            varlist = ['total',]
+        else:
+            varlist = [os.path.basename(veid) for veid in glob.glob('/proc/vz/*')]
+        ret = varlist
+        return ret
+
+    def extract(self):
+        global update
+        for veid in self.vars:
+            self.set2['total'] = {}
+            for line in dopen('/proc/bc/%s/ioacct' % veid).readlines():
+#            for line in dopen('ioacct.%d' % (update % 3)).readlines():
+                l = line.split()
+                if len(l) != 2: continue
+                if l[0] not in self.nick: continue
+                index = self.nick.index(l[0])
+                self.set2[veid][index] = long(l[1])
+                self.set2['total'][index] = self.set2['total'][index] + long(l[1])
+#            print veid, self.val[veid], self.set2[veid][0], self.set2[veid][1]
+#            print veid, self.val[veid], self.set1[veid][0], self.set1[veid][1]
+            for i in range(len(self.nick)):
+                self.val[veid][i] = (self.set2[veid][i] - self.set1[veid][i]) / elapsed
+        if step == op.delay:
+            self.set1.update(self.set2)
+
+# vim:ts=4:sw=4:et

Copied: trunk/tools/dstat/plugins/dstat_vz_ubc.py (from rev 8032, trunk/tools/dstat/plugins/dstat_vzubc.py)
===================================================================
--- trunk/tools/dstat/plugins/dstat_vz_ubc.py	                        (rev 0)
+++ trunk/tools/dstat/plugins/dstat_vz_ubc.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -0,0 +1,64 @@
+class dstat_plugin(dstat):
+    def __init__(self):
+        self.type = 'd'
+        self.width = 5
+        self.scale = 1000
+        self.open('/proc/user_beancounters')
+        self.nick = ('fcnt', )
+        self.cols = 1 ### Is this correct ?
+
+    def check(self):
+        info(1, 'Module %s is still experimental.' % self.filename)
+
+    def discover(self, *list):
+        ret = []
+        for l in self.splitlines():
+            if len(l) &lt; 7 or l[0] in ('uid', '0:'): continue
+            ret.append(l[0][0:-1])
+        ret.sort()
+        for item in list: ret.append(item)
+        return ret
+
+    def name(self):
+        ret = []
+        for name in self.vars:
+            if name == 'total':
+                ret.append('total failcnt')
+            else:
+                ret.append(name)
+        return ret
+
+    def vars(self):
+        ret = []
+        if not op.full:
+            list = ('total', )
+        else: 
+            list = self.discover
+        for name in list: 
+            if name in self.discover + ['total']:
+                ret.append(name)
+        return ret
+
+    def extract(self):
+        for name in self.vars + ['total']:
+            self.set2[name] = 0
+        for l in self.splitlines():
+            if len(l) &lt; 6 or l[0] == 'uid':
+                continue
+            elif len(l) == 7:
+                name = l[0][0:-1]
+                if name in self.vars:
+                    self.set2[name] = self.set2[name] + long(l[6])
+                self.set2['total'] = self.set2['total'] + long(l[6])
+            elif name == '0':
+                continue
+            else:
+                if name in self.vars:
+                    self.set2[name] = self.set2[name] + long(l[5])
+                self.set2['total'] = self.set2['total'] + long(l[5])
+        for name in self.vars:
+            self.val[name] = (self.set2[name] - self.set1[name]) * 1.0 / elapsed
+        if step == op.delay:
+            self.set1.update(self.set2)
+
+# vim:ts=4:sw=4:et

Deleted: trunk/tools/dstat/plugins/dstat_vzcpu.py
===================================================================
--- trunk/tools/dstat/plugins/dstat_vzcpu.py	2009-11-21 14:08:12 UTC (rev 8035)
+++ trunk/tools/dstat/plugins/dstat_vzcpu.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -1,59 +0,0 @@
-
-#Version: 2.2
-#VEID   user    nice    system   uptime     idle             strv   uptime          used           maxlat  totlat  numsched
-#302    142926  0       10252    152896388  852779112954062  0      427034187248480 1048603937010  0       0       0
-#301    27188   0       7896     152899846  853267000490282  0      427043845492614 701812592320   0       0       0
-
-class dstat_vzcpu(dstat):
-    def __init__(self):
-        self.type = 'p'
-        self.width = 3
-        self.scale = 34
-        self.open('/proc/vz/vestat')
-        self.nick = ('usr', 'sys', 'idl', 'nic')
-        self.cols = 4
-        info(1, 'Module dstat_vzcpu is still experimental.')
-
-    def discover(self, *list):
-        ret = []
-        for l in self.splitlines():
-            if len(l) &lt; 6 or l[0] == 'VEID': continue
-            ret.append(l[0])
-        ret.sort()
-        for item in list: ret.append(item)
-        return ret
-
-    def name(self):
-        ret = []
-        for name in self.vars:
-            if name == 'total':
-                ret.append('total ve usage')
-            else:
-                ret.append('ve ' + name + ' usage')
-        return ret
-
-    def vars(self):
-        ret = []
-        if not op.full:
-            list = ('total', )
-        else: 
-            list = self.discover
-        for name in list: 
-            if name in self.discover + ['total']:
-                ret.append(name)
-        return ret
-
-    def extract(self):
-        self.set2['total'] = [0, 0, 0, 0]
-        for line in self.splitlines():
-            if len(l) &lt; 6 or l[0] == 'VEID': continue
-            name = l[0]
-            self.set2[name] = ( long(l[1]), long(l[3]), long(l[4]) - long(l[1]) - long(l[2]) - long(l[3]), long(l[2]) )
-            self.set2['total'] = ( self.set2['total'][0] + long(l[1]), self.set2['total'][1] + long(l[3]), self.set2['total'][2] + long(l[4]) - long(l[1]) - long(l[2]) - long(l[3]), self.set2['total'][3] + long(l[2]) )
-        for name in self.vars:
-            for i in range(4):
-                self.val[name][i] = 100.0 * (self.set2[name][i] - self.set1[name][i]) / (sum(self.set2[name]) - sum(self.set1[name]))
-        if step == op.delay:
-            self.set1.update(self.set2)
-
-# vim:ts=4:sw=4:et

Deleted: trunk/tools/dstat/plugins/dstat_vzio.py
===================================================================
--- trunk/tools/dstat/plugins/dstat_vzio.py	2009-11-21 14:08:12 UTC (rev 8035)
+++ trunk/tools/dstat/plugins/dstat_vzio.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -1,66 +0,0 @@
-### Example content for /proc/bc/&lt;veid&gt;/ioacct
-#       read                         2773011640320
-#       write                        2095707136000
-#       dirty                        4500342390784
-#       cancel                       4080624041984
-#       missed                                   0
-#       syncs_total                              2
-#       fsyncs_total                       1730732
-#       fdatasyncs_total                      3266
-#       range_syncs_total                        0
-#       syncs_active                             0
-#       fsyncs_active                            0
-#       fdatasyncs_active                        0
-#       range_syncs_active                       0
-#       vfs_reads                       3717331387
-#       vfs_read_chars         3559144863185798078
-#       vfs_writes                       901216138
-#       vfs_write_chars          23864660931174682
-#       io_pbs                                  16
-
-class dstat_vzio(dstat):
-    def __init__(self):
-        self.nick = ['read', 'write', 'dirty', 'cancel', 'missed']
-        self.cols = len(self.nick)
-        info(1, 'Module dstat_vzio is still experimental.')
-
-    def name(self):
-        return ['ve/'+name for name in self.vars]
-
-    def vars(self):
-        ret = []
-        if not op.full:
-            varlist = ['total',]
-        else:
-            varlist = [os.path.basename(veid) for veid in glob.glob('/proc/vz/*')]
-        ret = varlist
-        return ret
-
-    def check(self):
-        if not os.path.exists('/proc/vz'):
-            raise Exception, 'System does not have OpenVZ support'
-        elif not os.path.exists('/proc/bc'):
-            raise Exception, 'System does not have (new) OpenVZ beancounter support'
-        elif not glob.glob('/proc/bc/*/ioacct'):
-            raise Exception, 'System does not have any OpenVZ containers'
-
-    def extract(self):
-        global update
-        for veid in self.vars:
-            self.set2['total'] = {}
-            for line in dopen('/proc/bc/%s/ioacct' % veid).readlines():
-#            for line in dopen('ioacct.%d' % (update % 3)).readlines():
-                l = line.split()
-                if len(l) != 2: continue
-                if l[0] not in self.nick: continue
-                index = self.nick.index(l[0])
-                self.set2[veid][index] = long(l[1])
-                self.set2['total'][index] = self.set2['total'][index] + long(l[1])
-#            print veid, self.val[veid], self.set2[veid][0], self.set2[veid][1]
-#            print veid, self.val[veid], self.set1[veid][0], self.set1[veid][1]
-            for i in range(len(self.nick)):
-                self.val[veid][i] = (self.set2[veid][i] - self.set1[veid][i]) / elapsed
-        if step == op.delay:
-            self.set1.update(self.set2)
-
-# vim:ts=4:sw=4:et

Deleted: trunk/tools/dstat/plugins/dstat_vzubc.py
===================================================================
--- trunk/tools/dstat/plugins/dstat_vzubc.py	2009-11-21 14:08:12 UTC (rev 8035)
+++ trunk/tools/dstat/plugins/dstat_vzubc.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -1,62 +0,0 @@
-class dstat_vzubc(dstat):
-    def __init__(self):
-        self.type = 'd'
-        self.width = 5
-        self.scale = 1000
-        self.open('/proc/user_beancounters')
-        self.nick = ('fcnt', )
-        self.cols = 1 ### Is this correct ?
-        info(1, 'Module dstat_vzubc is still experimental.')
-
-    def discover(self, *list):
-        ret = []
-        for l in self.splitlines():
-            if len(l) &lt; 7 or l[0] in ('uid', '0:'): continue
-            ret.append(l[0][0:-1])
-        ret.sort()
-        for item in list: ret.append(item)
-        return ret
-
-    def name(self):
-        ret = []
-        for name in self.vars:
-            if name == 'total':
-                ret.append('total failcnt')
-            else:
-                ret.append(name)
-        return ret
-
-    def vars(self):
-        ret = []
-        if not op.full:
-            list = ('total', )
-        else: 
-            list = self.discover
-        for name in list: 
-            if name in self.discover + ['total']:
-                ret.append(name)
-        return ret
-
-    def extract(self):
-        for name in self.vars + ['total']:
-            self.set2[name] = 0
-        for l in self.splitlines():
-            if len(l) &lt; 6 or l[0] == 'uid':
-                continue
-            elif len(l) == 7:
-                name = l[0][0:-1]
-                if name in self.vars:
-                    self.set2[name] = self.set2[name] + long(l[6])
-                self.set2['total'] = self.set2['total'] + long(l[6])
-            elif name == '0':
-                continue
-            else:
-                if name in self.vars:
-                    self.set2[name] = self.set2[name] + long(l[5])
-                self.set2['total'] = self.set2['total'] + long(l[5])
-        for name in self.vars:
-            self.val[name] = (self.set2[name] - self.set1[name]) * 1.0 / elapsed
-        if step == op.delay:
-            self.set1.update(self.set2)
-
-# vim:ts=4:sw=4:et

Modified: trunk/tools/dstat/plugins/dstat_wifi.py
===================================================================
--- trunk/tools/dstat/plugins/dstat_wifi.py	2009-11-21 14:08:12 UTC (rev 8035)
+++ trunk/tools/dstat/plugins/dstat_wifi.py	2009-11-24 01:46:30 UTC (rev 8036)
@@ -1,7 +1,7 @@
 global iwlibs
 from pythonwifi import iwlibs
 
-class dstat_wifi(dstat):
+class dstat_plugin(dstat):
     def __init__(self):
         self.name = 'wifi'
         self.type = 'd'


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="006830.html">[svn] r8035 - trunk/tools/dstat
</A></li>
	<LI>Next message: <A HREF="006832.html">[svn] r8037 - trunk/rpms/perl-WWW-Mechanize-Cached
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#6831">[ date ]</a>
              <a href="thread.html#6831">[ thread ]</a>
              <a href="subject.html#6831">[ subject ]</a>
              <a href="author.html#6831">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.repoforge.org/mailman/listinfo/commits">More information about the commits
mailing list</a><br>
</body></html>
