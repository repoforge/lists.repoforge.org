<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [svn] r6396 - in trunk/rpms: . mplayerplug-in svgalib vobcopy
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:commits%40lists.repoforge.org?Subject=Re:%20Re%3A%20%5Bsvn%5D%20r6396%20-%20in%20trunk/rpms%3A%20.%20mplayerplug-in%20svgalib%20vobcopy&In-Reply-To=%3C200807040231.m642VFFF024486%40surya.karan.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="005194.html">
   <LINK REL="Next"  HREF="005196.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[svn] r6396 - in trunk/rpms: . mplayerplug-in svgalib vobcopy</H1>
    <B>packagers at lists.rpmforge.net</B> 
    <A HREF="mailto:commits%40lists.repoforge.org?Subject=Re:%20Re%3A%20%5Bsvn%5D%20r6396%20-%20in%20trunk/rpms%3A%20.%20mplayerplug-in%20svgalib%20vobcopy&In-Reply-To=%3C200807040231.m642VFFF024486%40surya.karan.org%3E"
       TITLE="[svn] r6396 - in trunk/rpms: . mplayerplug-in svgalib vobcopy">packagers at lists.rpmforge.net
       </A><BR>
    <I>Fri Jul  4 04:31:15 CEST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="005194.html">[svn] r6395 - in trunk/rpms: . amrnb amrwb gsm liferea meld	perl-Nagios-Plugin syslinux
</A></li>
        <LI>Next message: <A HREF="005196.html">[svn] r6397 - in trunk/rpms: libshout tmux
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5195">[ date ]</a>
              <a href="thread.html#5195">[ thread ]</a>
              <a href="subject.html#5195">[ subject ]</a>
              <a href="author.html#5195">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: dag
Date: 2008-07-04 03:31:15 +0100 (Fri, 04 Jul 2008)
New Revision: 6396

Added:
   trunk/rpms/svgalib/
   trunk/rpms/svgalib/svgalib-1.4.3-fhs.patch
   trunk/rpms/svgalib/svgalib-1.9.21-cfg.patch
   trunk/rpms/svgalib/svgalib-1.9.21-demos.patch
   trunk/rpms/svgalib/svgalib-1.9.21-makefiles.patch
   trunk/rpms/svgalib/svgalib-1.9.25-kernel-2.6.26.patch
   trunk/rpms/svgalib/svgalib-todo
   trunk/rpms/svgalib/svgalib.spec
Modified:
   trunk/rpms/mplayerplug-in/mplayerplug-in.spec
   trunk/rpms/vobcopy/vobcopy.spec
Log:
Updates

Modified: trunk/rpms/mplayerplug-in/mplayerplug-in.spec
===================================================================
--- trunk/rpms/mplayerplug-in/mplayerplug-in.spec	2008-07-04 02:30:42 UTC (rev 6395)
+++ trunk/rpms/mplayerplug-in/mplayerplug-in.spec	2008-07-04 02:31:15 UTC (rev 6396)
@@ -7,27 +7,31 @@
 
 %{?dtag: %{expand: %%define %dtag 1}}
 
-%define mozilla seamonkey
-%{!?dtag:%define mozilla firefox}
-%{?el5:%define mozilla firefox}
-%{?fc7:%define mozilla firefox}
-%{?fc6:%define mozilla firefox}
+%define mozilla seamonkey-devel
 
+%{!?dtag:%define mozilla xulrunner-devel nspr-devel}
+%{?el5:%define mozilla nspr-devel xulrunner-devel}
+%{?fc7:%define mozilla firefox-devel}
+%{?fc6:%define mozilla firefox-devel}
+
 %{?fc4:%define _without_modxorg 1}
 %{?el4:%define _without_modxorg 1}
+%{?el4:%define mozilla seamonkey-devel}
 %{?fc3:%define _without_modxorg 1}
 %{?fc2:%define _without_modxorg 1}
 %{?fc1:%define _without_modxorg 1}
 %{?el3:%define _without_modxorg 1}
+%{?el3:%define mozilla seamonkey-devel}
 %{?rh9:%define _without_modxorg 1}
-%{?rh9:%define mozilla mozilla}
+%{?rh9:%define mozilla mozilla-devel}
 %{?rh7:%define _without_modxorg 1}
-%{?rh7:%define mozilla mozilla}
+%{?rh7:%define mozilla mozilla-devel}
 %{?el2:%define _without_modxorg 1}
+%{?el2:%define mozilla seamonkey-devel}
 
 Summary: Browser plugin for MPlayer
 Name: mplayerplug-in
-Version: 3.50
+Version: 3.55
 Release: 1
 License: GPL
 Group: Applications/Multimedia
@@ -36,7 +40,7 @@
 Source: <A HREF="http://dl.sf.net/mplayerplug-in/mplayerplug-in-%{version">http://dl.sf.net/mplayerplug-in/mplayerplug-in-%{version</A>}.tar.gz
 BuildRoot: %{_tmppath}/%{name}-%{version}-%{release}-root
 
-BuildRequires: %{mozilla}-devel, gtk2-devel &gt;= 2.2.1
+BuildRequires: %{mozilla}, gtk2-devel &gt;= 2.2.1
 BuildRequires: gcc-c++, gettext
 %{!?_without_modxorg:BuildRequires: libXt-devel, libXpm-devel}
 %{?_without_modxorg:BuildRequires: XFree86-devel}
@@ -51,7 +55,7 @@
 in your browser.
 
 %prep
-%setup -n %{name}
+%setup
 
 %build
 %configure
@@ -82,6 +86,9 @@
 %{_libdir}/mozilla/plugins/mplayerplug-in-wmp.xpt
 
 %changelog
+* Thu Jul 03 2008 Dag Wieers &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>&gt; - 3.55-1
+- Updated to release 3.55.
+
 * Sun Dec 02 2007 Dag Wieers &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>&gt; - 3.50-1
 - Updated to release 3.50.
 

Added: trunk/rpms/svgalib/svgalib-1.4.3-fhs.patch
===================================================================
--- trunk/rpms/svgalib/svgalib-1.4.3-fhs.patch	                        (rev 0)
+++ trunk/rpms/svgalib/svgalib-1.4.3-fhs.patch	2008-07-04 02:31:15 UTC (rev 6396)
@@ -0,0 +1,151 @@
+--- svgalib-1.4.3/doc/man1/savetextmode.1.debian	2004-07-16 17:36:23.000000000 +0200
++++ svgalib-1.4.3/doc/man1/savetextmode.1	2004-07-16 17:33:02.000000000 +0200
+@@ -10,7 +10,11 @@
+ .SH DESCRIPTION
+ These are simple scripts to save the SVGA register state when in textmode to the
+ files
+-.IR /tmp/fontdata &quot; and &quot; /tmp/textregs
++.IR /etc/vga/fontdata &quot; and &quot; /etc/vga/textregs
++.RI ( $HOME/.vga/fontdata &quot; and &quot; $HOME/.vga/textregs
++if directory
++.I /etc/vga
++is not writeable)
+ or to restore it from these files.
+ 
+ The actual utilities used are
+@@ -40,9 +44,13 @@
+ will understand.
+ 
+ .SH FILES
+-.I /tmp/fontdata
++.I /etc/vga/fontdata
++or
++.I $HOME/.vga/fontdata
+ .br
+-.I /tmp/textregs
++.I /etc/vga/textregs
++or
++.I $HOME/.vga/textregs
+ 
+ .SH SEE ALSO
+ 
+--- svgalib-1.4.3/doc/man1/svgakeymap.1.debian	2004-07-16 17:36:23.000000000 +0200
++++ svgalib-1.4.3/doc/man1/svgakeymap.1	2004-07-16 17:33:02.000000000 +0200
+@@ -9,7 +9,7 @@
+ Generates a keymap conversion file for
+ .BR svgalib (7)
+ from two keytable definitions. Keytables are searched for in
+-.I /usr/lib/kbd/keytables
++.I /lib/kbd/keymaps
+ and are automatically filtered through
+ .BR gzip (1)
+ if necessary.
+@@ -22,7 +22,7 @@
+ or piped in any creative manner you wish.
+ 
+ .SH FILES
+-.I /usr/lib/kbd/keytables/*.map[.gz]
++.I /lib/kbd/keymaps/*/*/*.map[.gz]
+ .RS
+ The system keytable files used by
+ .BR loadkeys &quot;(1).&quot;
+--- svgalib-1.4.3/doc/README.keymap.debian	2004-07-16 17:36:23.000000000 +0200
++++ svgalib-1.4.3/doc/README.keymap	2004-07-16 17:33:02.000000000 +0200
+@@ -83,7 +83,7 @@
+ equivalents in the layout expected by the program.
+ 
+ A program called svgakeymap is provided to generate these maps from the
+-keytable files in /usr/lib/kbd/keytables; you must have perl for it to work.
++keytable files in /lib/kbd/keymaps; you must have perl for it to work.
+ Creating a keymap file with svgakeymap is easy; to make a map to convert
+ scancodes from a US Dvorak keyboard to a US QWERTY keyboard as for our example
+ above:
+--- svgalib-1.4.3/utils/runx.debian	2004-07-16 17:36:24.000000000 +0200
++++ svgalib-1.4.3/utils/runx	2004-07-16 17:33:02.000000000 +0200
+@@ -5,8 +5,8 @@
+ # running X, and 'textmode' after. This will restore the textmode registers
+ # and the VGA palette in addition to the VGA font.
+ 
+-echo Saving font in /tmp/fontdata
+-restorefont -w /tmp/fontdata
++echo Saving font in $HOME/.fontdata
++restorefont -w $HOME/.fontdata
+ startx
+-echo Restoring font from /tmp/fontdata
+-restorefont -r /tmp/fontdata
++echo Restoring font from $HOME/.fontdata
++restorefont -r $HOME/.fontdata
+--- svgalib-1.4.3/utils/savetextmode.debian	2004-07-16 17:36:24.000000000 +0200
++++ svgalib-1.4.3/utils/savetextmode	2004-07-16 17:33:02.000000000 +0200
+@@ -1,4 +1,14 @@
+ #!/bin/sh
+-rm -f /etc/vga/textregs /etc/vga/fontdata
+-restoretextmode -w /etc/vga/textregs
+-restorefont -w /etc/vga/fontdata
++dir=/etc/vga
++if [ ! -w &quot;$dir&quot; ]; then
++  dir=&quot;$HOME/.vga&quot;
++  mkdir -p -m 700 &quot;$dir&quot;
++fi
++if [ -f /etc/textregs -o -f /etc/fontdata ]; then
++  echo &gt;&amp;2 &quot;WARNING: the textregs and fontdata files have moved in this&quot;
++  echo &gt;&amp;2 &quot;         release from /etc to /etc/vga; please remove or rename&quot;
++  echo &gt;&amp;2 &quot;         your old versions.&quot;
++fi
++rm -f &quot;$dir/textregs&quot; &quot;$dir/fontdata&quot;
++restoretextmode -w &quot;$dir/textregs&quot;
++restorefont -w &quot;$dir/fontdata&quot;
+--- svgalib-1.4.3/utils/svgakeymap.debian	2004-07-16 17:36:24.000000000 +0200
++++ svgalib-1.4.3/utils/svgakeymap	2004-07-16 17:33:02.000000000 +0200
+@@ -7,16 +7,16 @@
+ #   svgakeymap [physical_map [program_map]] &gt; output.keymap
+ #
+ # The conversion map is output to stdout; you may wish to redirect it.
+-# Keymaps are searched for in /usr/lib/kbd/keytables and are automatically
++# Keymaps are searched for in /lib/kbd/keymaps and are automatically
+ # filtered through gzip if necessary.
+ #
+ # Read the file README.keymap from the svgalib distribution for more info.
+ 
+-$ktd = &quot;/usr/lib/kbd/keytables/&quot;;
++$ktd = &quot;/lib/kbd/keymaps/&quot;;
+ if(scalar(@ARGV) &gt; 0) {
+     $inmap = $ARGV[0];
+ } else {
+-    $inmap = &quot;us&quot;;
++    $inmap = &quot;i386/qwerty/us&quot;;
+ }
+ if(scalar(@ARGV) &gt; 1) {
+     $outmap = $ARGV[1];
+@@ -34,7 +34,7 @@
+ 
+         unless(-e $bob) {
+             # Tack a .gz on it
+-            $bob .= &quot;.map&quot;;
++            $bob .= &quot;.kmap&quot;;
+             #print &quot;$bob\n&quot;;
+             
+             unless(-e $bob) {
+--- svgalib-1.4.3/utils/textmode.debian	2004-07-16 17:36:24.000000000 +0200
++++ svgalib-1.4.3/utils/textmode	2004-07-16 17:33:02.000000000 +0200
+@@ -1,4 +1,18 @@
+ #!/bin/sh
+-restoretextmode -r /etc/vga/textregs
+-restorefont -r /etc/vga/fontdata
++
++dir=/etc/vga
++[ -w &quot;$dir&quot; ] || dir=&quot;$HOME/.vga&quot;
++
++if [ -f &quot;$dir/textregs&quot; -o -f &quot;$dir/fontdata&quot; ]; then
++  restoretextmode -r &quot;$dir/textregs&quot;
++  restorefont -r &quot;$dir/fontdata&quot;
++elif [ -f /etc/textregs -o -f /etc/fontdata ]; then
++  echo &gt;&amp;2 &quot;WARNING: the textregs and fontdata files have moved in this&quot;
++  echo &gt;&amp;2 &quot;         release from /etc to /etc/vga; please remove or rename&quot;
++  echo &gt;&amp;2 &quot;         your old versions.&quot;
++  echo &quot;Using old location for data files.&quot;
++  restoretextmode -r /etc/textregs
++  restorefont -r /etc/fontdata
++fi
++
+ restorepalette

Added: trunk/rpms/svgalib/svgalib-1.9.21-cfg.patch
===================================================================
--- trunk/rpms/svgalib/svgalib-1.9.21-cfg.patch	                        (rev 0)
+++ trunk/rpms/svgalib/svgalib-1.9.21-cfg.patch	2008-07-04 02:31:15 UTC (rev 6396)
@@ -0,0 +1,115 @@
+--- svgalib-1.9.25/src/vga.c.defaultcfg	2005-10-25 13:13:56.000000000 +0200
++++ svgalib-1.9.25/src/vga.c	2006-07-17 13:11:20.000000000 +0200
+@@ -3710,7 +3710,9 @@
+         __svgalib_vesatext=1;
+         break;
+ #else
++#ifdef __i386__
+        fprintf(stderr,&quot;svgalib: Warning: VESA support not enabled!\n&quot;);
++#endif
+        break;
+ #endif
+     case 57: /* Vesa save bitmap */  
+--- svgalib-1.9.25/src/config/libvga.config.defaultcfg	2005-08-03 15:07:32.000000000 +0200
++++ svgalib-1.9.25/src/config/libvga.config	2006-07-17 13:19:14.000000000 +0200
+@@ -11,7 +11,7 @@
+ 
+ Helper /dev/svga
+ 
+-# NoHelper            # Disable use of the helper-kernelmodule (/dev/svga) and
++NoHelper              # Disable use of the helper-kernelmodule (/dev/svga) and
+                       # fallback to old ioperm/iopl and /dev/mem use.
+ 
+ # If you have two vga cards with the same pci vendor id, svgalib will try
+@@ -43,14 +43,14 @@
+ # mouse MouseMan	# Logitech MouseMan
+ # mouse Spaceball	# Spacetec Spaceball
+ # mouse IntelliMouse	# Microsoft IntelliMouse or Logitech MouseMan+ on serial port
+-# mouse IMPS2		# Microsoft IntelliMouse or Logitech MouseMan+ on PS/2 port
++mouse IMPS2		# Microsoft IntelliMouse or Logitech MouseMan+ on PS/2 port
+ # mouse pnp		# plug'n'pray
+ # mouse WacomGraphire   # Wacom Graphire tablet/mouse
+ # mouse DRMOUSE4DS	# Digital Research double-wheeled mouse
+ # mouse ExplorerPS2	# Microsoft Intellimouse Explorer PS/2
+ # mouse none		# None
+ 
+-mouse unconfigured
++# mouse unconfigured
+ 
+ # (DEBIAN NOTE: the mouse used to default to microsoft, but this was changed
+ #  to fix bug #13458. If your mouse used to work fine, you can simply change
+@@ -129,6 +129,7 @@
+ # want to specify a different device for svgalib to use
+ 
+ # mdev /dev/ttyS0 # mouse is at /dev/ttyS0
++mdev /dev/input/mice
+ 
+ # Some multiprotocol mice will need one of the following:
+ 
+@@ -346,35 +347,35 @@
+ # chipset VGA		# Standard VGA
+ # chipset EGA		# EGA
+ # chipset ET3000	# Tseng ET3000
+-# chipset ET4000	# Tseng ET4000
++# chipset ET4000	# Tseng ET4000 (only available on i386)
+ # chipset Cirrus	# Cirrus Logic GD542x/543x/544x
+-# chipset TVGA		# Trident TVGA8900/9000
++# chipset TVGA		# Trident TVGA8900/9000 (only available on i386)
+ # chipset Oak		# Oak Technologies 037/067/077
+ # chipset S3		# S3 chipsets
+ # chipset GVGA6400	# Genoa 6400
+ # chipset ARK		# ARK Logic
+ # chipset ATI		# old ATI VGA
+-# chipset Mach32	# ATI Mach32
++# chipset Mach32	# ATI Mach32 (only available on i386)
+ # chipset ALI		# ALI2301
+ # chipset Mach64	# ATI Mach64 - deprecated, use RAGE driver
+ # chipset ET6000        # Tseng ET6000
+ # chipset APM	 	# Alliance Technology AT 24/25/3D
+ # chipset NV3		# nVidia Riva 128
+-# chipset VESA          # nicely behaved Vesa Bioses
++# chipset VESA          # nicely behaved Vesa Bioses (only available on i386)
+ # chipset MX		# MX86251 (some Voodoo Rush boards)
+ # chipset PARADISE 	# WD90C31
+ # chipset RAGE		# RagePro (and might work with some older mach64)
+ # chipset BANSHEE	# Banshee/V3.
+ # chipset SIS		# SiS 5597/6326/620/530 cards / integrated vga.
+ # chipset I740		# Intel i740 based cards.
+-# chipset NEOMAGIC
++# chipset NEOMAGIC	# (only available on i386)
+ # chipset LAGUNA	# Cirrus Logic Laguna series (546X)
+ # chipset FBDEV		# Use kernel fbdev, instead of direct hardware.
+ # chipset G400		# Matrox Mystique/G100/G200/G400/G450
+ # chipset R128		# Ati Rage128 and Radeon
+ # chipset SAVAGE	# S3 chipsets Savage, Virge, and some Trio64
+ # chipset MILLENNIUM	# Matrox Millennium and Millennium II
+-# chipset I810		# Intel i810/815 integrated video
++# chipset I810		# Intel i810/815 integrated video (i386 only)
+ # chipset TRIDENT	# Trident PCI and AGP chipsets
+ # chipset RENDITION	# Rendition V2100/V2200
+ # chipset G450C2
+@@ -421,11 +422,11 @@
+ # Clockchip ICD2061A  # The only one supported right now
+ 
+ 
+-# VesaText	      # Helps the VESA driver with text mode restoration
+-		      # problems.
++VesaText	      # Helps the VESA driver with text mode restoration
++		      # problems (i386 only).
+ 
+-# VesaSave 14	      # changing value might help text mode restoring
+-		      # problems with VESA driver. Legal values: 0-15
++# VesaSave 14	      # changing value might help text mode restoring problems
++		      # with VESA driver (i386 only). Legal values: 0-15
+ 
+ # NoVCControl	      # Disables svgalib's finding a new VC if run
+ 		      # from X, also disables svgalib restoring textmode when
+@@ -439,7 +440,7 @@
+                       # me (<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">matan at svgalib.org</A>)
+ 
+ # NeoMagicLibretto100 # Enable if you have a NeoMagic card on a Toshiba
+-                      # Libretto 100, 110, etc
++                      # Libretto 100, 110, etc (i386 only).
+ 
+ # FbdevNoVga          # When this is set the FBDEV chipset drivers doesn't
+ 		      # (try to) use standardvga modes through the vga driver.

Added: trunk/rpms/svgalib/svgalib-1.9.21-demos.patch
===================================================================
--- trunk/rpms/svgalib/svgalib-1.9.21-demos.patch	                        (rev 0)
+++ trunk/rpms/svgalib/svgalib-1.9.21-demos.patch	2008-07-04 02:31:15 UTC (rev 6396)
@@ -0,0 +1,431 @@
+--- svgalib-1.9.21/demos/testgl.c.demos	2002-04-03 09:31:14.000000000 +0200
++++ svgalib-1.9.21/demos/testgl.c	2005-07-01 20:51:55.000000000 +0200
+@@ -184,7 +184,7 @@
+ 
+     if (!vga_hasmode(VGAMODE)) {
+ 	printf(&quot;Mode not available.\n&quot;);
+-	exit(-1);
++	return -1;
+     }
+     VIRTUAL = 0;		/* No virtual screen. */
+     if (vga_getmodeinfo(VGAMODE)-&gt;colors == 16 ||
+@@ -224,5 +224,5 @@
+     if (VIRTUAL)
+ 	gl_freecontext(backscreen);
+     vga_setmode(TEXT);
+-    exit(0);
++    return 0;
+ }
+--- svgalib-1.9.21/demos/vgatweak.c.demos	2000-08-06 12:20:02.000000000 +0200
++++ svgalib-1.9.21/demos/vgatweak.c	2005-07-01 20:51:55.000000000 +0200
+@@ -124,7 +124,7 @@
+ 	testmode(mode);
+     else {
+ 	printf(&quot;Error: Video mode not supported by driver\n&quot;);
+-	exit(-1);
++	return -1;
+     }
+     
+     return 0;
+--- svgalib-1.9.21/demos/linearfork.c.demos	2000-01-06 13:12:36.000000000 +0100
++++ svgalib-1.9.21/demos/linearfork.c	2005-07-01 20:51:55.000000000 +0200
+@@ -82,7 +82,7 @@
+ 
+     if (!vga_hasmode(vgamode)) {
+ 	printf(&quot;Mode not available.\n&quot;);
+-	exit(1);
++	return 1;
+     }
+     vga_setmode(vgamode);
+     vga_setlinearaddressing();
+@@ -95,7 +95,7 @@
+     /* purposes. */
+     if (keyboard_init()) {
+ 	printf(&quot;Could not initialize keyboard.\n&quot;);
+-	exit(1);
++	return 1;
+     }
+     /* Translate to 4 keypad cursor keys, and unify enter key. */
+     keyboard_translatekeys(TRANSLATE_CURSORKEYS | TRANSLATE_KEYPADENTER |
+@@ -161,5 +161,5 @@
+     keyboard_close();		/* Don't forget this! */
+ 
+     vga_setmode(TEXT);
+-    exit(0);
++    return 0;
+ }
+--- svgalib-1.9.21/demos/bg_test.c.demos	2000-01-06 13:12:36.000000000 +0100
++++ svgalib-1.9.21/demos/bg_test.c	2005-07-01 20:51:55.000000000 +0200
+@@ -9,6 +9,7 @@
+ #include &lt;stdio.h&gt;
+ #include &lt;stdlib.h&gt;
+ #include &lt;unistd.h&gt;
++#include &lt;string.h&gt;
+ #include &lt;strings.h&gt;
+ #include &lt;vga.h&gt;
+ #include &lt;vgagl.h&gt;
+--- svgalib-1.9.21/demos/accel.c.demos	2002-04-03 09:30:23.000000000 +0200
++++ svgalib-1.9.21/demos/accel.c	2005-07-01 20:51:55.000000000 +0200
+@@ -97,7 +97,7 @@
+ 
+     if (accelfuncs == 0) {
+ 	printf(&quot;No acceleration supported.\n&quot;);
+-	exit(0);
++	return 1;
+     }
+     printf(&quot;Accelflags: 0x%08X\n&quot;, accelfuncs);
+ 
+@@ -292,7 +292,7 @@
+ 	    );
+     }
+     vga_setmode(TEXT);
+-    exit(-1);
++    return 0;
+ }
+ 
+ 
+--- svgalib-1.9.21/demos/vgatest.c.demos	2005-01-27 11:34:16.000000000 +0100
++++ svgalib-1.9.21/demos/vgatest.c	2005-07-01 20:51:55.000000000 +0200
+@@ -275,7 +275,7 @@
+ 
+ 	if (mode &lt; 1 || mode &gt; GLASTMODE) {
+ 	    printf(&quot;Error: Mode number out of range \n&quot;);
+-	    exit(-1);
++	    return -1;
+ 	}
+     }
+     if (vga_hasmode(mode)) {
+@@ -285,7 +285,7 @@
+ 		}
+ 	} else {
+ 		printf(&quot;Error: Video mode not supported by driver\n&quot;);
+-		exit(-1);
++		return -1;
+     }
+     
+ 	vga_setmode(TEXT);
+--- svgalib-1.9.21/demos/printftest.c.demos	2000-01-06 13:12:36.000000000 +0100
++++ svgalib-1.9.21/demos/printftest.c	2005-07-01 20:51:55.000000000 +0200
+@@ -44,7 +44,7 @@
+ 
+     if (!vga_hasmode(vgamode)) {
+ 	printf(&quot;Mode not available.\n&quot;);
+-	exit(1);
++	return 1;
+     }
+ 
+     vga_setmode(vgamode);
+@@ -68,5 +68,5 @@
+ 
+     vga_setmode(TEXT);
+ 
+-    exit(retval);
++    return retval;
+ }
+--- svgalib-1.9.21/demos/fun.c.demos	2002-07-20 18:33:54.000000000 +0200
++++ svgalib-1.9.21/demos/fun.c	2005-07-01 20:51:55.000000000 +0200
+@@ -13,6 +13,7 @@
+ #include &lt;unistd.h&gt;
+ #include &lt;string.h&gt;
+ #include &lt;time.h&gt;
++#include &lt;string.h&gt;
+ #include &lt;vga.h&gt;
+ #include &lt;vgagl.h&gt;
+ 
+--- svgalib-1.9.21/demos/bankspeed.c.demos	2002-04-03 09:31:22.000000000 +0200
++++ svgalib-1.9.21/demos/bankspeed.c	2005-07-01 20:51:55.000000000 +0200
+@@ -125,7 +125,7 @@
+ 
+     if (!vga_hasmode(VGAMODE)) {
+ 	printf(&quot;Mode not available.\n&quot;);
+-	exit(-1);
++	return -1;
+     }
+     VIRTUAL = 0;		/* No virtual screen. */
+     if (vga_getmodeinfo(VGAMODE)-&gt;colors == 16 ||
+@@ -165,5 +165,5 @@
+     t2=clock();
+     printf(&quot;total:%1.2f sec\n&quot;,(1.0*t2-t1)/CLOCKS_PER_SEC); 
+     vga_setmode(TEXT);
+-    exit(0);
++    return 0;
+ }
+--- svgalib-1.9.21/demos/eventtest.c.demos	2000-01-06 13:12:36.000000000 +0100
++++ svgalib-1.9.21/demos/eventtest.c	2005-07-01 20:51:55.000000000 +0200
+@@ -3,6 +3,7 @@
+ #include &lt;stdlib.h&gt;
+ #include &lt;stdio.h&gt;
+ #include &lt;unistd.h&gt;
++#include &lt;time.h&gt;
+ #include &lt;sys/time.h&gt;
+ #include &lt;sys/types.h&gt;
+ #include &lt;vga.h&gt;
+@@ -254,5 +255,5 @@
+     keyboard_close();		/* Don't forget this! */
+ #endif
+     vga_setmode(TEXT);
+-    exit(0);
++    return 0;
+ }
+--- svgalib-1.9.21/demos/svidtune.c.demos	2000-01-06 13:12:36.000000000 +0100
++++ svgalib-1.9.21/demos/svidtune.c	2005-07-01 20:51:55.000000000 +0200
+@@ -48,7 +48,7 @@
+ 
+     if (!vga_hasmode(vgamode)) {
+ 	printf(&quot;Mode not available.\n&quot;);
+-	exit(1);
++	return 1;
+     }
+ 
+     vga_setmode(vgamode);
+@@ -176,5 +176,5 @@
+ 
+     vga_setmode(TEXT);
+ 
+-    exit(retval);
++    return retval;
+ }
+--- svgalib-1.9.21/demos/keytest.c.demos	2000-01-06 13:12:36.000000000 +0100
++++ svgalib-1.9.21/demos/keytest.c	2005-07-01 20:51:55.000000000 +0200
+@@ -38,7 +38,7 @@
+ 
+     if (!vga_hasmode(vgamode)) {
+ 	printf(&quot;Mode not available.\n&quot;);
+-	exit(1);
++	return 1;
+     }
+     printf(&quot;\nWARNING: This program will set the keyboard to RAW mode.\n&quot;
+ 	   &quot;The keyboard routines in svgalib have not been tested\n&quot;
+@@ -61,7 +61,7 @@
+     /* purposes. */
+     if (keyboard_init()) {
+ 	printf(&quot;Could not initialize keyboard.\n&quot;);
+-	exit(1);
++	return 1;
+     }
+     /* Translate to 4 keypad cursor keys, and unify enter key. */
+     keyboard_translatekeys(TRANSLATE_CURSORKEYS | TRANSLATE_KEYPADENTER |
+@@ -126,5 +126,5 @@
+ 
+     keyboard_close();		/* Don't forget this! */
+     vga_setmode(TEXT);
+-    exit(0);
++    return 0;
+ }
+--- svgalib-1.9.21/demos/scrolltest.c.demos	2000-01-12 21:03:39.000000000 +0100
++++ svgalib-1.9.21/demos/scrolltest.c	2005-07-01 20:51:55.000000000 +0200
+@@ -304,5 +304,5 @@
+     demo3();
+ 
+     vga_setmode(TEXT);
+-    exit(0);
++    return 0;
+ }
+--- svgalib-1.9.21/demos/forktest.c.demos	2000-01-06 13:12:36.000000000 +0100
++++ svgalib-1.9.21/demos/forktest.c	2005-07-01 20:51:55.000000000 +0200
+@@ -82,7 +82,7 @@
+ 
+     if (!vga_hasmode(vgamode)) {
+ 	printf(&quot;Mode not available.\n&quot;);
+-	exit(1);
++	return 1;
+     }
+     vga_setmode(vgamode);
+     gl_setcontextvga(vgamode);
+@@ -94,7 +94,7 @@
+     /* purposes. */
+     if (keyboard_init()) {
+ 	printf(&quot;Could not initialize keyboard.\n&quot;);
+-	exit(1);
++	return 1;
+     }
+     /* Translate to 4 keypad cursor keys, and unify enter key. */
+     keyboard_translatekeys(TRANSLATE_CURSORKEYS | TRANSLATE_KEYPADENTER |
+@@ -160,5 +160,5 @@
+     keyboard_close();		/* Don't forget this! */
+ 
+     vga_setmode(TEXT);
+-    exit(0);
++    return 0;
+ }
+--- svgalib-1.9.21/demos/mjoytest.c.demos	2000-01-06 13:12:36.000000000 +0100
++++ svgalib-1.9.21/demos/mjoytest.c	2005-07-01 20:51:55.000000000 +0200
+@@ -196,7 +196,7 @@
+ 
+     if (!vga_hasmode(vgamode)) {
+ 	printf(&quot;Mode not available.\n&quot;);
+-	exit(-1);
++	return -1;
+     }
+ 
+     puts(&quot;In the demo, press\n&quot;
+@@ -286,6 +286,6 @@
+     printf(&quot;Shutting down.\n&quot;);
+ 
+     vga_setmode(TEXT);
+-    exit(0);
++    return 0;
+ }
+ 
+--- svgalib-1.9.21/demos/speedtest.c.demos	2000-01-06 13:12:36.000000000 +0100
++++ svgalib-1.9.21/demos/speedtest.c	2005-07-01 20:51:55.000000000 +0200
+@@ -1,4 +1,3 @@
+-
+ #include &lt;unistd.h&gt;
+ #include &lt;stdlib.h&gt;
+ #include &lt;stdio.h&gt;
+@@ -308,5 +307,5 @@
+     speed();
+ 
+     vga_setmode(TEXT);
+-    exit(0);
++    return 0;
+ }
+--- svgalib-1.9.21/demos/linearspeed.c.demos	2003-11-07 10:26:02.000000000 +0100
++++ svgalib-1.9.21/demos/linearspeed.c	2005-07-01 20:51:55.000000000 +0200
+@@ -418,5 +418,5 @@
+     if(!fast)sysmem_speed();
+ 
+     vga_setmode(TEXT);
+-    exit(0);
++    return 0;
+ }
+--- svgalib-1.9.21/demos/testlinear.c.demos	2004-09-16 19:56:12.000000000 +0200
++++ svgalib-1.9.21/demos/testlinear.c	2005-07-01 20:51:55.000000000 +0200
+@@ -11,7 +11,7 @@
+ #include &lt;string.h&gt;
+ #include &lt;vga.h&gt;
+ #include &lt;time.h&gt;
+-#include &quot;../src/libvga.h&quot;
++#include &quot;libvga.h&quot;
+ 
+ 
+ #define USE_LINEAR_ADDRESSING
+@@ -66,7 +66,7 @@
+     if (!(argc == 2 &amp;&amp; strcmp(argv[1], &quot;--force&quot;) == 0))
+ 	if (!(vga_getmodeinfo(vga_getdefaultmode())-&gt;flags &amp; CAPABLE_LINEAR)) {
+ 	    printf(&quot;Linear addressing not supported for this chipset.\n&quot;);
+-	    exit(1);
++	    return 1;
+ 	}
+     vga_init();
+     vga_setmode(vga_getdefaultmode());
+@@ -75,7 +75,7 @@
+     if (vga_setlinearaddressing() == -1) {
+ 	vga_setmode(TEXT);
+ 	printf(&quot;Could not set linear addressing.\n&quot;);
+-	exit(-1);
++	return -1;
+     }
+ #endif
+ 
+--- svgalib-1.9.21/demos/Makefile.demos	2004-11-16 08:59:52.000000000 +0100
++++ svgalib-1.9.21/demos/Makefile	2005-07-01 20:59:09.000000000 +0200
+@@ -4,19 +4,15 @@
+ # This file is a part of SVGAlib.
+ #----------------------------------------------------------------------
+ 
+-include ../Makefile.cfg
+-
+-srcdir    = ..
+-VPATH     = $(srcdir)/demos
+-
+ #----------------------------------------------------------------------
+-# Compiler Section (overrides Makefile.cfg)
++# Compiler Section
+ #----------------------------------------------------------------------
+ 
+-CFLAGS = $(WARN) $(OPTIMIZE) -I$(srcdir)/include -I$(srcdir)/gl $(DEBFLAGS)
+-ifeq (a.out, $(TARGET_FORMAT))
+-  CFLAGS += -DSVGA_AOUT
+-endif
++CC      = gcc
++CFLAGS  = -Wall -Wstrict-prototypes
++CFLAGS += -fomit-frame-pointer -O2 -fno-strength-reduce -pipe -g
++LDFLAGS = -s
++LIBS    = -lvgagl -lvga -lm
+ 
+ #----------------------------------------------------------------------
+ # Rules Section
+@@ -25,51 +21,12 @@
+ PROGS    = fun testgl speedtest mousetest vgatest scrolltest testlinear \
+ 	   keytest testaccel accel forktest eventtest spin bg_test printftest \
+ 	   joytest mjoytest bankspeed lineart linearspeed addmodetest \
+-	   svidtune linearfork cursor vgatweak buildcsr
+-
+-# Determine what library (static or shared) we will be linking programs with
+-ifdef INSTALLSHAREDLIB
+-  LIBS = -lvgagl -lvga
+-endif
+-ifndef LIBS
+-  LIBS    = ../staticlib/libvgagl.a ../staticlib/libvga.a -lm
+-  LVGADEP = $(LIBS)
+-endif
++	   svidtune linearfork cursor vgatweak
+ 
+ all:	$(PROGS)
+ 
+-.PHONY: all clean cleanbin dep
+-
+-$(PROGS): $(LVGADEP)
+-
+ .c:
+ 	$(CC) $(CFLAGS) $(LDFLAGS) -o $* $*.c $(LIBS)
+ 
+-rwpage: rwpage.pp
+-	$(PC) -Rintel rwpage.pp
+-
+-testaccel: testaccel.c
+-	$(CC) $(CFLAGS) $(LDFLAGS) -o testaccel testaccel.c $(LIBS) -lm
+-
+-accel: accel.c
+-	$(CC) $(CFLAGS) $(LDFLAGS) -o accel accel.c $(LIBS) -lm
+-
+-linearspeed: linearspeed.c memset.o
+-	$(CC) $(CFLAGS) $(LDFLAGS) -o linearspeed linearspeed.c memset.o $(LIBS)
+-
+-buildcsr: mkcur.o
+-	$(CC) -o buildcsr $(LDFLAGS) mkcur.o -lvgagl -lvga
+-
+-clean:	cleanbin
+-	rm -f .depend *.o *~ *.bak core
+-
+-cleanbin:
+-	rm -f $(PROGS) rwpage
+-
+-#
+-# No dependencies required here.
+-#
+-
+-dep:
+-.depend:
+-
++clean:
++	rm -f $(PROGS)
+--- svgalib-1.9.21/demos/mousetest.c.demos	2000-01-06 13:12:36.000000000 +0100
++++ svgalib-1.9.21/demos/mousetest.c	2005-07-01 20:51:55.000000000 +0200
+@@ -34,7 +34,7 @@
+ 
+     if (!vga_hasmode(vgamode)) {
+ 	printf(&quot;Mode not available.\n&quot;);
+-	exit(-1);
++	return -1;
+     }
+ #ifndef MANUALLY_SETUP_MOUSE
+     /* Enable automatic mouse setup at mode set. */
+@@ -72,7 +72,7 @@
+     /* To be able to test fake mouse events... */
+     if (keyboard_init()) {
+ 	printf(&quot;Could not initialize keyboard.\n&quot;);
+-	exit(1);
++	return 1;
+     }
+ 
+     /* Set the range for the wheel */
+@@ -136,5 +136,5 @@
+ #endif
+ 
+     vga_setmode(TEXT);
+-    exit(0);
++    return 0;
+ }

Added: trunk/rpms/svgalib/svgalib-1.9.21-makefiles.patch
===================================================================
--- trunk/rpms/svgalib/svgalib-1.9.21-makefiles.patch	                        (rev 0)
+++ trunk/rpms/svgalib/svgalib-1.9.21-makefiles.patch	2008-07-04 02:31:15 UTC (rev 6396)
@@ -0,0 +1,30 @@
+--- svgalib-1.9.21/Makefile.makefiles	2005-03-18 14:49:10.000000000 +0100
++++ svgalib-1.9.21/Makefile	2005-07-08 21:16:12.000000000 +0200
+@@ -152,8 +126,10 @@
+ 	@echo &quot;savetextmode:     Script that saves textmode information used by 'textmode'.&quot;
+ 	@$(INSTALL_SCRIPT) utils/savetextmode $(bindir)
+ ifeq ($(LRMI),lrmi)
+-	@echo &quot;mode3:       Restore textmode by setting VESA mode 3.&quot;
++	@echo &quot;mode3:            Restore textmode by setting VESA mode 3.&quot;
+ 	@$(INSTALL_PROGRAM) lrmi-0.6m/mode3 $(bindir)
++	@echo &quot;vga_reset:        Restore textmode by resetting graphic board.&quot;
++	@cp lrmi-0.6m/vga_reset $(bindir)
+ endif
+ 	@echo &quot;Installing keymap utilities in $(bindir):&quot;
+ 	@echo &quot;svgakeymap:       Perl script that generates scancode conversion maps.&quot;
+--- svgalib-1.9.21/src/Makefile.makefiles	2005-02-03 12:31:43.000000000 +0100
++++ svgalib-1.9.21/src/Makefile	2005-07-08 21:16:12.000000000 +0200
+@@ -471,9 +471,11 @@
+ vga.o: vga.c
+ 	$(CC) $(CFLAGS) $(VGA_DEFINES) -c -o $@ $&lt;
+ 
+-#lrmi must NOT be compiled as -fPIC
++# XXX: Upstream used this so it may break, disabled to close an RC
++# lrmi must NOT be compiled as -fPIC
+ lrmi.o: lrmi.c
+-	$(CC) $(CFLAGS:-fPIC=) -c -o $@ $&lt;
++	$(CC) $(CFLAGS) -c -o $@ $&lt;
++#	$(CC) $(CFLAGS:-fPIC=) -c -o $@ $&lt;
+ 
+ $(RAMDAC): %.o: %.c
+ 	$(CC) $(CFLAGS) $(RAMDAC_DEFINES) -c -o $@ $&lt;

Added: trunk/rpms/svgalib/svgalib-1.9.25-kernel-2.6.26.patch
===================================================================
--- trunk/rpms/svgalib/svgalib-1.9.25-kernel-2.6.26.patch	                        (rev 0)
+++ trunk/rpms/svgalib/svgalib-1.9.25-kernel-2.6.26.patch	2008-07-04 02:31:15 UTC (rev 6396)
@@ -0,0 +1,69 @@
+diff -up svgalib-1.9.25/src/lrmi.6.c~ svgalib-1.9.25/src/lrmi.6.c
+--- svgalib-1.9.25/src/lrmi.6.c~	2008-05-31 15:58:26.000000000 +0200
++++ svgalib-1.9.25/src/lrmi.6.c	2008-05-31 15:58:26.000000000 +0200
+@@ -169,6 +169,13 @@ LRMI_free_real(void *m)
+ 		}
+ 	}
+ 
++#ifndef TF_MASK
++#define TF_MASK X86_EFLAGS_TF
++#define IF_MASK X86_EFLAGS_IF
++#define IOPL_MASK X86_EFLAGS_IOPL
++#define VIF_MASK X86_EFLAGS_VIF
++#define VIP_MASK X86_EFLAGS_VIP
++#endif
+ 
+ #define DEFAULT_VM86_FLAGS 	(IF_MASK | IOPL_MASK)
+ #define DEFAULT_STACK_SIZE 	0x1000
+diff -up svgalib-1.9.25/src/lrmi.9.c~ svgalib-1.9.25/src/lrmi.9.c
+--- svgalib-1.9.25/src/lrmi.9.c~	2008-05-31 15:58:25.000000000 +0200
++++ svgalib-1.9.25/src/lrmi.9.c	2008-05-31 15:58:25.000000000 +0200
+@@ -206,6 +206,13 @@ LRMI_free_real(void *m)
+ 
+ 
+ #if defined(__linux__)
++#ifndef TF_MASK
++#define TF_MASK X86_EFLAGS_TF
++#define IF_MASK X86_EFLAGS_IF
++#define IOPL_MASK X86_EFLAGS_IOPL
++#define VIF_MASK X86_EFLAGS_VIF
++#define VIP_MASK X86_EFLAGS_VIP
++#endif
+ #define DEFAULT_VM86_FLAGS 	(IF_MASK | IOPL_MASK)
+ #elif defined(__NetBSD__) || defined(__FreeBSD__) || defined(__OpenBSD__)
+ #define DEFAULT_VM86_FLAGS  (PSL_I | PSL_IOPL)
+diff -up svgalib-1.9.25/lrmi-0.6m/lrmi.c~ svgalib-1.9.25/lrmi-0.6m/lrmi.c
+--- svgalib-1.9.25/lrmi-0.6m/lrmi.c~	2008-05-31 16:10:14.000000000 +0200
++++ svgalib-1.9.25/lrmi-0.6m/lrmi.c	2008-05-31 16:10:14.000000000 +0200
+@@ -170,6 +170,14 @@ LRMI_free_real(void *m)
+ 	}
+ 
+ 
++#ifndef TF_MASK
++#define TF_MASK X86_EFLAGS_TF
++#define IF_MASK X86_EFLAGS_IF
++#define IOPL_MASK X86_EFLAGS_IOPL
++#define VIF_MASK X86_EFLAGS_VIF
++#define VIP_MASK X86_EFLAGS_VIP
++#endif
++
+ #define DEFAULT_VM86_FLAGS 	(IF_MASK | IOPL_MASK)
+ #define DEFAULT_STACK_SIZE 	0x1000
+ #define RETURN_TO_32_INT 	255
+diff -up svgalib-1.9.25/lrmi-0.9/lrmi.c~ svgalib-1.9.25/lrmi-0.9/lrmi.c
+--- svgalib-1.9.25/lrmi-0.9/lrmi.c~	2008-05-31 16:10:28.000000000 +0200
++++ svgalib-1.9.25/lrmi-0.9/lrmi.c	2008-05-31 16:10:28.000000000 +0200
+@@ -203,6 +203,13 @@ LRMI_free_real(void *m)
+ 
+ 
+ #if defined(__linux__)
++#ifndef TF_MASK
++#define TF_MASK X86_EFLAGS_TF
++#define IF_MASK X86_EFLAGS_IF
++#define IOPL_MASK X86_EFLAGS_IOPL
++#define VIF_MASK X86_EFLAGS_VIF
++#define VIP_MASK X86_EFLAGS_VIP
++#endif
+ #define DEFAULT_VM86_FLAGS 	(IF_MASK | IOPL_MASK)
+ #elif defined(__NetBSD__) || defined(__FreeBSD__) || defined(__OpenBSD__)
+ #define DEFAULT_VM86_FLAGS  (PSL_I | PSL_IOPL)

Added: trunk/rpms/svgalib/svgalib-todo
===================================================================
--- trunk/rpms/svgalib/svgalib-todo	                        (rev 0)
+++ trunk/rpms/svgalib/svgalib-todo	2008-07-04 02:31:15 UTC (rev 6396)
@@ -0,0 +1,103 @@
+wip:
+-don't allow any vga modes (not even 320x200x256, mode 5) with fbdev and
+ fbdev_novga, it barfs in vgaclear.c because of outb instructions. If the
+ framebuffer can handle it, it will still be available as mode 146.
+-use /sys/bus/pci for linear fd.
+-when mem_fd == -1 (nohelper, secure) and linear_fd != -1 and trying to set
+ runinbackground and CM can handle emulatepage set emulatepage instead of
+ refusing to runinbackground.
+
+wip2:
+-fix a cut and paste error in fbdev.c which caused fbdev_set_virtual_height
+ to not do anything, leaving yres_virtual at yres .
+-add fbdev_put_vscreeninfo, which tries to put the vscreen info three times
+ before giving up:
+ 1st with yres_virtual as calculated by fbdev_set_virtual_height
+ 2nd with yres_virtual set to 2x yres
+ 3th with yres_virtual set to yres
+ This is needed because even with the max of 8192 in fbdev_set_virtual_height
+ fbdev still doesn't like the yres_virtuals we calculate for all modes,
+ with this 3 attempts approach much more modes are available.
+-update fbdev_getmodeinfo to calculate maxpixels based on the yres_virtual
+ which actually succeeded.
+-check all uses of long, replace most with int because:
+ -most of the times a 32 bit variable is enough (it works on i386 where
+  a long is 32 bit doesn't it), 64 bit is a waste of memory and slower.
+ -sometimes a long ptr is used to walk past MMIO mapped 32 bits registers,
+  which causes it to walk in steps of 64 bits, skipping a reg each time,
+  which is a plain bug. This also goes for other use of long ptrs to point
+  to 32 bits data (memsetlong, memcpylong) .
+-change modeline for <A HREF="http://lists.repoforge.org/mailman/listinfo/commits">640x480 at 72Hz</A> in timing.c to Xorg's builtin default
+ modeline for <A HREF="http://lists.repoforge.org/mailman/listinfo/commits">640x480 at 72Hz</A>, the old one makes my monitor go into powersaving
+ mode.
+-restore textmode and return an error code if chipset_setregs fails
+ in vga_setmode.
+-use the same checks done in vga_runinbackground, in
+ vga_runinbackgroundversion to determine if runinbackground is ok.
+-add fbdev_novga docs to libvga.config
+  
+wip3:
+-vga_getmodeinfo used to check for EXT_INFO_AVAILABLE in modeinfo.flags,
+ before adding __svgalib_modeinfo_linearset to modeinfo.flags. This seems wrong,
+ since lots of drivers don't set EXT_INFO_AVAILABLE but do support linear
+ just fine, so the check has been simplified to just checking for
+ CAPABLE_LINEAR . Otherwise a program could get/do:
+ -call getmodeinfo, see that mode is linear capable
+ -call setlinearaddressing, which indicates success
+ -call getmodeinfo again, still don't see the IS_LINEAR flag.
+-in setmode don't set IS_LINEAR in __svgalib_modeinfo_linearset when enabling
+ LFB because of emulating page, although the LFB has been explicitly
+ enabled, this was not on the users request, so we mustnot return
+ LINEAR_POINTER, but GM in getgraphmem hence IS_LINEAR shouldnot be set.
+ And it is also not correct to report IS_LINEAR in getmodeinfo when not
+ explicitly requested.
+ (all this happened only for cards which need the LFB explicitly enabled).
+-in restorestate enable linear mode when emulating pages on cards which
+ need it explictly enabled, checking saved_linear is no longer enough,
+ since we no longer set IS_LINEAR in this case unless explicitly requested
+ by the user.
+-320x200x256 is linear because it fits within one page, but it should be
+ accessed through GM not through LINEAR_POINTER. Fix this in: vga.c &amp; vgapix.c.
+-Because of the above we cannot do 320x200x256 when emulating pages,
+ update vga_hasmode for this. 
+
+
+todo:
+-VESA on x86_64 ?!
+
+cleanups:
+-clean up makefiles, use TOPDIR everywhere, set include paths so that
+compilation of utils, gl threeDkit will work without install libvga first
+-check init return value in setchip xxx.
+-This has inspired me to get rid of the unneeded GM pointer in svgalib, GM
+(in drivers sometimes still called __svgalib_graph_mem) always points to
+BANKED_POINTER after a setmode, and no code checks for it not being set
+(which is ok, progs should call setmode before drawingfuncs) so tomorrow I'm
+going through the entire source and replace it all with BANKED_POINTER.
+Which imho is a better name, and makes things less confusing, why have 2
+ptrs for the same thing? 
+-vga_setchipsetandfeatures should do same sanitychecks as vga_setchipset
+-move come from background call to above forbidvtrelease=0
+-add chipset range check to disable_chipset, setchipset
+-get_perm in vga_fork is bullshit, because done already is 1 so it will do
+ nothing! Same goes for  __vga_map;
+-ioperm is not needed when doing iopl, what does iopl(value lower then 3) do?
+-ioperm does nog get inherited by fork, iopl does.
+-vga_set_LRMI_callbacks is done in a zillion places
+-move only do this once readconfig var to readconfig func.
+-move only do this once vars for map_mmio and map_mem to the funcs.
+-__svgalib_flipaway may be made static
+-__svgalib_runinbackground may be made static
+-map_mem may be made static
+-__svgalib_savemem may be removed
+-don't open /dev/mem in drivers instead use mem_fd
+-do we need to make sure fd's 0,1,2, are going somewhere in vga_init,
+ or can this be delayed till open_mem?
+-Remove release_acquire debug stuff
+-properly check mmap, fork execv and other return values.
+-make map_vgaxxxio static
+
+
+strangeness: 
+-inconsistent use of __svgalib_secondary in flip_away vs flip_back
+-vga_flip vs console switches

Added: trunk/rpms/svgalib/svgalib.spec
===================================================================
--- trunk/rpms/svgalib/svgalib.spec	                        (rev 0)
+++ trunk/rpms/svgalib/svgalib.spec	2008-07-04 02:31:15 UTC (rev 6396)
@@ -0,0 +1,126 @@
+# $Id$
+# Authority: dag
+
+Summary: Low-level fullscreen SVGA graphics library
+Name: svgalib
+Version: 1.9.25
+Release: 1
+Group: System Environment/Libraries
+License: Public Domain
+URL: <A HREF="http://www.svgalib.org/">http://www.svgalib.org/</A>
+
+Source0: <A HREF="http://www.arava.co.il/matan/svgalib/svgalib-%{version">http://www.arava.co.il/matan/svgalib/svgalib-%{version</A>}.tar.gz
+Patch0: svgalib-1.9.21-makefiles.patch
+Patch1: svgalib-1.4.3-fhs.patch
+Patch2: svgalib-1.9.21-demos.patch
+Patch3: svgalib-1.9.21-cfg.patch
+Patch4: svgalib-1.9.25-kernel-2.6.26.patch
+BuildRoot: %{_tmppath}/%{name}-%{version}-%{release}-root-%(%{__id_u} -n)
+
+Exclusivearch: %{ix86} x86_64
+
+%description
+The svgalib package provides the SVGAlib low-level graphics library
+for Linux.  SVGAlib is a library which allows applications to use full
+screen graphics on a variety of hardware platforms. Some games and
+utilities use SVGAlib for their graphics. For details on
+supported chipsets, see man 7 svgalib (when svgalib is installed).
+
+%package devel
+Summary: Development tools for the SVGAlib graphics library
+Group: Development/Libraries
+Requires: %{name} = %{version}-%{release}
+Provides: libvga-devel = %{version}-%{release}
+
+%description devel
+The svgalib-devel package contains the libraries and header files
+needed to build programs which will use the SVGAlib low-level graphics
+library.
+
+%prep
+%setup
+%patch0 -p1 -b .makefiles
+%patch1 -p1 -b .fhs
+%patch2 -p1
+%patch3 -p1 -b .defaultcfg
+%patch4 -p1
+
+#the testlinear demo needs svgalib's internal libvga header, so copy it to the
+#demo dir
+cp src/libvga.h demos
+
+%build
+#%{?_smp_mflags} doesn't work on x86_64 chances are it will fail on
+#some i386 machines too.
+%{__make} shared OPTIMIZE=&quot;%{optflags}&quot; LDFLAGS= \
+  prefix=&quot;%{_prefix}&quot; \
+  NO_HELPER=&quot;y&quot; \
+  INCLUDE_ET4000_DRIVER=&quot;y&quot; \
+  INCLUDE_OAK_DRIVER=&quot;y&quot; \
+  INCLUDE_MACH32_DRIVER=&quot;y&quot; \
+  INCLUDE_ET3000_DRIVER=&quot;y&quot; \
+  INCLUDE_GVGA6400_DRIVER=&quot;y&quot; \
+  INCLUDE_ATI_DRIVER=&quot;y&quot; \
+  INCLUDE_G450C2_DRIVER=&quot;y&quot; \
+  INCLUDE_ET4000_DRIVER_TEST=&quot;y&quot; \
+  INCLUDE_FBDEV_DRIVER_TEST=&quot;y&quot; \
+  INCLUDE_VESA_DRIVER_TEST=&quot;y&quot;
+make -C utils OPTIMIZE=&quot;%{optflags}&quot; LDFLAGS=&quot;&quot; \
+  prefix=&quot;%{_prefix}&quot;
+make -C threeDKit OPTIMIZE=&quot;%{optflags} -I../gl&quot; LDFLAGS=&quot;&quot; \
+  prefix=&quot;%{_prefix}&quot; lib3dkit.so.%{version}
+
+
+%install
+%{__rm} -rf %{buildroot}
+%{__install} -d -m0755 %{buildroot}%{_sysconfdir}/vga
+%{__install} -d -m0755 %{buildroot}%{_libdir}
+%{__make} install \
+  TOPDIR=&quot;%{buildroot}&quot; \
+  prefix=&quot;%{buildroot}%{_prefix}&quot; \
+  mandir=&quot;%{buildroot}%{_mandir}&quot; \
+  sharedlibdir=&quot;%{buildroot}%{_libdir}&quot; \
+  NO_HELPER=&quot;y&quot; \
+  MANFORMAT=&quot;compressed&quot; \
+  INSTALL_PROGRAM=&quot;install -p -m0755&quot; \
+  INSTALL_SCRIPT=&quot;install -p -m0755&quot; \
+  INSTALL_SHLIB=&quot;install -p -m0755&quot; \
+  INSTALL_DATA=&quot;install -p -m0644&quot;
+%{__ln_s} -f libvga.so.%{version} %{buildroot}%{_libdir}/libvga.so.1
+%{__ln_s} -f libvgagl.so.%{version} %{buildroot}%{_libdir}/libvgagl.so.1
+%{__ln_s} -f lib3dkit.so.%{version} %{buildroot}%{_libdir}/lib3dkit.so.1
+#for %ghost
+touch %{buildroot}%{_sysconfdir}/vga/fontdata
+touch %{buildroot}%{_sysconfdir}/vga/textregs
+
+%post -p /sbin/ldconfig
+%postun -p /sbin/ldconfig
+
+%clean
+%{__rm} -rf %{buildroot}
+
+%files
+%defattr(-, root, root, 0755)
+%doc doc/CHANGES doc/README.joystick doc/README.keymap lrmi-0.6m/README
+%doc doc/README.multi-monitor doc/README.vesa doc/TODO doc/dual-head-howto
+%doc %{_mandir}/man[^3]/*
+%dir %{_sysconfdir}/vga/
+%config(noreplace) %{_sysconfdir}/vga/dvorak-us.keymap
+%config(noreplace) %{_sysconfdir}/vga/libvga.config
+%config(noreplace) %{_sysconfdir}/vga/libvga.et4000
+%config(noreplace) %{_sysconfdir}/vga/null.keymap
+%ghost %{_sysconfdir}/vga/fontdata
+%ghost %{_sysconfdir}/vga/textregs
+%{_bindir}/*
+%{_libdir}/*.so.*
+
+%files devel
+%defattr(-, root, root, 0755)
+%doc demos doc/DESIGN doc/Driver-programming-HOWTO doc/README.patching
+%doc %{_mandir}/man3/*.3*
+%{_includedir}/*
+%{_libdir}/*.so
+
+%changelog
+* Thu Jul 03 2008 Dag Wieers &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>&gt; - 1.9.25-1
+- Initial package. (based on Fedora)


Property changes on: trunk/rpms/svgalib/svgalib.spec
___________________________________________________________________
Name: svn:keywords
   + Id Revision
Name: svn:eol-style
   + native

Modified: trunk/rpms/vobcopy/vobcopy.spec
===================================================================
--- trunk/rpms/vobcopy/vobcopy.spec	2008-07-04 02:30:42 UTC (rev 6395)
+++ trunk/rpms/vobcopy/vobcopy.spec	2008-07-04 02:31:15 UTC (rev 6396)
@@ -8,9 +8,11 @@
 License: GPL
 Group: Applications/Multimedia
 URL: <A HREF="http://vobcopy.org/projects/c/c.shtml">http://vobcopy.org/projects/c/c.shtml</A>
+
 Source: <A HREF="http://vobcopy.org/download/vobcopy-%{version">http://vobcopy.org/download/vobcopy-%{version</A>}.tar.bz2
 Patch0: vobcopy-1.0.1-Makefile.patch
 BuildRoot: %{_tmppath}/%{name}-%{version}-%{release}-root
+
 BuildRequires: libdvdread-devel
 
 %description


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="005194.html">[svn] r6395 - in trunk/rpms: . amrnb amrwb gsm liferea meld	perl-Nagios-Plugin syslinux
</A></li>
	<LI>Next message: <A HREF="005196.html">[svn] r6397 - in trunk/rpms: libshout tmux
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#5195">[ date ]</a>
              <a href="thread.html#5195">[ thread ]</a>
              <a href="subject.html#5195">[ subject ]</a>
              <a href="author.html#5195">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.repoforge.org/mailman/listinfo/commits">More information about the commits
mailing list</a><br>
</body></html>
