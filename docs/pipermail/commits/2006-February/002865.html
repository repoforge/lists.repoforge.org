<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [svn] r4065 - in trunk/rpms: . mirrordir nagios nagios-nrpe	nagios-nsca python-inotify
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:commits%40lists.repoforge.org?Subject=Re:%20Re%3A%20%5Bsvn%5D%20r4065%20-%20in%20trunk/rpms%3A%20.%20mirrordir%20nagios%20nagios-nrpe%0A%09nagios-nsca%20python-inotify&In-Reply-To=%3C20060209132957.356253180A7%40pooch.vmhosting.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002864.html">
   <LINK REL="Next"  HREF="002866.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[svn] r4065 - in trunk/rpms: . mirrordir nagios nagios-nrpe	nagios-nsca python-inotify</H1>
    <B>packagers at lists.rpmforge.net</B> 
    <A HREF="mailto:commits%40lists.repoforge.org?Subject=Re:%20Re%3A%20%5Bsvn%5D%20r4065%20-%20in%20trunk/rpms%3A%20.%20mirrordir%20nagios%20nagios-nrpe%0A%09nagios-nsca%20python-inotify&In-Reply-To=%3C20060209132957.356253180A7%40pooch.vmhosting.org%3E"
       TITLE="[svn] r4065 - in trunk/rpms: . mirrordir nagios nagios-nrpe	nagios-nsca python-inotify">packagers at lists.rpmforge.net
       </A><BR>
    <I>Thu Feb  9 14:29:57 CET 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="002864.html">[svn] r4064 - in trunk/rpms: nagios nagios-nrpe nagios-nsca
</A></li>
        <LI>Next message: <A HREF="002866.html">[svn] r4066 - in trunk/rpms: . icewm python-pyrss2gen
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2865">[ date ]</a>
              <a href="thread.html#2865">[ thread ]</a>
              <a href="subject.html#2865">[ subject ]</a>
              <a href="author.html#2865">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: dag
Date: 2006-02-09 14:29:55 +0100 (Thu, 09 Feb 2006)
New Revision: 4065

Added:
   trunk/rpms/mirrordir/
   trunk/rpms/mirrordir/mirrordir-0.10.49-datadir-fix.patch
   trunk/rpms/mirrordir/mirrordir-0.10.49-zlib-1.1.3-zfree.patch
   trunk/rpms/mirrordir/mirrordir.spec
Modified:
   trunk/rpms/nagios-nrpe/nagios-nrpe.spec
   trunk/rpms/nagios-nsca/nagios-nsca.spec
   trunk/rpms/nagios/nagios.spec
   trunk/rpms/python-inotify/python-inotify.spec
Log:
Updates

Added: trunk/rpms/mirrordir/mirrordir-0.10.49-datadir-fix.patch
===================================================================
--- trunk/rpms/mirrordir/mirrordir-0.10.49-datadir-fix.patch	2006-02-08 12:51:55 UTC (rev 4064)
+++ trunk/rpms/mirrordir/mirrordir-0.10.49-datadir-fix.patch	2006-02-09 13:29:55 UTC (rev 4065)
@@ -0,0 +1,51 @@
+diff -urN mirrordir-0.10.49-old/diffie/arc.h mirrordir-0.10.49/diffie/arc.h
+--- mirrordir-0.10.49-old/diffie/arc.h	Tue Nov 23 09:40:09 1999
++++ mirrordir-0.10.49/diffie/arc.h	Fri Jan 12 16:46:32 2001
+@@ -41,8 +41,8 @@
+ } Arc;
+ 
+ #ifndef HAVE_BUILTIN_ARC
+-#define ARC_INIT_SCRIPT		SYSCONFDIR &quot;/ssocket/arcinit.cs&quot;
+-#define ARC_ENCRYPT_SCRIPT	SYSCONFDIR &quot;/ssocket/arcencrypt.cs&quot;
++#define ARC_INIT_SCRIPT		SYSCONFDIR &quot;/mirrordir/arcinit.cs&quot;
++#define ARC_ENCRYPT_SCRIPT	SYSCONFDIR &quot;/mirrordir/arcencrypt.cs&quot;
+ #endif
+ 
+ void arc_init (Arc * arc, unsigned char *key, int key_size);
+diff -urN mirrordir-0.10.49-old/diffie/diffie-socket.h mirrordir-0.10.49/diffie/diffie-socket.h
+--- mirrordir-0.10.49-old/diffie/diffie-socket.h	Tue Nov 23 09:40:09 1999
++++ mirrordir-0.10.49/diffie/diffie-socket.h	Fri Jan 12 16:46:16 2001
+@@ -348,14 +348,14 @@
+ 
+ #else
+ 
+-#define SCRIPT_ACCEPT		SYSCONFDIR &quot;/ssocket/accept.cs&quot;
+-#define SCRIPT_CONNECT		SYSCONFDIR &quot;/ssocket/connect.cs&quot;
++#define SCRIPT_ACCEPT		SYSCONFDIR &quot;/mirrordir/accept.cs&quot;
++#define SCRIPT_CONNECT		SYSCONFDIR &quot;/mirrordir/connect.cs&quot;
+ 
+-#define KEY_DIR			SYSCONFDIR &quot;/ssocket&quot;
+-#define PRIVATE_KEY_DIR		SYSCONFDIR &quot;/ssocket/private&quot;
+-#define PUBLIC_KEY_DIR		SYSCONFDIR &quot;/ssocket/public&quot;
+-#define PRIVATE_KEY_FILE	SYSCONFDIR &quot;/ssocket/private/%d&quot;
+-#define PUBLIC_KEY_FILE		SYSCONFDIR &quot;/ssocket/public/%d&quot;
++#define KEY_DIR			SYSCONFDIR &quot;/mirrordir&quot;
++#define PRIVATE_KEY_DIR		SYSCONFDIR &quot;/mirrordir/private&quot;
++#define PUBLIC_KEY_DIR		SYSCONFDIR &quot;/mirrordir/public&quot;
++#define PRIVATE_KEY_FILE	SYSCONFDIR &quot;/mirrordir/private/%d&quot;
++#define PUBLIC_KEY_FILE		SYSCONFDIR &quot;/mirrordir/public/%d&quot;
+ #define USER_KEY_DIR		&quot;.ssocket&quot;
+ 
+ #endif
+diff -urN mirrordir-0.10.49-old/scripts/Makefile.in mirrordir-0.10.49/scripts/Makefile.in
+--- mirrordir-0.10.49-old/scripts/Makefile.in	Sun Jan 16 22:19:32 2000
++++ mirrordir-0.10.49/scripts/Makefile.in	Fri Jan 12 16:48:01 2001
+@@ -77,7 +77,7 @@
+ system = @system@
+ 
+ sysconf_DATA = accept.cs connect.cs arcencrypt.cs arcinit.cs
+-sysconfdir = ${prefix}/etc/ssocket
++sysconfdir = ${datadir}/mirrordir
+ mkinstalldirs = $(SHELL) $(top_srcdir)/mkinstalldirs
+ CONFIG_HEADER = ../config.h
+ CONFIG_CLEAN_FILES = 

Added: trunk/rpms/mirrordir/mirrordir-0.10.49-zlib-1.1.3-zfree.patch
===================================================================
--- trunk/rpms/mirrordir/mirrordir-0.10.49-zlib-1.1.3-zfree.patch	2006-02-08 12:51:55 UTC (rev 4064)
+++ trunk/rpms/mirrordir/mirrordir-0.10.49-zlib-1.1.3-zfree.patch	2006-02-09 13:29:55 UTC (rev 4065)
@@ -0,0 +1,39 @@
+--- mirrordir/zlib.orig/infblock.c	Mon Jun  8 19:06:16 1998
++++ mirrordir/zlib/infblock.c	Thu Feb  7 11:41:57 2002
+@@ -249,10 +249,11 @@
+                              &amp;s-&gt;sub.trees.tb, s-&gt;hufts, z);
+       if (t != Z_OK)
+       {
+-        ZFREE(z, s-&gt;sub.trees.blens);
+         r = t;
+-        if (r == Z_DATA_ERROR)
++        if (r == Z_DATA_ERROR) {
++	  ZFREE(z, s-&gt;sub.trees.blens);
+           s-&gt;mode = BAD;
++	}
+         LEAVE
+       }
+       s-&gt;sub.trees.index = 0;
+@@ -313,11 +314,12 @@
+         t = inflate_trees_dynamic(257 + (t &amp; 0x1f), 1 + ((t &gt;&gt; 5) &amp; 0x1f),
+                                   s-&gt;sub.trees.blens, &amp;bl, &amp;bd, &amp;tl, &amp;td,
+                                   s-&gt;hufts, z);
+-        ZFREE(z, s-&gt;sub.trees.blens);
+         if (t != Z_OK)
+         {
+-          if (t == (uInt)Z_DATA_ERROR)
++          if (t == (uInt)Z_DATA_ERROR) {
++	    ZFREE(z, s-&gt;sub.trees.blens);
+             s-&gt;mode = BAD;
++	  }
+           r = t;
+           LEAVE
+         }
+@@ -329,6 +331,7 @@
+         }
+         s-&gt;sub.decode.codes = c;
+       }
++      ZFREE(z, s-&gt;sub.trees.blens);
+       s-&gt;mode = CODES;
+     case CODES:
+       UPDATE

Added: trunk/rpms/mirrordir/mirrordir.spec
===================================================================
--- trunk/rpms/mirrordir/mirrordir.spec	2006-02-08 12:51:55 UTC (rev 4064)
+++ trunk/rpms/mirrordir/mirrordir.spec	2006-02-09 13:29:55 UTC (rev 4065)
@@ -0,0 +1,84 @@
+# $Id$
+# Authority: dag
+# Upstream: Paul Sheer &lt;psheer$obsidian,co,za&gt;
+
+Summary: Easy to use ftp mirroring package
+Name: mirrordir
+Version: 0.10.49
+Release: 1
+License: GPL
+Group: Applications/Internet 
+URL: <A HREF="ftp://ftp.obsidian.co.za/pub/mirrordir/">ftp://ftp.obsidian.co.za/pub/mirrordir/</A>
+
+Source: <A HREF="ftp://ftp.obsidian.co.za/pub/mirrordir/mirrordir-%{version">ftp://ftp.obsidian.co.za/pub/mirrordir/mirrordir-%{version</A>}.tar.bz2
+Patch: mirrordir-0.10.49-datadir-fix.patch
+Patch1: mirrordir-0.10.49-zlib-1.1.3-zfree.patch
+BuildRoot: %{_tmppath}/%{name}-%{version}-%{release}-root
+
+%description
+Easy to use ftp mirroring package - simply use
+mirrordir <A HREF="ftp://some.where.com/dir">ftp://some.where.com/dir</A> /some/local/dir
+
+%package devel
+Summary: Header files, libraries and development documentation for %{name}.
+Group: Development/Libraries
+Requires: %{name} = %{version}-%{release}
+
+%description devel
+This package contains the header files, static libraries and development
+documentation for %{name}. If you like to develop programs using %{name},
+you will need to install %{name}-devel.
+
+%prep
+%setup
+%patch -p1
+%patch1 -p1 -b .zfree
+
+%build
+%configure
+%{__make} %{?_smp_mflags}
+
+%install
+%{__rm} -rf %{buildroot}
+%{__perl} -pi -e 's|-f \$\(bindir\)/mirrordir \$|-f \$\(bindir\)/mirrordir \$\(DESTDIR\)\$|' src/Makefile
+%{__make} install DESTDIR=&quot;%{buildroot}&quot;
+
+%clean
+%{__rm} -rf %{buildroot}
+
+%post -p /sbin/ldconfig
+%postun -p /sbin/ldconfig
+
+%files 
+%defattr(-, root, root, 0755)
+%doc AUTHORS BUGS ChangeLog COPYING NEWS README THANKS TODO
+%doc %{_mandir}/man1/copydir.1*
+%doc %{_mandir}/man1/forward.1*
+%doc %{_mandir}/man1/mirrordir.1*
+%doc %{_mandir}/man1/pslogin.1*
+%doc %{_mandir}/man1/recursdir.1*
+%doc %{_mandir}/man1/secure-mcserv.1*
+%config(noreplace) %{_sysconfdir}/secure*
+%config(noreplace) %{_sysconfdir}/pam.d/*
+%{_bindir}/copydir
+%{_bindir}/forward
+%{_bindir}/mirrordir
+%{_bindir}/pslogin
+%{_bindir}/recursdir
+%{_bindir}/secure-mcserv
+%{_datadir}/mirrordir/
+%{_libdir}/libdiffie.so.*
+%{_libdir}/libmirrordirz.so.*
+
+%files devel
+%defattr(-, root, root, 0755)
+%{_libdir}/libdiffie.a
+%exclude %{_libdir}/libdiffie.la
+%{_libdir}/libdiffie.so
+%{_libdir}/libmirrordirz.a
+%exclude %{_libdir}/libmirrordirz.la
+%{_libdir}/libmirrordirz.so
+
+%changelog
+* Thu Feb 09 2006 Dag Wieers &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>&gt; - 0.10.49-1
+- Initial package. (using DAR)


Property changes on: trunk/rpms/mirrordir/mirrordir.spec
___________________________________________________________________
Name: svn:keywords
   + Id Revision
Name: svn:eol-style
   + native

Modified: trunk/rpms/nagios/nagios.spec
===================================================================
--- trunk/rpms/nagios/nagios.spec	2006-02-08 12:51:55 UTC (rev 4064)
+++ trunk/rpms/nagios/nagios.spec	2006-02-09 13:29:55 UTC (rev 4065)
@@ -3,7 +3,9 @@
 # Upstream: Ethan Galstad &lt;nagios$nagios,org&gt;
 
 %{?rh7:%define _without_embedperl 1}
+%{?rh7:%define _without_perlcache 1}
 %{?el2:%define _without_embedperl 1}
+%{?el2:%define _without_perlcache 1}
 
 ### FIXME: TODO: Add sysv script based on template. (remove cmd-file on start-up)
 %define logmsg logger -t %{name}/rpm
@@ -11,7 +13,7 @@
 Summary: Open Source host, service and network monitoring program
 Name: nagios
 Version: 2.0
-Release: 1
+Release: 2
 License: GPL
 Group: Applications/System
 URL: <A HREF="http://www.nagios.org/">http://www.nagios.org/</A>
@@ -67,6 +69,7 @@
 	--with-nagios-user=&quot;nagios&quot; \
 	--with-nagios-group=&quot;nagios&quot; \
 %{!?_without_embedperl:--enable-embedded-perl} \
+%{!?_without_perlcache:--with-perlcache} \
 	--with-perlcache \
 	--with-template-objects \
 	--with-template-extinfo \
@@ -106,7 +109,10 @@
 	/usr/sbin/useradd -r -d %{_localstatedir}/log/nagios -s /bin/sh -c &quot;nagios&quot; nagios || \
 		%logmsg &quot;Unexpected error adding user \&quot;nagios\&quot;. Aborting installation.&quot;
 fi
-/usr/sbin/groupadd nagiocmd &amp;&gt;/dev/null
+if ! /usr/bin/getent group nagiocmd &amp;&gt;/dev/null; then
+	/usr/sbin/groupadd nagiocmd &amp;&gt;/dev/null || \
+		%logmsg &quot;Unexpected error adding group \&quot;nagiocmd\&quot;. Aborting installation.&quot;
+fi
 
 %post
 /sbin/chkconfig --add nagios
@@ -152,7 +158,7 @@
 %{_bindir}/convertcfg
 %{_bindir}/nagios
 %{_bindir}/nagiostats
-%{_bindir}/p1.pl
+%{!?_without_perlcache:%{_bindir}/p1.pl}
 %{_bindir}/mini_epn
 %{_bindir}/new_mini_epn
 %{_libdir}/nagios/
@@ -174,6 +180,10 @@
 %{_includedir}/nagios/
 
 %changelog
+* Wed Feb 08 2006 Dag Wieers &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>&gt; - 2.0-2
+- Fixed the nagiocmd group creation. (Rick Johnson)
+- Added _without_perlcache macro. (Rick Johnson)
+
 * Wed Feb 08 2006 Dag Wieers &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>&gt; - 2.0-1
 - Updated to release 2.0.
 

Modified: trunk/rpms/nagios-nrpe/nagios-nrpe.spec
===================================================================
--- trunk/rpms/nagios-nrpe/nagios-nrpe.spec	2006-02-08 12:51:55 UTC (rev 4064)
+++ trunk/rpms/nagios-nrpe/nagios-nrpe.spec	2006-02-09 13:29:55 UTC (rev 4065)
@@ -9,7 +9,7 @@
 Summary: Nagios Remote Plug-ins Execution daemon
 Name: nagios-nrpe
 Version: 2.3
-Release: 1
+Release: 2
 License: GPL
 Group: Applications/Internet
 URL: <A HREF="http://www.nagios.org/">http://www.nagios.org/</A>
@@ -94,7 +94,7 @@
 
 start() {
 	echo -n $&quot;Starting $desc ($prog): &quot;
-	daemon $prog -s -c &quot;$CONFIG&quot; -d
+	daemon $prog -c &quot;$CONFIG&quot; -d
 	RETVAL=$?
 	echo
 	[ $RETVAL -eq 0 ] &amp;&amp; touch %{_localstatedir}/lock/subsys/$prog
@@ -217,6 +217,9 @@
 %{_libdir}/nagios/plugins/
 
 %changelog
+* Wed Feb 08 2006 Dag Wieers &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>&gt; - 2.3-2
+- Fixed wrong -s option and sysv problem on some dists. (Rick Johnson)
+
 * Wed Feb 08 2006 Dag Wieers &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>&gt; - 2.3-1
 - Updated to release 2.3.
 

Modified: trunk/rpms/nagios-nsca/nagios-nsca.spec
===================================================================
--- trunk/rpms/nagios-nsca/nagios-nsca.spec	2006-02-08 12:51:55 UTC (rev 4064)
+++ trunk/rpms/nagios-nsca/nagios-nsca.spec	2006-02-09 13:29:55 UTC (rev 4065)
@@ -10,7 +10,7 @@
 Summary: Nagios Service Check Acceptor
 Name: nagios-nsca
 Version: 2.5
-Release: 1
+Release: 2
 License: GPL
 Group: Applications/Internet
 URL: <A HREF="http://www.nagios.org/">http://www.nagios.org/</A>
@@ -83,7 +83,7 @@
 
 start() {
 	echo -n $&quot;Starting $desc ($prog): &quot;
-	daemon $prog -s -c &quot;$CONFIG&quot; -d
+	daemon $prog -c &quot;$CONFIG&quot; -d
 	RETVAL=$?
 	echo
 	[ $RETVAL -eq 0 ] &amp;&amp; touch %{_localstatedir}/lock/subsys/$prog
@@ -191,6 +191,9 @@
 %{_sbindir}/send_nsca
 
 %changelog
+* Wed Feb 08 2006 Dag Wieers &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>&gt; - 2.5-2
+- Removed -s option in sysv script. (Rick Johnson)
+
 * Wed Feb 08 2006 Dag Wieers &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>&gt; - 2.5-1
 - Updated to release 2.5.
 

Modified: trunk/rpms/python-inotify/python-inotify.spec
===================================================================
--- trunk/rpms/python-inotify/python-inotify.spec	2006-02-08 12:51:55 UTC (rev 4064)
+++ trunk/rpms/python-inotify/python-inotify.spec	2006-02-09 13:29:55 UTC (rev 4065)
@@ -6,13 +6,13 @@
 
 Summary: Python module implementing Linux inotify support
 Name: python-inotify
-Version: 0.0.6
+Version: 0.1.0
 Release: 1
-License: UNKNOWN
+License: GPL
 Group: Development/Libraries
-URL: <A HREF="http://www.amautacorp.com/staff/Rudd-O/projects/search-services/">http://www.amautacorp.com/staff/Rudd-O/projects/search-services/</A>
+URL: <A HREF="http://rudd-o.com/projects/python-inotify/">http://rudd-o.com/projects/python-inotify/</A>
 
-Source: <A HREF="http://www.amautacorp.com/staff/Rudd-O/projects/files/search-services/python-inotify-%{version">http://www.amautacorp.com/staff/Rudd-O/projects/files/search-services/python-inotify-%{version</A>}.tar.gz
+Source: <A HREF="http://rudd-o.com/wp-content/projects/files/python-inotify/python-inotify-%{version">http://rudd-o.com/wp-content/projects/files/python-inotify/python-inotify-%{version</A>}.tar.gz
 BuildRoot: %{_tmppath}/%{name}-%{version}-%{release}-root
 
 BuildRequires: python, python-devel
@@ -44,9 +44,12 @@
 %{python_sitearch}/_inotify.so
 %{python_sitearch}/inotify.py
 %{python_sitearch}/inotify.pyc
-%{python_sitearch}/FSTree.pyo
-%{python_sitearch}/inotify.pyo
+%ghost %{python_sitearch}/FSTree.pyo
+%ghost %{python_sitearch}/inotify.pyo
 
 %changelog
+* Wed Feb 08 2006 Dag Wieers &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>&gt; - 0.1.0-1
+- Updated to release 0.1.0.
+
 * Mon May 30 2005 Dag Wieers &lt;<A HREF="http://lists.repoforge.org/mailman/listinfo/commits">dag at wieers.com</A>&gt; - 0.0.6-1
 - Initial package. (using DAR)


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002864.html">[svn] r4064 - in trunk/rpms: nagios nagios-nrpe nagios-nsca
</A></li>
	<LI>Next message: <A HREF="002866.html">[svn] r4066 - in trunk/rpms: . icewm python-pyrss2gen
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2865">[ date ]</a>
              <a href="thread.html#2865">[ thread ]</a>
              <a href="subject.html#2865">[ subject ]</a>
              <a href="author.html#2865">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.repoforge.org/mailman/listinfo/commits">More information about the commits
mailing list</a><br>
</body></html>
