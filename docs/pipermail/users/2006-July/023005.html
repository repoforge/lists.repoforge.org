<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [suggest] new clamav update miss 'clamav' user/group creation/update
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:users%40lists.repoforge.org?Subject=Re:%20Re%3A%20%5Bsuggest%5D%20new%20clamav%20update%20miss%20%27clamav%27%20user/group%20creation/update&In-Reply-To=%3C44A8DD92.6020807%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   
   <LINK REL="Next"  HREF="023006.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[suggest] new clamav update miss 'clamav' user/group creation/update</H1>
    <B>J.J.Garcia</B> 
    <A HREF="mailto:users%40lists.repoforge.org?Subject=Re:%20Re%3A%20%5Bsuggest%5D%20new%20clamav%20update%20miss%20%27clamav%27%20user/group%20creation/update&In-Reply-To=%3C44A8DD92.6020807%40gmail.com%3E"
       TITLE="[suggest] new clamav update miss 'clamav' user/group creation/update">stigmatedbrain at gmail.com
       </A><BR>
    <I>Mon Jul  3 11:04:18 CEST 2006</I>
    <P><UL>
        
        <LI>Next message: <A HREF="023006.html">[suggest] new clamav update miss 'clamav' user/group	creation/update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23005">[ date ]</a>
              <a href="thread.html#23005">[ thread ]</a>
              <a href="subject.html#23005">[ subject ]</a>
              <a href="author.html#23005">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi folks,

Just updating clamav 'bundle' from old 'clamav-server' (i think the just
previous) and i noticed that the 'clamav' user/group for this pkg is not created
by default by the rpm pkg.

At the same time, the /var/log/clamav is not updated/created with clamav.clamav
ownership,

Don't know if it is my actual config (previous one untouched anyway), but this
is what i did to get it up and running in a CentOs 4.3 host

Thanks for your ideas

Jose

--------

[<A HREF="http://lists.repoforge.org/mailman/listinfo/users">root at sparkbox</A> ~]# yum update
&lt;...&gt;

Resolving Dependencies
--&gt; Populating transaction set with selected packages. Please wait.
---&gt; Package clamav.i386 0:0.88.3-1.el4.rf set to be updated
---&gt; Package clamav-db.i386 0:0.88.3-1.el4.rf set to be updated
---&gt; Package clamd.i386 0:0.88.3-1.el4.rf set to be updated
--&gt; Running transaction check

Dependencies Resolved

=============================================================================
 Package                 Arch       Version          Repository        Size
=============================================================================
Installing:
 clamav                  i386       0.88.3-1.el4.rf  rpmforge          724 k
     replacing  clamav-lib.i386 0.88.2-2.el4.kb

 clamav-db               i386       0.88.3-1.el4.rf  rpmforge          5.1 M
     replacing  clamav-update.i386 0.88.2-2.el4.kb

 clamd                   i386       0.88.3-1.el4.rf  rpmforge           64 k
     replacing  clamav-server.i386 0.88.2-2.el4.kb


Transaction Summary
=============================================================================
Install      3 Package(s)
Update       0 Package(s)
Remove       0 Package(s)
Total download size: 5.9 M
Is this ok [y/N]: y
Downloading Packages:
(1/3): clamav-0.88.3-1.el 100% |=========================| 724 kB    00:01
(2/3): clamav-db-0.88.3-1 100% |=========================| 5.1 MB    00:11
(3/3): clamd-0.88.3-1.el4 100% |=========================|  64 kB    00:00
Running Transaction Test
Finished Transaction Test
Transaction Test Succeeded
Running Transaction
  Installing: clamav-db                    ######################### [1/8]
  Installing: clamav
[2/8]warning: /etc/freshclam.conf created as /etc/freshclam.conf.rpmnew
  Installing: clamav                       ######################### [2/8]
  Installing: clamd                        ######################### [3/8]
  Cleanup   : clamav                       ######################### [4/8]
  Removing  : clamav-lib                   ######################### [5/8]
warning: /etc/sysconfig/freshclam saved as /etc/sysconfig/freshclam.rpmsave
warning: /etc/cron.d/clamav-update saved as /etc/cron.d/clamav-update.rpmsave
  Removing  : clamav-update                ######################### [6/8]
warning: /var/lib/clamav/main.cvd saved as /var/lib/clamav/main.cvd.rpmsave
warning: /var/lib/clamav/daily.cvd saved as /var/lib/clamav/daily.cvd.rpmsave
  Removing  : clamav-data                  ######################### [7/8]
  Removing  : clamav-server                ######################### [8/8]

Installed: clamav.i386 0:0.88.3-1.el4.rf clamav-db.i386 0:0.88.3-1.el4.rf
clamd.i386 0:0.88.3-1.el4.rf
Replaced: clamav-data.i386 0:0.88.2-2.el4.kb clamav-lib.i386 0:0.88.2-2.el4.kb
clamav-server.i386 0:0.88.2-2.el4.kb clamav-update.i386 0:0.88.2-2.el4.kb
Complete!


[<A HREF="http://lists.repoforge.org/mailman/listinfo/users">root at sparkbox</A> ~]# service clamd start
Starting Clam AntiVirus Daemon: ERROR: Can't get information about user clamav.

[FALL&#211;]
[<A HREF="http://lists.repoforge.org/mailman/listinfo/users">root at sparkbox</A> ~]# cp /etc/freshclam.conf /etc/freshclam.conf.old
[<A HREF="http://lists.repoforge.org/mailman/listinfo/users">root at sparkbox</A> ~]# cp /etc/freshclam.conf.rpmnew /etc/freshclam.conf
cp: &#191;sobreescribir &#171;/etc/freshclam.conf&#187;? (s/n) s
[<A HREF="http://lists.repoforge.org/mailman/listinfo/users">root at sparkbox</A> ~]# groupadd clamav
[<A HREF="http://lists.repoforge.org/mailman/listinfo/users">root at sparkbox</A> ~]# useradd -g clamav -s /sbin/nologin -c &quot;Clam AntiVirus&quot; clamav
[<A HREF="http://lists.repoforge.org/mailman/listinfo/users">root at sparkbox</A> ~]# service clamd start
Starting Clam AntiVirus Daemon:                                                [
 OK  ]

[<A HREF="http://lists.repoforge.org/mailman/listinfo/users">root at smarteyebox</A> yum.repos.d]# freshclam -v
ERROR: Can't open /var/log/clamav/freshclam.log in append mode (check permissions!).
ERROR: Problem with internal logger.

[<A HREF="http://lists.repoforge.org/mailman/listinfo/users">root at sparkbox</A> ~]# l /var/log/clamav/
drwxr-xr-x   2      104      105 4,0K jul  3 10:32 clamav/
&lt;...&gt;

[<A HREF="http://lists.repoforge.org/mailman/listinfo/users">root at sparkbox</A> ~]# chown -R clamav.clamav /var/log/clamav/

[<A HREF="http://lists.repoforge.org/mailman/listinfo/users">root at sparkbox</A> ~]# freshclam -v
Current working dir is /var/clamav
Max retries == 3
ClamAV update process started at Mon Jul  3 10:47:04 2006
Querying current.cvd.clamav.net
TTL: 103
Software version from DNS: 0.88.3
main.cvd version from DNS: 39
main.cvd is up to date (version: 39, sigs: 58116, f-level: 8, builder: tkojm)
daily.cvd version from DNS: 1579
daily.cvd is up to date (version: 1579, sigs: 2627, f-level: 8, builder: sven)
Freeing option list...done


[<A HREF="http://lists.repoforge.org/mailman/listinfo/users">root at sparkbox</A> ~]# clamscan
/root/.xauthv1YQ7D: OK
/root/.rpmmacros: OK
/root/.festival_history: OK
/root/.bash_history: OK
/root/.xauthyIE3tF: OK
/root/.gtkrc-1.2-gnome2: OK
/root/.xauthrr5vmv: OK
/root/.bash_profile: OK
&lt;...&gt;
----------- SCAN SUMMARY -----------
Known viruses: 60743
Engine version: 0.88.3
Scanned directories: 1
Scanned files: 54
Infected files: 0
Data scanned: 0.18 MB
Time: 2.030 sec (0 m 2 s)


[<A HREF="http://lists.repoforge.org/mailman/listinfo/users">sm0ketst at sparkbox</A> ~]$ clamscan
/home/sm0ketst/.signature.tag: OK
/home/sm0ketst/.rpmmacros: OK
/home/sm0ketst/soundconverter.log: OK
&lt;...&gt;





</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	<LI>Next message: <A HREF="023006.html">[suggest] new clamav update miss 'clamav' user/group	creation/update
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#23005">[ date ]</a>
              <a href="thread.html#23005">[ thread ]</a>
              <a href="subject.html#23005">[ subject ]</a>
              <a href="author.html#23005">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.repoforge.org/mailman/listinfo/users">More information about the users
mailing list</a><br>
</body></html>
